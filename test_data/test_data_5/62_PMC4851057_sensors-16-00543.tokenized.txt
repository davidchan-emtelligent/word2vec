sensors ( basel ) sensors ( basel ) sensors sensors ( basel , switzerland ) 1424 - 8220 mdpi 27092503 4851057 10.3390 / s16040543 sensors - 16 - 00543 article a sea - sky line detection method for unmanned surface vehicles based on gradient saliency wang bo * su yumin wan lei passaro vittorio m. n. academic editor national key laboratory of science and technology on underwater vehicle , harbin engineering university , harbin 150001 , china ; suyumin @ hrbeu.edu.cn ( y.s. ) ; wanlei @ hrbeu.edu.cn ( l.w . )
* correspondence : wb @ hrbeu.edu.cn ; tel. : + 86 - 451 - 8251 - 9733 15 4 2016 4 2016 16 4 543 07 2 2016 05 4 2016 ( c ) 2016 by the authors ; licensee mdpi , basel , switzerland .
2016 this article is an open access article distributed under the terms and conditions of the creative commons by attribution ( cc - by ) license ( http :// creativecommons.org / licenses / by / 4.0 /) .
special features in real marine environments such as cloud clutter , sea glint and weather conditions always result in various kinds of interference in optical images , which make it very difficult for unmanned surface vehicles ( usvs ) to detect the sea - sky line ( ssl ) accurately .
to solve this problem a saliency - based ssl detection method is proposed. through the computation of gradient saliency the line features of ssl are enhanced effectively , while other interference factors are relatively suppressed , and line support regions are obtained by a region growing method on gradient orientation .
the ssl identification is achieved according to region contrast , line segment length and orientation features , and optimal state estimation of ssl detection is implemented by introducing a cubature kalman filter ( ckf ) .
in the end , the proposed method is tested on a benchmark dataset from the " xl " usv in a real marine environment , and the experimental results demonstrate that the proposed method is significantly superior to other state - of - the - art methods in terms of accuracy rate and real - time performance , and its accuracy and stability are effectively improved by the ckf .
unmanned surface vehicle sea - sky line gradient saliency region growing line support region 1 .
introduction in recent years , with their rapid development usvs are playing more and more important roles in various areas such as meteorological monitoring , maritime search and rescue , enemy reconnaissance and precision military strikes .
to navigate autonomously and accomplish a variety of missions without human interventions , usvs need to be equipped with different sensors like radars , cameras and thermal infrared imagers to perceive and comprehend the marine environment and all kinds of targets around them , and intelligent behaviors including target detection , identification and tracking are implemented autonomously .
as a result , cameras have become an indispensable important sensor for usvs due to their high resolution , abundant information , similarity to the human visual system and low cost .
in the optical images obtained by cameras in the marine environment , the sea - sky line ( ssl ) is one of the most important cues .
firstly , in optical images where the ssl represents a dividing line , the sky region above and the sea region below have different pixel value distributions [ 1 ] , so the accurate detection of ssl is of great benefit to target detection .
secondly , while a distant target enters into the field of view ( fov ) of a camera , in optical images it always appears around the ssl , and then moves into the sky region or the sea region during the approaching process , therefore the detection of ssl is an effective measure to improve the target detection , identification and tracking performance through narrowing the target searching range and suppressing false detections .
thirdly , according to the position and motion pattern of the detected ssl , the motion status of usvs can be estimated and motion compensation of images can be implemented , which is quite applicable to usv target detection and tracking .
in optical images the ssl presents itself a dividing line composed of a gradient of maximum pixels between the sky region and the sea region , which is a straight line without consideration of sea surface curvature and optical distortion .
however , in optical images from real marine environments there often exist strong interferences , including cloud clutter and sea glint , besides , changeable weather conditions like fog , snow or rain can seriously decrease the image contrast and sharpness and brings about noise in images , causing great difficulties for accurate ssl detection .
kim , et al. extracted horizon pixels based on calculation of a column directional gradient , then a random sample consensus ( ransac ) algorithm was applied to select inlier horizon pixels and the final horizon was detected stably by least squares optimization [ 2 ] .
however , the ransac line fitting method is quite sensitive to widely distributed noise and strong edges and the authors claimed sensor pose information was exploited to predict the horizon location .
zou , et al. proposed a shearlet - based edge identification method for ssl detection in infrared images [ 3 ] .
shearlets are capable of direction information analysis and can provide edge geometric features , but the computational complexity is rather high and such a method is not suitable for real - time applications at all .
rahman , et al. accomplished horizon detection with the canny edge detection and hough transform methods [ 4,5,6,7,8 ] , but the hough transform needs a compromise between detection accuracy and computational complexity , moreover , it suffers from interference of strong edges and noise like cloud clutter and wave glint , and the hough transform often fabricates false line segments .
tang , et al. proposed a ssl detection method based on radon transform [ 9 ] , but this method faces the same problems as the hough transform , besides , the radon transform cannot determine the endpoints of line segments .
rahul , et al. proposed a theoretical framework for generating pseudospectral images from spectrum analysis of color images , and then an ellipse fitting method derived from calculation of inertia moments of connected components in binary edge images was introduced for horizon detection [ 10 ] .
however , when the image contrast or sharpness is weak , or strong interference edges exist , the probability of false detection increases significantly .
ahmad , et al. designed a maximally stable external edge detection method on the basis of canny edges , then a support vector machine classifier was trained to classify edge points using local scale invariant features , and finally , a dynamic programming method was applied to extract the horizon lines [ 11 ] .
however , machine learning methods always need a large amount of samples to train the classifier , and the great variations of illumination , reflection , scattering and clutter in marine environments brings great challenges for these methods .
nasim , et al. presented an approach employing the segmentation of sea surface scenes into several clusters with a k - means algorithm , then analyzed image clusters to extract the sky region and find a horizon path between the sky region and the other clusters [ 12 ] , but for these region segmentation methods , special features in the sea - sky scene such as low contrast , weak sharpness , cloud clutter and sea glint may lead to large misalignment or false horizon line detections .
in this paper a novel saliency - based ssl detection method is proposed. through the computation of gradient saliency the line features of ssl are enhanced effectively , while other interference factors are relatively suppressed , and line support regions ( lsr ) are obtained by a region growing method based on gradient orientation .
the ssl identification is achieved according to region contrast , line segment length and orientation features of lsrs , and an optimal state estimation of ssl detection is implemented by introducing ckf .
the structure of this paper is as follows : firstly , the hardware architechture and the principle of the optoelectronic imaging unit mounted on the " xl " usv are introduced .
then the key algorithms , such as gradient saliency calculation , region growing algorithm based on gradient orientation , improvement of detected line features , identification of ssl , and improvement of accuracy and stability based on ckf , are detailed in the following sections .
finally , our proposed method is tested on a benchmark dataset from the " xl " usv in a real marine environment to demonstrate its effectiveness .
2. hardware architecture an optoelectronic imaging unit capable of 2 - axis image stabilization is developed in our research work , and it is mounted on the " xl " usv to acquire optical images in real marine environments .
the hardware architecture is presented in figure 1 , where the optoelectronic imaging unit consists of three main parts : horizontal bearing stabilization servo , vertical pitch stabilization servo and stabilization control .
horizontal bearing stabilization servo , the principle of which is the same as vertical pitch stabilization servo , uses a mems gyroscope to measurethe horizontal angular velocity caused by usv motion disturbances on the camera , and uses an angle encoder to measure the horizontal angular position of the camera .
the sensor data is transmitted to the stabilization control , which generates control signals for the torque motor according to pid control law , and the torque motor drives the slip ring on which the camera is mounted to rotate to compensate the horizontal angular velocity caused by disturbances .
the digital video signal of the camera is grabbed and compressed into a video stream by stabilization control system , which executes some intelligent actions such as ssl detection , target detection , target identification and target tracking at the same time .
the video stream can be saved on local hard disks or transmitted to a real - time monitoring terminal far away through a suitable datalink .
3. detection of line features the diagram of the proposed ssl detection method is presented in figure 2 .
firstly , the gradient saliency is calculated based on rgb color space of optical images .
secondly , the saliency list is constructed and a region growing algorithm is applied to produce lsrs .
thirdly , the line features are extracted and improved on the basis of detected lsrs .
finally , the real ssl needs to be identified from candidate line features , and the accuracy is further improved by ckf according to previous state estimation and current detection .
3.1 .
gradient saliency saliency originates from visual uniqueness , unpredictability , rarity or surprise , and it is tightly related to human perception and processing of visual stimuli .
the human visual system always pays more attention to variations in images like color , gradient and edges , and high gradient edges arouse intense stimuli in the visual system , in other words , high gradient edges obtain high saliency [ 13 ] .
in this paper global gradient saliency based on the rgb color space is introduced .
the reason for choosing rgb color space instead of gray space in the calculation of gradient saliency is that gradient information is lost in the transformation from a rgb color image to a gray image , for instance , different color values could be projected into the same gray value [ 14 ] , which will have a negative influence on ssl detection as a result .
given an optical image i , the gradient submatrix for each color can be calculated through convolution of the color value submatrix with sobel operators , thus the gradient saliency of a pixel i in image i is formulated as a distance measure between the gradient of pixel i and the other pixels : ( 1 ) s ( i )= sumjinid ( gi,gj ) where d ( gi,gj ) denotes the distance measured between gradient vectors gi and gj of pixels i and j in image i. let the pixel number in image i be n the computational complexity of gradient saliency calculation for all pixels is o ( n2 ) .
actually , the definition of gradient saliency ignores spatial relations among pixels , therefore pixels with the same gradient will have the same gradient saliency , and gradient saliency can be rewritten as follows [ 13 ] : ( 2 ) s ( i )= sumk = 1nh ( gk ) d ( gi,gk ) where n is the number of distinct gradient vectors in image i , gk and h ( gk ) denote the gradient vector and its probability , respectively .
then the computational complexity of gradient saliency calculation is reduced to o ( n + n2 ) .
the distance measure d ( gi,gk ) is described as follows : ( 3 ) d ( gi,gk )=|| gi - gk || 1gi =[ dridgidbi ] t where || gi - gk || 1 denotes the l1 norm of vector gi - gk. if the gradient level of each color is normalized to l , then the number of distinct gradients is n = l3 and there will be 3l kinds of gradient saliency .
the accurate quantization of gradient saliency is beneficial to ssl detection accuracy , but the computational cost is high and there will be more ssl gaps .
subsequently , in this paper the gradient amplitude and orientation are used for gradient saliency calculation as follows [ 15 ] : ( 4 ) gi ={ 12 [( phixx + phiyy )+( phixx - phiyy ). cos2thetai + 2phixy.sin2thetai ]} 12thetai = 12arctan ( 2phixyphixx - phiyy ) where thetai is gradient orientation of pixel i , and quantities phixx , phixy and phiyy are defined as follows : ( 5 ) phixx = dridxdridx + dgidxdgidx + dbidxdbidxphixy = dridxdridy + dgidxdgidy + dbidxdbidyphiyy = dridydridy + dgidydgidy + dbidydbidy then the distance measure d ( gi,gk ) is simplified as follows : ( 6 ) d ( gi,gk )=| gi - gk | if the gradient level is normalized to l , then the number of distinct gradients is n = l and there will be l kinds of gradient saliency .
the computational cost is effectively reduced , and experiments show that the continuity and accuracy of detected ssl are satisfactory .
the gradient maps and gradient saliency maps of optical images acquired by the " xl " usv in typical adverse weather are presented in figure 3 .
figure 3a - c shows the typical original images obtained in rainy weather , sunny weather with strong illumination and foggy weather , respectively .
the gradient maps shown in figure 3d - f are obtained through convolution of the original images with sobel operators ; note that there exist high gradient edges formed by certain elements such as the usv hull , mountains , sunlight illumination and wave glint , which make it very difficult to distinguish and accurately detect ssls with relatively weak gradient .
in gradient saliency maps , as shown in figure 3g - i , the line features of ssl are effectively enhanced , although strong edges formed by various interference still exist and part of the ssl is missing , the ssl can already be detected accurately in all probability .
3.2 .
region growing based on gradient orientation the basic idea of region growing methods is that spatially neighboring pixels with similar properties should be clustered together to constitute connected regions .
the ssl in optical images shows typical line features , which are actually rectangular regions with a width of several pixels formed by neighboring pixel sets with high gradient and similar orientation , therefore we can consider the use of region growing methods to detect line features in gradient saliency maps [ 16 ] .
in this paper the seed points of region growing are selected according to gradient saliency , the criterion for growth is defined as similarity of gradient orientation , and the proximate rectangle regions with similar gradient orientation , known as lsr , are obtained as a result .
observing gradient saliency maps , we can conclude that pixels with high gradient saliency and geometric property actually account for a very small proportion , thus we can select a specific proportion of pixels with the highest gradient saliency to participate in region growing , and that will effectively decrease the computational complexity of the region growing method .
the region growing process based on gradient orientation can be described as follows : step 1 .
calculate the histogram of gradient saliency , select 10 % of pixels with the highest gradient saliency in the histogram and sort them in the order of gradient saliency to construct a saliency list l , set all the pixels in l as " unlabeled " ; step 2 .
pick up an " unlabeled " pixel i from saliency list l in sequence , initialize a lsr ck as a null set , add pixel i into ck and set it as " labeled " in l , and initialize the region orientation thetak of ck as gradient orientation of pixel i ; step 3 .
for each pixel j in ck , if its 8 - connected pixel l is " unlabeled " in saliency list l , and satisfies the condition as follows [ 16 ] : ( 7 ) | thetak - thetal |< tau where thetal is gradient orientation of pixel l , tau is tolerance of region growing and tau = pi / 8 , then add pixel l into ck and set it as " labeled " .
update the region orientation as follows : ( 8 ) thetak = arctansumjincksinthetajsumjinckcosthetaj if there is a new pixel added into ck , then repeat this step ; step 4 .
repeat steps 2 and 3 until all the pixels in saliency list l are " labeled " .
as shown in figure 4a - c , the gradient saliency histograms are calculated by the gradient saliency maps shown in figure 3g - i , where the red dot dashed lines denote the thresholds of 10 % of pixels with the highest gradient saliency .
figure 4d - f are saliency lists displayed in graphical format showing that the saliency lists essentially contain all the effective edges in the corresponding gradient saliency maps .
the region growing process based on gradient orientation is illustrated by the example of a 20 x 20 local region around ssl , as shown in figure 5 .
figure 5a presents the original image of the local region , and the gradient orientation of each pixel is indicated by an arrow , as depicted in figure 5b , where the red one denotes a seed point with maximum gradient saliency .
in figure 5c a lsr is obtained by region growing from the seed point , through appending to the seed point neighboring pixels that have high gradient saliency and similar gradient orientation , the lsr continues growing along the ssl , as shown in figure 5c , until the final lsr depicted in figure 5e is formed .
the blue rectangle in figure 5f is the minimum enclosing rectangle of the obtained lsr .
3.3 .
line feature extraction and improvement lsrs obtained by the region growing method indicate line features that exist in optical images , the mathematical description of line features can be generated by calculating statistical parameters of the lsr .
the saliency centroid ( x k,y k ) of lsr ck can be calculated as follows : ( 9 ) x k = sumiincks ( i ) xisumiincks ( i ) , y k = sumiincks ( i ) yisumiincks ( i ) where ( xi,yi ) is pixel coordinates of pixel i , s ( i ) is gradient saliency of pixel i. the correlation matrix phik of lsr ck is formulated as follows [ 16 ] : ( 10 ) phik =[ phixxphixyphixyphiyy ] where phixx , phixy and phiyy are second order saliency central moments defined as follows : ( 11 ) phixx = sumiincks ( i )( xi - x k ) 2sumiincks ( i ) , phiyy = sumiincks ( i )( yi - y k ) 2sumiincks ( i ) phixy = sumiincks ( i )( xi - x k )( yi - y k ) sumiincks ( i ) the main orientation theta k of lsr ck should be the angle denoted by eigenvector associated with the smaller eigenvalue of correlation matrix phik .
the line feature represented by ck corresponds to a geometric object that is a minimum enclosing rectangle rk of ck with the main orientation theta k. to calculate the length lk and width wk of rk for lsr ck , which are also the size of the line feature represented by ck , all the pixels in ck are rotated by theta k around centroid ( x k,y k ) , and the length lk and width wk are set to the smallest values that make the rectangle cover the complete lsr ck. the region growing method exploits similarity of gradient orientation as the predefined criterion for growth , the neighboring pixels , the gradient orientation of which is within the tolerance to main orientation of lsr , are appended to the lsr , thus some curve edges with small curvature or polyline edges with small orientation change may grow into lsr .
in two local regions of the gradient saliency maps shown in figure 6 , due to the small variation of gradient orientation , the polyline edge in figure 6a and the arc edge in figure 6b , which are marked by red rectangles , form two false lsrs after the region growing process .
if statistical parameters are computed on the basis of a false lsr , the line feature error will be huge , thus the curve edges and polyline edges should be approximately interpreted as several line features .
a lsr is improved according to its aligned point density , which is defined as follows : ( 12 ) dk = n ( ck ) n ( rk )= n ( ck ) lk.wk where n ( ck ) and n ( rk ) denote the pixel number of lsr ck and its minimum enclosing rectangle rk , dk is the aligned point density of lsr ck. if the aligned point density dk exceeds the threshold td , the lsr represents an effective line feature , otherwise the lsr should be interpreted as several line features , that means it needs to be cut into several lsrs by the following methods : method 1 .
reduce the tolerance of the region growing method to tau = pi / 16 , mark all the pixels included in the lsr as " unlabeled " and repeat region growing on this pixel set , compute the aligned point density of the new lsr , if it still does not exceed threshold the td , try method 2 ; method 2 .
define the radius rk of lsr ck as the maximum distance between the seed point and all the other pixels in ck , reduce rk to 80 % of current value and remove all the outlier pixels from ck , then repeat this procedure until the aligned point density dk exceeds threshold td. the threshold td needs to be set by experience , if td is set too large , the edges will be overcut , else if td is set too small , the aforementioned curve and polyline problem cannot be solved ; generally td is set to 0.7 .
the computed line features of lsrs are shown in original optical images , as depicted in figure 7 .
note that the curve edges in images are approximately interpreted as several line segments due to improvement of line features .
consequently , the negative influence of various edges on ssl detection is effectively suppressed by improvement of line features , otherwise there will be huge error in computation of line features for ssl detection , when other edges accidentally intersect ssl with small angles .
4. identification of ssl if we observe the line feature detection results of optical images acquired under typical adverse weather condtions , it is easy to discover that there are gaps in the ssl , or even part of the ssl is missing due to the adverse effect of factors such as target position , illumination , rain , snow and fog .
to achieve accurate identification of ssl , the line features of ssl need to be merged into an integral line feature first .
suppose that the line feature set detected from an optical image is denoted by { psik } where psik is the unique parameter vector of a line feature : ( 13 ) psik =[ x1k,y1k,x2k,y2k,theta k ] t where ( x1k,y1k ) and ( x2k,y2k ) are coordinates of the start point and the end point of the line feature , theta k is the orientation of the line feature .
then the necessary and sufficient condition that two line features psij and psik belong to the same line segment is formulated as follows : ( 14 ) | theta j - theta k |< delta | x1jy1j1x2jy2j1x1ky1k1 |< lambda ||( x1j,y1j ) - ( x2j,y2j )|| 2 | x1jy1j1x2jy2j1x2ky2k1 |< lambda ||( x1j,y1j ) - ( x2j,y2j )|| 2 where delta is the line feature orientation tolerance and delta = pi / 32 , lambda is the line feature offset tolerance and lambda = 2 .
when this condition is met , line features psij and psik are merged into a new line feature .
to reduce the computational complexity of line feature merging , the line feature set { psik } is arranged by the order of orientation theta k , so each time we only need to examine if two neighboring line features psik and psik + 1 satisfy the condition above .
if there are npsi line features in { psik } , then the computational complexity is reduced from o ( npsi2 ) to o ( npsilognpsi ) .
the experimental results of line feature merging are shown in figure 8 , where the blue line segments denote new line features , which are obtained by merging several line features that satisfy the condition above .
note that besides the line feature denoted by ssl , there are other line features produced by wave glint , the usv hull , the target , mountains , etc .
therefore the ssl needs to be identified from among the line feature set according to region contrast , line segment length and orientation features .
the region contrast etak of line feature psik is formulated as follows : ( 15 ) etak = sumj != kexp ( - ||( x k,y k ) - ( x j,y j )|| 22sigmaeta2 ) n ( cj )| s ( ck ) - s ( cj )| where s ( cj ) and s ( ck ) denote the mean gradient saliency of lsrs cj and ck corresponding to line features psij and psik , respectively .
( x j,y j ) and ( x k,y k ) are the saliency centroids of cj and ck , variance sigmaeta controls the weighting strength of spatial distance between saliency centroids and in this paper sigmaeta2 = 0.64 is used .
the likelihood muk of each line feature belonging to ssl can be calculated as follows : ( 16 ) muk = exp ( lkl0 - 1 ) etaksumetajcostheta k where lk and l0 denote length of the line feature and the image diagonal , respectively .
the line feature with the maximum likelihood muk will be selected as the ssl detection result .
5. detection accuracy improvement the kalman filtering theory considers a processed signal as the system output under the effect of gaussian white noise , and the relationship between input and output can be described by state space equations , thus the optimal state estimation can be recursively calculated by previous system state estimation and current measurement [ 17,18 ] .
to solve the high dimensional nonlinear filtering problems , haykin , et al. proposed a spherical - radial cubature rule to numerically compute multivariate moment integrals encountered in the nonlinear bayesian filter , and this nonlinear filter , known as ckf , achieves higher accuracy and stability for state estimation of nonlinear system over conventional nonlinear filters [ 19,20 ] .
there exist various interference factors like low contrast , low sharpness and noise in optical images from real marine environment , besides there are some approximations in ssl detection method , and those cause errors in ssl detection results .
to illustrate the noise distribution pattern in ssl detection results , we have mounted the optoelectronic imaging unit at the same height above the sea surface as the " xl " usv so that the camera is absolutely stationary without any impact of usv motion status .
optical images are acquired under different weather conditions and camera poses , and the ssl detection results are compared with the ground truth labeled by experts .
the comparison verifies that the noise amplitude obeys a gaussian distribution and its power spectral density is uniformly distributed , approximately .
thus we can use ckf to estimate the actual position of the ssl .
the geometric model of ssl detection is shown in figure 9 , where w and h are the image width and height , y1 and y2 are vertical coordinates of points where the ssl intersects with the left and right image borders , y0 is the vertical coordinate of the midpoint on the ssl , and theta0 is the orientation of the ssl .
the process equation for the ssl detection problem is formulated as follows : ( 17 ) y ^ k + 1 = f ( y ^ k )+ vk =[ 1deltat0.5.deltat200001deltat0000010000001deltat0.5.deltat200001deltat000001 ]. y ^ k + vk where y ^ k is the system state at time k and y ^ k =[ y1y.1y 1y2y.2y 2 ] kt , vk is gaussian white noise with zero mean and covariance qk , deltat is the period for acquiring optical images .
the measurement equation is formulated as follows : ( 18 ) z ^ k + 1 = h ( y ^ k + 1 )+ wk + 1 =[ y1 + y22atan ( y2 - y1w )] k + 1 + wk + 1 where wk + 1 is gaussian white noise with zero mean and covariance rk + 1 .
the cubature point set and the corresponding weights are set as follows [ 19 ] : ( 19 ) epsiloni = m2 [ 1 ] iomegai = 1m,i = 1,2 ,... , m = 2n where [ 1 ] i is the i - th element of a complete fully symmetric set of points , n is state dimension and n = 6 in this paper .
the cubature kalman filtering process is described as follows [ 20 ] : 5.1 .
time update factorize state covariance pk | k with cholesky decomposition : ( 20 ) pk | k = sk | ksk | kt evaluate the cubature points : ( 21 ) yi,k | k = sk | kepsiloni + y ^ k | k,i = 1,2 ,... , m = 2n evaluate the propagated cubature points : ( 22 ) yi,k + 1 | k *= f ( yi,k | k ) estimate the predicted state and error covariance : ( 23 ) y ^ k + 1 | k = 1msumi = 1myi,k + 1 | k * pk + 1 | k = 1msumi = 1myi,k + 1 | k * yi,k + 1 | k * t - y ^ k + 1 | ky ^ k + 1 | kt + qk 5.2 .
measurement update factorize predicted error covariance pk + 1 | k with cholesky decomposition : ( 24 ) pk + 1 | k = sk + 1 | ksk + 1 | kt evaluate the cubature points : ( 25 ) yi,k + 1 | k = sk + 1 | kepsiloni + y ^ k + 1 | k,i = 1,2 ,... , m = 2n evaluate the propagated cubature points : ( 26 ) zi,k + 1 | k = h ( yi,k + 1 | k ) estimate the predicted measurement and error covariance : ( 27 ) z ^ k + 1 | k = 1msumi = 1mzi,k + 1 | kpzz,k + 1 | k = 1msumi = 1mzi,k + 1 | kzi,k + 1 | kt - z ^ k + 1 | kz ^ k + 1 | kt + rk + 1 estimate the cross - covariance : ( 28 ) pxz,k + 1 | k = 1msumi = 1myi,k + 1 | kzi,k + 1 | kt - x ^ k + 1 | kz ^ k + 1 | kt estimate the kalman gain : ( 29 ) wk = pxz,k + 1 | kpzz,k + 1 | k - 1 estimate the updated state : ( 30 ) y ^ k + 1 | k + 1 = y ^ k + 1 | k + wk ( z ^ k + 1 - z ^ k + 1 | k ) update the state covariance : ( 31 ) pk + 1 | k + 1 = pk + 1 | k - wk + 1pzz,k + 1 | kwk + 1t 5.3 .
initial conditions the initial conditions of ckf for ssl detection are set as follows : ( 32 ) p0 | 0 = diag [ 100.09.01.0100.09.01.0 ] y ^ 0 =[ 180.00.00.0180.00.00.0 ] t the covariance matrices of process noise and measurement noise are set as follows : ( 33 ) qk =[ gamma00gamma ] , gamma =[ deltat5 / 20deltat4 / 8deltat3 / 6deltat4 / 8deltat3 / 3deltat2 / 2deltat3 / 6deltat2 / 2deltat ] rk + 1 = diag [ 100.016.0 ] 6 .
experimental results and discussion to demonstrate the effectiveness and superiority of the proposed saliency based ssl detection method , the " xl " usv was used to acquire optical images of a marine environment in typical adverse weather like rainy weather , sunny weather with strong illumination , and foggy weather in the penglai sea area , shandong province , china , as shown in figure 10 .
the exposure and focus of the optoelectronic imaging unit were set to auto mode , and the optical image resolution was set to 640 x 480 .
we have evaluated the proposed method on a benchmark dataset including 400 optical images and compared it against other state - of - the - art methods , including ransac line fitting [ 2 ] , hough transform [ 5 ] , radon transform [ 9 ] and shearlet transform [ 3 ] .
the experimental environment was the c ++ compiler of microsoft visual studio 2012 on a dual core 2.5 ghz machine with 2 gb ram .
for the hough transform and radon transform , we used the authors' implementations , while for ransac line fitting and shearlet transform , we implemented the algorithms in c ++ since we failed to obtain the authors' implementations .
the proposed method is similar to hough transform and radon transform in line feature detection , therefore the performance of the three methods in line feature detection is contrasted first .
figure 11a - c shows the line feature detection results of the hough transform .
the basic principle of the hough transform is to search for local peaks in hough space to determine the line feature parameters , however , random edges caused by wave glints , illumination , mountains and cloud clusters accumulate in hough space to form local peaks , and many mutually unrelated edges are connected in error to form false line features as a result , which causes great difficulty for the identification of the ssl .
figure 11d - f shows the line feature detection results of radon transform .
the radon transform projects gradient maps into sinograms by line integrals , then the local peaks are searched to determine the line feature parameters , thus it is confronted with the same problem as the hough transform , besides , the radon transform can not determine the endpoints of line features .
figure 11g - i is the results obtained by the proposed method .
the interference edges are obviously suppressed , and it is feasible to accurately identify the ssl from the detected line features .
therefore , the line feature detection performance of the proposed method is significantly superior to that of the hough transform and radon transform .
however , the ssl is usually weak or maybe even partly missing , so the interference edge points may randomly constitute lines which have many or even the most inliers , thus not only is the number of false alarmd of ransac line fitting rather high , but also the computational cost is enormously huge .
figure 12d,i,n,s,x are detection results of the shearlet transform. with the advantage of edge geometric features provided by the shearlet transform , the edge direction information is extracted and classified , but usually interference edges have better gradient orientation consistency than the relatively weak ssl , thus the detection accuracy of shearlet transform are not satisfactory , while the computational complexity is unacceptably huge .
figure 12e,j,o,t,y shows the detection results of the proposed method .
obviously the ssl can be more accurately detected in the presence of various interfering factors , and the detection accuracy performance is superior to that of the other state - of - the - art methods .
a detection result is considered to be accurate if it overlaps more than 50 % of the real ssl .
based on this criterion the accuracy rates of the hough transform , radon transform , ransac line fitting , shearlet transform and the proposed method were statistically compared .
besides , the real - time requirement for application on usvs is considered and the average consumed time is also contrasted .
as observed in table 1 , the accuracy rate and real - time performance of the proposed method significantly outperform other state - of - the - art methods .
ransac line fitting gets the worst accuracy rate , and it takes a lot of time to process a single image due to random edge point selection and inlier verification .
the shearlet transform achieves a better accuracy rate , but its computational complexity is huge and its real - time performance is the worst .
both the accuracy rate and the real - time performance of the hough transform are similar to those of the radon transform , but the radon transform projected gradient maps into sinograms , while the hough transform projects binary edge maps into hough space , thus the accuracy rate of the radon transform is slightly better but its average consumed time is a bit longer than that of the hough transform .
in a real marine environment a sequence of optical images were continuously acquired by optoelectronic imaging unit with a sampling period deltat = 80ms and processed by our proposed method online to detect the ssl .
taking 450 frames acquired during 36 s as an example , we compare the ssl detection results with state estimation by ckf , as depicted in figure 13 .
generally , the vertical coordinates y1 and y2 should be continuously and smoothly changing with time k , yet there exist many peaks which represent abrupt changes in the ssl state caused by usv motion and various interference factors .
thus ckf is applied to estimate the optimal state of the ssl according to the previous state estimation and current measurement , which denotes the ssl detection result of the current image .
as observed in figure 13 , the ssl state estimation by ckf is changing more smoothly with time , when it is accurately tracking the ssl state .
to quantitatively evaluate the accuracy improvement by ckf , the ssl detection results and state estimation by ckf have been contrasted with the ground truth , which is the manually labeled ssl in the dataset by experts .
the root mean square error ( rmse ) at time k is defined as follows : ( 34 ) rmse ( k )= 1ksumi = 0k ( y ^ k - y ^ k | k ) 2 where y ^ k is the ground truth at time k , and y ^ k | k is the detection result or state estimation by ckf at time k. the rmse of detection results and state estimation by ckf is shown in figure 14 .
after ckf applied to the proposed method , the rmse of state estimation decreases by more than 50 % and the accuracy of ssl detection is obviously improved .
the proposed method has been used on the " xl " usv to accelerate target searching by reducing the search area and computational complexity .
the sea trial results show that the search time for a single target decreases by more than 82 % with knowledge of the ssl location .
future research work will be concentrated on accurate noise modeling with compensation of usv motion status so that nonlinear bayesian filtering method could separate the noise to further improve the accuracy and stability of ssl detection method .
the proposed method could also be used for horizon detection of monochromatic images such as infrared images or spectrum images .
7. conclusions through the computation of gradient saliency , the line features of the ssl in optical images acquired in typical adverse weather can be effectively enhanced , while other interference factors are relatively suppressed .
the region growing method on gradient orientation can accurately extract line features which have good gradient orientation consistency , meanwhile avoiding the problems in other line feature detection methods like the hough transform and radon transform where mutually unrelated edges often get connected by mistake to form false line features .
experimental results from the " xl " usv in typical adverse weather demonstrate that the proposed method is significantly superior to other state - of - the - art methods in terms of accuracy rate and real - time performance , and its accuracy and stability has been further improved by ckf .
acknowledgments this research work is supported by the national high technology research and development program ( 863 program ) of china ( 2014aa09a509 ) and the national natural science foundation of china ( 51409054 , 51509054 ) .
author contributions bo wang : implementation of algorithm and experiment analysis and writing of the paper .
yumin su : scientific advising and writing .
lei wan : architecture design and implementation of optoelectronic imaging unit .
conflicts of interest the authors declare no conflict of interest .
references 1 .
ddumble s. gibbens p. horizon profile detection for attitude determination j. intell. robot. syst .
2012 68 339 357 2 .
kim s. lee j. small infrared target detection by region - adaptive clutter rejection for sea - based infrared search and track sensors 2014 14 13210 13242 25054633 3 .
zou r.b. shi c.c. a sea - sky line identification algorithm based on shearlets for infrared image adv. mater. res .
2014 846 1031 1035 4 .
kim s. sea - based infrared scene interpretation by background type classification and coastal region detection for small target detection sensors 2015 15 24487 24513 26404308 5 .
shen y.f. krusienski d. li j. rahman z. a hierarchical horizon detection algorithm ieee geosci .
remote sens. lett .
2013 10 111 114 6 .
wan l. zeng w.j. qin z.b. huang s.l. real - time detection of sea surface targets j. shanghai jiaotong univ. 2012 46 1421 1427 7 .
dong y.f. zhang y.f. zhu c. wang a.b. extracting sea - sky - line based on improved local complexity proceedings of the 2010 international conference on computer mechatronics , control and electronic engineering new york , ny , usa 24 - 26 august 2010 8 .
lan j.h. jia z.l. wu c.h. yang j. sea - land - line extraction using weighted optimum neighborhood algorithm proc .
spie 2013 10.1117 / 12.2038018 9 .
tang d. sun g. wang d.h. niu z.d. chen z.p. research on infrared ship detection method in sea - sky background proc .
spie 2013 10.1117 / 12.2033039 10 .
rahul w. raymond j. horizon detection from pseudo spectra images of water scenes proceedings of the 2010 ieee conference on cybernetics and intelligent systems singapore 28 - 30 june 2010 11 .
ahmad t. bebis g. rregentova e. nefian a. a machine learning approach to horizon line detection using local features proceedings of the 2013 9th international symposium on advances in visual computing rethymnon , greece 29 - 31 july 2013 12 .
boroujeni n.s. etemad s. ali w.a. robust horizon detection using segmentation for uav applications proceedings of the 2012 9th conference on computer and robot vision toronto , on , canada 28 - 30 may 2012 13 .
cheng m.m. mitra n.j. huang x.l. global contrast based salient region detection ieee trans .
pattern anal. mach. intell .
2015 37 569 582 10.1109 / tpami.2014.2345401 26353262 14 .
gershikov e. is color important for horizon line detection ?
proceedings of the 2014 international conference on advanced technologies for communications hanoi , vietnam 15 - 17 october 2014 15 .
di zenzo s. a note on the gradient of a multi - image comput. vis. graph .
image process .
1986 33 116 125 10.1016 / 0734 - 189x ( 86 ) 90223 - 9 16 .
grompone g.r. fakubowicz j. morel j.m. rrandall g. lsd : a fast line segment detector with a false detection control ieee trans .
pattern anal. mach. intell .
2010 32 722 732 20224126 17 .
kalman r.e. a new approach to linear filtering and prediction problems j. basic eng. trans .
asme 1960 82 35 45 10.1115 / 1.3662552 18 .
castella f.r. an adaptive two - dimensional kalman tracking filter ieee trans. aerosp. electron. syst .
1980 16 822 829 10.1109 / taes.1980.309006 19 .
arasaratnam i. haykin s. cubature kalman filters ieee trans. autom .
control 2009 54 1254 1268 10.1109 / tac.2009.2019800 20 .
jia b. xin m. cheng y. high - degree cubature kalman filter automatica 2013 49 510 518 10.1016 / j.automatica.2012.11.014 figure 1 hardware architecture of the optoelectronic imaging unit .
figure 2 block diagram of the proposed ssl detection method .
figure 3 gradient maps and gradient saliency maps of optical images in typical adverse weather conditions .
( a - c ) are original images ; ( d - f ) are gradient maps ; ( g - i ) are gradient saliency maps .
figure 4 histograms of gradient saliency and saliency list images .
( a - c ) are histograms of gradient saliency ; ( d - f ) are saliency list images .
figure 5 region growing process based on gradient orientation .
( a ) is the original image of the local region ; ( b - d ) show the lsr in growing ; ( e ) is the final lsr in the end of region growing ; ( f ) is minimum enclosing rectangle of the lsr .
figure 6 false detections of line features .
( a ) is polyline edge ; ( b ) is curve edge .
figure 7 line feature detection results of optical images in typical adverse weather conditions .
( a - c ) are optical images with extracted line features .
figure 8 line feature merging results of optical images in typical adverse weather conditions .
( a - c ) are optical images with improved line features .
figure 9 geometric model of ssl detection .
figure 10 " xl " usv and the optoelectronic imaging unit .
figure 11 line feature detection results of optical images : ( a - c ) are results of the hough transform method ; ( d - f ) are results of radon transform method ; ( g - i ) are results of the proposed method .
figure 12 comparison of ssl detection results .
( a,f,k,p,u ) are detection results of the hough transformation method ; ( b,g,l,q,v ) are detection results of the radon transformation method ; ( c,h,m,r,w ) are detection results of the ransac line fitting method ; ( d,i,n,s,x ) are detection results of the shearlet transformation method ; ( e,j,o,t,y ) are detection results of the proposed method .
figure 13 the ssl state comparison of detection results and state estimation by ckf .
( a ) are detection results and state estimation of vertical coordinate y1 ; ( b ) are detection results and state estimation of vertical coordinate y2 .
figure 14 the rmse comparison of detection results and state estimation by ckf .
( a ) is rmse of detection results and state estimation of vertical coordinate y1 ; ( b ) is rmse of detection results and state estimation of vertical coordinate y2 .
sensors - 16 - 00543 - t001 _ table 1 table 1 ssl detection result comparison of different methods on the benchmark dataset .
measure hough transform radon transform ransac line fitting shearlet transform the proposed method accuracy rate 76.8 % 79.0 % 67.3 % 84.3 % 94.8 % average consumed time 167 ms 185 ms 1354 ms 5629 ms 52 ms