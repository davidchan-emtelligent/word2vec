j neuroengineering rehabil journal of neuroengineering and rehabilitation 1743 - 0003 biomed central london 17767712 2008198 1743 - 0003 - 4 - 33 10.1186 / 1743 - 0003 - 4 - 33 research a biologically inspired neural network controller for ballistic arm movements bernabucci ivan 1 i.bernabucci @ uniroma3.it conforto silvia 1 conforto @ uniroma3.it capozza marco 2 neri.accornero @ uniroma1.it accornero neri 2 neri.accornero @ uniroma1.it schmid maurizio 1 schmid @ uniroma3.it d'alessio tommaso 1 dalessio @ uniroma3.it 1 dipartimento di elettronica applicata , universita degli studi " roma tre " , roma , italy 2 dipartimento di scienze neurologiche , universita " la sapienza " , roma , italy 2007 3 9 2007 4 33 33 22 5 2006 3 9 2007 copyright ( c ) 2007 bernabucci et al ; licensee biomed central ltd .
2007 bernabucci et al ; licensee biomed central ltd .
this is an open access article distributed under the terms of the creative commons attribution license () , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
background in humans , the implementation of multijoint tasks of the arm implies a highly complex integration of sensory information , sensorimotor transformations and motor planning .
computational models can be profitably used to better understand the mechanisms sub - serving motor control , thus providing useful perspectives and investigating different control hypotheses .
to this purpose , the use of artificial neural networks has been proposed to represent and interpret the movement of upper limb .
in this paper , a neural network approach to the modelling of the motor control of a human arm during planar ballistic movements is presented .
methods the developed system is composed of three main computational blocks : 1 ) a parallel distributed learning scheme that aims at simulating the internal inverse model in the trajectory formation process ; 2 ) a pulse generator , which is responsible for the creation of muscular synergies ; and 3 ) a limb model based on two joints ( two degrees of freedom ) and six muscle - like actuators , that can accommodate for the biomechanical parameters of the arm .
the learning paradigm of the neural controller is based on a pure exploration of the working space with no feedback signal .
kinematics provided by the system have been compared with those obtained in literature from experimental data of humans .
results the model reproduces kinematics of arm movements , with bell - shaped wrist velocity profiles and approximately straight trajectories , and gives rise to the generation of synergies for the execution of movements .
the model allows achieving amplitude and direction errors of respectively 0.52 cm and 0.2 radians .
curvature values are similar to those encountered in experimental measures with humans .
the neural controller also manages environmental modifications such as the insertion of different force fields acting on the end - effector .
conclusion the proposed system has been shown to properly simulate the development of internal models and to control the generation and execution of ballistic planar arm movements .
since the neural controller learns to manage movements on the basis of kinematic information and arm characteristics , it could in perspective command a neuroprosthesis instead of a biomechanical model of a human upper limb , and it could thus give rise to novel rehabilitation techniques .
background human beings are able to accomplish extremely complex motor tasks in all kinds of environments by means of a highly organized architecture including sensors , processing units and actuators. from a cognitive and developmental perspective , and a rehabilitation standpoint , it is necessary to fully understand the complex interactions between the controller ( the central nervous system ) and the controlled object ( all parts of the body )[ 1 ] .
these interactions describe the process of motor control for which many theories have been developed .
as far as the generation of motor commands is concerned , in literature it is generally acknowledged that nervous system generates motor commands based on internal models able to take account of the kinematics and the dynamics of the biomechanical structures [ 2 - 4 ] .
these models can be described as groups of neural connections that intrinsically contain information about biomechanical properties of the human body in relation both to the environment and the subject 's experience .
however , the mechanisms underlying the generation and organization of these neural models are still object of controversy [ 5 ] .
in order to interpret their functions , in literature different computational approaches to simulate both the biomechanical structure and the controller have been presented for a 2d [ 6 ] framework .
in this context , there is an interest in the use of artificial neural networks ( ann ) because of their capabilities to adapt and to generalise to new situations .
in order to link the neural learning / adaptation processes to their artificial replica , ann have been used in some studies regarding neurophysiologic simulations .
however , most of these ann imply the presence of a supervisor that uses sensory information in order to minimize the error related to the motor task [ 7 ] .
this methodology , commonly implemented on forward multilayer networks with retrospective learning ( back propagation ) , is efficient from an operative standpoint , but not completely plausible as a biologically inspired learning model of motor control , at least for the presence of a teacher who is pre - existent to the organization of the system .
to overcome this drawback , neural models using unsupervised training techniques for the exploration of motor spaces have been proposed [ 8 ] thus meeting the features of self - organization typical of internal representations .
the adaptability of the neural model together with the unsupervised training can also answer to environmental modifications such as those represented by external force fields and haptic distortions .
following this approach , it is of interest to study models able to simulate motor control mechanisms in terms of both generating and managing the sequence of motor commands that enable the arm to execute movements in the space .
in this paper the focus is on the execution of ballistic movements .
according to the work of karniel and inbar [ 9 ] , ballistic movements can be studied considering that : 1 ) there is no visual information ; 2 ) any single movement is ballistic .
as for every voluntary movement , the central nervous system must address three main computational problems : 1 ) determination of the desired trajectory in the visual coordinates ; 2 ) transformation of the trajectory from visual to body coordinates ; 3 ) generation of motor commands [ 10 ] .
the lack of visual information and the ballistic nature prevent to have a feedback on the controller [ 11,12 ] : in fact , the delay introduced by a proprioceptive feedback in a biological system is too large to permit on - line corrections of the trajectories , and other studies [ 13 ] state that motor commands could be adjusted online without the need to involve a conscious decision process .
in any case , the commonly accepted idea is that ballistic movements can be managed by feed - forward controllers without using visual information as feedback .
some common characteristics are generally shared by ballistic movements on a plane , and these are : roughly straight pathways and bell - shaped hand speed profiles [ 14,15 ] .
moreover , point to point movements have been studied following the hypothesis known as the minimum variance rule , able to attain physiological kinematic results as fitt 's law and 2 / 3 power law [ 16 ] .
some authors [ 17,18 ] tried to provide a mathematical explanation of these kinematic invariants suggesting the hypothesis that the central nervous system aims at maximizing the smoothness of the movement .
in this work , ballistic movements will be controlled by an ann controller that can be defined as " biologically inspired " .
it will be able to generate muscular activations knowing only the starting and arrival points of each movement , giving rise to a solution for the inverse dynamics problem ( that is determining muscular forces on the basis of kinematic information ) .
the muscular activations will generate ballistic movements having characteristics similar to human movements .
this biologically inspired model will integrate an ann , which should accomplish the task on the basis of its adaptability and plasticity [ 19,20 ] , together with a biomechanical arm model , considered as a 2 dof system , in order to simulate the behaviour of an end - effector driven by the sequences generated by the controller .
in the first part of this work , materials and methods will be reported : after a description of the parallel distributed computational system that has been used , the generator of the neural input commands and the biomechanical model of the arm will be presented .
finally , the evaluation tests and the obtained results will be discussed .
methods in this section we describe the general scheme of the proposed model , which can be divided into three main modules , each one with a specific functionality in the transformation process from perception to motor action , that is : the perception task , the elaboration of data and the motor activation .
therefore , two computational blocks simulate the motor control of the upper limb , while a third block is responsible for the modelling of the actuator .
the first module is devoted to processing spatial information in order to solve the inverse dynamics problem ( i.e. which neural signals , that is which forces , have to be generated to reach a specific point in the environment ?) .
the strategy can be acquired after a series of synaptic modifications that represent the construction of the internal model both in architectural and functional ways .
the whole process , that simulates the generation of the internal models by means of synaptic modifications , is called learning .
it must be emphasized that , since the main purpose of the present work is to characterize a model simulating the generation and the actuation of ballistic movements , no online feedback on the position error is present in the scheme .
we deal , in fact , with a process where the learning scheme modifies the neural features in order to map the working space and reach the desired targets .
even if the learning scheme can be considered as a functionality of the neural system , a separate paragraph in the materials and methods section has been devoted to the explanation of the learning process in order to outline the processing scheme adopted .
the second module is called pulse generator , and it essentially generates the motor signals necessary for to activate the muscles and to consequently produce the movements of the arm model .
the third module simulates a simplified version of the biomechanical arm model .
in fact , the human arm presents a high number of degrees of freedom and a redundancy due to the difference of dimensions between muscular activations space and working space ( that is the whole set of the points attainable by the arm model ) , so that the set of available ways to accomplish a specific task is not unique .
in the model , only two mono - articular pairs of muscles for each joint ( elbow and shoulder ) and a bi - articular pair of muscles connecting the two joints have been taken into account .
the first agonist - antagonist pair acts across the shoulder joint : the pectoralis major is the flexor , while the deltoid is the extensor .
the second pair acts across the elbow joint : the long head biceps brachialis is the flexor , while the lateral head triceps brachialis is the extensor .
the third pair of muscles links both the joints : the flexor is the biceps brachialis short head and the extensor is the triceps brachialis long head. from the results that will be presented below , it emerges that , even in this simplified version , the synthesized system is able to execute accurate planar movements .
the proposed model figure 1 shows a diagram of the entire model involving the cascade of the three modules .
figure 1 diagram of the modelled motor control chain .
the task is executed by the three modules , while no feedback connection is present .
the first module has been structured as a multi layer perceptron with an architecture composed by 4 layers .
the design process of the neural network used for this study is based on the analysis of the behaviour of various neural structures in responding to a same training and testing set .
in order to choose the most adequate structure , different types of neural networks have been considered and trained : a first group with only one hidden layer ( varying the number of neurons ) , and a second group with two hidden layers ( varying the number of neurons in different combinations for each layer ) .
experimental results considering the errors with respect to the training set and to the testing set as cross - validation ( in order to avoid over - fitting problems ) led us to choose an ann design with two hidden layer of 20 neurons each .
the input layer is therefore defined by 4 input units , which correspond to the coordinates of the starting and final positions of the movement .
more specifically , the first 2 units are related to the information on the initial position of the trajectory , while the other 2 units are related to the desired final position .
the output layer has 4 units , because the neural network generates one value of timing for each of the three muscular pairs related to shoulder and elbow , plus one value shared by all the muscular pairs , as in fig. 2 : tcoactshoulder , tcoactelbow , tcoactbiarticular , tall , respectively .
more specifically : figure 2 neural activations of the shoulder , the elbow and the biarticular muscle pair .
tall , total time of neural activations , is the same for all the muscles ; the three tcoact represent the interval of co - activation of flexor and extensor muscle .
the value of 1.5 s in the abscissa is the total observation time .
* for the shoulder , when the agonist muscle is activated , the movement starts .
after a time interval , defined by the ann , the antagonist is activated , so that the time interval tcoactshoulder is characterized by the co - activations of the agonist and antagonist ( mono - articular ) muscles of the shoulder joint ( i.e. simultaneous presence of the neural inputs for shoulder muscles ) ; its sign defines which muscle ( i.e. agonist or antagonist ) is activated first ; * for the elbow , tcoactelbow has the same function of tcoactshoulder ; * for the muscle pair that connect the two joints , tcoactbiarticular has the same function of tcoactshoulder and tcoactelbow .
* the movement duration is tall : it represents the total duration of the neural activation , thus affecting the whole movement of the arm .
this output value is constrained in the range 300 ms - 1 s. the time range has been chosen in order to let the limb model reach every sector of the working plane , while maintaining the ballistic characteristics of the movement .
figure 2 depicts the profile of these neural activations having rectangular shapes , and shows the duration of the entire voluntary task ranging in the interval 300 ms and 1 s. the transfer function chosen for every unit is the well known hyperbolic tangent nim = 21 + e - sumj = 0nmwjm - 1.njm - 1 - 1 , where the output nim of the ith neuron at the mth layer is obtained from the weighted outputs of the ( m - 1 ) th level .
the values generated by the output layer , from now on indicated as neural outputs p , are bounded between - 1 and 1 , and are used by the pulse generator .
the system , in the present version , allows having only biphasic activation patterns for each muscle pair .
thus , the interval delimited by the initial point of the pattern and the tcoactshoulder , the tcoactelbow and the tcoactbiarticular values correspond to the action pulse , i.e. the time in which the neural activations of the agonist muscle determine an activation in the emg signal , while the one going from this value till the end of the pattern , i.e. the time in which the neural co - activations of the antagonist muscle determine a braking burst in the emg signal [ 21 ] , corresponds to the braking command .
the range of these intervals , including the co - activation time of the shoulder and the elbow muscles , together with the whole duration of the activations , establishes the direction , length and curvature of the movements .
the neural outputs p need to be transformed in order to be utilized as commands for the muscles like mechanical actuators .
here the second module ( i.e. the pulse generator ) comes into play : its main purpose is to generate the pulse train shape , by analyzing and elaborating p. this pulse train should simulate the efferent commands given to the motor neurons , and thus to the biomechanical model of the arm .
the third module in fig. 1 corresponds to a biomechanical model of an upper limb , composed of a skeletal structure together with a muscular structure .
the skeletal model has a plant structure composed of two segments ( because the wrist joint is not considered ) , with lengths l1 and l2 , which represent the forearm and the upper arm respectively , connected through two rotoidal joints ( figure 3 ) .
the planar joints that connect the two segments can assume values ( q1 and q2 ) in the angular range [ 0 , pi ] .
these values can be put in correspondence with the cartesian coordinates of the free end in the working plane by means of direct kinematic transformation ( equation 2 ) .
figure 3 biomechanical model of the upper limb .
the two segments l1 and l2 represent the arm and the forearm. from the angular values q1 and q2 it is possible , by means of direct kinematics , to obtain the cartesian position of the wrist within the working plane .
the effect of gravity force is not considered in the model .
x = l1.cos ( q1 )+ l2.cos ( q1 + q2 ) y = l1.sin ( q1 )+ l2.sin ( q1 + q2 ) the muscular system is thus based on 6 muscle - like actuators , and establishes the dynamic relationship between the position of the arm and the torques acting on each single joint .
body segment anthropometrics and inertias of both upper arm and forearm are obtained from the scientific literature [ 22 ] , taking into account the specific body height and weight .
table 1 shows the values of the inertias adopted in the muscular - skeletal system .
table 1 numerical values of the parameters of the arm parameter units m - mass of the subject 80 kg m1 - mass of the upper arm 2.24 kg m2 - mass of the lower arm 1.92 kg l - height of he subject 1.70 m l1 - length of the upper arm 0.297 cm l2 - length of the lower arm 0.272 m i1 - inertias of the upper arm m1 *( 0.322 * l1 ) 2 i2 - inertias of the lower arm m2 *( 0.468 * l2 ) 2 following the work of massone and myers [ 1 ] , each muscle is synthesized with the non - linear hill - type lump circuit [ 23 ] as depicted in figure 4 .
figure 4 hill 's muscle model .
the force f applied on the joint depends on se , the series elastic element , pe , the parallel viscous element , and ce , that is the contractile element , defined by the neural input processor ( nip ) and a viscous element b ( nu ) where nu is the shortening velocity of the muscle .
according to the notation present in [ 9 ] , the neural outputs serve as inputs for the actuator , resulting in a time function called f0 representing the muscle tension .
the hill model is composed of a series elastic element ( se ) , a parallel viscous element ( pe ) and a contractile element ( ce ) which includes the non - linear viscosity b depending on the shortening velocity nu , as in equation 3 b ={( a.t0 )/( b + v ) a '. t0v <= 0v > 0a = a '= 4,b = 1 where a , b and a ' are constant parameters ( whose measurement units are respectively a = [ m - 1 ] , b = [ rad / s ] and a ' = [ a / b ]) and t0 is the value of the torque applied by the single muscular unit as a percentage of the maximum isometric force associated to that muscle ( t0 = fmax * f0 * d , where d is the average moment arm , fmax is the maximum isometric force associated to that muscle and f0 is the percentage coefficient ) , thus resulting in a different behaviour of the contractile element when shortening or lengthening .
table 2 shows the numerical values of the parameters of the hill 's model .
table 2 numerical values of the hill 's parameters parameter units kse 120 n / rad bpe 30 n.s / rad fmax ( shoulder ) 800 n fmax ( elbow ) 700 n fmax ( double joint ) 1000 n the force difference between the muscles of each single joint is implemented on the actuators by means of different maximal amplitudes of the corresponding forces .
the values of the forces are related to maximal values that are represented in table 2 .
then the effects of the corresponding torques thus obtained are then summed in order to obtain the overall torques on each joint tau1 and tau2 , as in equation 4 : tau1 = f1 - flex - f1 - ext + phi.f3 - flex - phi.f3 - exttau2 = f2 - flex - f2 - ext + phi.f3 - flex - phi.f3 - ext where phi = 0.6 and phi = 0.4 are non dimensional units and the f values in the equation are the values of the torque applied by each muscle of the corresponding joint during flexion or extension .
finally , the trajectory in the working plane is obtained from a double integration at each sampling time of the acceleration of the end point of the effector due to the changes in the overall torque applied to both joints .
the learning paradigm one key point of the present work is the training paradigm adopted for the neural controller with the aim of defining a specific internal model during ballistic movements of the arm , that is to establish a mapping between the desired movements within the working plane and the necessary neural outputs , so that the controller could learn the inverse dynamics of the biomechanical arm model .
the algorithm will adapt the neural weights and biases so that , if the 4 inputs of the network respectively correspond to the coordinates of the starting point [ q1 , q2 ] , and of the desired target [ q1d , q2d ] , then the output of the net will approach the correct p. more precisely , as shown in the scheme depicted in figure 5 , the output p of a non - trained network ( phase 1 ) can be the input for the biomechanical arm model ( phase 2 ) : this input leads to the execution of a reaching movement in general different from the desired one , that is towards a different target .
these neural inputs p , together with the starting and ending points coordinates , become the new data for the training of the network ( phase 3 ) .
in this way , a mapping between muscular activations and points of the working space can be attained .
figure 5 diagram of the exploration and the learning process .
( 1 ) the arm starts in the position defined by the angle q1 and q2 ( cartesian position xs , ys ) , while the desired target position is defined by q1d and q2d ( cartesian position xd and yd ) .
the angles q1 ' and q2 ' univocally define the spatial configuration of the arm in the arrival point ( cartesian position xa , ya ) ( 2 ) , that in the early phases of the learning process is different from the desired one : the ann learns the association between the starting point and the arrival point ( 3 ) .
the key feature of this approach is that the position error in executing the movements is not used in the training .
the reason is that , following the studies of [ 20 ] a supervised training mechanism for the controller must be excluded , thus meaning that the knowledge of the position error made in carrying out the movement will not be used to train the neural network .
the exclusion of a feedback circuit both in the phases of learning and executing the task , reflects the capacity of the motor control system to explore the workspace either without basing itself on pre - existent information ( batch supervised training ) or elaborating the data coming from the environment ( feedback error learning ) .
in the learning phase of the network , the association : " starting point - neural inputs generating the movement from the starting point to an ending point " is therefore used .
this is the step - by - step procedure in which the controller learns to make different movements .
it is important to stress again that , unlike most of the models proposed in the literature , this controller learns the movement actually carried out , not the wanted one .
this training strategy recalls the big picture of the classical piagetian 's concept of motor development .
more in particular it can be considered as leading the way to the circular reaction learning model .
otherwise , in the proposed scheme , the construction of the inverse dynamics of the arm within a particular environment neglects the interconnection between the eye and the arm systems , but is driven by a purely proprioceptive exploration phase outlining the development of an internal model .
during the training phase , the neural controller tends to achieve an optimal behaviour in reaching a desired target point by improving the correlation between the sensory map ( starting and ending point ) and the motor map ( muscular activations which generate the movement between these two points ) through the entire working plane .
the reduction of the error on the final position can be thus considered as a consequence and not a cause of the learning procedure .
the proposed neural model , basing on the philosophy architecture of direct - inverse model ( jordan , 1995 ) , shows novel and innovative characteristics .
simulating the internal model : the training phase during the training , the system automatically and randomly chooses the starting and ending points of the movements , which in turn determine the parameters p to be used in the pulse generator .
in addition , during the training a random noise generator acts on the output of the neural network in order to prevent convergence on local minima , which would imply a limitation in direction or amplitude of upper limb movements .
in fact , especially for the very first period of exploration , is it possible to have small variations in the weights of the neural controller .
this could possibly bring the neural network to converge to a local minimum state , where the weights are not optimally calibrated to face the problem of the arm control .
for this reason , the noise generator intervenes on the output parameters p of the neural controller with a probability exponentially decreasing with the number of overall movements ( see figure 6 ) .
figure 6 learning scheme of the proposed model .
the noise is added to the neural input generated by the controller .
the new vector ni is thus used for the generation of the muscular activities and for the controller training process .
in the initial phases of the training , the controller is not trained , and there is no correspondence between the desired target and the one actually reached by the movement of the biomechanical model of the arm .
at the end of each task , a standard back - propagation algorithm with momentum is used for the training and thus the variation of the weights .
the training of the artificial neural network and the complete coverage of the working plane , with respect to both the possible starting and target points , can be reached with about 200.000 random generations ( epochs ) .
the decision about the end of the training is not based on a prefixed number of movements / training steps but on the monitoring of the convergence of the network .
once the neural controlled is trained , the overall system is tested and the behaviour is analyzed .
in this second phase , the noise generator is not active .
even if the inputs driving the network are different from those used in the training phase , the generalization capabilities of the connectionist system enables it to operate correctly .
simulating the internal model : testing the performance of the model tests , and comparisons with results available in literature have been performed in order to evaluate the performance of the model after the convergence of the network .
the neural controller has been tested by presenting a high number of pairs of randomly chosen start - target points , and the errors in reaching the target have been recorded .
initially , in order to qualitatively test the behaviour of the controller , a set of 1000 movements starting from the same initial point have been considered .
this set have been used to analyze the capacity to cover the entire workspace , to give a graphical representation of the correlation of the error position with respect to the length of the movements and to observe the distribution of the peak velocity within the working plane .
furthemore,1200 random movements ranging from 5 cm to 60 cm , subdivided into groups spaced out by 5 cm ( 200 movements per group ) , have been generated , in order to make a comparison with the kinematic analysis of ballistic arm movements presented in literature ( such as in [ 8,14,24 ]) , where movements with a maximum amplitude of +/ - 30 cm have been examined .
this subset has been defined physiological subset ( ps ) .
the characteristics of these tasks have been analyzed and compared to the data obtained from experimental tests on human beings , carried out in [ 8,24 ] .
in the latter paper , indexes useful to quantitatively determine some characteristics of the movements have been calculated .
the accuracy of the neural network in implementing the movements has been characterised by means of the following parameters : * the absolute position error of the arrival position reached by the end - effector with respect to the desired final position ( or target ) .
* the module error ( the amplitude error ) .
* the phase error ( the error pointing at the target ) .
* the curvature .
* the velocity curve .
the position and phase errors have been chosen in order to reveal the presence of a biased behaviour .
in particular , the module error | e | has been defined as the difference between the segment connecting the starting point and the arrival point ( xa , ya ) and the straight line from the starting point to the target ( xt , yt ) .
the phase error /_ e ( deltaphi ) has been defined as the difference of the angles which identify the two lines connecting the starting point with respectively the target and the arrival point , and it has been used to determine if the neural controller was able to correctly point at the target .
the pair of error parameters are graphically explained in figure 7 .
figure 7 module and phase error .
considering the movement directed from the starting point ( xp , yp ) to the arrival point ( xa , ya ) , the module error ( or amplitude error ) | e | is the distance between ( xtp , ytp ) and ( xa , ya ) ; the phase error ( or the direction error ) is the angular difference between the segment connecting ( xp , yp ) and ( xt , yt ) and the segment connecting ( xp , yp ) and ( xa , ya ) .
for the curvature , there are various definitions in the literature .
the index of curvature of a movement , c , is defined in [ 24 ] as the ratio between the curvilinear abscissa and the minimum euclidean distance between the starting and the arrival point .
where the numerator represents the amplitude of the movement carried out , while the denominator is the minimum distance between the starting point and the arrival point .
this is defined as the normal curvature ( nc ) .
in [ 25,26 ] , two curvature indexes are used : the first is the ratio between the distance from the medium point of the straight line connecting the starting ( a ) and the arrival point ( b ) and the trajectory performed by the subject ( medium curvature : mdc ) , while the second considers the maximum value of all the distances from the points defining the trajectory and the straight line defining the minimum distance from the two extremities of the path ( maximum curvature : mxc ) .
in [ 27 ] the measure of curvature is obtained from mxc , by replacing the maximum value with the mean value ( total curvature : tc ) .
figure 8 graphically describes these differences .
figure 8 curvature indexes .
the figure shows the 4 indexes taken into account : the normal curvature ( nc ) is the ratio between the length of the trajectory executed ( l ) and the straight line connecting the starting point and the arrival point ( h ) .
the maximum curvature is the maximum distance ( d ) between l and h. the medium curvature is the distance ( d ) between l and h evaluated in h / 2 .
in the end the total curvature is the mean value of all the distances d between l and h. the coefficient of variation ( cv ) , defined as the ratio between the standard deviation and the mean error position has also been evaluated .
the distribution of the neural activation times with respect to the length of the movements has been taken into account .
finally , the performance of the model with respect its possibilities of adapting to modifications in the environment , such as the presence of disturbing force fields , has been taken into account .
to this purpose , a force proportional to the movement speed and directed along the horizontal axis has been inserted in the model , after the training for unobstructed movements in all the working plane .
the additional training necessary to the model to be able to cope with this force and the performance as for the reaching errors have been evaluated .
results and discussion the proposed neural system is able to achieve a complete coverage of the working plane , unlike other models [ 9 ] which are limited to short amplitude motor tasks , usually around 20 - 30 cm. this feature can be appreciated in figure 9 where , for visualization purposes , the same starting point and 1000 target points have been considered .
figure 9 distribution of the targets reached within the working plane .
the starting point is indicated with the circle mark .
it is possible to observe an almost complete coverage of the area .
figure 10 shows two different movements starting from the same point , together with the neural outputs p and the relevant velocity profiles .
figure 10 example of two movements carried out by the arm model guided by the trained neural controller starting from the same initial position .
the starting point is the same for the 2 tasks ( coordinates : x = - 0.2 ; y = 0.2 ) ; the arrival points have been chosen in 2 different symmetric positions with respect to the starting point , at a distance of about 22.4 cm. each row represents a different movement .
the left column of this image depicts the trajectory followed by the wrist .
the central column shows the neural inputs necessary for the motor commands of the flexor and extensor muscles acting on both the shoulder and the elbow joint .
the right column shows the wrist velocity profile .
the first movement of the set simulates the role of the pectoralis major , in the shoulder joint , for targets positioned in a position west with respect to the starting point , while the second one implies the use of the deltoid for the target allocated in a position east with respect to the starting point .
the velocity profile reflects the bell shaped behaviour typically found in literature ( see e.g. [ 14 ]) .
figure 11 shows that even when changing the starting point , the relations between the direction of the movement and the neural inputs persist .
figure 11 example of two movements carried out by the arm model guided by the trained neural controller starting from different initial positions .
the two tasks start from different points , and point towards different directions within the working plane .
in the upper row , the central column shows the neural commands of the muscle pair of the shoulder and of the elbow joint necessary for the trajectory presented in the left column .
the movement starts at the point [ - 0.4 ; 0.35 ] while the target point is at [ - 0.2 ; 0.2 ] .
in the lower row , the right column shows the wrist velocity profile for the second movement whose starting point is at [ - 0.2 ; 0.3 ] and whose target point is at [ - 0.2 ; 0.1 ] .
for the ps , the mean position error has been of about 4.8 cm with a standard deviation of about 4 cm. figure 12 shows the histogram of the percentage of the absolute position error with respect to the length of the movement .
the mean absolute error , normalised with respect to the length of the movements , resulted always lower than 0.27 .
these findings show that the model is able to accurately simulated ballistic ( unobstructed ) movements of the arm .
figure 12 histogram of the percentage error position .
histogram of the percentage error position ( pe , that is the absolute position error with respect to the length of the movement carried out ) of the end effector of the upper limb with respect to the number of movements analyzed .
the module error shows a value of 0.51 cm. , as illustrated by figure 13 .
the mean value of the angular error , presented in figure 14 , resulted almost negligible , thus showing that the ann gives unbiased results , that is it is able to correctly point ( in the average ) at the target with limited ( in the average ) errors .
figure 13 module error .
the figure shows the trend of the module error ( or amplitude error ) with respect to the movements included in the subset analyzed .
it is possible to observe that the mean value is close to zero , thus proving an unbiased behaviour .
figure 14 phase error .
the figure shows the trend of the phase error ( or direction error ) with respect to the movements included in the subset analyzed .
also in this case the mean value is negligible .
moreover , in figure 15 it is possible to see that the mean absolute position error has a limited variation with the increase of the movement length .
figure 15 dispersion of the error with respect to the length of the movements .
it is possible to observe a monotonic increase of the mean position error value with respect to the length of the movement .
the vertical bars represent the value 2 * std .
when analysing the cv of the movements in ps it is possible to observe that monotonically increases ranging from 0.6 to 0.8 .
this behaviour can be explained by considering that when the movement becomes longer the precision in reaching the target decreases and the position error distribution increases .
a comparison between the experimental data reported in [ 24,26 ] and the data extracted from the simulated model of the present work is interesting because it puts in evidence the behaviour of the proposed neural model for as what concerns the curvature .
to compare our results with the data in the literature , the four values of curvature have been taken into account .
the table 3 shows the mean values of nc , mxc , mdc and tc ) .
the mean value of nc reported in [ 28 ] is about 1.02 , for movements with a maximum amplitude of 42 cm , while in this system the mean value is 1.06 .
table 3 mean values of the curvature indexes for the set of movements normal curvilinearity nc 1.09 maximum curvilinearity mxc 0.63 cm medium curvilinearity mdc 0.61 cm total curvilinearity tc 0.16 cm two main things must be stressed out : * even if the biomechanical arm model is only an approximation of a real upper limb structure , in which further muscle activations have an influence , even if minor , on the overall movement , the results are very interesting .
* all the experiments on human subjects from the literature are replications of the same set of movements in different direction or with different amplitude ; this brings a specialization of the tasks during the trials and therefore to lower errors .
in [ 26,29 ] the normalized maximum curvature shows a value of about 0.05 +/ - 0.02 .
this result has been estimated as the ratio between the maximum distance from the straight line connecting the starting and the arrival point ( that is the value mxc of the present system ) and the length of straight line connecting them ; moreover the values reported are related to tasks performed on the sagittal plane .
figure 16 depicts a bi - dimensional projection of the error for the wrist final position when implementing 1000 test movements , with the same starting point .
taking off the outliers ( which are the movements that show a ratio between final error position and length of the desired task greater than 27 %) , the results considering only one starting point and movements with a maximum amplitude of 60 cm show a mean error position value of about 2.4 cm with a standard deviation of 1.8 cm ( it is possible to see that the behaviour is quite uniform , even if there are some error peaks far from the starting point that can justify a correlation different from zero ) .
figure 16 distribution of the absolute error position within the working plane .
the figure shows that higher values are mostly present along the borderline of the working plane .
figure 17 shows the behaviour of the velocity profile whose peak value , when considering the movements starting from the same point , increases accordingly with the length of the movements. from the model it has been possible to evaluate the presence of the " scaling effect " which explains the invariant property of the wrist velocity profile : when the length of the movement increases , so does the maximum velocity reached along the trajectory while maintaining the same profile .
figure 17 graph of the scale effect .
the figure shows the distribution of the wrist peak velocity with respect to the distance from the starting point .
it is possible to observe a uniform increase of the peak velocity from the area near the starting point to the borders of the working plane .
figure 18 shows that the velocity curve maintains the same profile for shorter and larger movements , and that the duration of the movements does not increase linearly with their length .
these findings are similar to those present in [ 14,23 ] .
figure 18 comparison between wrist velocity profile .
the figure shows the wrist velocity profiles of two different movements starting from the same initial point , directed towards the same direction but with different amplitudes .
shorter movement is related to the slower velocity profile ( the blue one ) .
moreover , similar activations bursts are associated to similar movements : i.e. it is possible to see that in movements directed towards the same area inside the working plane , not only the same muscles of the shoulder and the elbow joint are activated first , but also the intervals of the neural activations of these muscles show the same duration .
this finding can be correlated with a feature that could be defined as a global isochrony of the movements .
in figure 19 the value of the total activation time of activation with respect to length of the movement is shown .
it emerges that the time spent increases , though not proportionally , to the length of the movement .
figure 19 dispersion of the neural activation times with respect to the length of the movements. from the figure it is possible to observe an increment of he neural activation time .
finally , we simulated the insertion of the model in a force field , proportional to the movement speed , with a peak amplitude up to 15 n and directed along x axis , which acts on the already trained controller .
the additional training needed by the model to be able to cope with this force required only the 1 % of the epochs necessary for the training all over the working plane for unobstructed movements .
it resulted that the model learned to deal with this force by modifying the activation intervals of the muscles , thus increasing the stiffness of the arm through co - contractions of the muscles .
after the additional training , in the testing phase , the model showed errors similar to those obtained with no force .
in figure 20 it is possible to observe the behaviour of the system in the force field and after the short re - learning phase in the new environment .
figure 20 adaptation of the neural controller to external forces .
the upper figure shows the effect of a force , directed along the x - axis , applied on the end - point of the biomechanical arm model and proportional to its velocity .
the shift from the arrival point induced by the disturbances is clearly visible .
the lower figure shows the behaviour of the overall system after a training period of the neural controller within he modified working space .
the controller learns how to take into account the effects of the external forces acting on the dynamics of the arm model .
conclusion a neural - network motor controller able to simulate the ballistic movements of an arm has been presented .
this controller is implemented by means of a neural network that simulates the internal model devoted to the management of the feed - forward aspects of the movement .
the biomechanical model includes three pairs of muscles , and two joints .
the results obtained are plausible from a biological standpoint and might be interpreted taking into account some features : * the capability of the controller to solve the inverse dynamics problem , that is to generate the proper muscular activations and then the muscular forces , exclusively on the basis of kinematic information such as the starting and ending point of the movements ; * the capacity of the neural controller to acquire the internal model of the plant with a learning process that excludes the use of an online feedback on the position error , thus showing a biologically plausible behaviour ; * the ability of the overall system to obtain realistic trajectories and bell shaped profiles similar to the experimental ones : the value of the parameters characterising the trajectories are in good agreement with those obtained from experiments on humans in similar tasks ; * the paradigm adopted for the on - line learning of the system dynamics that includes the biomechanical characteristics of the arm .
in this way , both the adaptive characteristics of the controller with respect to the plant , and the simplicity of the control activations are emphasised .
even if the model can be further complicated by optimizing the biomechanical model , to increase its capacity to obtain realistic trajectories , the presented results open a wide field of applications : from the cognitive ones to the use of this model for the control of smart functional electrical stimulation ( sfes ) systems , to the rehabilitation .
for instance , the availability of such a controller , once adapted to electrical stimulation systems , could enhance the possibilities of paretic patients to control their arm movements with more reduced effort during rehabilitation sessions , thus stimulating cortical synaptic plasticity and the recovery of correct muscular synergies .
the availability of such a controller , once adapted to electrical stimulation systems , can greatly enhance the possibilities of paretic patients to control their arm movements with more reduced effort during rehabilitation sessions , thus stimulating cortical synaptic plasticity and the recovery of correct muscular synergies .
such an application is quite new because most paretic patients have neural implants for grasping , while better and more physiological movements imply the involvement also of the entire arm .
this controller not necessarily must rely on implanted cuff electrodes and could use surface and / or minimally invasive stimulators .
the system can be driven by some hci ( for instance , a gaze tracker ) which gives the neural controller the intention of the movement ( starting and ending points ) leaving the burden of activating the stimulation to the neural net .
obviously , the system proposed is able only to make ballistic planar movements , which in any case constitute as a proof of concept .
acknowledgements this work has been partially supported by miur .
myers jd massone ll the role of the plant properties in point - to - point arm movements : a robustness study biological cybernetics 1997 76 173 180 9151415 10.1007 / s004220050330 shadmehr r mussa - ivaldi fa adaptive representation of dynamics during learning of a motor task j neurosci 1994 14 3208 3224 8182467 kawato m internal models for motor control and trajectory planning current opinion in neurobiology 1999 9 718 727 10607637 10.1016 / s0959 - 4388 ( 99 ) 00028 - 8 wolpert dm miall rc forward models for physiological motor control neural netw 1996 9 1265 1279 12662535 10.1016 / s0893 - 6080 ( 96 ) 00035 - 4 shadmehr r generalization as a behavioral window to the neural mechanisms of learning internal models human movement science 2004 23 543 568 15589621 10.1016 / j.humov.2004.04.003 tee kp burdet e chew cm milner te a model of force and impedance in human arm movements biological cybernetics 2004 90 368 375 15221397 10.1007 / s00422 - 004 - 0484 - 4 todorov e jordan mi optimal feedback control as a theory of motor coordination nature neuroscience 2002 5 1226 1235 12404008 10.1038 / nn963 berthier ne rosenstein mt barto ag approximate optimal control as a model for motor learning psychological review 2005 112 329 346 15783289 10.1037 / 0033 - 295x.112.2.329 karniel a inbar gf a model for learning human reaching movements biological cybernetics 1997 77 173 183 9352631 10.1007 / s004220050378 kawato m uno y isobe m suzuki r hierarchical neural network model for voluntary movement withapplication to robotics control systems magazine , ieee 1988 8 8 15 10.1109 / 37.1867 hollerbach mj flash t dynamic interactions between limb segments during planar arm movement biological cybernetics 1982 44 67 77 7093370 10.1007 / bf00353957 lackner jr dizio p rapid adaptation to coriolis force perturbations of arm trajectory journal of neurophysiology 1994 72 299 313 7965013 goodale ma pelisson d prablanc c large adjustments in visually guided reaching do not depend on vision of the hand or perception of target displacement nature 1986 320 748 750 3703000 10.1038 / 320748a0 morasso p spatial control of arm movements experimental brain research experimentelle hirnforschung 1981 42 223 227 abend w bizzi e morasso p human arm trajectory formation brain 1982 105 331 348 7082993 10.1093 / brain / 105.2.331 harris cm wolpert dm signal - dependent noise determines motor planning nature 1998 394 780 784 9723616 10.1038 / 29528 flash t hogan n the coordination of arm movements : an experimentally confirmed mathematical model j neurosci 1985 5 1688 1703 4020415 uno y kawato m suzuki r formation and control of optimal trajectory in human multijoint arm movement .
minimum torque - change model biological cybernetics 1989 61 89 101 2742921 10.1007 / bf00204593 kawato m furukawa k suzuki r a hierarchical neural - network model for control and learning of voluntary movement biological cybernetics 1987 57 169 185 3676355 10.1007 / bf00364149 accornero n capozza m controllo motorio : rete neurale autoapprendente riv neurobiol 1996 42 206 207 hannaford b stark l roles of the elements of the triphasic control signal experimental neurology 1985 90 619 634 4065278 10.1016 / 0014 - 4886 ( 85 ) 90160 - 8 drillis r contini r bluestein m body segment parameters ; a survey of measurement techniques artificial limbs 1964 25 44 66 14208177 hill av the heat of shortening and the dynamic constants of muscle proceedings of the royal society of london 1938 126 136 195 caselli p conforto s schmid m accornero n d'alessio t difference in sensorimotor adaptation to horizontal and vertical mirror distortions during ballistic arm movements human movement science 2006 25 310 325 16563539 10.1016 / j.humov.2005.12.003 wolpert dm ghahramani z jordan mi perceptual distortion contributes to the curvature of human reaching movements exp brain res 1994 98 153 156 8013583 10.1007 / bf00229120 atkeson cg hollerbach jm kinematic features of unrestrained vertical arm movements j neurosci 1985 5 2318 2330 4031998 boessenkool jj nijhof ej erkelens cj a comparison of curvatures of left and right hand movements in a simple pointing task experimental brain research experimentelle hirnforschung 1998 120 369 376 10.1007 / s002210050410 messier j kalaska jf comparison of variability of initial kinematics and endpoints of reaching movements experimental brain research experimentelle hirnforschung 1999 125 139 152 10.1007 / s002210050669 messier j kalaska jf differential effect of task conditions on errors of direction and extent of reaching movements experimental brain research experimentelle hirnforschung 1997 115 469 478 10.1007 / pl00005716