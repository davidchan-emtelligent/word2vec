bmc bioinformatics bmc bioinformatics bmc bioinformatics 1471 - 2105 biomed central 23621982 3691524 1471 - 2105 - 14 - 142 10.1186 / 1471 - 2105 - 14 - 142 methodology article incorporating phylogenetic - based covarying mutations into rnaalifold for rna consensus structure prediction ge ping 1 pge @ eecs.ucf.edu zhang shaojie 1 shzhang @ eecs.ucf.edu 1 department of electrical engineering and computer science , university of central florida , orlando , fl 32816 - 2362 , usa 2013 27 4 2013 14 142 142 29 11 2012 4 4 2013 copyright ( c ) 2013 ge and zhang ; licensee biomed central ltd .
2013 ge and zhang ; licensee biomed central ltd.this is an open access article distributed under the terms of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 2.0 ) , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
background rnaalifold , a popular computational method for rna consensus structure prediction , incorporates covarying mutations into a thermodynamic model to fold the aligned rna sequences .
when quantifying covariance , it evaluates conserved signals of two aligned columns with base - pairing rules .
this scoring scheme performs better than some other approaches , such as mutual information .
however it ignores the phylogenetic history of the aligned sequences , which is an important criterion to evaluate the level of sequence covariance .
results in this article , in order to improve the accuracy of consensus structure folding , we propose a novel approach named phylornaalifold .
it incorporates the number of covarying mutations on the phylogenetic tree of the aligned sequences into the covariance scoring of rnaalifold .
the benchmarking results show that the new scoring scheme of phylornaalifold can improve the consensus structure detection of rnaalifold .
conclusion incorporating additional phylogenetic information of aligned sequences into the covariance scoring of rnaalifold can improve its performance of consensus structures folding .
this improvement is correlated with alignment characteristics , such as pair - wise identity and the number of sequences in the alignment .
background the discovery of novel non - coding rna ( ncrna ) families expanded our understanding of rnas , which not only carry genetic codes for protein synthesis but also participate in other functions , especially the regulatory processes , such as localization , replication , translation and degradation [ 1 - 4 ] .
in mammals , a substantial amount of transcripts ( above 90 %) are non - protein - coding , and most of them are functional [ 5,6 ] .
what 's more , the non - coding regions in the human genome are crucially important .
for example , microrna ( mirna ) is used as a marker to differ normal tissues from tumors [ 7 - 9 ] ; long non - coding rna ( lncrna ) also contributes to human disease etiology [ 10 ] .
these findings fuel the research of rna and also pose new challenges .
unlike protein - coding genes , whose primary sequences can be applied for accurate functional prediction with statistical signals , rnas' functions depend on their secondary structures .
many computational methods have been proposed to fold rna structures .
one type of popular algorithms adopts minimum free energy ( mfe ) model to fold a single rna sequence , which has been implemented in mfold [ 11 ] and rnafold [ 12 ] .
however , the structure prediction accuracy of this approach is limited .
one major reason is that the precise energy parameters are hard to obtain experimentally [ 13 ] ; on the other hand , the functional rna structure may not be the one with the minimum energy [ 4 ] .
what 's more , single sequence folding may not be applied to discover new rna families even if the predicted structures are correct , because the statistical signals in an rna secondary structure are not strong enough to distinguish itself from the stable structures folding from random sequences [ 14,15 ] .
comparative methods can solve these problems by folding a consensus structure from multiple sequences , which not only improve the structure prediction accuracy , but also provide additional signals to discover novel rnas [ 16 ] .
the idea of this approach is that rna secondary structures are conserved through evolution .
therefore , a consensus structure detected by comparing related rna sequences should be more accurate and significant than the structure folded from a single sequence. with a consistent consensus structure , the specific structure of each sequence in the alignment can be obtained by constraint folding .
a classic comparative method is the sankoff algorithm [ 17 ] .
because constructing a precise structural alignment of rna sequences is also a challenging problem , the sankoff algorithm computes alignment and fold structure simultaneously .
excessive computational resources ( o ( n6 )) are required by the sankoff algorithm for a large - scale problem .
some implementations of this approach , such as dynalign [ 18 ] , foldalign [ 19 ] , locarna [ 20 ] and conan [ 21 ] , attempt to restrict its solution space by limiting the number of possible sub - structures .
however these methods are still computationally expensive ( o ( n4 )) .
to reduce the computation complexity , comparative methods may align related sequences first and then detect conserved signals in the alignment to infer a consensus structure .
one type of these methods extends the energy - based model from single sequences to alignments .
based on the assumption that high covariance of two aligned columns implies the conservation of pairing , all potential pairing columns in an alignment can be determined .
after that the optimal consensus structure with minimum average free energy can be folded just as a single sequence structure .
an example of covariance scoring scheme is mutual information ( mi ) , which can measure the dependence of two columns in the alignments [ 22 - 24 ] .
rnaalifold [ 25 ] adopts the basic idea of mi scoring and imports the pairing rules of rna into the measurement of covariance .
another type of comparative methods is evolution - based .
in these methods , no thermodynamic parameters but statistical learning algorithms are used .
the evolutionary history of the aligned sequences is reformed with probability theories [ 26,27 ] , and the rna secondary structures are modeled as stochastic context - free grammar ( scfg ) [ 28 - 30 ] .
both strategies have their own strengths and weaknesses [ 31 ] .
some methods try to integrate both approaches .
for example , petfold extends pfold [ 30 ] , an evolution - based algorithm , to consider the energetically favorable base - pairs [ 32 ] .
however , petfold utilizes a nussinov style model [ 33 ] , which does not make full use of the energy parameters .
rnaalifold also tested two other covariance scoring schemes to incorporate evolutionary information [ 25,34 ] , but neither of them yielded a better result .
in this article , we propose a novel method called phylornaalifold .
it improves rnaalifold by explicitly incorporating the phylogenetic tree of the aligned sequences into the computation of covariance scores .
like rnaalifold , phylornaalifold detects pairing columns by evaluating covarying mutations and folds rna structures through an mfe model .
unlike rnaalifold , which does not consider the relative positions of sequences in the phylogeny , phylornaalifold counts the number of covarying mutations on the phylogenetic tree for each pair of columns with a parsimony approach .
what 's more , comparing with petfold , phylornaalifold retains the turner 's model [ 35 ] in rnaalifold , which describes rna structures with many thermodynamic parameters derived from physical studies. with the supports of both energy - based model and evolution - based model , phylornaalifold may detect consensus structures more precisely .
the rest of the article is organized as follows : in the methods section , we discuss the basic mechanism of rnaalifold , its shortcomings , and details of the phylornaalifold algorithm .
in the results section , we describe the benchmark datasets , experimental results , and the effect of parameters and alignment characteristics on our algorithm .
in the discussion and conclusion section , we summarize our existing works and propose directions for future research .
methods consensus folding energy and covariance score in rnaalifold the basic approach of rnaalifold [ 25 ] is to integrate covarying mutation into the thermodynamic model to predict consensus structures .
first , covariance scores are computed for all pairs of columns to determine possible pairing positions in the consensus structure .
then , based on the mfe model , the minimum average folding energy is computed with dynamic programming .
assume the given alignment is denoted by , which contains n sequences a ={ s1,s2 ,... , sn } .
each sequence contains l symbols , including nucleotides and gaps , and sik represents the ith symbol ( 1 <= i <= l ) at the kth ( 1 <= k <= n ) rna sequence .
the minimization of free energy is computed by using the following recursive functions : ( 1 ) fi,j = min ( fi + 1,j,mini < k <= j ( ci,k + fk + 1,j )) ci,j = phi2gammai,j + minsumskinah ( i,j,sk ) mini < p < q < jsumskinai ( i,j,p,q,sk )+ cp,qmini < p < jfmi,p + fm1p + 1,j + mafmi,j = minfmi + 1,j + mcmini < p < jci,p + fmp + 1,j + mbfm1i,jfm1i,j = minfm1i,j - 1 + mc,ci,k where fi,j,ci,j,fmi,j,fm1i,j denote the minimum free energies for the region between ith column and jth column with unconstrained structure , with enclosed structure , with a multi - loop , and with a multi - loop containing a single branch , respectively .
h ( i,j,s ) is the free energy for a hairpin loop enclosed by si and sj , and i ( i,j,p,q,s ) is the free energy for an internal loop containing two base - pairs , one is between si and sj and the other is between sp and sq. ma,mc are penalties for closing bases and non - pairing bases in multi - loops .
mb is the bonus for branch bases in multi - loops .
the recursive functions were derived from the turner 's model [ 35 ] .
one major change made by rnaalifold for consensus folding is the usage of covariance score gamma .
it is not only a factor in the computing of free energy , but also determines the possible pairing columns in the alignment .
two parts , one is bonus and the other is penalty , are in this score .
the first part of the covariance score is called the conservation score .
for ( sik,sjk ) and ( sil,sjl ) , three levels of confidence for pairing are assessed : base - pairs without mutation , base - pairs with one mutation , and base - pairs with two mutations .
in the latest version of vienna rna package ( v2.0 ) [ 36 ] , the recursive function for computing conservation score is : ( 2 ) vi,j = 1nsum1 <= k < l <= nh ( sik,sil )+ h ( sjk,sjl ) if ( sik,sjk ) inband ( sil,sjl ) inb0otherwise where h ( x,y ) is the hamming distance between base x and base y , and ={' au ' , ' ua ' , ' cg ' , ' gc ' , ' gu ' , ' ug '} is the set of all possible base - pairs .
the second part is the penalty score qi,j , which deals with a pair of symbols that cannot form a base - pair : ( 3 ) qi,j = sum1 <= k <= n0if ( sik,sjk ) inb0.25ifsikandsjkare gaps1otherwise overall , the covariance score is : ( 4 ) gammai,j = vi,j - phi1xqi,j where phi1 = phi2 = 1 .
a threshold value gammat = - 2 is defined for gammai,j. if gammai,j > gammat , ith column and jth column are considered to be pairing columns .
in the final output , the minimum average folding energy , including the covariance score , is normalized by dividing n. phylogenetic - based covarying mutation rnaalifold incorporates covarying mutations into consensus folding to improve the detection of pairing columns. from equation ( 2 ) , it can be seen that rnaalifold counts the level of covariance by treating all sequences equally and try all possible combinations of base - pairs .
in short , rnaalifold models the relationship of sequences as a complete graph .
as a result , the specific evolutionary relationship among sequences in the phylogenetic history is ignored .
take the rna structural alignment in figure 1 as an example .
the red and green columns achieve the same covariance score ( 2 ) in rnaalifold .
however , as described in [ 37 ] , the conservation evidence in figure 1 ( c ) is stronger than that in figure 1 ( b ) because at least two mutations occur at the green columns while only one is required to form the red ones .
figure 1 covarying mutations in an rna alignment .
( a ) a multiple rna alignment and its phylogenetic tree .
three pairs of columns , which are marked with different colors , are analyzed in the following three sub - figures .
( b ) possible covarying mutations in the red columns .
in this case , only one pair - wise mutation is required at the root node .
( c ) possible covarying mutations in the green columns .
at least two pair - wise mutations occur at the internal nodes in this case ; ( d ) possible covarying mutations in the blue columns .
there are non - pairing bases , ' ag ' and ' a - ' .
the label inference of the internal nodes does not depend on them .
so in this case , the number of mutations is one .
phylornaalifold models the relationship of aligned sequences as a tree by introducing the phylogenetic history of the alignment into the computation of covariance scores .
the level of structural conservation is measured by the number of covarying mutations on the tree .
our assumption is that more covarying mutations on the tree mean stronger evidence of conservation .
in addition , phylornaalifold does not discard the original scoring scheme of rnaalifold , because experimental results showed this scheme can infer significant rna structural aspects with high sensitivity and selectivity [ 38 ] .
assume mi,j covarying mutations occur between ith and jth columns on the alignment ' s phylogenetic tree and the number of base - pairs on those columns is bi,j. the value of mi,j depends on the size of the alignment .
since our approach focuses on improving the bonus part of the covariance scores , the number of covarying mutations is normalized with its upper bound : mi,jbi,j - 1 .
a new factor for the conservation score is proposed : ( 5 ) ini,j = 1 + betaxmi,jbi,j - 1 where beta is the scale parameter for the normalized covarying mutation numbers .
phylornaalifold computes covariance scores with the following formula : ( 6 ) gammai,jp = ini,jxvi,j - phi1xqi,j all the other parameters and their default values in rnaalifold are retained .
due to the fact that gammai,jp >= gammai,j ( ini,j >= 1 ) , two columns would be marked as pairing in phylornaalifold if their covariance score in rnaalifold is greater than the threshold gammat ( the default value of gammat is - 2 ) .
thus the advantage of phylornaalifold is to import more potentially pairing positions with high mutation numbers .
computing the number of covarying mutations given a phylogenetic tree and labels at its leaves , the fitch algorithm can optimize nucleotide assignment of the internal nodes to minimize the number of mutations [ 39 ] .
if we model solving phylogeny as a maximum parsimony problem , this number can be taken as the actual number of mutations .
the fitch algorithm consists of a forward phase and a backward phase .
in the forward phase , all possible labels at each internal node are inferred .
in addition , the number of mutations is estimated during a bottom - up traversal .
in the backward phase , a top - down pass is performed to find the optimal label at each internal node .
only the forward algorithm is applied to phylornaalifold , since we do not need the exact labels at the internal nodes , but only the number of mutations on the tree .
without loss of generality , we require to be a rooted binary tree .
r denotes the root of and v , vl , vr denote a node , left child of v , and right child of v respectively .
f ( v ) is the set of possible labels at node v , and cost ( v ) is the number of mutations on the sub - tree which is rooted at v. then the forward phase can be described with the following recursive functions : ( 7 ) f ( v )= f ( vl ) intersectionf ( vr ) iff ( vl ) intersectionf ( vr )!= emptyf ( vl ) unionf ( vr ) otherwisecost ( v )= cost ( vl )+ cost ( vr ) iff ( vl ) intersectionf ( vr )!= emptycost ( vl )+ cost ( vr )+ 1otherwise for each leaf , f ( v ) is a base at the corresponding sequence .
after the computation is finished , cost ( r ) shows the minimum number of mutations on the phylogenetic tree .
the optimization of this algorithm was proved in [ 40 ] .
in equation 5 , the computation of ini,j does not depend on non - pairing bases .
therefore , in the revised fitch algorithm non - pairing bases need not to be considered when the number of covarying mutations is computed .
we changed the original fitch algorithm in two ways : ( 1 ) at any leaf node , if ( sik,sjk ) not - inb , set ( sik,sjk )= (' - ' , ' - ') ; ( 2 ) for one internal node v , if the bases at vl ( vr ) is (' - ' , ' - ') , v will obtain f ( vr )( f ( vl )) as its label .
one example of this algorithm is shown in figure 1 ( d ) .
the revised fitch algorithm can be described by using the following functions : ( 8 ) f ( v )= f ( vl ) intersectionf ( vr ) iff ( vl ) intersectionf ( vr )!= emptyandf ( vl )!=(' - ' , ' - ') andf ( vr )!=(' - ' , ' - ') f ( vl ) iff ( vr )=(' - ' , ' - ') f ( vr ) iff ( vl )=(' - ' , ' - ') f ( vl ) unionf ( vr ) otherwisecost ( v )= cost ( vl )+ cost ( vr ) iff ( vl ) intersectionf ( vr )!= emptyandf ( vl )!=(' - ' , ' - ') andf ( vr )!=(' - ' , ' - ') cost ( vl ) iff ( vr )=(' - ' , ' - ') cost ( vr ) iff ( vl )=(' - ' , ' - ') cost ( vl )+ cost ( vr )+ 1otherwise it is easy to see that our algorithm is optimal , because it only excludes non - pairing bases from the computation of the original fitch algorithm .
in phylornaalifold , the tree structure is an input variable and the clients can use any phylogenetic tree construction algorithm to build it. the time complexity of the original rnaalifold algorithm is o ( mxn2 + n3 ) [ 41 ] , where n is the length of the alignment and m is the number of sequences in the alignment .
the extra computation in phylornaalifold is caused by the revised fitch algorithm , whose time complexity ranges from o ( logm ) to o ( m ) .
in addition , phylornaalifold needs to compute ini,j for each pair of columns in the alignment .
thus the overall time consumption of the revised fitch algorithm is o ( logmxn2 ) or o ( mxn2 ) .
neither of them increases the time complexity of rnaalifold .
results benchmarking datasets the 19 rfam [ 42 ] families used in the cmfinder paper [ 43 ] were selected as our first benchmarking dataset .
it captures the diversity of known families by excluding highly conserved ones .
other programs , such as petfold [ 32 ] and rnaalifold [ 34 ] , also adopted it in their experiments .
all the testing families came from rfam version 11.0 and their seed alignments were used .
in order to evaluate the dependence of our folding algorithm on the alignment quality , we also realigned the seeds with clustalw [ 44 ] to generate the second benchmarking dataset .
for this dataset , the predicted structure of the first sequence in each alignment was compared with its real consensus structure to measure the accuracy .
pair - wise identity and the number of sequences in an alignment are two important alignment characteristics .
pair - wise identity is related to the performance of consensus structure folding , while the number of members is important for inferring an accurate evolutionary history .
to analyze these two factors , we generated the third benchmarking dataset which consisted of alignments with different number of sequences and identities .
member sequences were randomly picked from each seed alignment .
for each family , we generated three sets .
each set included 50 alignments , and the alignments contained 5 sequences , 10 sequences and 20 sequences respectively .
7 families ( ctrna _ pga1 , glms , lin - 4 , lysine , mir - 10 , s2m , tymo _ trna - like ) , whose sequences are less than 50 , were excluded from this dataset because the diversity of generated alignments was too small .
phylornaalifold requires a phylogenetic tree of the alignment to infer the consensus structural aspects .
in our experiments , dnadist and kitsch in the phylip package [ 45 ] were used to generate phylogenies .
first dnadist computed a distance matrix of the sequences .
after that , kitsch estimated a phylogenetic tree from the output matrix of dnadist .
the reason of using kitsch was that it can generate rooted binary trees , which were required by phylornaalifold .
another notable issue in this process is that if two sequences differ in more than 75 % of their positions , dnadist would set the distance between them to - 1 , which represents infinity .
kitsch rejects negative distances .
thus - 1 was replaced with 1000 in distance matrices .
we have checked all the positive sequence distances in our experiments .
none of them exceeded 10 , so 1000 is large enough to represent infinity .
the implementation of phylornaalifold was on the top of program rnaalifold in the vienna rna package 2.0.7 [ 36 ] .
the major change made by phylornaalifold is to incorporate our fitch module into the scoring scheme of rnaalifold .
to test our idea , matthews correlation coefficient ( mcc ) [ 46 ] was used to measure the accuracy of consensus structure prediction .
its definition is : ( 9 ) mcc = tpxtn - fpxfn ( tp + fp )( tp + fn )( tn + fp )( tn + fn ) where tp,tn,fp,fn represent the number of true positives , true negatives , false positives , and false negatives , respectively .
additional predicted base - pairs that are not in the reference structure fall into two categories .
some base - pairs contradict reference , the others are compatible with it. compatible base - pairs can be inserted into the known consensus structure , while adding contradictory base - pairs breaks the pairing rules .
only contradictory base - pairs were counted as false positive predictions .
five algorithms , rnaalifold , ribosum - based rnaalifold , phylornaalifold , ribosum - based phylornaalifold , and petfold , have been tested on the first two datasets .
the first four have also been benchmarked on the third dataset .
the ribosum scoring scheme [ 47 ] is used in the latest version of vienna rna package .
in this scheme , the sum of hamming distance h ( sik,sil )+ h ( sjk,sjl ) in conservation score was replaced by an entry in the ribosum matrix r : r ( siksjk,silsjl ) .
the experiment results in [ 34 ] showed that ribosum - based rnaalifold outperformed the orignal rnaalifold in most of cases .
in addition , the authors of [ 34 ] used phi1 = 0.6 and phi2 = 0.5 as the default parameters in their experiments .
we applied their settings to make the comparison fair .
the performance of petfold was tested in our experiments too .
we used the web - server of petfold [ 48 ] and its default parameters .
effect of parameter beta in the first experiment , we compared the structure prediction results of phylornaalifold with rnaalifold on the original cmfinder dataset .
default values for phi1 , phi2 and gammat were used , and beta was a variable ranging from 1 to 15 .
figure 2 shows that the novel scoring scheme of phylornaalifold improves the performance of rnaalifold in nearly all cases , except beta = 1 .
the differences of average mcc in both cases , with or without using ribosum matrix , become larger when beta is increased , and they are maximized at beta = 10 .
the largest differences are 0.079 and 0.033 for ribosum supported and non - ribosum supported algorithms .
after that , the performance of phylornaalifold is not boosted with the increasing of beta .
in the following experiments , we select 10 as a default value for beta .
figure 2 mcc on the cmfinder dataset as a function of the beta parameter .
the mcc results of phylornaalifold , with and without ribosum matrix support , are shown in this figure .
the dash lines are references for the curves , which show the performance of rnaalifold on the same dataset .
it can be seen that except for beta = 1 , the new phylogenetic - based covariance scoring scheme improves the performance of rnaalifold .
benchmarking with other methods table 1 summarizes all results of the consensus structure predictions on the structural alignments .
phylornaalifold with ribosum support achieves the best average mcc score .
when ribosum matrix is incorporated , the score difference between phylornaalifold and rnaalifold becomes smaller .
this may suggest that by using ribosum matrix , rnaalifold quantifies the conservation among base - pairs more precisely than its original solution .
the advantage of using phylogenetic history is swamped by this strategy to some extent .
the average specificity scores of five algorithms are the same , while phylornaalifold and petfold have two largest average sensitivity scores .
it is evidence of evolutionary information helping the energy - based folding algorithms to detect more base - pairs with introducing very few errors .
an interesting observation is that cobalamin has relative low mcc scores for rnaalifold .
phylornaalifold improves the accuracy of the consensus structure prediction of cobalamin greatly .
in addition , petfold has the best performance on this family among all five algorithms .
we checked the consensus structure of cobalamin and the predicted results of rnaalifold .
one possible reason is that there are too many gaps and non - pairing bases at its pairing columns , which decrease the covariance scores of those columns in rnaalifold greatly .
without the bonus from evolutionary information , those columns cannot be detected by rnaalifold at all .
table 1 the benchmarking results on the structural alignments of the cmfinder dataset ( beta = 10 ) family # seq mpi rnaalifold phylornaalifold rnaalifoldwith ribosum phylornaalifoldwith ribosum petfold cobalamin 430 49.7 0.756 0.951 0.591 0.951 0.976 ctrna _ pga1 15 73.0 0.979 0.979 0.979 0.979 1.000 entero _ cre 56 81.7 0.912 0.912 0.916 0.916 1.000 entero _ orir 60 87.4 0.47 0.681 0.703 0.703 0.747 glms 18 57.4 0.973 0.987 1.000 1.000 0.987 histone3 52 46.0 1.000 1.000 1.000 1.000 1.000 intron _ gpii 98 52.3 1.000 1.000 1.000 1.000 1.000 ire 62 76.8 0.814 0.854 0.965 0.965 0.965 let - 7 67 66.4 0.861 0.967 1.000 1.000 0.915 lin - 4 12 68.8 0.977 1.000 1.000 1.000 0.836 lysine 47 48.4 0.952 0.981 0.981 0.981 0.952 mir - 10 36 67.9 0.789 0.865 0.957 0.957 0.935 purine 133 54.7 0.904 1.000 1.000 1.000 0.977 rfn 144 68.1 0.826 0.851 0.826 1.000 1.000 rhino _ cre 12 81.4 0.581 0.581 0.976 0.976 0.750 s _ box 433 62.9 0.883 0.924 0.963 1.000 0.944 s2m 38 78.3 1.000 1.000 1.000 1.000 1.000 secis 61 41.0 0.972 1.000 1.000 1.000 0.972 tymo _ trna - like 28 68.2 0.908 0.908 0.910 0.910 0.975 mean 0.871 0.918 0.935 0.965 0.944 specificity 1.000 1.000 1.000 1.000 1.000 sensitivity 0.802 0.881 0.919 0.952 0.922 the mcc on structural alignments of the cmfinder dataset is compared among phylornaalifold , rnaalifold and petfold .
the parameter beta of phylornaalifold is 10 .
best performance on the same family is set to bold .
table 2 shows the results on the non - structural alignments of the cmfinder dataset .
in this case , ribosum - based phylornaalifold still achieves the highest average mcc score .
the performance of rnaalifold with ribosum support is almost the same as that of the top one algorithm .
what 's more , petfold , which has a larger average mcc score in the previous experiment than ribosum - based rnaalifold , falls to third place .
this suggests that the evolutionary information at the pairing columns may be disrupted by clustalw , whose alignment function does not consider secondary structures .
table 2 the benchmarking results on the non - structural alignments of the cmfinder dataset ( beta = 10 ) family mpi rnaalifold phylornaalifold rnaalifoldwith ribosum phylornaalifoldwith ribosum petfold cobalamin 43.2 - 0.001 - 0.001 - 0.002 - 0.002 - 0.002 ctrna _ pga1 66.5 0.865 0.889 0.979 0.979 0.936 entero _ cre 81.7 0.912 0.912 0.916 0.916 1.000 entero _ orir 87.5 0.694 0.830 0.965 0.965 0.910 glms 55.2 0.445 0.566 0.873 0.784 0.811 histone3 45.1 1.000 1.000 1.000 1.000 1.000 intron _ gpii 46.2 0.760 0.794 0.826 0.826 0.794 ire 77.3 0.480 0.480 0.710 0.710 0.816 let - 7 66.7 0.760 0.761 0.666 0.666 0.742 lin - 4 64.6 0.523 0.521 0.712 0.712 0.739 lysine 44.0 0.307 0.414 0.513 0.484 0.388 mir - 10 68.4 0.741 0.820 0.957 0.957 0.935 purine 53.8 0.852 0.977 0.977 0.977 0.953 rfn 64.2 0.342 0.309 0.302 0.433 0.477 rhino _ cre 81.4 0.581 0.581 0.976 0.976 0.750 s _ box 56.5 0.430 0.430 0.817 0.860 0.750 s2m 78.3 1.000 1.000 1.000 1.000 1.000 secis 36.5 0.000 0.000 0.000 0.000 - 0.003 tymo _ trna - like 64.1 0.691 0.703 0.768 0.768 0.596 mean 0.599 0.631 0.735 0.737 0.715 specificity 0.947 0.947 0.947 0.947 0.999 sensitivity 0.486 0.545 0.689 0.704 0.655 the mcc on non - structural alignments of the cmfinder dataset is compared between phylornaalifold , rnaalifold and petfold .
the parameter beta of phylornaalifold is 10 .
best performance on the same family is set to bold .
effects of identity and the number of sequences in this experiment , we try to analyze the correlation of two alignment characteristics , pair - wise identity and the number of sequences , with the performance of phylornaalifold .
figure 3 shows the experiment results .
it can be seen that all four algorithms have similar performance when the number of sequences in the alignments is 5. with the increasing of the members in the alignments , the average mcc difference between phylornaalifold and rnaalifold becomes larger .
using more sequences provides a more precise phylogenetic history , so it is reasonable that phylornaalifold achieves its best performance on alignments with 20 sequences .
in addition , for experiments on the alignments of 10 sequences and 20 sequences , the maximum performance difference exists between the pair - wise identities 65 and 80 .
if the pair - wise identity of an alignment is small , the original covariance scoring scheme of rnaalifold works well enough because a large number of different base - pairs at the pairing columns provide substantial conservational signals .
on the other hand , when the alignment 's pair - wise identity is too large , all the symbols at the pairing columns are almost the same .
the effect of our new covariance scoring scheme is reduced due to the lack of evolutionary information .
figure 3 the effect of alignment pair - wise identity and sequence number on the structural prediction of phylornaalifold ( beta = 10 ) .
the mcc results of phylornaalifold and rnaalifold on the third benchmarking dataset are shown in this figure .
it can be seen that the performance difference between phylornaalifold and rnaalifold increases with the increasing of the sequence number in the alignments .
in addition , the maximum mcc difference is achieved in the range of 65 ~ 75 identities .
discussion and conclusion we have proposed a novel approach , phylornaalifold , to fold rna consensus structures by evaluating the level of conservation in aligned rna sequences. with an evolution - based covariance scoring scheme , phylornaalifold can detect more potential pairing columns than rnaalifold .
the benchmark testing shows that phylornaalifold can improve the performance of rnaalifold , as well as petfold .
there are two possible directions for further research .
the first direction is to analyze the dependence of phylornaalifold on the phylogenetic tree construction algorithms .
tree structures have great effect on the rna structure prediction of phylornaalifold .
besides dnadist and kitsch , there are other algorithms , such as upgma [ 49 ] , paup [ 50 ] and mrbayes [ 51 ] , which can construct alternative trees .
finding or design an optimal algorithm for detecting the phylogenetic information in the pairing columns is an open question .
ideally , structure conservation should be considered because it is crucial for evaluating the similarity between two rna sequences .
the second direction deals with incorporating the phylogenetic information of non - pairing bases into the folding algorithm .
only covarying mutations among base - pairs are considered in phylornaalifold .
in probabilistic methods , all the possible mutations , including mutations in loop regions and stack regions , are modeled with hmm .
our goal is to incorporate both types of mutations into phylornaalifold , while still keep the simplicity of the scoring scheme .
availability the latest version of phylornaalifold can be downloaded at : http :// genome.ucf.edu / phylornaalifold .
competing interests both authors declare that they have no competing interests .
authors' contributions sz conceived of the study and designed the algorithm .
pg implemented the algorithm and carried out the benchmarking tests .
both authors wrote and approved the manuscript .
acknowledgements this work is supported in part by a university of central florida in - house award and the national institute of general medical sciences of the national institutes of health ( r01gm102515 ) .
eddy sr non - coding rna genes and the modern rna world nat rev genet 2001 2 12 919 929 10.1038 / 35103511 11733745 mattick js challenging the dogma : the hidden layer of non - protein - coding rnas in complex organisms bioessays 2003 25 10 930 939 10.1002 / bies.10332 14505360 he l hannon gj micrornas : small rnas with a big role in gene regulation nat rev genet 2004 5 7 522 531 10.1038 / nrg1379 15211354 mandal m breaker rr gene regulation by riboswitches nat rev mol cell biol 2004 5 6 451 463 10.1038 / nrm1403 15173824 the encode project consortium an integrated encyclopedia of dna elements in the human genome nature 2012 489 7414 57 74 10.1038 / nature11247 22955616 the fantom consortium the transcriptional landscape of the mammalian genome science 2005 309 5740 1559 1563 16141072 esquela - kerscher a slack fj oncomirs - micrornas with a role in cancer nat rev cancer 2006 6 4 259 269 16557279 croce cm causes and consequences of microrna dysregulation in cancer nat rev genet 2009 10 10 704 714 10.1038 / nrg2634 19763153 nicoloso ms spizzo r shimizu m rossi s calin ga micrornas - the micro steering wheel of tumour metastases nat rev cancer 2009 9 4 293 302 19262572 mercer tr dinger me mattick js long non - coding rnas insights into functions nat rev genet 2009 10 3 155 159 10.1038 / nrg2521 19188922 zuker m stiegler p optimal computer folding of large rna sequences using thermodynamics and auxiliary information nucleic acids res 1981 9 133 148 10.1093 / nar / 9.1.133 6163133 hofacker il fontana w stadler pf bonhoeffer sl tacker m schuster p fast folding and comparison of rna secondary structures monatsh chem 1994 125 167 188 10.1007 / bf00818163 jaeger ja turner dh zuker m improved predictions of secondary structures for rna proc natl acad sci usa 1989 86 20 7706 7710 10.1073 / pnas.86.20.7706 2479010 workman c krogh a no evidence that mrnas have lower folding free energies than random sequences with the same dinucleotide distribution nucleic acids res 1999 27 24 4816 4822 10.1093 / nar / 27.24.4816 10572183 rivas e eddy sr secondary structure alone is generally not statistically significant for the detection of noncoding rnas bioinformatics 2000 16 7 583 605 10.1093 / bioinformatics / 16.7.583 11038329 woese cr pace nr 4 probing rna structure , function , and history by comparative analysis cold spring harbor monograph archive 1993 24 91 117 sankoff d simultaneous solution of the rna folding , alignment and protosequence problems siam j appl math 1985 45 5 810 825 10.1137 / 0145048 harmanci ao sharma g mathews dh efficient pairwise rna structure prediction using probabilistic alignment constraints in dynalign bmc bioinformatics 2007 8 130 10.1186 / 1471 - 2105 - 8 - 130 17445273 havgaard jh torarinsson e gorodkin j fast pairwise structural rna alignments by pruning of the dynamical programming matrix plos comput biol 2007 3 10 1896 1908 17937495 will s reiche k hofacker il stadler pf backofen r inferring noncoding rna families and classes by means of genome - scale structure - based clustering plos comput biol 2007 3 4 e65 10.1371 / journal.pcbi.0030065 17432929 dowell rd eddy sr efficient pairwise rna structure prediction and alignment using sequence alignment constraints bmc bioinformatics 2006 7 400 10.1186 / 1471 - 2105 - 7 - 400 16952317 chiu dky kolodziejczak t inferring consensus structure from nucleic acid sequences comput appl biosci : cabios 1991 7 3 347 352 1913217 gutell rr woese cr higher order structural elements in ribosomal rnas : pseudo - knots and the use of noncanonical pairs proc natl acad sci usa 1990 87 2 663 667 10.1073 / pnas.87.2.663 2300554 gutell rr power a hertz gz putz ej stormo gd identifying constraints on the higher - order structure of rna : continued development and application of comparative sequence analysis methods nucleic acids res 1992 20 21 5785 5795 10.1093 / nar / 20.21.5785 1454539 hofacker il fekete m stadler pf secondary structure prediction for aligned rna sequences j mol biol 2002 319 5 1059 1066 10.1016 / s0022 - 2836 ( 02 ) 00308 - x 12079347 eddy sr durbin r rna sequence analysis using covariance models nucleic acids res 1994 22 11 2079 2088 10.1093 / nar / 22.11.2079 8029015 pedersen js bejerano g siepel a rosenbloom k lindblad - toh k lander es kent j miller w haussler d identification and classification of conserved rna secondary structures in the human genome plos comput biol 2006 2 4 e33 10.1371 / journal.pcbi.0020033 16628248 sakakibara y brown m hughey r mian is sjolander k underwood rc haussler d stochastic context - free grammars for trna modeling nucleic acids res 1994 22 23 5112 5120 10.1093 / nar / 22.23.5112 7800507 knudsen b hein j rna secondary structure prediction using stochastic context - free grammars and evolutionary history bioinformatics 1999 15 6 446 454 10.1093 / bioinformatics / 15.6.446 10383470 knudsen b hein j pfold : rna secondary structure prediction using stochastic context - free grammars nucleic acids res 2003 31 13 3423 3428 10.1093 / nar / gkg614 12824339 do cb woods da batzoglou s contrafold : rna secondary structure prediction without physics - based models bioinformatics 2006 22 14 e90 e98 10.1093 / bioinformatics / btl246 16873527 seemann se gorodkin j backofen r unifying evolutionary and thermodynamic information for rna folding of multiple alignments nucleic acids res 2008 36 20 6355 6362 10.1093 / nar / gkn544 18836192 nussinov r pieczenik g griggs j kleitman d algorithms for loop matchings siam j appl math 1978 35 68 82 10.1137 / 0135006 bernhart sh hofacker il will s gruber ar stadler pf rnaalifold : improved consensus structure prediction for rna alignments bmc bioinformatics 2008 9 474 10.1186 / 1471 - 2105 - 9 - 474 19014431 zuker m on finding all suboptimal foldings of an rna molecule science 1989 244 4900 48 52 10.1126 / science.2468181 2468181 lorenz r bernhart sh honer zu siederdissen c tafer h flamm c stadler pf hofacker il viennarna package 2.0 algorithms mol biol 2011 6 26 10.1186 / 1748 - 7188 - 6 - 26 22115189 gulko b haussler d using multiple alignments and phylogenetic trees to detect rna secondary structure biocomputing : proceedings of the 1996 pacific symposium 1996 350 367 washietl s hofacker il consensus folding of aligned sequences as a new measure for the detection of functional rnas by comparative genomics j mol biol 2004 342 19 30 10.1016 / j.jmb.2004.07.018 15313604 fitch wm margoliash e construction of phylogenetic trees science 1967 155 3760 279 284 10.1126 / science.155.3760.279 5334057 waterman ms introduction to computational biology : maps , sequences and genomes 1995 london : chapman and hall xia f dou y zhou x yang x xu j zhang y fine - grained parallel rnaalifold algorithm for rna secondary structure prediction on fpga bmc bioinformatics 2009 10 suppl 1 s37 10.1186 / 1471 - 2105 - 10 - s1 - s37 19208138 gardner pp daub j tate j moore bl osuch ih griffiths - jones s finn rd nawrocki ep kolbe dl eddy sr bateman a rfam : wikipedia , clans and the " decimal " release nucleic acids res 2011 39 database issue d141 d145 21062808 yao z weinberg z ruzzo wl cmfinder - a covariance model based rna motif finding algorithm bioinformatics 2006 22 4 445 452 10.1093 / bioinformatics / btk008 16357030 larkin ma blackshields g brown np chenna r mcgettigan pa mcwilliam h valentin f wallace im wilm a lopez r thompson jd gibson tj higgins dg clustal w and clustal x version 2.0 bioinformatics 2007 23 21 2947 2948 10.1093 / bioinformatics / btm404 17846036 felsenstein j phylip - phylogeny inference package ( version 3.2 ) cladistics 1989 5 164 166 gardner pp giegerich r a comprehensive comparison of comparative rna structure prediction approaches bmc bioinformatics 2004 5 140 10.1186 / 1471 - 2105 - 5 - 140 15458580 klein rj eddy sr rsearch : finding homologs of single structured rna sequences bmc bioinformatics 2003 4 44 10.1186 / 1471 - 2105 - 4 - 44 14499004 seemann se menzel p backofen r gorodkin j the petfold and petcofold web servers for intra - and intermolecular structures of multiple rna sequences nucleic acids res 2011 39 web server issue w107 w111 21609960 sokal rr michener cd a statistical method for evaluating systematic relationships university kansas scienti bull 1958 28 1409 1438 swofford dl paup : phylogenetic analysis using parsimony ( and other methods ) 2002 sunderland massachusettss : sinauer associates huelsenbeck jp ronquist f mrbayes : bayesian inference of phylogenetic trees bioinformatics 2001 17 8 754 755 10.1093 / bioinformatics / 17.8.754 11524383