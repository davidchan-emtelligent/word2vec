behav genet behav .
genet behavior genetics 0001 - 8244 1573 - 3297 springer us new york 29468443 5846829 9891 10.1007 / s10519 - 018 - 9891 - 5 brief communication deviations from expectations : a commentary on aliev et al. van der sluis sophie + 31 20 598 6833 s.vander.sluis @ vu.nl 12 vroom cesar - reyer 12 dolan conor v .
3 1 0000 0004 0435 165xgrid.16872.3adepartment of clinical genetics , section complex trait genetics , center for neurogenomics and cognitive research , amsterdam neuroscience , vu medical centre amsterdam ( vumc ) , amsterdam , the netherlands 2 0000 0004 1754 9227grid.12380.38department of complex trait genetics , center for neurogenomics and cognitive research , amsterdam neuroscience , vu university amsterdam , de boelelaan 1085 , 1081 hv amsterdam , the netherlands 3 0000 0004 1754 9227grid.12380.38department of biological psychology , vu university amsterdam , amsterdam , the netherlands 21 2 2018 21 2 2018 2018 48 2 168 172 ( c ) the author ( s ) 2018 open accessthis article is distributed under the terms of the creative commons attribution 4.0 international license ( http :// creativecommons.org / licenses / by / 4.0 /) , which permits unrestricted use , distribution , and reproduction in any medium , provided you give appropriate credit to the original author ( s ) and the source , provide a link to the creative commons license , and indicate if changes were made.issue - copyright - statement ( c ) springer science + business media , llc , part of springer nature 2018 the trait - based association test that uses extended simes ( tates , van der sluis et al .
2013 ) was proposed as a multivariate test in the context of genome - wide association studies ( gwas ) .
in regular univariate gwas , the statistical association between a phenotype of interest ( e.g. , height ) and a single nucleotide polymorphism ( snp ) is tested , yielding a single p - value .
if m phenotypes are studied , each phenotype can be individually regressed on the snp , yielding m p - values .
tates is a so - called combination test : it tests a multivariate hypothesis by combining the m p - values obtained in the m univariate tests .
specifically , tates is based on selection of the minimal p - value among m appropriately weighted p - values , and as such tests the hypothesis that at least one of the m phenotypes is associated to the particular snp .
tates was inspired by the gates procedure , a gene based test of association ( li et al. 2011 ) .
aliev et al. set out to demonstrate that the type i error rate of tates is incorrect .
to this end , they present results of a small simulation study in which they examined the empirical type i error rate of tates given two or three correlated phenotypes , and a mathematical proof showing that the distribution of tates p - values is not uniform under the null - hypothesis ( h0 ) given two phenotypes .
we gratefully use this opportunity to comment on this work .
empirical type i error rates in the original tates paper , the authors showed in 20 scenarios ( 8 of which concerned the effect of missing data ) that the type i error rate of tates is correct when the number of phenotypes m equaled 20 , the number of simulations nsim equaled 2000 , and alpha was set to 0.05 .
these simulation settings were deemed realistic in the context of questionnaire data ( i.e. , psychological questionnaires often consist of > 10 items , which one may want to study individually ) , and tailored to this context , featuring various realistic models to account for the phenotypic covariance structure ( specifically , 1 - , 2 - or 4 - factor models and network models ) .
aliev et al. report simulations featuring m = 2 and m = 3 phenotypes in 10 correlational settings .
in these simulations , 6 out of 10 ( m = 2 ) , and 21 out of 30 ( m = 3 ) phenotypic correlations r > 0.70 ( see aliev et al. , table 1 , column 4 , and table 2 , column 5 ) .
they then show that , given nsim = 100,000 , the type i error rate of tates deviated significantly from 0.05 ( 95 % confidence interval : ci95 = ( 0.04865 , 0.05135 )) in 8 of the 10 scenarios when m = 2 , with a maximal empirical rate of 0.0553 ( when r = 0.9343 ) instead of expected 0.05 .
when m = 3 , the type i error rate of tates deviated significantly from 0.05 in all 10 presented scenarios , with a maximal empirical rate of 0.0540 ( when r1,2 = 0.81 , r1,3 = 0.95 , r2,3 = 0.78 ) .
before we dwell on the statistical and practical significance of deviations of this magnitude , we first wish to gain a more comprehensive view of tates 's type i error rate .
table 1 type i error rates of four combination tests in 20 simulation scenarios correlations tates simes minpbonf minpns nvar = 2 0.1 0.05012 0.05006 0.04932 0.04955 0.3 0.05009 0.04887 0.04804 0.05033 0.5 0.05230 0.04858 0.04704 0.05326 0.7 0.05172 0.04408 0.04153 0.05459 0.9 0.05550 0.04191 0.03672 0.05967 nvar = 4 0.1 0.05000 0.04987 0.04890 0.04925 0.3 0.05148 0.04976 0.04807 0.05123 0.5 0.05128 0.04579 0.04291 0.05268 0.7 0.05115 0.04089 0.03637 0.05583 0.9 0.05324 0.03511 0.02654 0.06250 nvar = 8 0.1 0.05025 0.04999 0.04883 0.04930 0.3 0.05005 0.04777 0.04579 0.04955 0.5 0.04924 0.04350 0.03968 0.04949 0.7 0.04742 0.03699 0.03135 0.05175 0.9 0.04495 0.02881 0.01821 0.05524 nvar = 16 0.1 0.04977 0.04945 0.04803 0.04851 0.3 0.04891 0.04659 0.04363 0.04773 0.5 0.04674 0.04110 0.03651 0.04664 0.7 0.04093 0.03209 0.02576 0.04408 0.9 0.03677 0.02502 0.01314 0.04660 mean ( sd ) 0.0491 ( 0.0042 ) 0.0428 ( 0.0076 ) 0.0388 ( 0.0108 ) 0.0514 ( 0.0045 ) largest overshoot 0.0055 0 0 0.0125 largest undershoot 0.0132 0.0250 0.0369 0.0059 sum of absolute deviations across all conditions 0.0525 0.1439 0.2236 0.0664 italicized values lie outside the 95 % confidence interval given nsim = 100,000 ( ci95 = 0.0486 - 0.0514 ) .
italicized and bold values lie outside the 95 % confidence interval given nsim = 10,000 ( ci95 = 0.0457 - 0.0543 ) .
comprehensive simulations to investigate the empirical type i error rate of tates more extensively , we ran additional simulations in which we varied both the number of phenotypes m and the correlations r between the m phenotypes .
specifically , we simulated data for m = 2 , 4 , 8 , and 16 , and r = 0.1 , 0.3 , 0.5 , 0.7 , and 0.9 , resulting in 20 simulation settings in total .
note that the resulting correlational structure is compound symmetric ( i.e. , all phenotypes correlated equally strong ) , which is consistent with a single ( parallel ) factor model .
we simulated phenotypic and genotypic data for n = 2000 subjects .
like aliev et al. , we simulated a single diallelic variant ( unassociated , maf = 0.5 ) , and ran nsim = 100,000 simulations for each setting .
to broaden the present scope of our simulations and to put the tates results into perspective , we analyzed the simulated data using tates and three other combination tests that , like tates , are based on selection of the minimal p - value among m weighted p - values .
the first combination test that we consider is based on bonferroni correction ( referred to as minpbonf ; simes 1986 ) .
running m univariate analyses to regress m phenotypes on a snp , the m p - values are all bonferroni - corrected ( i.e. , weighted with m ) , and then the smallest bonferroni - corrected p - value is selected .
the second combination test , which we refer to as minpns , is similar to minpbonf , except that one does not correct for the observed number of phenotypes m , but for the effective number of phenotypes meff .
as suggested by nyholt ( 2004 , based on sidak 1968 , 1971 ) , we calculated meff based on eigenvalue decomposition of the m x m phenotypic correlation matrix , and the smallest weighted p - value is selected as minpns p - value .
note that , assuming non - zero phenotypic correlations , meff is always < m , and minpns is thus always less strict than minpbonf .
the third combination test is the original simes test that tates is a variation on ( simes 1986 ) .
in simes , the m p - values are first sorted ascendingly .
in an iterative fashion , each jth p - value of the m sorted p - values is then weighted with m / j , such that the lowest p - value is weighted with the largest weight ( i.e. , m / 1 ) and the highest p - value is weighted with the smallest weight ( i.e. , m / m = 1 ) .
the simes p - value then corresponds to the smallest weighted p - value .
tates , which is based on gates ( li et al. 2011 ) , weights in fashion similar to simes , except that the observed number of p - values m and j are replaced with the effective number of p - values me and mej .
specifically , tates weights each jth p - value pj by me / mej , and mej is calculated as \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$${ m _{ ej }}= j - \ mathop \ sum \ limits _{{ i = 1 }}^{ j } i ({\ lambda _ i }> 1 )({\ lambda _ i } - 1 )$$\ end { document } mej = j - sumi = 1ji ( lambdai > 1 )( lambdai - 1 ) where j is the number of top j p - values , lambdai denotes the ith eigenvalue of the correlation matrix between the j p - values ( which can be approximated from the correlations between the j phenotypes ) , and i ( x ) is an indicator function taking on value 0 if lambdai <= 1 and 1 if lambdai > 1. that is , the effective number of p - values mej among the j p - values is calculated as the observed number of p - values j minus the sum of the difference between the eigenvalues lambdai and 1 for those eigenvalues lambdai > 1 .
the value of me is equal to mej for the case that j = m , i.e. , when the selection of top p - values covers all p - values .
the tates p - value then corresponds to the smallest weighted p - value .
following this procedure , the smallest original p - value is always weighted by the largest weight , while the largest original p - value is weighted by me / me = 1 as in that case mej = me. as the weight me / mej is always >= 1 , the weighted p - values are , like in the simes test , always >= the original , unweighted p - values .
all four combination tests test the hypothesis that at least 1 of the m phenotypes is associated to the snp under study by assessing whether the selected weighted p - value is smaller than a beforehand established threshold ( it being 0.05 , or the default genome - wide threshold 5 x 10 - 8 ) .
we ran the 20 simulation scenarios for all four methods , and then established the percentage of p - values per scenario smaller than 0.05 .
for all four methods , these observed type i error rates are shown in table 1 .
we then established whether the observed percentage fell inside the ci95 given alpha = 0.05 .
the standard error of the ml estimator of the p - value is \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ se =\ sqrt { p \ times ( 1 - p )/ nsim }$$\ end { document } se = px ( 1 - p )/ nsim , where p denotes the percentage of significant tests expected given the chosen alpha ( i.e. , 0.05 ) , and nsim the total number of simulations .
given nsim = 100,000 and alpha = 0.05 , the ci95 thus equals ( p - 1.96 x se , p + 1.96 x se ) = ( 0.04865 , 0.05135 ) .
in table 1 , values that fall outside the ci95 given nsim = 100,000 are italicized , while values falling outside the ci95 given nsim = 10,000 are italicized and bold .
the type i error results in table 1 show that when correlations are medium - to - high , tates is slightly liberal when m is small , yet slightly conservative when m is large .
simes and minpbonf are almost always conservative , and becomes more so with increasing correlations and increasing m. in contrast , minpns is generally liberal , and especially so when m is small and correlations are high .
if we sum the absolute deviations from 0.05 across all 20 scenarios , we see that overall , tates remains closest to 0.05 , while minpbonf shows the largest overall deviation , entirely due to its conservativeness .
indeed , minpbonf shows the largest undershoot , while minpns shows the largest overshoot .
overall , the type i error rate of tates does show m - and r - dependent variation around 0.05 , but these deviations are small , especially compared to the other considered combination tests .
the deviations reported by aliev et al. are associated with the special case of small m and ( very ) high r. however , regardless of the narrow scope of the simulations by aliev et al. , one may still ask whether the observed deviations are a reason to reject the tates procedure .
power to detect departures from nominal alpha the larger the number of replications in a simulation study , the more power one has to demonstrate that the empirical type i error rate of a method deviates from the expected type i error rate .
for instance , with nsim = 2000 ( original tates paper ) , nsim = 10,000 , and nsim = 100,000 ( aliev et al. , and present simulations ) , the ci95 's of an unbiased p - value are 0.0404 - 0.0596 , 0.0457 - 0.0543 , and 0.0486 - 0.0514 , respectively .
the empirical type i error rates of tates , as displayed in table 1 , should thus be considered incorrect in either 1 , 3 , or , 10 of the 20 scenarios , depending on the power , i.e. , the chosen nsim .
aliev et al. emphasized statistical significance in assessing the type i error results .
however , in this situation , we believe that it is more important to consider the practical relevance of deviations of 0.05 , 0.005 , or 0.001 .
we are convinced that deviations of this magnitude , while statistically significant given large nsim , cannot justify the rejection of tates , or any other method , and believe therefore that the tates type i error rates give little reason for concern .
the assumption of uniformly distributed p - values aliev et al. argued that the distribution of the tates p - values should be uniform under the h0 , and that the probability distribution function should at least not exceed 1 at the low end of the distribution , i.e. , around 0 .
they consider this a condition for the type i error rate of tates to be correct .
it is important to note that p - values may not be uniformly distributed under the h0 in special cases ( see aliev et al. ' s references to murdoch et al. 2008 ; bland 2013 ) .
however , in most statistical tests , when distributional assumptions and sample size requirements are met , the resulting p - values are indeed assumed to be uniformly distributed under h0 .
combination tests like minpbonf , minpns , and tates work with these p - values .
however , these combination tests themselves are based on selection of the minimal p - value among m weighted p - values .
so while the p - values of the m univariate tests , on which these combination tests are based , should indeed generally be uniformly distributed , the relevant question here is whether the p - values resulting from combination tests' weighted - selection procedure should be uniformly distributed as well .
before we discuss the distributions of the p - values of these four combination tests for the 20 simulation scenarios described above , we wish to emphasize the nature of the weighting in the four different tests .
in minpbonf and minpns , all m p - values are weighted by the same constant , being m for minpbonf and meff for minpns .
in the original simes test and tates , however , each of the m p - values is weighted differently , i.e. , each jth p - value among the m ascendingly sorted p - values is weighted with m / j or me / mej , respectively .
figure 1 shows the distributions of the first 10,000 ( of 100,000 ) p - values obtained with tates and minpbonf ( panel a and b , respectively ) in each of the 20 aforementioned simulation settings ( the p - value distributions obtained with simes and minpns are very similar to those of tates and minpbonf , respectively , and therefore not shown separately ). fig. 1 p - value distributions under the h0 for tates ( a ) and minpbonf ( b ) in 20 simulated scenarios varying the number of phenotypes m ( columns ) and the correlations between these phenotypes ( rows ) .
note that the p - value distributions of simes and minpns are quite similar to those of tates and minpbonf , respectively , and are therefore not displayed separately clearly , p - value distributions of methods that are based on selection of the minimal weighted p - value are not uniformly distributed under h0 , even if the m p - values that they are based on are .
specifically , when all p - values are weighted with the same weight ( minpbonf , minpns ) , selection of the minimal weighted p - value results ( as could be expected ) in a p - value distribution with a right , positive skew .
when smaller p - values are weighted more heavily , the deviation of uniformity increases with increasing m and increasing correlations , with the bulk of p - values at the high end of the distribution .
indeed , as both simes and tates weight the highest original p - value with the smallest weight ( i.e. , 1 , see above ) , the simes p - value and the tates p - value very often equal the largest p - value before weighting .
conclusion aliev et al. set out to show that the type i error rate of tates procedure is incorrect by presenting results of a simulation study and a mathematical proof concerning the non - uniformity of tates 's p - value distribution. with respect to the former , we believe that the simulation results of aliev et al. as well as our own showed that tates 's type i error rate indeed shows slight in - or deflation , depending on the number of phenotypes m and the strength of their intercorrelations r. however , we consider the observed deviations of 0.05 , whether or not statistically significant , to be too small to be considered of practical concern .
note that in this commentary , we addressed the type i error rate given an expected rate of alpha = 0.05 , like aliev et al. did .
we also considered alpha = 0.01 and alpha = 0.001 ( supplemental table 1 ) and found that type i error rates of tates were close to expectation ( ranges 0.0081 - 0.0120 , and 0.00094 - 0.00129 , respectively ) .
while again some values deviated statistically significantly from expectation ( specifically , given alpha = 0.01 and alpha = 0.001 , 1 and 0 values of the 20 simulated settings fell outside the ci95 given nsim = 10,000 , and 9 and 5 fell outside the ci95 given nsim = 100,000 , respectively ) , the deviations were small and , in our view , of little practical significance. with respect to mathematical proof concerning the uniformity of the p - value distribution , we believe that the assumption that the distribution of p - values of a method that is based on p - value selection should be uniform , is based on misconception .
the p - values that the combination tests are based on should be uniformly distributed , but the p - values of subsequent weighted - selection - based combination tests are not expected to be uniformly distributed .
all in all , if one wishes to apply a combination test to tackle a multivariate problem , we believe that tates represents a viable option .
electronic supplementary material below is the link to the electronic supplementary material .
supplementary material 1 ( docx 19 kb ) this comment refers to the article available at 10.1007 / s10519 - 018 - 9890 - 6 .
electronic supplementary material the online version of this article ( 10.1007 / s10519 - 018 - 9891 - 5 ) contains supplementary material , which is available to authorized users .
this comment refers to the article available at : https :// doi.org / 10.1007 / s10519 - 018 - 9890 - 6 .
acknowledgements this work was funded by the netherlands organization for scientific research ( nwo magw vidi 452 - 12 - 014 ) .
compliance with ethical standards conflict of interest sophie van der sluis , cesar - reyer vroom and conor v. dolan declare that they have no conflict of interest .
human and animal rights this article does not contain any studies with human participants or animals performed by any of the authors .
informed consent only simulated data were used in this study .
references bland m do baseline p - values follow a uniform distribution in randomised trials ?
plos one 2013 8 10 1 5 10.1371 / journal.pone.0076010 li m - x gui h - s kwan jsh sham pc gates : a rapid and powerful gene - based association test using extended simes procedure am j hum genet 2011 88 283 293 10.1016 / j.ajhg.2011.01.019 21397060 murdoch dj tsai y - l adcock j p - values are random variables am stat 2008 62 3 242 245 10.1198 / 000313008x332421 nyholt dr a simple correction for multiple testing for single - nucleotide polymorphisms in linkage disequilibrium with each other am j hum genet 2004 74 765 769 10.1086 / 383251 14997420 sidak z on multivariate normal probabilities of rectangles : their dependence on correlations ann math statist 1968 39 1425 1434 10.1214 / aoms / 1177698122 sidak z on probabilities of rectangles in multivariate normal student distributions : their dependence on correlations ann math statist 1971 41 169 175 simes rt an improved bonferroni procedure for multiple tests of significance biometrika 1986 73 3 751 754 10.1093 / biomet / 73.3.751 van der sluis s posthuma d dolan cv tates : efficient multivariate genotype - phenotype analysis for genome - wide association studies plos genet 2013 9 1 1 9