bmc bioinformatics bmc bioinformatics 1471 - 2105 biomed central 18474116 2412881 1471 - 2105 - 9 - 235 10.1186 / 1471 - 2105 - 9 - 235 software discovery and assembly of repeat family pseudomolecules from sparse genomic sequence data using the assisted automated assembler of repeat families ( aaarf ) algorithm debarry jeremy d 1 jdebarry @ uga.edu liu renyi 12 rliu.biocomp @ gmail.com bennetzen jeffrey l 1 maize @ uga.edu 1 department of genetics , university of georgia , athens , ga 30602 - 7223 , usa 2 current address : department of botany and plant sciences , university of california , riverside , ca 92521 , usa 2008 13 5 2008 9 235 235 10 7 2007 13 5 2008 copyright ( c ) 2008 debarry et al ; licensee biomed central ltd .
2008 debarry et al ; licensee biomed central ltd .
this is an open access article distributed under the terms of the creative commons attribution license () , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
background higher eukaryotic genomes are typically large , complex and filled with both genes and multiple classes of repetitive dna .
the repetitive dnas , primarily transposable elements , are a rapidly evolving genome component that can provide the raw material for novel selected functions and also indicate the mechanisms and history of genome evolution in any ancestral lineage .
despite their abundance , universality and significance , studies of genomic repeat content have been largely limited to analyses of the repeats in fully sequenced genomes .
results in order to facilitate a broader range of repeat analyses , the assisted automated assembler of repeat families algorithm has been developed .
this program , written in perl and with numerous adjustable parameters , identifies sequence overlaps in small shotgun sequence datasets and walks them out to create long pseudomolecules representing the most abundant repeats in any genome .
testing of this program in maize indicated that it found and assembled all of the major repeats in one or more pseudomolecules , including coverage of the major long terminal repeat retrotransposon families .
both sanger sequence and 454 datasets were appropriate .
conclusion these results now indicate that hundreds of higher eukaryotic genomes can be efficiently characterized for the nature , abundance and evolution of their major repetitive dna components .
1 background all higher eukaryotic genomes are rich in multiple classes of repetitive dna .
transposable elements ( tes ) are particularly abundant , and are the most important factor responsible for genome size variation in both animals and plants [ 1 ] .
although tes have been judged to be ' junk dna ' , existing within host genomes as purely selfish denizens [ 2,3 ] , it has been found that some repetitive elements perform important roles in their host genomes [ 4 - 7 ] , for instance , as with the telomere - generating het - a and tart retroelements of drosophila [ 8 ] .
in the last decade , the generation of whole genome sequence data from multiple species has provided the opportunity to investigate the relative contributions of repetitive elements to genomic organization and evolution [ 9 - 14 ] .
tes have been identified in nearly all organisms studied to date .
they are reported to account for 3 % of the 4 mb yeast genome [ 6 ] , 20 % of the 140 mb arabidopsis genome [ 13 ] , 22 % of the 165 mb drosophila genome [ 15 ] , 35 % of the 390 mb rice genome [ 14 ] , 15 % of the 1200 mb chicken genome [ 16 ] , > 60 % of the 2400 mb maize genome [ 17 ] , 46 % of the 3200 mb human genome [ 18 ] , > 70 % of the 4800 mb barley genome [ 19 ] and > 90 % of the 16 gb wheat genome [ 20 ] .
one type of te is the long terminal repeat ( ltr ) retrotransposon ( lrp ) .
lrps account for the great majority of the repetitive dna in plant genomes [ 19 ] .
lrps are named for the ltrs that flank the coding regions of the element .
ltrs contain regulatory sequences important for the proper expression of the lrp , such as the transcription start site and polyadenylation signals .
located between the ltrs of the element are the coding regions that provide the protein products necessary for the element 's transposition .
lrps typically contain two open reading frames ( orfs ) .
the first of these , gag , contains products necessary for the formation of a virus - like particle where reverse transcription of the rna intermediate takes place .
the second orf , pol , contains the protease , reverse transcriptase , rnase - h and integrase regions necessary for element protein processing , reverse transcription , degradation of the rna intermediate and integration into a new genome location [ 6,19 ] .
historically , lrps , other tes and other types of repetitive dna have been identified in a genome by their presence in or near genes , or by the amplification of sequences with homology to tes from other species [ 11,21 ] .
due in part to the wealth of sequence information provided by whole genome sequencing projects , the opportunities to detect tes have greatly expanded in recent years .
however , the high cost of completed whole genome sequencing makes this approach inappropriate to investigate the te content of a large number of species .
as interest in tes and other repetitive elements has grown , techniques have been developed to discover and investigate them directly .
without the availability of a large amount of assembled genome sequence , studies focused on the identification of tes within a genome have been restricted to the use of hybridization and pcr techniques [ 6,22 - 25 ] .
while these methods are useful for the identification of repeats that are highly homologous to already - discovered repeats , they lack the power necessary to discover or precisely quantitate new classes of repetitive dna .
sample sequence analysis , wherein a small amount of dna sequence is generated from randomly selected clones [ 26 - 28 ] , can efficiently provide unbiased genomic information , that could potentially be analyzed for repetitive dna content .
the programs recon [ 29 ] and reas [ 30 ] have been designed for the de novo discovery of repeats .
recon utilizes assembled genomic sequence as input , while reas was designed for highly redundant genomic coverage with sanger sequence data sets [ 30 ] .
reas was found to not be adaptable for use with 454 sequence data [ 31 ] .
thus , there is currently no method available that is designed to discover and describe genomic repeats using small quantities of unassembled sanger or 454 sequence data .
in order to provide an automated method for the efficient characterization of all of the high copy number repeats within a genome from sparse sample sequence data , the assisted automated assembler of repeat families , or aaarf , algorithm is described in this article .
tests of aaarf on the zea mays genome , using random shotgun sequence data from a sanger sequencing output and from a simulated 454 sequence data set are presented .
the z. mays genome has been well studied in terms of repeat content and provides an excellent opportunity to test aaarf 's effectiveness .
for both data sets , the program constructed builds representing repeats necessary for genome structure and function ( centromeric , ribosomal and knob repeats ) and the seven most abundant lrps in the z. mays genome .
2 implementation 2.1 the aaarf algorithm aaarf works by comparing sample sequences from a genome to one another via blast [ 32 ] and then using a series of blast analyses and multiple alignments to " walk out " an in silico produced molecule , or " build " , that represents a discreet family of repeats from the target organism .
a schematic of the aaarf process is shown in figure 1 .
initially , aaarf accepts a fasta file of sample sequences as input .
an unused sequence ( the first in the input file in figure 1 ) in the dataset is blasted against all other sample sequences .
next , a coverage matrix representing the detected similarities for the sequence is generated based on this blast output .
the coverage matrix is a representation of the coverage depth for each nucleotide position in the sequence being considered .
the coverage matrix is used to assess the repetitive nature of the sample sequence .
the program calculates start and stop points for the sequence that represent the boundaries of a user defined minimum coverage threshold , based on a minimum depth of coverage requirement .
this section of the sequence is known as the minimally covered sequence , or mcs .
if this sequence does n't meet the minimum coverage requirement , or the mcs is too short , the sequence is rejected and the process starts again with the next sequence in the dataset .
the portion of the sample sequence that corresponds to the mcs is extracted from the sample sequence .
next , the blast output is searched to locate sequences that overlap the mcs in the current search direction ( right , in figure 1 ) .
sequences that meet the minimum coverage requirements and have the potential to extend the process are selected .
a sub - sequence corresponding to the coverage and extension criteria are extracted from the chosen sequences .
a multiple alignment of the selected sequences is performed to generate a consensus sequence called the new query ( nq ) .
the nq is blasted against the mcs to locate the overlap region .
such an overlap indicates that the multiple alignment has produced a sequence that is able to extend the build process correctly .
the overlap region is trimmed from the mcs and the nq is added to the growing build .
to complete a single step , the nq re - enters the loop and is blasted against the sample sequence dataset .
directional extension will continue until either there is insufficient evidence in the coverage matrix to indicate a repetitive sequence or the requirement for a minimum number of sequences to extend the process is not met .
extension then begins from the same starting sequence in the opposite direction .
sample sequences are only allowed to participate in a single build .
this prevents the seeding of additional builds by sequences already used to construct a build .
a sample sequence can participate in both directional extensions of a build in an effort to produce a build that most closely represents a full - length element family .
the size of a single round of extension can be smaller than an individual sample sequence .
to ensure that an entire sample sequence is used in build construction , the user can adjust the number of times that a sequence can be used to extend the build in a given direction .
using the program output along with the sample sequence dataset under investigation , it is possible to locate the biological ends of the elements represented by the builds .
figure 1 schematic of the aaarf algorithm .
shown is an illustration of the aaarf process used to assemble builds representing high copy number repeat families from sample sequence data .
2.2 program construction input and output aaarf consists of a single script written in the perl programming language ( see additional files 1 and 2 ) .
the program makes use of a suite of freely available bioperl modules [ 33 ] .
blast and clustalw [ 34 ] are used for sequence comparisons and multiple alignments , respectively .
a single file of fasta sequences and a blast database made from the same sequences , are used as input to the program .
the program produces a fasta file of builds and a diagnostic log file .
the log file is produced with the log4perl module [ 35 ] , a customizable perl logger .
aaarf 's activities during the build process are recorded in this file for later inspection .
aaarf was run on a 2 ghz macintosh with 1 gb of ram .
analysis of the sanger sequence dataset test was completed in 302 minutes ( 10,000 sequences ) , and analysis of the simulated 454 dataset was completed in 1.5 days ( 50,419 sequences ) .
2.3 build issues there are a number of potential issues that arise when attempting to construct full - length repetitive elements from sample sequence data .
it is important that these concerns are understood in order to properly implement the aaarf algorithm and interpret its results .
the first of these deals with the internalization and single copy nature of ltrs within a build .
ltrs are arranged at either end of a lrp in a direct repeat orientation .
because aaarf utilizes sequence similarity to construct builds , the two ltrs of a lrp will usually be combined into a single ltr composed of sample sequences from either end of multiple elements .
since it is unlikely that both ltrs of a single lrp will be present in a random set of sample sequences , a build 's ltr region will likely be a combination of ltrs from multiple related lrps .
also , because the construction of a build begins at a random point along a repeat ( as dictated by the randomly chosen sample sequence that initiates the build ) , the ltr region will most likely not be present at the end of the build , but internalized within the build .
the next issue to consider is the size of the builds as compared to actual repeats .
aaarf builds may be larger than the corresponding type of native repeat .
it is possible that a full - length copy of the element may be produced for both search directions for a single build .
the number of times that a sequence is allowed to participate in a build are restricted in a given search direction based on the sizes of the sample sequences use as input ( sanger or 454 ) .
the count is reset at the start of each directional search , allowing for multiple full - length representations to be present in a single build .
this restriction on the number of times that a sequence is used in a search direction ensures that an entire sample sequence is only used once in each build direction .
the parameter controlling the number of times that a sequence can be used to extend a build in a single direction is adjustable by the user .
another way that builds may exceed the size of actual repeats reflects possible size differences within the repeat family .
some families will contain members that are larger than others due to insertions or deletions in certain family members .
as long as the affected member is able to replicate , it will be maintained in the genome , and if it is present at a sufficient copy number , be incorporated into a build .
thus , it is possible that a build may represent the largest members of a family , while the smaller members are also contained within the build .
alternatively , builds may be smaller than native repeats .
in general , it is likely that a build will be shorter than a native lrp by the length of one ltr because of ltr internalization .
a small build will also be produced in any situation where there are not enough sequences present for a particular type of repeat to be assembled by the program .
for instance , ltrs by their nature should be present in numbers at least 2x the amount of sequence for any other region of the element .
since they are present more frequently in the dataset , it is possible that builds representing the ltrs of a family of elements will be produced in cases where construction of the internal regions of the elements is not possible .
also , a build may be broken up due to indels in some family members .
indels can be incorporated into a build as long as there are enough sequences in the dataset to cross the indel - generated build gap .
however , if the indel is large enough that it causes the depth of coverage to drop below the requisite threshold , build construction will stop in that direction .
repeat families may contain levels of sequence diversity that make it impossible for aaarf to assemble all members into a single build .
in this case , it is possible that the family will be broken up into multiple builds .
for nearly all repeat families that aaarf was able to construct in full - length or near full - length form , there were multiple builds for each family ( table 1 ) .
because of the issues discussed above , it is possible for a build to be fragmented due to low coverage .
if this is the case , then there will be no full - length build for a particular family .
rather , the builds for that family will be present in fragmented form .
it is also possible that sample sequences from regions that differ between members of the same repeat family may initiate their own build .
in this instance there may be a full - length build for a family and additional builds representing regions that were unable to collapse into the full - length build .
in some cases it is possible to resolve build fragmentation issues and identify builds that belong to the same family .
shared sequence similarity among aaarf - produced builds can be used to infer relationships between builds that were not combined because of sequence divergence issues or positional effects of sequence used in the build process .
for the three fragmented builds in the sanger and 454 tests , comparison of the builds to one another was able to successfully resolve one of the fragmentation events .
table 1 sanger and 454 results compared to the seven most abundant ltr retrotransposon families in maize most abundant lrps in maize ( a ) percent genome composition element size ( kb ) ltr size ( kb ) sanger : best build size ( bp ) sanger : number of builds 454 : best build size ( bp ) 454 : number of builds huck 10.7 11 - 14 1.6 23706 ( fl ) 8 11269 ( f ) 10 ji 9.4 8.5 - 10 1.3 10041 ( fl ) 4 9432 ( fl ) 3 opie 7.1 6.5 - 9 1.3 8150 ( fl ) 3 9599 ( fl ) 2 zeon 4.8 7.3 0.6 7412 ( fl ) 7 1225 ( i ) 4 grande 3.9 10.5 - 13.5 0.6 8469 ( f ) 4 6459 ( i ) 3 cinful 3.5 8.5 0.6 7264 ( f ) 5 1600 ( i ) 4 xilon ( b ) 3.1 11.7 2.7 8971 ( i ) 1 2107 ( i ) 5 ( a ) percent genome composition data from meyers et al .
2001. ( b ) xilon percent genome composition from meyers , pers. comm .
fl = builds representing full - length copies of repeat families , f = builds representing fragmented copies of repeat families , i = incomplete builds 3 results 3.1 testing the aaarf algorithm a wealth of information exists regarding the repeats found in the maize genome ( table 1 ) , particularly the lrp content [ 17,26,36 - 39 ] .
the maize genome is approximately 2400 mb in size [ 17 ] , and > 60 % of the genome is composed of repetitive dna [ 40 ] , primarily lrps [ 6 ] .
in order to ascertain aaarf 's effectiveness , a database of known maize genomic repeats was assembled .
this database is a combination of tigr 's maize repeat database [ 41 ] and a maize repeat database developed by p. san miguel at purdue university ( p. san miguel , pers. comm. ) .
each of these databases contains the sequences of many different repeat families and individual family members found in maize .
builds produced by aaarf were blasted against this known repeat database to investigate how accurately the builds represent actual genomic repeats and to examine how well the program constructs builds representing distinct families of repeats .
to classify a build as representing a type of known repeat , several criteria were used .
a build was required to be at least 1 kb in size , and to have at least one hit with a minimum blast score of 100 when compared to the known repeat database .
a score of less than 100 was taken as evidence that no useful sequence similarity existed between the build and the known repeat database .
builds were also inspected to ensure that they did not improperly fuse two repeat families .
finally , each build was examined to ensure that it showed similarity to a single family of known repeats over at least 90 % of its length .
in this regard , all builds generated by aaarf from the maize data analyzed ( below ) were found to be homologous to an already - known maize repeat family , indicating both the quality and comprehensiveness of the tigr and san miguel databases .
the ultimate goal of the aaarf algorithm is to construct the best build possible for a given family of repeats .
how well aaarf is able to accomplish this is dependent on the amount of sequence in the sample data set for a given repeat family .
there are many issues regarding the build process that were considered in the examination of the builds ( discussed in implementation ) .
a build was classified as full - length only if it showed similarity to the entire length of multiple members of a single discreet repeat family .
3.2 aaarf analysis of sanger sample sequence data from maize random unfiltered shotgun sequence reads produced by sanger sequencing for maize are available from tigr [ 42 ] .
sequences were obtained from tigr in december of 2005 .
we selected the first 10,000 available sequences from this database for input into aaarf .
this sample sequence dataset totaled 7,821,671 bp ( average read size 782 bp ) , representing 0.33 % of the maize genome ( table 2 ) .
input sequences were screened for vector content using ncbi 's univec database [ 43 ] .
aaarf produced 180 builds from the sanger sample sequence dataset described above ( table 2 ) and the parameter set described in table 3. of these , 57 were chosen for further analysis ( table 2 ) .
as expected , aaarf assembled builds for non - te repeats , including centromeric repeats , ribosomal repeats and knob repeats .
in addition , builds representing all 7 of the most abundant lrp families in the maize genome were constructed ( table 1 ) .
full - length builds were constructed for the four most abundant families .
builds representing the grande and cinful families were fragmented , such that there was a region missing from each build .
for both grande and cinful , the missing region was assembled intact in additional builds for each family .
for the xilon build , a 700 bp portion of the ltr region found in native xilon elements was missing .
thus , aaarf constructed full - length or near full - length builds representing the seven most abundant lrp families in the maize genome .
in all cases , aaarf was able to assemble a build for each of these families that readily identified the repeat family .
for the grande family ( the build with the largest missing fragment ) the largest build covered 80 % of the expected family size .
table 2 overall results of aaarf tests of sanger and simulated 454 data sets number of sample sequences sequence amount ( bp ) (% genome ) total builds builds < 1 kb ( a ) fused builds ( a ) build coverage < 90 % ( a ) no hits / score too low ( a ) analyzed builds sanger sequence build results 10000 7821671 ( 0.33 %) 180 46 5 49 23 57 454 sequence build results 50419 5045000 ( 0.21 %) 63 2 2 12 1 46 ( a ) builds not further analyzed table 3 parameter settings for sanger and 454 tests minimum hit length minimum hit identity maximum e - value required length of mcs required mcs coverage depth minimum number of hits for extension sanger 150 89 1.00e - 25 150 3 2 454 30 88 1.00e - 10 30 3 2 required coverage length maximum extend length minimum bl2seq hit size maximum bl2seq e - value maximum number of times a sequence can be used in one direction other sanger 150 50 90 1.00e - 10 13 454 30 40 15 10 4 bl2seq word size : 7 3.3 454 sequence analysis 454 sequence analysis [ 44 ] is an emerging high throughput technology that greatly lowers the cost of data generation .
this will facilitate the generation of sample sequence datasets for a wide array of species .
the initial 454 sequences had an average length of ~ 100 bp [ 44 ] .
in order to test the ability of aaarf to utilize this type of data , a simulated dataset of 454 sequences for the maize genome was generated ( see below ) .
sequences were screened for vector content using ncbi 's univec database [ 43 ] .
a total of 50,419 sequences representing 5,045,000 bp ( average read size 100 bp ) were used as input .
this dataset represents ~ 0.21 % of the maize genome ( table 2 ) .
the same database of known repeats and the same build classification criteria used for testing the output of the sanger sequence test were used for analyzing the 454 sequences .
smaller input sequences cause a variety of build issues stemming from the required blast parameter settings used by aaarf .
because of the reduced size of the input sequences compared to the previous dataset , the number of builds with a total size of less than 1 kb was greatly increased .
since aaarf only allows each sample sequence to participate in a single build , builds of less than 1 kb in length were rejected .
this ensured that as many sequences as possible were available to the program for each build , instead of being utilized in smaller , ultimately uninformative builds .
despite the inherent difficulties posed by shorter sequences , and the overall reduction in sample sequence dataset size , aaarf generated 46 builds that were identified as belonging to known repeat families ( table 2 ) .
all huck family builds were fragmented in the output , with an approximately 1.4 kb fragment missing from the largest build .
this fragment was present intact in an additional huck build .
ji and opie were constructed in full - length form .
for the remaining 4 families in table 1 , only grande was constructed in a large build .
it is possible that the inability of the program to construct the other four elements in a full - length size is due to the 454 sample sequence data being only ~ 64 % the size of the sanger sequence dataset .
it is also possible that further parameter optimization for 454 data will yield superior results .
as 454 sequencing technology continues to develop , the average size of the reads is increasing .
such an increase in sequence size will facilitate their use as input sequences for the aaarf approach .
apart from sequence size issues , 454 technology brings with it a new set of issues with regard to reliability statistics and error rates [ 45 ] .
in particular homopolymers pose specific problems due to the nature of the pyrosequencing technology that 454 sequencing employs [ 46 ] .
precise parameter adjustments to account for these issues can be made with the use of actual 454 data .
3.4 454 dataset construction in order to simulate a 454 sequence dataset for maize , all available unfiltered shotgun sequences for the maize genome were downloaded from tigr [ 42 ] .
at the time of this analysis , there were 50,877 shotgun sequences in this dataset .
the data were divided into three subsets of 16,959 sequences each .
to simulate an average read size of 100 bp , a subsequence of each read was extracted .
positions 100 - 150 , 100 - 200 and 100 - 250 were extracted from all sequences in each set respectively .
the extraction was initiated from the 100 bp position for each read to avoid any possible sequencing errors at the end of the read .
only one sequence was extracted from each shotgun read to provide a random sampling .
this produced three datasets composed of 50 , 100 and 150 bp sequences .
for each of the three subsets , there were sequences that were not large enough for the extraction process , resulting in a final count of 50,419 sequences .
3.5 parameters aaarf parameters for the sanger sequencing and 454 datasets were determined by trial and error in order to examine how changes in the program parameters affected program output .
adjustable parameters for both tests are found in table 3 .
parameters affecting the required length of blast hits , coverage , extension length and maximum number of times that a sequence is allowed to participate in a search direction were chosen based on the sizes of the sample sequences used for each test .
identity and e - value requirements for both tests were determined by trial and error .
required depth of coverage for a sequence to be classified as repetitive , and the required minimum number of sequences for extension were chosen based on an interpretation of what was necessary to recognize a repetitive sequence .
the presence of a particular sequence in the sample sequence dataset at least 3 times was seen as evidence of its repetitive nature .
because of slight positional variation of the coordinates of sequences participating in the aaarf process , it is possible that a sequence that belongs in a build may be rejected due to a difference with required positional parameters generated during mcs construction .
in order to account for this phenomenon , only 2 sequences were required for extension .
this did not affect the accuracy of the builds when compared to a test requiring a 3 sequence minimum for extension .
for the 454 test , the word - size blast parameter for the bl2seq was lowered to 7 from the standard 11 .
during testing it became apparent that the small size of the 454 sequences presented problems with the detection of overlap between the new query sequence and the mcs ( figure 1 ) .
reduction in the required word size facilitated overlap detection .
3.6 end finding as the name of the program indicates , there is a hands - on component to the aaarf process .
the program assembles builds representing discreet families of genomic repeats while maintaining the correct order and orientation of the elements .
however , the element components are unlikely to be placed in the same end - to - end fashion as a typical element .
this is due to the random starting point for a build .
to alleviate this issue , a method for the identification of the biological element endpoints of lrps for aaarf - produced builds has been developed .
for lrps , the ultimate goal is to locate the ltr region of the build as this region contains both element ends .
initially , blastx is used to locate possible protein coding regions within the build , to narrow the area of the build where the ltr may be found .
next , the build is used in a blast analysis against the sample sequence data set that was used as input for the aaarf program .
this blast provides coverage information for the build .
in addition to facilitating the location of the biological endpoints of the build , this information can be compared to the aaarf - generated diagnostic log file to ensure that all suitable sequences were used to construct a given build .
if sequences are found in this comparison that were not used to construct a build , program parameters can be altered to incorporate these sequences .
the apollo program [ 47 ] was used to visualize this comparison ( figure 2 ) .
using this information , it is possible to examine the build for regions that are represented at a greater depth of coverage in the sample sequence dataset ( figure 2 ) .
the region of the build that contains the ltr should be covered by sample sequences at least twice as deeply as the rest of the build .
this is due to the presence of ltrs at either end of a native full - length element and the solo - ltrs present in the genome as a result of partial element removal by unequal recombination .
around this region of increased coverage , the individual sample sequences that cover the region are inspected to locate sequences that are truncated at approximately the same position on the build ( figure 2 ) .
because the ltrs are present on either side of a native full - length element , sample sequences that include the ltr boundaries may include either sequence from the interior of the element or sequence from the genome surrounding the element .
figure 2 comparison of an aaarf - produced build to the sample sequence dataset .
shown is the blast result of an aaarf - generated build compared to the sample sequence dataset used to create it. the bottom , metered line represents the full - length opie build ( 8,150 bp ) from the sanger sequence test .
smaller lines above represent sample sequences .
regions of shared similarity between the build and the sample sequences are indicated by the position of the sample sequences relative to the build .
a region of increased coverage on the build , combined with sample sequences whose similarity to the build stops at the same position ( boxed area ) , indicates the likely presence of an ltr .
once these possible boundaries are identified , this region is extracted from the build for further inspection .
there are four possible orientations for the ltr region , depending on the orientation and strandedness of the sequence that initiated the build .
the extracted section is then inspected for conserved ltr terminal dinucleotide motifs and the primer binding site and polypurine tract for the element family that has been constructed .
these structures are localized to the ltr region of native lrps and can be used to indicate the presence of an ltr within the build .
for a build representing a full - length element , this information can then be used to manually reconstruct a build with ltrs at either end of the build .
for builds that are less than full - length , this approach will be useful in identifying the ltr region if it is contained in the build .
as a proof of principle , this method was used to identify biological element endpoints for the full - length opie build in the sanger sequence test .
the location of the ltr within the build was verified using actual elements from the known repeat database .
4 discussion aaarf provides an excellent resource for the initial characterization of high copy number repeats in a genome that has been subjected to very limited shotgun sequence analysis .
because of the nature of the aaarf process , the pseudomolecules it produces are " patchwork " representations of native repeat elements .
a multiple alignment of selected overlapping and extending sequences is used for each directional extension .
thus , each step represents sections from actual repeats found in the target genome .
sequence divergence information for actual elements is available via the sample sequences used to construct the pseudomolecule. by comparing these pseudomolecules to the input sample sequence dataset , information about the evolutionary history of the assembled repeat family and the percent of the target genome composed of that repeat can be determined .
while these tests have focused on aaarf 's ability to construct builds representing lrp sequences , the utility of the program extends to the construction of builds representing any high copy number repeat in a genome .
as long as there is sufficient sequence in the sample sequence dataset to represent the repeat , aaarf will construct a build for it. the parameters used here were developed for use in the maize genome .
depending on the type of sample sequence being used or the species being investigated , it will be necessary to alter the program parameters to produce the most accurate builds possible .
this is the primary reason that the diagnostic test log is produced as a part of the aaarf process .
using this log file , it will be possible to optimize the parameter set for any species under investigation .
5 conclusion as understanding of the prevalence and effects of lrps has increased , it has become apparent that understanding the evolutionary dynamics of lrps both within individual genomes and among different species is necessary for a complete understanding of genome structure and history .
the true utility of the aaarf approach is its ability to facilitate such an understanding .
because aaarf is designed to function on sample sequence data , important information about the te content of a genome can be investigated with a small amount of sequence , making this type of analysis feasible for studies that involve hundreds of species .
6 availability and requirements * project name : assisted automated assembler of repeat families * project home page : * operating system : mac os x * programming language : perl * other requirements : bioperl 1.2.3 or higher , bioperl run package 1.4 or higher , log4perl 1.01 or higher , ncbi blast 2.2.9 or higher , clustalw 1.8.3 or higher * license : gnu lesser general public license * restrictions : none 7 authors' contributions jdd co - designed the algorithm , conducted the testing and implementation of the algorithm and drafted the manuscript .
rl co - designed the algorithm and reviewed the manuscript .
jlb conceived the approach , participated in its design , provided valuable guidance and critically edited the manuscript .
all authors read and approved the final manuscript .
supplementary material additional file 1 aaarf algorithm perl script .
this is the aaarf algorithm .
the file can be viewed in a text editor .
examples are bbedit for macintosh and wordpad for windows .
this file is also available at the project homepage . click here for file additional file 2 aaarf program documentation .
this is the aaarf algorithm documentation .
the file is intended to aid in the use of the program and provides instructions for its use .
the file can be viewed in a text editor .
examples are bbedit for macintosh and wordpad for windows .
this file is also available at the project homepage . click here for file kidwell mg transposable elements and the evolution of genome size in eukaryotes genetica 2002 115 49 63 12188048 10.1023 / a : 1016072014259 orgel le crick fh sapienza c selfish dna nature 1980 288 645 646 7453798 10.1038 / 288645a0 doolittle wf sapienza c selfish genes , the phenotype paradigm and genome evolution nature 1980 284 601 603 6245369 10.1038 / 284601a0 makalowski w genomics .
not junk after all science 2003 300 1246 1247 12764185 10.1126 / science.1085690 kidwell mg lisch dr perspective : transposable elements , parasitic dna , and genome evolution evolution int j org evolution 2001 55 1 24 11263730 kumar a bennetzen jl plant retrotransposons annu rev genet 1999 33 479 532 10690416 10.1146 / annurev.genet.33.1.479 bennetzen jl transposable element contributions to plant gene and genome evolution plant mol biol 2000 42 251 269 10688140 10.1023 / a : 1006344508454 pardue ml danilevskaya on lowenhaupt k slot f traverse kl drosophila telomeres : new views on chromosome evolution trends genet 1996 12 48 52 8851970 10.1016 / 0168 - 9525 ( 96 ) 81399 - 0 lander es linton lm birren b nusbaum c zody mc baldwin j devon k dewar k doyle m fitzhugh w funke r gage d harris k heaford a howland j kann l lehoczky j levine r mcewan p mckernan k meldrim j mesirov jp miranda c morris w naylor j raymond c rosetti m santos r sheridan a sougnez c stange - thomann n stojanovic n subramanian a wyman d rogers j sulston j ainscough r beck s bentley d burton j clee c carter n coulson a deadman r deloukas p dunham a dunham i durbin r french l grafham d gregory s hubbard t humphray s hunt a jones m lloyd c mcmurray a matthews l mercer s milne s mullikin jc mungall a plumb r ross m shownkeen r sims s waterston rh wilson rk hillier lw mcpherson jd marra ma mardis er fulton la chinwalla at pepin kh gish wr chissoe sl wendl mc delehaunty kd miner tl delehaunty a kramer jb cook ll fulton rs johnson dl minx pj clifton sw hawkins t branscomb e predki p richardson p wenning s slezak t doggett n cheng jf olsen a lucas s elkin c uberbacher e frazier m gibbs ra muzny dm scherer se bouck jb sodergren ej worley kc rives cm gorrell jh metzker ml naylor sl kucherlapati rs nelson dl weinstock gm sakaki y fujiyama a hattori m yada t toyoda a itoh t kawagoe c watanabe h totoki y taylor t weissenbach j heilig r saurin w artiguenave f brottier p bruls t pelletier e robert c wincker p smith dr doucette - stamm l rubenfield m weinstock k lee hm dubois j rosenthal a platzer m nyakatura g taudien s rump a yang h yu j wang j huang g gu j hood l rowen l madan a qin s davis rw federspiel na abola ap proctor mj myers rm schmutz j dickson m grimwood j cox dr olson mv kaul r shimizu n kawasaki k minoshima s evans ga athanasiou m schultz r roe ba chen f pan h ramser j lehrach h reinhardt r mccombie wr de la bastide m dedhia n blocker h hornischer k nordsiek g agarwala r aravind l bailey ja bateman a batzoglou s birney e bork p brown dg burge cb cerutti l chen hc church d clamp m copley rr doerks t eddy sr eichler ee furey ts galagan j gilbert jg harmon c hayashizaki y haussler d hermjakob h hokamp k jang w johnson ls jones ta kasif s kaspryzk a kennedy s kent wj kitts p koonin ev korf i kulp d lancet d lowe tm mclysaght a mikkelsen t moran jv mulder n pollara vj ponting cp schuler g schultz j slater g smit af stupka e szustakowski j thierry - mieg d thierry - mieg j wagner l wallis j wheeler r williams a wolf yi wolfe kh yang sp yeh rf collins f guyer ms peterson j felsenfeld a wetterstrand ka patrinos a morgan mj de jong p catanese jj osoegawa k shizuya h choi s chen yj initial sequencing and analysis of the human genome nature 2001 409 860 921 11237011 10.1038 / 35057062 waterston rh lindblad - toh k birney e rogers j abril jf agarwal p agarwala r ainscough r alexandersson m an p antonarakis se attwood j baertsch r bailey j barlow k beck s berry e birren b bloom t bork p botcherby m bray n brent mr brown dg brown sd bult c burton j butler j campbell rd carninci p cawley s chiaromonte f chinwalla at church dm clamp m clee c collins fs cook ll copley rr coulson a couronne o cuff j curwen v cutts t daly m david r davies j delehaunty kd deri j dermitzakis et dewey c dickens nj diekhans m dodge s dubchak i dunn dm eddy sr elnitski l emes rd eswara p eyras e felsenfeld a fewell ga flicek p foley k frankel wn fulton la fulton rs furey ts gage d gibbs ra glusman g gnerre s goldman n goodstadt l grafham d graves ta green ed gregory s guigo r guyer m hardison rc haussler d hayashizaki y hillier lw hinrichs a hlavina w holzer t hsu f hua a hubbard t hunt a jackson i jaffe db johnson ls jones m jones ta joy a kamal m karlsson ek karolchik d kasprzyk a kawai j keibler e kells c kent wj kirby a kolbe dl korf i kucherlapati rs kulbokas ej kulp d landers t leger jp leonard s letunic i levine r li j li m lloyd c lucas s ma b maglott dr mardis er matthews l mauceli e mayer jh mccarthy m mccombie wr mclaren s mclay k mcpherson jd meldrim j meredith b mesirov jp miller w miner tl mongin e montgomery kt morgan m mott r mullikin jc muzny dm nash we nelson jo nhan mn nicol r ning z nusbaum c o'connor mj okazaki y oliver k overton - larty e pachter l parra g pepin kh peterson j pevzner p plumb r pohl cs poliakov a ponce tc ponting cp potter s quail m reymond a roe ba roskin km rubin em rust ag santos r sapojnikov v schultz b schultz j schwartz ms schwartz s scott c seaman s searle s sharpe t sheridan a shownkeen r sims s singer jb slater g smit a smith dr spencer b stabenau a stange - thomann n sugnet c suyama m tesler g thompson j torrents d trevaskis e tromp j ucla c ureta - vidal a vinson jp von niederhausern ac wade cm wall m weber rj weiss rb wendl mc west ap wetterstrand k wheeler r whelan s wierzbowski j willey d williams s wilson rk winter e worley kc wyman d yang s yang sp zdobnov em zody mc lander es initial sequencing and comparative analysis of the mouse genome nature 2002 420 520 562 12466850 10.1038 / nature01262 adams md celniker se holt ra evans ca gocayne jd amanatides pg scherer se li pw hoskins ra galle rf george ra lewis se richards s ashburner m henderson sn sutton gg wortman jr yandell md zhang q chen lx brandon rc rogers yh blazej rg champe m pfeiffer bd wan kh doyle c baxter eg helt g nelson cr gabor gl abril jf agbayani a an hj andrews - pfannkoch c baldwin d ballew rm basu a baxendale j bayraktaroglu l beasley em beeson ky benos pv berman bp bhandari d bolshakov s borkova d botchan mr bouck j brokstein p brottier p burtis kc busam da butler h cadieu e center a chandra i cherry jm cawley s dahlke c davenport lb davies p de pablos b delcher a deng z mays ad dew i dietz sm dodson k doup le downes m dugan - rocha s dunkov bc dunn p durbin kj evangelista cc ferraz c ferriera s fleischmann w fosler c gabrielian ae garg ns gelbart wm glasser k glodek a gong f gorrell jh gu z guan p harris m harris nl harvey d heiman tj hernandez jr houck j hostin d houston ka howland tj wei mh ibegwam c jalali m kalush f karpen gh ke z kennison ja ketchum ka kimmel be kodira cd kraft c kravitz s kulp d lai z lasko p lei y levitsky aa li j li z liang y lin x liu x mattei b mcintosh tc mcleod mp mcpherson d merkulov g milshina nv mobarry c morris j moshrefi a mount sm moy m murphy b murphy l muzny dm nelson dl nelson dr nelson ka nixon k nusskern dr pacleb jm palazzolo m pittman gs pan s pollard j puri v reese mg reinert k remington k saunders rd scheeler f shen h shue bc siden - kiamos i simpson m skupski mp smith t spier e spradling ac stapleton m strong r sun e svirskas r tector c turner r venter e wang ah wang x wang zy wassarman da weinstock gm weissenbach j williams sm woodaget worley kc wu d yang s yao qa ye j yeh rf zaveri js zhan m zhang g zhao q zheng l zheng xh zhong fn zhong w zhou x zhu s zhu x smith ho gibbs ra myers ew rubin gm venter jc the genome sequence of drosophila melanogaster science 2000 287 2185 2195 10731132 10.1126 / science.287.5461.2185 stein ld bao z blasiar d blumenthal t brent mr chen n chinwalla a clarke l clee c coghlan a coulson a d'eustachio p fitch dh fulton la fulton re griffiths - jones s harris tw hillier lw kamath r kuwabara pe mardis er marra ma miner tl minx p mullikin jc plumb rw rogers j schein je sohrmann m spieth j stajich je wei c willey d wilson rk durbin r waterston rh the genome sequence of caenorhabditis briggsae : a platform for comparative genomics plos biol 2003 1 e45 14624247 10.1371 / journal.pbio.0000045 kellogg ea bennetzen jl the evolution of nuclear genome structure in seed plants am j bot am j bot 2004 91 1709 1725 10.3732 / ajb.91.10.1709 vij s gupta v kumar d vydianathan r raghuvanshi s khurana p khurana jp tyagi ak decoding the rice genome bioessays 2006 28 421 432 16547947 10.1002 / bies.20399 kapitonov vv jurka j molecular paleontology of transposable elements in the drosophila melanogaster genome proc natl acad sci u s a 2003 100 6569 6574 12743378 10.1073 / pnas.0732024100 wicker t robertson js schulze sr feltus fa magrini v morrison ja mardis er wilson rk peterson dg paterson ah ivarie r the repetitive landscape of the chicken genome genome res 2005 15 126 136 15256510 10.1101 / gr.2438005 sanmiguel p tikhonov a jin yk motchoulskaia n zakharov d melake - berhan a springer ps edwards kj lee m avramova z bennetzen jl nested retrotransposons in the intergenic regions of the maize genome science 1996 274 765 768 8864112 10.1126 / science.274.5288.765 wong lh choo kh evolutionary dynamics of transposable elements at the centromere trends genet 2004 20 611 616 15522456 10.1016 / j.tig.2004.09.011 feschotte c jiang n wessler sr plant transposable elements : where genetics meets genomics nat rev genet 2002 3 329 341 11988759 10.1038 / nrg793 flavell rb repetitive dna and chromosome evolution in plants philos trans r soc lond b biol sci 1986 312 227 242 2870519 10.1098 / rstb.1986.0004 turcotte k srinivasan s bureau t survey of transposable elements from rice genomic sequences plant j 2001 25 169 179 11169193 10.1046 / j.1365 - 313x.2001.00945.x goldberg ml sheen jy gehring wj green mm unequal crossing - over associated with asymmetrical synapsis between nomadic elements in the drosophila - melanogaster genome proc natl acad sci u s a 1983 80 5017 5021 16593354 10.1073 / pnas.80.16.5017 miller k lynch c martin j herniou e tristem m identification of multiple gypsy ltr - retrotransposon lineages in vertebrate genomes j mol evol 1999 49 358 366 10473777 10.1007 / pl00006559 judelson hs sequence variation and genomic amplification of a family of gypsy - like elements in the oomycete genus phytophthora mol biol evol 2002 19 1313 1322 12140243 voytas df cummings mp koniczny a ausubel fm rodermel sr copia - like retrotransposons are ubiquitous among plants proc natl acad sci u s a 1992 89 7124 7128 1379734 10.1073 / pnas.89.15.7124 meyers bc tingey sv morgante m abundance , distribution , and transcriptional activity of repetitive elements in the maize genome genome res 2001 11 1660 1676 11591643 10.1101 / gr.188201 elgar g clark ms meek s smith s warner s edwards yj bouchireb n cottage a yeo gs umrania y williams g brenner s generation and analysis of 25 mb of genomic dna from the pufferfish fugu rubripes by sequence scanning genome res 1999 9 960 971 10523524 10.1101 / gr.9.10.960 li wl zhang p fellers jp friebe b gill bs sequence composition , organization , and evolution of the core triticeae genome plant journal 2004 40 500 511 15500466 10.1111 / j.1365 - 313x.2004.02228.x bao z eddy sr automated de novo identification of repeat sequence families in sequenced genomes genome res 2002 12 1269 1276 12176934 10.1101 / gr.88502 li rq ye j li sg wang j han yj ye c wang j yang hm yu j wong gks wang j reas : recovery of ancestral sequences for transposable elements from the unassembled reads of a whole genome shotgun plos computational biology 2005 1 313 321 10.1371 / journal.pcbi.0010043 macas j neumann p navratilova a repetitive dna in the pea ( pisum sativum l. ) genome : comprehensive characterization using 454 sequencing and comparison to soybean and medicago truncatula bmc genomics 2007 8 427 18031571 10.1186 / 1471 - 2164 - 8 - 427 altschul sf gish w miller w myers ew lipman dj basic local alignment search tool j mol biol 1990 215 403 410 2231712 stajich je block d boulez k brenner se chervitz sa dagdigian c fuellen g gilbert jgr korf i lapp h lehvaslaiho h matsalla c mungall cj osborne bi pocock mr schattner p senger m stein ld stupka e wilkinson md birney e the bioperl toolkit : perl modules for the life sciences genome research 2002 12 1611 1618 12368254 10.1101 / gr.361602 thompson jd higgins dg gibson tj clustal w : improving the sensitivity of progressive multiple sequence alignment through sequence weighting , position - specific gap penalties and weight matrix choice nucleic acids res 1994 22 4673 4680 7984417 10.1093 / nar / 22.22.4673 the log4perl project bennetzen jl the contributions of retroelements to plant genome organization , function and evolution trends microbiol 1996 4 347 353 8885169 10.1016 / 0966 - 842x ( 96 ) 10042 - 1 sanz - alferez s sanmiguel p jin yk springer ps bennetzen jl structure and evolution of the cinful retrotransposon family of maize genome 2003 46 745 752 14608391 10.1139 / g03 - 061 sanmiguel p gaut bs tikhonov a nakajima y bennetzen jl the paleontology of intergene retrotransposons of maize nat genet 1998 20 43 45 9731528 10.1038 / 1695 sanmiguel p bennetzen jl evidence that a recent increase in maize genome size was caused by the massive amplification of intergene retrotransposons annals of botany 1998 82 37 44 10.1006 / anbo.1998.0746 bennetzen jl sanmiguel p chen m tikhonov a francki m avramova z grass genomes proc natl acad sci u s a 1998 95 1975 1978 9482817 10.1073 / pnas.95.5.1975 ouyang s buell cr the tigr plant repeat databases : a collective resource for the identification of repetitive sequences in plants nucleic acids res 2004 32 d360 3 14681434 10.1093 / nar / gkh099 the tigr maize database univec database margulies m egholm m altman we attiya s bader js bemben la berka j braverman ms chen yj chen zt dewell sb du l fierro jm gomes xv godwin bc he w helgesen s ho ch irzyk gp jando sc alenquer mli jarvie tp jirage kb kim jb knight jr lanza jr leamon jh lefkowitz sm lei m li j lohman kl lu h makhijani vb mcdade ke mckenna mp myers ew nickerson e nobile jr plant r puc bp ronan mt roth gt sarkis gj simons jf simpson jw srinivasan m tartaro kr tomasz a vogt ka volkmer ga wang sh wang y weiner mp yu pg begley rf rothberg jm genome sequencing in microfabricated high - density picolitre reactors nature 2005 437 376 380 16056220 huse sm huber ja morrison hg sogin ml welch dm accuracy and quality of massively parallel dna pyrosequencing genome biol 2007 8 r143 17659080 10.1186 / gb - 2007 - 8 - 7 - r143 goldberg smd johnson j busam d feldblyum t ferriera s friedman r halpern a khouri h kravitz sa lauro fm li k rogers yh strausberg r sutton g tallon l thomas t venter e frazier m venter jc a sanger / pyrosequencing hybrid approach for the generation of high - quality draft assemblies of marine microbial genomes ( vol 103 , pg 11240 , 2006 ) p natl acad sci usa p natl acad sci usa 2006 103 16057 16057 lewis se searle sm harris n gibson m lyer v richter j wiel c bayraktaroglir l birney e crosby ma kaminker js matthews bb prochnik se smithy cd tupy jl rubin gm misra s mungall cj clamp me apollo : a sequence annotation editor genome biol 2002 3 research0082 12537571 10.1186 / gb - 2002 - 3 - 12 - research0082