peerj peerj peerj peerj peerj 2167 - 8359 peerj inc .
san francisco , usa 23862108 3709111 95 10.7717 / peerj.95 ecologystatistics generalized linear mixed models can detect unimodal species - environment relationships jamil tahira 12 ter braak cajo j.f .
1 cajo.terbraak @ wur.nl 1 biometris , wageningen university and research centre , wageningen , the netherlands 2 department of mathematics , comsats institute of information technology , islamabad , pakistan xu jianhua 9 7 2013 2013 1 e95 6 5 2013 7 6 2013 ( c ) 2013 jamil and ter braak 2013 jamil and ter braakthis is an open access article distributed under the terms of the creative commons attribution license , which permits unrestricted use , distribution , and reproduction in any medium , provided the original author and source are credited .
niche theory predicts that species occurrence and abundance show non - linear , unimodal relationships with respect to environmental gradients .
unimodal models , such as the gaussian ( logistic ) model , are however more difficult to fit to data than linear ones , particularly in a multi - species context in ordination , with trait modulated response and when species phylogeny and species traits must be taken into account .
adding squared terms to a linear model is a possibility but gives uninterpretable parameters .
this paper explains why and when generalized linear mixed models , even without squared terms , can effectively analyse unimodal data and also presents a graphical tool and statistical test to test for unimodal response while fitting just the generalized linear mixed model .
the r - code for this is supplied in supplemental information 1 .
environmental gradient testing unimodal response niche theory generalized linear mixed model gaussian logistic model higher education commission pakistantj was funded by a grant from the higher education commission pakistan .
the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .
introduction niche theory predicts that species occurrence and abundance show non - linear , unimodal relationships with respect to environmental gradients ( austin , 1987 ; palmer & dixon , 1990 ; whittaker , 1967 ) .
many studies fail to test for unimodal response ( austin , 2007 ) .
thus straight - line relationships are often fitted without justification ( e.g. , gibson et al. , 2004 ) .
pollock , morris & vesk ( 2012 ) propose a generalized linear mixed model for investigating trait modulation of the environmental response of a number of species .
in their data unimodal response was said to be precluded , presumably as they examined relatively short environmental gradients .
but might their method or a small modification thereof have worked for unimodal response ?
ives & helmus ( 2011 ) recently proposed phylogenetic generalized linear mixed models .
can these models usefully analyze unimodal response ?
a similar question arises in community ecological ordination , a class of multivariate methods to analyze the occurrence and / or abundance of a set of species in a set of sites and resulting in a configuration of the sites in a factorial plane , the directions of which can be interpreted as latent environmental variables ( jongman , ter braak & van tongeren , 1995 ; ter braak & prentice , 1988 ; walker & jackson , 2011 ) .
principal component analysis and redundancy analysis are linear ordination methods whereas ( detrended ) correspondence analysis and canonical correspondence analysis are claimed to be able to analyze unimodal response ( ter braak , 1985 ; ter braak , 1986 ) .
nevertheless , ( canonical ) correspondence analysis is an eigen vector method and therefore inherently linear .
this is most apparent in the reconstitution formula of ( canonical ) correspondence ( greenacre , 1984 ; ter braak & verdonschot , 1995 ) .
how can it be understood that these methods are able to model unimodal data but are inherently linear ?
some insight in this question is given by ihm & van groenewoud ( 1984 ) and further worked out by ter braak ( 1987 ) and de rooij ( 2007 ) who showed the relationship between the unimodal model and a generalized ( bi ) linear model , also known as goodman 's rc model .
the relationship can be used both ways .
ihm & van groenewoud ( 1984 ) use the relationship to justify their model b which is a ( bi ) linear model , for ecological ordination and de rooij ( 2007 ) uses it to transform the linear predictor of the rc model into a quadratic form , with the graphical purpose to transform a vector representation or biplot to a distance representation that is supposed to be easier to interpret for naive users of multivariate methods .
additional insight is given by zhu , hastie & walther ( 2005 ) who introduced a weighted sample model to show the equivalence of canonical correspondence analysis and linear discriminant analysis .
in this paper we propose a graphical tool and statistical test to test for unimodal response while fitting just a generalized linear mixed model ( glmm ) without squared terms .
glmms are model - based , inferential statistical tools .
glmms are very useful for describing the community patterns and are becoming popular in ecological and evolutionary studies ( bolker et al. , 2009 ; ives & helmus , 2011 ; zuur et al. , 2009 ) .
even when unimodality is detected using the proposed tool and test , we claim that glmms can effectively analyze unimodal data when the niche width is not very different among species and illustrate this claim by comparing the glmm approach with an explicit unimodal model approach on data that show unimodal response .
we focus on explicit environmental variables .
in this case of direct gradient analysis , we can of course add the squares of environmental variables to the model ( ter braak & looman , 1986 ) and test the statistical significance of the addition , but the argument extends to the trait modulated response ( jamil et al. , 2012 ) and to latent variable models ( walker & jackson , 2011 ) for which models without squared terms are easier to handle with software that is more widely available .
material & methods generalized linear mixed models and unimodal response for ease of exposition we start with a logistic linear mixed model for presence - absence data as example glmm .
the same approach can be followed for count data and loglinear models , which would relate to the rc model ( de rooij , 2007 ) .
consider the logistic linear mixed model that relates the probability of occurrence pij of species j in site i to a quantitative environmental variable xi by the formula ( 1 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ text { logit }({ p }_{ i j })={\ alpha }_{ j }+{\ beta }_{ j }{ x }_{ i }+{\ gamma }_{ i }\ quad ( i = 1 ,\ ldots , n ; j = 1 ,\ ldots , m ) \ end { eqnarray *}\ end { document } logit ( pij )= alphaj + betajxi + gammai ( i = 1 ,... , n ; j = 1 ,... , m ) with alphaj an intercept , betaj a slope and gammai a site effect , which we all take as random parameters with normal distributions with zero mean and variances \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}${\ sigma }_{\ alpha }^{ 2 }$\ end { document } sigmaalpha2 , \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}${\ sigma }_{\ beta }^{ 2 }$\ end { document } sigmabeta2 and \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}${\ sigma }_{\ gamma }^{ 2 }$\ end { document } sigmagamma2 .
in this random intercept , random slope model ( gelman & hill , 2007 ; zuur et al. , 2009 ) it is prudent to have an additional parameter rho for the correlation between the intercepts { alphaj } and slopes { betaj } ; otherwise the model would change by just centering the environmental variable .
inclusion of the random site effects { gammai } are a means to avoid pseudoreplication ( hurlbert , 1984 ) as they introduce correlation among species .
these correlations were not modelled by pollock , morris & vesk ( 2012 ) which makes their statistical tests liberal .
the site effects may account for the size of the site , the fertility of the site or any other unknown factors that influence the probability of occurrence of all species in the site .
the site effect gammai will thus be expected to be related to the expected number of species in a site , that is to sumjpij and , in terms of the data , to the number of species that is observed in a site , for short the site total , defined as si = sumjyij .
the site total and the site effect are expected to have a monotonic positive relationship .
we now turn to one of the simplest unimodal curves for presence - absence , the gaussian logistic curve ( oksanen et al. , 2001 ; ter braak & looman , 1986 ) ( 2 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ mathrm { logit }({ p }_{ i j })={ a }_{ j } - \ frac {({ x }_{ i } - { u }_{ j })^{ 2 }}{ 2 { t }_{ j }^{ 2 }}&&\ displaystyle \ end { eqnarray *}\ end { document } logit ( pij )= aj - ( xi - uj ) 22tj2 with aj a coefficient related to maximum probability of occurrence , uj the species optimum and tj the tolerance of species j. this model thus has a logistic form but is nonlinear in this parameterization. by expanding the quadratic term , ( 3 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle { a }_{ j } - \ frac {({ x }_{ i } - { u }_{ j })^{ 2 }}{ 2 { t }_{ j }^{ 2 }}={ a }_{ j } - \ frac { 1 }{ 2 { t }_{ j }^{ 2 }}{ x }_{ i }^{ 2 } - \ frac { 1 }{ 2 { t }_{ j }^{ 2 }}{ u }_{ j }^{ 2 }+\ frac { 1 }{{ t }_{ j }^{ 2 }}{ x }_{ i }{ u }_{ j }=\ left ({ a }_{ j } - \ frac { 1 }{ 2 { t }_{ j }^{ 2 }}{ u }_{ j }^{ 2 }\ right )+\ left (\ frac {{ u }_{ j }}{{ t }_{ j }^{ 2 }}\ right ){ x }_{ i } - \ frac { 1 }{ 2 { t }_{ j }^{ 2 }}{ x }_{ i }^{ 2 }&&\ displaystyle \ end { eqnarray *}\ end { document } aj - ( xi - uj ) 22tj2 = aj - 12tj2xi2 - 12tj2uj2 + 1tj2xiuj = aj - 12tj2uj2 + ujtj2xi - 12tj2xi2 it can be fitted to the data of each individual species by a generalized linear model ( glm ) by using x and x2 as predictors ( jongman , ter braak & van tongeren , 1995 ; ter braak & looman , 1986 ) .
the fit is unimodal if the regression coefficient of x2 is negative .
might we be able to model unimodal response even without the squared term ?
on assuming tj = t and setting ( 4 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} {\ alpha }_{ j }={ a }_{ j } - \ frac { 1 }{ 2 { t }^{ 2 }}{ u }_{ j }^{ 2 },\ qquad {\ beta }_{ j }=\ frac {{ u }_{ j }}{{ t }^{ 2 }}\ quad \ text { and }\ quad {\ gamma }_{ i }=\ frac { - 1 }{ 2 { t }^{ 2 }}{ x }_{ i }^{ 2 } , \ end { eqnarray *}\ end { document } alphaj = aj - 12t2uj2,betaj = ujt2andgammai = - 12t2xi2 , we obtain eq .
( 1 ) again .
if t would vary among species then eq .
( 1 ) does not exactly hold because \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}${ x }_{ i }^{ 2 }/{ t }_{ j }^{ 2 }$\ end { document } xi2 / tj2 then also depends on j. with equal tolerances , unimodal response can thus be represented by a simple linear model with site effects and , as we propose , be fitted by a glmm based on eq .
( 1 ) .
the glmm has additional normality assumptions .
in case of unimodal response , the assumption that the site effects { gammai } are independent normal is false , as the site effects then depend on xi through \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}${ x }_{ i }^{ 2 }/{ t }^{ 2 }$\ end { document } xi2 / t2 .
this will be the basis of our test on unimodal response in the next section .
the site effects in eq .
( 4 ) also have a nonzero mean , but that is not a problem , as the mean can be taken out and transferred to the intercepts ( alphaj ) .
the unimodal model with two or more environmental variables ( ter braak & prentice , 1988 ) can similarly be rewritten as a simple linear model without squared terms if the tolerances are equal ( appendix 1 ) .
in conclusion , up to distributional assumptions , the glmm ( e.g. , eq .
( 1 )) can be interpreted as a gaussian logistic model with equal tolerances for the species .
a graphical tool and statistical test for unimodal response equation ( 4 ) suggests a graphical tool for detecting unimodal response and also a statistical test .
the idea is to fit a glmm to the binary data { yij } with respect to the environmental variable with values { xi } ( i = 1 , ... , n ) .
in the r package lme4 ( bates , maechler & bolker , 2011 ) , the model can be fitted by \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ mathtt { lmer ( y \ sim 1 + x + ( 1 + x \ mid sp ) + ( 1 \ mid site ),}&&\ displaystyle \ nonumber \\ \ displaystyle \ qquad \ quad \ mathtt { family = binomial ( link = " logit ") , data ),}&&\ displaystyle \ end { eqnarray *}\ end { document } lmer ( y ~ 1 + x + ( 1 + x | sp ) + ( 1 | site ) , family = binomial ( link = " logit ") , data ) , where y represents the vectorized response data while sp and site are factors indicating species and sites .
the site effects { gammai } obtained from the fit are then plotted against the environmental variable { xi } .
there is an indication of unimodal response in terms of the species response with respect to the environmental variable x if this graph shows a n - shaped ( as opposed to u - shaped ) quadratic relationship .
if the shape is not quadratic but curved , a transformation of x may improve it. in the statistical test for unimodal response , the null model is the glmm of eq .
( 1 ) with , specifically , independent and normally distributed site effects .
the alternative model is that the site effects depend quadratically on the environmental variable .
as the site effects typically also depend on the site total s , a sensitive test on unimodal response is obtained by regressing the site effects on x , x2 and s , according to the model formula ( 5 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ gamma \ sim x +{ x }^{ 2 }+ s. &&\ displaystyle \ end { eqnarray *}\ end { document } gamma ~ x + x2 + s. there is evidence of unimodal response if the squared term is significant as judged by a z - test or , equivalently , an anova test on its regression coefficient , the null model being gamma ~ x + s. the r - code for making the graph and performing the test on unimodality is supplied in supplemental information 1 .
simulated data in the first example series the procedure to simulate data is the following : ( 1 ) generate n = 50 values of an environmental variable x as a random sample from the uniform distribution , x ~ u ( - 2 , 2 ) .
( 2 ) generate a vector u of length m from a uniform distribution u ( - tau , tau ) , where tau = 2 + t , for a fixed value of t , to ensure that optima are also placed outside the sample range of x .
( 3 ) generate a vector a of length m drawn at random from the standard normal distribution .
( 4 ) generate binomial probabilities pij from the unimodal response curve ( 6 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ hspace *{ - 14pc } { p }_{ i j }={\ mathrm { logit }}^{ - 1 }\ left ({ a }_{ j } - \ frac {({ x }_{ i } - { u }_{ j })^{ 2 }}{ 2 { t }_{ j }^{ 2 }}\ right )&&\ displaystyle \ end { eqnarray *}\ end { document } pij = logit - 1aj - ( xi - uj ) 22tj2 and generate presence - absence data yij at random from a bernoulli distribution with probability pij and tj = t. we simulate data with constant tolerance in each data set for m = 100 species and vary t between data sets ( t = 0.5 , 1 and 4 ) .
figure 1 indicates how the simulated species response curves look in each data set .
we repeated the example with x and u having normal distributions instead ( x ~ n ( 0 , 1 ) and u ~ n ( 0 , t2 )) , but do not show the results as they were very similar to the uniformly distributed case .
10.7717 / peerj.95 / fig - 1 figure 1 simulated unimodal response ( occurrence probability pij of a species at a site ) against environmental variable x for a selection of species .
for left to right : three tolerances ( t = 0.5 , 1 and 4 ) .
in the second example series , we vary the tolerance lognormally among species , t ~ log n ( 0 , sigma ) with sigma = 0.25 , 0.5 and 1 so that the median tolerance is 1 .
for sigma = 1 , the coefficient of variation is larger than 100 % .
in the third example series we vary the number of species ( m = 10 , 50 and 100 ) with t = 1 .
for the rest , the simulation is set up as in the first series .
we also simulated data according to eq .
( 1 ) with the strict assumptions of the glmm of independent normal site effects .
each dataset was characterized by beta diversity and length of gradient .
the index of beta diversity is betaw = t / s - 1 , where t is the total number of species , and s is the average number of species per site ( whittaker , 1960 ) .
length of gradient , obtained by analyzing the data with detrended correspondence analysis ( dca ) , is expressed in standard deviation ( sd ) units ( hill & gauch , 1980 ) .
values greater than 4 are commonly taken to indicate unimodal response .
beta diversity was calculated using the asbio package ( aho , 2011 ) and dca was performed in the vegan package ( oksanen et al. , 2011 ) , both in r. real data we illustrate our method with three real data sets .
the first is the dune meadow data ( jongman , ter braak & van tongeren , 1995 ) .
this is a small data set of 28 higher plants in 20 sites in a dune area in the netherlands .
environmental variables , related to soil and management , were measured at each site ; we use the variable moisture .
the second data set includes the vegetation of the rising seashore on the island skabbholmen in the stockholm archipelago , eastern central sweden ( cramer & hytteborn , 1987 ) and is part of the canoco package ( ter braak & smilauer , 1998 ) .
the data set consists of 63 sites sampled in both 1978 and 1984 and contains 68 species .
the environmental variable is elevation .
the third data set involves phytoplankton communities of 203 lakes located within four climate zones and associated measurements on various environmental variables and morphological species traits of 60 species ( kruk et al. , 2011 ) .
we consider the environmental variable temperature .
for each data set we fit a glmm according to eq .
( 1 ) with x the noted environmental variable , plot the resulting site effects against x and test for unimodal response at the 5 % significance level explained by and below eq .
( 5 ) .
for the seashore data , we analyzed 1978 and 1984 separately .
we also compare the regression coefficient betaj as estimated by glmm with the optimum uj as obtained by explicitly fitting eq .
( 2 ) using glm ( ter braak & looman , 1986 ) for species with a well - defined optimum , that is , the squared term of which has a z - ratio smaller than - 1 in the glm model .
in the small dune meadow data set we used z - ratio < 0 .
results simulated data figure 1 shows the simulated response curves in example series 1 ; the sampled range of the environmental variable is the range of x shown. with increasing tolerance the part of the curves that is sampled shows less unimodal response .
this is expressed quantitatively in the length of gradient sd units which varies between about 1 sd ( not so unimodal ) to 6 sd ( very unimodal ) ; the beta diversity varies correspondingly between 1 and 5 .
in fig. 2 , the site effects estimated by the glmm analysis of each of the simulated data sets are plotted against the environmental variable .
in all three series , site effects shows a clear quadratic relationship with the environmental variable except for large tolerance ( t = 4 ) in the first series .
note the decreasing range of site effects as the tolerance increases in the first row of fig. 2 ; for large tolerance , the site effects are close to zero .
nevertheless , the squared term in eq .
( 5 ) was significant in all examples ( p < 0.001 ) so that the method detects unimodal response even if it is moderate ( t = 4 ) .
when the data are simulated according to eq .
( 1 ) with the strict normality assumptions of the glmm , the squared term was not judged significant more often than expected on the basis of type i error of the test .
10.7717 / peerj.95 / fig - 2 figure 2 simulated data : site effects as estimated by glmm based on eq .
( 1 ) plotted against environmental variable x. a quadratic relationship indicates a unimodal response .
rows : example series 1 - 3 , columns : parameter varied .
figure 3 shows the relationship between the random slopes ( betaj ) estimated by glmm and the true optima ( uj ) in the three simulation series .
the relation is positive as predicted by eq .
( 4 ) .
the relationship is weaker the larger the tolerance ( fig. 3 , first row ). with tolerance varying across species , the relationship continues to hold true surprisingly well ( fig. 3 , second row ) , except perhaps when the coefficient of variation of the tolerance is large (> 100 %) .
the larger the number of species the clearer the predicted relationships ( last row of figs. 2 and 3 ) .
10.7717 / peerj.95 / fig - 3 figure 3 simulated data : glmm random slopes of eq .
( 1 ) plotted against the true optima of the gaussian logistic curve of eq .
( 2 ) .
rows : example series 1 - 3 , columns : parameter varied .
in the two bottom rows the ( median ) tolerance is 1 .
real data example the site effects estimated by glmm show a quadratic relationship with the noted environmental variable in each of the three data sets ( fig. 4 top row ) , with the least unimodal response in the dune meadow data .
unimodal response is significant in all cases , as judged by our proposed significance test ( p < 0.001 ) and the relationship between the random slopes ( betaj ) estimated by glmm and the optima ( uj ) obtained from a fit of the unimodal model of eq .
( 1 ) is close to linear ( fig. 4 , bottom row ) .
in the dune meadow data there is one outlier for a species with a z - ratio close to 0 .
in the phytoplankton data , the species with similar low values for the optimum received differential values for the slope , but otherwise there is a good agreement .
10.7717 / peerj.95 / fig - 4 figure 4 real data : site effects ( top ) and the glmm random slopes ( bottom ) plotted against the environmental variable x and the optima of the gaussian logistic curve as estimated by glm , respectively .
discussion our analysis of multi - species data sets showed that a glmm without squared terms but with site effects is able to detect unimodal response .
the theory required equal tolerances among species , but the simulations showed remarkable robustness to this assumption. with significant unimodal response , as judged by our test , the assumption of independence and normality of the site effects underlying the glmm is clearly violated .
this result can be interpreted in two ways .
the first way is to try and adapt the model so that the assumptions are no longer ( grossly ) violated , for example , by extending the glmm with an explicit square of the environmental variable as fixed effect , yielding ( 7 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ text { logit }({ p }_{ i j })={\ alpha }_{ j }+{\ beta }_{ 1 j }{ x }_{ i }+{\ beta }_{ 2 }{ x }_{ i }^{\ mathrm { 2 }}+{\ gamma }_{ i }&&\ displaystyle \ end { eqnarray *}\ end { document } logit ( pij )= alphaj + beta1jxi + beta2xi2 + gammai and then testing the normality assumption on the new site effects , for example by making a q - q plot ( gelman & hill , 2007 ) .
the site effects gammai obtained from the fit can then be plotted against the environmental variable to assess whether or not the unimodality is adequately modeled using quadratic terms .
the extended model still assumes constant tolerance ( as does eq .
( 1 )) as it can be rewritten as ( 8 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ text { logit }({ p }_{ i j })={ a }_{ j } - \ frac {({ x }_{ i }\ mathrm { - }{ u }_{ j })^{ 2 }}{ 2 { t }^{ 2 }}+{\ widetilde {\ gamma }}_{ i }&&\ displaystyle \ end { eqnarray *}\ end { document } logit ( pij )= aj - ( xi - uj ) 22t2 + gamma ~ i with ( 9 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} t = 1 /\ sqrt { - 2 {\ beta }_{ 2 }},\ qquad {{ u }_{ j }={ t }^{ 2 }\ beta }_{ j },\ qquad { a }_{ j }={\ alpha }_{ j }+\ frac { 1 }{ 2 { t }^{ 2 }}{ u }_{ j }^{ 2 },\ quad \ text { and }\ quad {\ widetilde {\ gamma }}_{ i }={\ gamma }_{ i }+\ frac { 1 }{ 2 { t }^{ 2 }}{ x }_{ i }^{ 2 } .
\ end { eqnarray *}\ end { document } t = 1 / - 2beta2,uj = t2betaj,aj = alphaj + 12t2uj2,andgamma ~ i = gammai + 12t2xi2 .
we can go one step further and test the assumption of equi - tolerance by adding the squared term x2 also as a random ( species - dependent ) component to eq .
( 7 ) and testing the significance of this extra variance component .
in the r package lme4 ( bates , maechler & bolker , 2011 ) , the two models to compare are ( with xx = x2 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ mathtt { lmer ( y \ sim 1 + x + xx + ( 1 + x \ mid sp ) + ( 1 \ mid site )}&&\ displaystyle \ nonumber \\ \ displaystyle \ qquad \ quad \ mathtt { family = binomial ( link = " logit ") , data )}&&\ displaystyle \ end { eqnarray *}\ end { document } lmer ( y ~ 1 + x + xx + ( 1 + x | sp ) + ( 1 | site ) family = binomial ( link = " logit ") , data ) and \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle \ mathtt { lmer ( y \ sim 1 + x + xx + ( 1 + x + xx \ mid sp ) + ( 1 \ mid site )}&&\ displaystyle \ nonumber \\ \ displaystyle \ qquad \ quad \ mathtt { family = binomial ( link = " logit ") , data )}.&&\ displaystyle \ end { eqnarray *}\ end { document } lmer ( y ~ 1 + x + xx + ( 1 + x + xx | sp ) + ( 1 | site ) family = binomial ( link = " logit ") , data ) .
we are currently investigating robust ways of testing the equi - tolerance assumption on the basis of these two models , as the default anova test has inflated type i error for small t. the second way of interpretation is to conclude that the glmm based on eq .
( 1 ) is remarkably robust to the normality assumption on the site effects and the equi - tolerance assumption and that it can be used as a basis of more complicated models , such as the trait modulated response model ( jamil et al. , 2012 ; pollock , morris & vesk , 2012 ) and latent variable models ( walker & jackson , 2011 ) , even for unimodal response .
in this way , the site effects are treated as nuisance parameters and the independence and normal distributions , needed for efficient computation , as a prior distribution that a posteriori may turn out to be false .
cormont et al .
( 2011 ) used this type of rationale to claim that their linear trait - environment method is well suited to analyze unimodal response .
conclusions site effects in multi - species glmm serve three purposes in ecological data , first to avoid pseudoreplication ( hurlbert , 1984 ) , second to account for differences in species richness among sites ( ives & helmus , 2011 ) and third ( this paper ) to allow for common nonlinear , unimodal response .
the results of this paper imply that the phylogenetic generalized linear mixed models of ives & helmus ( 2011 ) are not in conflict with niche theory as they include random site effects and can thus deal with unimodal response .
walker & jackson ( 2011 ) used a latent variable approach to test for unimodal response .
we tried their approach with the phytoplankton data , but failed to get an answer because the program for fitting the quadratic model crashed .
we focused this paper on the easier task of detection unimodal response to measured environmental variables by using a glmm without squared terms .
to scale up to a latent variable approach we need factor analytic structure within a glmm .
this already exists for linear mixed models ( thompson et al. , 2003 ; verbyla et al. , 2003 ) and it is a matter of time that it becomes standardly available for glmm .
this paper shows the utility of such factor analytic models in ecology ( walker & jackson , 2011 ) if they allow additional random site effects .
a glmm with terms that are linear in quantitative predictors is , of course , linear .
but with random site effects included , glmms can detect and fit unimodal response , with the provision that the differences in niche widths among species is not too large .
the application scope of glmm in ecology is thus much broader than one might think at first glance .
supplemental information 10.7717 / peerj.95 / supp - 1 supplemental information 1 r - script for testing unimodality with output and plot for the dune meadow data .
the zip file contains three files .
the file " rcode _ with _ example.r " is the r - script with r - function test.graph.unimodal and application to the dune data .
the file " rcode _ with _ example _ output.txt " contains the output of the r - script and the file " rcode _ with _ example _ plot.pdf " the produced plot .
click here for additional data file .
this paper benefited from input from mike palmer , steve walker and mu zhu .
appendix 1 this appendix shows that similarity between the gaussian logit models and glmms extends beyond the gaussian logistic curve .
the gaussian logistic model can be extended to two environmental variables as follows ( ter braak & prentice , 1988 ) \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ text { logit }({ p }_{ i j })={ a }_{ j } - \ frac { 1 }{ 2 }({ d }_{ 1 }({ x }_{ i 1 } - { u }_{ 1 j })^{ 2 }+{{ d }_{ 2 }({ x }_{ i 2 } - { u }_{ 2 j })}^{ 2 } - 2 { d }_{ 12 j }({ x }_{ i 1 } - { u }_{ 1 j })({ x }_{ i 2 } - { u }_{ 2 j })) \ end { eqnarray *}\ end { document } logit ( pij )= aj - 12 ( d1 ( xi1 - u1j ) 2 + d2 ( xi2 - u2j ) 2 - 2d12j ( xi1 - u1j )( xi2 - u2j )) where d 's are precision parameters , in the context of the bivariate normal distribution ( rue & held , 2005 ). by setting \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle {\ alpha }_{ j }={ a }_{ j } - \ frac { 1 }{ 2 }({ d }_{ 1 }{ u }_{ 1 j }^{ 2 }+{ d }_{ 2 }{ u }_{ 2 j }^{ 2 } - 2 { d }_{ 12 j }{ u }_{ 1 j }{ u }_{ 2 j }),&&\ displaystyle \ end { eqnarray *}\ end { document } alphaj = aj - 12 ( d1u1j2 + d2u2j2 - 2d12ju1ju2j ) , \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle {\ beta }_{ 1 j }={ d }_{ 1 }{ u }_{ 1 j } - { d }_{ 12 j }{ u }_{ 2 j },&&\ displaystyle \ end { eqnarray *}\ end { document } beta1j = d1u1j - d12ju2j , \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle {\ beta }_{ 2 j }={ d }_{ 2 }{ u }_{ 2 j } - { d }_{ 12 j }{ u }_{ 1 j },&&\ displaystyle \ end { eqnarray *}\ end { document } beta2j = d2u2j - d12ju1j , \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ displaystyle {\ beta }_{ 3 j }={ d }_{ 12 j },&&\ displaystyle \ end { eqnarray *}\ end { document } beta3j = d12j , and \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} {\ gamma }_{ i }= - \ frac { 1 }{ 2 }({ d }_{ 1 }{ x }_{ i 1 }^{ 2 }+{ d }_{ 2 }{ x }_{ i 2 }^{ 2 }) \ end { eqnarray *}\ end { document } gammai = - 12 ( d1xi12 + d2xi22 ) we can write \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { upgreek } \ usepackage { mathrsfs } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document } }{}\ begin { eqnarray *} \ text { logit }({ p }_{ i j })={\ alpha }_{ j }+{\ beta }_{ 1 j }{ x }_{ i 1 }+{\ beta }_{ 2 j }{ x }_{ i 2 }+{\ beta }_{ 3 j }{ x }_{ i 1 }{ x }_{ i 2 }+{\ gamma }_{ i } .
\ end { eqnarray *}\ end { document } logit ( pij )= alphaj + beta1jxi1 + beta2jxi2 + beta3jxi1xi2 + gammai .
here beta3j are random effects for interactions .
if the ' co - precisions' are equal ( d12j = d12 ) the term beta3jxi1xi2 can be subsumed in to the site effects gammai and the model can do without interactions .
the gammai account for the quadratic term arising from the gaussian ( logit ) model .
extension to more than two environmental variables is immediate .
in conclusion , up to distributional assumptions , the glmm can be interpreted as a gaussian logistic model with equal tolerances for the species .
additional information and declarations competing interests cjftb is an academic editor for peerj .
author contributions tahira jamil conceived and designed the experiments , performed the experiments , analyzed the data , contributed reagents / materials / analysis tools , wrote the paper .
cajo j.f. ter braak conceived and designed the experiments , contributed reagents / materials / analysis tools , wrote the paper .
references aho ( 2011 ) aho k 2011 asbio : a collection of statistical tools for biologists .
r package version 0.3 - 36 .
available at http :// cran.r - project.org ( accessed 29 november 2011 ) austin ( 2007 ) austin mp species distribution models and ecological theory : a critical assessment and some possible new approaches ecological modelling 2007 200 1 19 10.1016 / j.ecolmodel.2006.07.005 austin ( 1987 ) austin mp models for the analysis of species' response to environmental gradients plant ecology 1987 69 35 45 10.1007 / bf00038685 bates , maechler & bolker ( 2011 ) bates d maechler m bolker b 2011 lme4 : linear mixed - effects models using s4 classes .
r package version 0.999375 - 39 .
available at http :// cran.r - project.org ( accessed 29 november 2011 ) bolker et al .
( 2009 ) bolker bm brooks me clark cj geange sw poulsen jr stevens mhh white jss generalized linear mixed models : a practical guide for ecology and evolution trends in ecology and evolution 2009 24 127 135 10.1016 / j.tree.2008.10.008 19185386 cormont et al .
( 2011 ) cormont a vos cc van turnhout cam foppen rpb ter braak cjf using life - history traits to explain bird population responses to increasing weather variability climate research 2011 49 59 71 10.3354 / cr01007 cramer & hytteborn ( 1987 ) cramer w hytteborn h the separation of fluctuation and long - term change in vegetation dynamics of a rising seashore plant ecology 1987 69 157 167 10.1007 / bf00038697 de rooij ( 2007 ) de rooij m the distance perspective of generalized biadditive models : scalings and transformations journal of computational and graphical statistics 2007 16 210 227 10.1198 / 106186007x180101 gelman & hill ( 2007 ) gelman a hill j data analysis using regression and multilevel / hierarchical models 2007 cambridge cambridge university press gibson et al .
( 2004 ) gibson la wilson ba cahill dm hill j spatial prediction of rufous bristlebird habitat in a coastal heathland : a gis - based approach journal of applied ecology 2004 41 213 223 10.1111 / j.0021 - 8901.2004.00896.x greenacre ( 1984 ) greenacre mj theory and applications of correspondence analysis 1984 london academic press hill & gauch ( 1980 ) hill mo gauch hg detrended correspondence analysis : an improved ordination technique plant ecology 1980 42 47 58 10.1007 / bf00048870 hurlbert ( 1984 ) hurlbert sh pseudoreplication and the design of ecological field experiments ecological monographs 1984 54 187 211 10.2307 / 1942661 ihm & van groenewoud ( 1984 ) ihm p van groenewoud h correspondence analysis and gaussian ordination compstat lectures 1984 3 5 60 ives & helmus ( 2011 ) ives ar helmus mr generalized linear mixed models for phylogenetic analyses of community structure ecological monographs 2011 81 511 525 10.1890 / 10 - 1264.1 jamil et al .
( 2012 ) jamil t ozinga wa kleyer m ter braak cjf selecting traits that explain species - environment relationships : a generalized linear mixed model approach journal of vegetation science 2012 10.1111 / j.1654 - 1103.2012.12036.x jongman , ter braak & van tongeren ( 1995 ) jongman rhg ter braak cjf van tongeren ofr data analysis in community and landscape ecology 1995 cambridge cambridge university press kruk et al .
( 2011 ) kruk c peeters e van nes eh huszar vlm costa ls scheffer m phytoplankton community composition can be predicted best in terms of morphological groups limnology and oceanography 2011 56 110 118 10.4319 / lo.2011.56.1.0110 oksanen et al .
( 2011 ) oksanen j blanchet fg kindt r legendre p o'hara rb simpson gl solymos p stevens mhh wagner h 2011 vegan : community ecology package .
r package version 1.17 - 12 .
available at http :// cran.r - project.org ( accessed 29 november 2011 ) oksanen et al .
( 2001 ) oksanen j laara e tolonen k warner bg confidence intervals for the optimum in the gaussian response function ecology 2001 82 1191 1197 10.1890 / 0012 - 9658 ( 2001 ) 082 [ 1191 : ciftoi ] 2.0.co ; 2 palmer & dixon ( 1990 ) palmer mw dixon pm small - scale environmental heterogeneity and the analysis of species distributions along gradients journal of vegetation science 1990 1 57 65 10.2307 / 3236053 pollock , morris & vesk ( 2012 ) pollock lj morris wk vesk pa the role of functional traits in species distributions revealed through a hierarchical model ecography 2012 35 716 725 10.1111 / j.1600 - 0587.2011.07085.x rue & held ( 2005 ) rue h held l gaussian markov random fields : theory and applications 2005 london chapman and hall - crc press ter braak ( 1985 ) ter braak cjf correspondence analysis of incidence and abundance data : properties in terms of a unimodal response model biometrics 1985 41 859 873 10.2307 / 2530959 ter braak ( 1986 ) ter braak cjf canonical correspondence analysis : a new eigenvector technique for multivariate direct gradient analysis ecology 1986 67 1167 1179 10.2307 / 1938672 ter braak ( 1987 ) ter braak cjf unimodal models to relate species to environment phd thesis 1987 wageningen universityavailable at http :// edepot.wur.nl / 201452 ter braak & looman ( 1986 ) ter braak cjf looman cwn weighted averaging , logistic regression and the gaussian response model vegetatio 1986 65 3 11 10.1007 / bf00032121 ter braak & prentice ( 1988 ) ter braak cjf prentice ic a theory of gradient analysis advances in ecological research 1988 18 271 317 10.1016 / s0065 - 2504 ( 08 ) 60183 - x ter braak & smilauer ( 1998 ) ter braak cjf smilauer p canoco reference manual and user 's guide to canoco for windows : software for canonical community ordination ( version 4 ) 1998 ithaca microcomputer power available at http :// www.canoco.com ter braak & verdonschot ( 1995 ) ter braak cjf verdonschot pfm canonical correspondence analysis and related multivariate methods in aquatic ecology aquatic sciences 1995 57 255 289 10.1007 / bf00877430 thompson et al .
( 2003 ) thompson r cullis b smith a gilmour a a sparse implementation of the average information algorithm for factor analytic and reduced rank variance models australian & new zealand journal of statistics 2003 45 445 459 10.1111 / 1467 - 842x.00297 verbyla et al .
( 2003 ) verbyla ap eckermann pj thompson r cullis br the analysis of quantitative trait loci in multi - environment trials using a multiplicative mixed model australian journal of agricultural research 2003 54 1395 1408 10.1071 / ar02239 walker & jackson ( 2011 ) walker sc jackson da random - effects ordination : describing and predicting multivariate correlations and co - occurrences ecological monographs 2011 81 635 663 10.1890 / 11 - 0886.1 whittaker ( 1960 ) whittaker rh vegetation of the siskiyou mountains , oregon and california ecological monographs 1960 30 279 338 10.2307 / 1943563 whittaker ( 1967 ) whittaker rh gradient analysis of vegetation biological reviews of the cambridge philosophical society 1967 49 207 264 4859903 zhu , hastie & walther ( 2005 ) zhu m hastie tj walther g constrained ordination analysis with flexible response functions ecological modelling 2005 187 524 536 10.1016 / j.ecolmodel.2005.01.049 zuur et al .
( 2009 ) zuur af ieno en walker n saveliev aa smith gm mixed effects models and extensions in ecology with r 2009 new york springer verlag