sensors ( basel ) sensors ( basel ) sensors sensors ( basel , switzerland ) 1424 - 8220 mdpi 28441751 5426928 10.3390 / s17040932 sensors - 17 - 00932 article implementation issues of adaptive energy detection in heterogeneous wireless networks sobron iker 1 * eizmendi inaki 1 martins wallace a .
2 diniz paulo s. r. 2 ordiales juan luis 1 velez manuel 1 pajares martinsanz gonzalo academic editor 1 university of the basque country upv / ehu , 48013 bilbao , spain ; inaki.eizmendi @ ehu.eus ( i.e. ) ; juanluis.ordiales @ ehu.eus ( j.l.o. ) ; manuel.velez @ ehu.eus ( m.v . )
2 federal university of rio de janeiro ( ufrj ) , rio de janeiro 21941 - 972 , brazil ; wallace.martins @ smt.ufrj.br ( w.a.m. ) ; diniz @ smt.ufrj.br ( p.s.r.d . )
* correspondence : iker.sobron @ ehu.eus ; tel. : + 34 - 94 - 601 - 7256 23 4 2017 4 2017 17 4 932 31 1 2017 12 4 2017 ( c ) 2017 by the authors .
2017 licensee mdpi , basel , switzerland .
this article is an open access article distributed under the terms and conditions of the creative commons attribution ( cc by ) license ( http :// creativecommons.org / licenses / by / 4.0 /) .
spectrum sensing ( ss ) enables the coexistence of non - coordinated heterogeneous wireless systems operating in the same band .
due to its computational simplicity , energy detection ( ed ) technique has been widespread employed in ss applications ; nonetheless , the conventional ed may be unreliable under environmental impairments , justifying the use of ed - based variants .
assessing ed algorithms from theoretical and simulation viewpoints relies on several assumptions and simplifications which , eventually , lead to conclusions that do not necessarily meet the requirements imposed by real propagation environments .
this work addresses those problems by dealing with practical implementation issues of adaptive least mean square ( lms ) - based ed algorithms .
the paper proposes a new adaptive ed algorithm that uses a variable step - size guaranteeing the lms convergence in time - varying environments .
several implementation guidelines are provided and , additionally , an empirical assessment and validation with a software defined radio - based hardware is carried out .
experimental results show good performance in terms of probabilities of detection ( pd > 0.9 ) and false alarm ( pf ~ 0.05 ) in a range of low signal - to - noise ratios around [ - 4,1 ] db , in both single - node and cooperative modes .
the proposed sensing methodology enables a seamless monitoring of the radio electromagnetic spectrum in order to provide band occupancy information for an efficient usage among several wireless communications systems .
energy detection sdr implementation usrp cooperative networks 1 .
introduction an important bottleneck in current broadband wireless communication systems is spectrum scarcity .
among the proposals to address this issue , the continuous sensing of particular spectrum bands in order to detect the so - called white spaces is quite promising .
users that otherwise would not be able to communicate can leverage this knowledge to opportunistically use the available spectrum portions .
the sensing stage here is of paramount importance and , in this context , it is implemented by devices with built - in antenna ( or antenna array ) , down converters , analog - to - digital converters ( adcs ) , and digital processors that are fed by the resulting digital samples and may perform additional expert processing .
the devices capable of performing those tasks are called cognitive radio ( cr ) nodes ; in fact , following an intelligent sensing framework , the main challenges regarding spectrum sensing by cr nodes can be cast within the digital signal processing context , as will be further clarified .
current wireless communication models state new ecosystems such as 5g in order to integrate different wireless communication solutions into a unified structure that connects people , machines and devices on a massive scale , besides offering a variety of ubiquitous services and applications [ 1 ] .
in order to favor this model , the shared use of radio spectrum resources is also promoted [ 2 ] by providing alternatives for the coexistence of non - coordinated heterogeneous wireless systems operating in the same band .
at this point , spectrum sensing is the first stage of the dynamic spectrum access cycle that enables a virtually harmless coexistence .
the basic functioning principle of this solution relies on a usually unlicensed or secondary user ( su ) , capable of observing whether a specific frequency band is being utilized by a primary , or licensed , user ( pu ) .
if the frequency band is available , then the secondary user can occupy it without interfering with primary terminals .
in addition , if the authorized terminal restarts transmission , the secondary terminal jumps off into a different band , or modifies its transmission scheme , while staying in the same frequency band , in order to minimize interference [ 3,4,5 ] .
several wireless technologies such as zigbee , wifi and bluetooth already coexist in unlicensed bands ( i.e. , industrial , scientific and medical ( ism ) bands ) , employing spectrum sensing as a listen - before - talk strategy in order to minimize mutual interferences in the spectrum sharing scenario .
in addition , other wireless schemes such as long term evolution ( lte ) - unlicensed extend lte to unlicensed spectrum by aggregating unlicensed carriers with licensed ones through carrier aggregation or solely operating in unlicensed bands [ 6 ] , where spectrum sensing will play an important role .
lastly , we can also mention the recently emerged concept named licensed shared access ( lsa ) [ 7,8 ] .
lsa is a supervised shared access proposal based on an exclusive regime of spectrum sharing among incumbents - - i.e. , pus , which have the right to commercially exploit a given wireless spectrum portion - - and lsa licensees - - i.e. , licensed users that leased an incumbent 's spectrum band , which can then be used when permission is granted .
the entity responsible for granting permissions is a denominated lsa controller , whose decisions are taken based on spectrum availability information provided by incumbents to the lsa repositories [ 9 ] .
in this context , spectrum sensing technologies facilitate the decisions of lsa controllers by providing lsa repositories with dynamic and up - to - date radio - environment maps ( rems ) [ 1,10 ] .
more specifically , this dynamic knowledge and update of rems is acquired via processing of spectrum measurements collected from intelligent sensors , consisting of measurement - capable devices ( mcds ) with geo - location information .
a plethora of spectrum sensing techniques can be found in the literature , where energy detection ( ed ) plays a key role in low - complexity applications due to its inherent computational simplicity in terms of implementation and no need of prior information about pus [ 5,11,12,13,14 ] .
variants of the ed technique , including adaptive ed solutions , have been proposed in order to address those cases in which the conventional energy detector is unreliable due to environmental circumstances , such as insufficient signal strength , rapid noise - power fluctuations , or background interferences [ 15,16 ] .
whenever possible , cooperative strategies are employed to increase the detection reliability in either centralized or distributed manners [ 17,18 ] .
in this context , distributed least - mean - squares ( lms ) - based algorithms have been widely employed for adaptive ed purposes [ 19,20,21,22,23,24 ] .
commonplace among those skeptical researchers and practitioner engineers is the fact that most of the works in this area are analyzed from theoretical and simulation viewpoints solely , thus relying on several assumptions and simplifications which , eventually , lead to conclusions that do not necessarily meet the requirements imposed by real propagation environments .
exceptions to this rule include [ 25,26 ] and references therein , which consider some practical issues of conventional ed , and [ 27,28,29 ] , which consider practical opportunistic spectrum access from a cross - layer perspective , analyzing medium access control ( mac ) and other layers of the protocol stack .
in this work , we analyze the distributed lms - based ed technique proposed in [ 24 ] from a practical viewpoint .
in theoretical works , environment parameters , such as signal - to - noise ratio ( snr ) and noise variance , are initially fixed to analyze the performance of the algorithm .
based on those predefined values , the step - size of the lms algorithm , which controls the convergence speed of the algorithm , is accordingly chosen .
in real scenarios , shadowing due to moving objects or people along with other environmental impairments make the environment time - varying .
as a consequence , those parameters which are considered constant in theoretical works are no longer time - invariant and must be updated online .
these reasons motivated this work to deal with the implementation issues of the previously - proposed adaptive ed algorithm and present a new practical proposal of the theoretical lms - based ed algorithm .
the proposed modifications make the original algorithm practical to work with minimal tuning in heterogeneous wireless scenarios .
in addition , an empirical assessment and validation with a software defined radio ( sdr ) - based hardware implementation is carried out .
thus , the main contributions of the paper are : ( 1 ) a new proposal of a variable step - size ( vss ) lms ed algorithm which computes online the step - size in order to ensure the convergence of the adaptive solution proposed in [ 24 ] for time - varying snr environments ; ( 2 ) practical solutions for noise variance and snr estimations as well as data sharing ; ( 3 ) implementation guidelines of the vsslms - based ed algorithm for single - node and cooperative modes ; ( 4 ) an implementation of the practical vsslms - based ed scheme in an sdr - based framework using universal software radio peripheral ( usrp ) platforms for both single - node and cooperative ed ; and , finally ; ( 5 ) the evaluation of the sensing system using lab measurements in a real indoor radio - propagation scenario .
the ed - based sensing methodology proposed in this paper pursues an actual seamless monitoring of the radio environment through the received electromagnetic signal strength processing in mcds ( i.e. , usrp devices ) .
the ed - based sensing solutions are given for stand - alone or cooperative modes , in which the latter provides a more accurate and reliable monitoring in areas with low snr .
the described sensing procedure can be employed for different purposes such as opportunistic spectrum access in spectrum sharing scenarios or generation of rems .
the paper is organized as follows .
section 2 briefly reviews the lms - based ed algorithm proposed in [ 24 ] ; section 3 deals with the three main implementation issues of the algorithm , namely noise variance and snr estimation , variable step - size computation , and cooperative issues ; in section 4 , the sdr - based testbench is described .
the results corresponding to the lab measurements and further discussions are presented in section 5 , in which transient and steady - state analyses are firstly performed in section 5.1 , while the detection performance for different schemes is analyzed in section 5.2 .
finally , conclusions are drawn in section 6 .
2. review of adaptive ed algorithm let us consider a cognitive radio network where secondary users spatially distributed perform spectrum sensing in a selected frequency band in order to detect the presence of licensed or primary users .
the primary - user signal and the input noise at the secondary - user receiver are assumed random and zero - mean gaussian distributed with covariance matrices sigmas = sigmas2in and sigmaw = sigmaw2in , respectively .
thus , the received signal x =[ x1 ,... , xn ] t can be expressed as ( 1 ) x = betas + w , where s =[ s1 ,... , sn ] t is the pu signal , w =[ w1 ,... , wn ] t denotes the input noise , and beta works as a selector of the environment characteristic under the hypotheses h0 ( absence of pu signal , i.e. , beta = 0 ) and h1 ( presence of pu signal , i.e. , beta = 1 ) .
the energy detector of the m - th secondary user computes a local test statistic ym,k from n received samples at the time slot k as ( 2 ) ym,k = x2 = sumn = 1nxn2 .
the local test statistic is then used to compute an adaptive lms - based test statistic ( cf. [ 24 ] for more details ) , which can then be employed in both cooperative and single - node contexts .
as a result , the update equation of the test statistic omegam,k to be used in a distributed detection process at the m - th su can be expressed as ( 3 ) omegam,k + 1 = omegam,k + mumsumiinnmciepsiloni,ku ~ i,k , where u ~ i,k = yi,k - gammai represents the adaptive filter input associated with the i - th neighboring user within the neighborhood of the m - th user , denoted as nm. it is worth noticing that ( 3 ) is the generalized expression for single - node and distributed cooperative detection .
when cooperation is possible , the lms - based test statistic uses the local test statistics obtained from the m - th node and their neighboring sus , i.e. , yi,kforiinnm .
when single - node operation is chosen , the lms - based test statistic uses only the test statistic of the m - th su , i.e. , ym,k since card ( nm )= 1 .
the value gammai is the threshold over the test statistic yi,k for a predefined probability of false alarm pf = pr ( yi,k > gammai | h0 ) .
in general , gammai can be computed by considering yi,k as being gaussian distributed , a reasonable approximation for sufficiently high n in practice [ 24,30 ] .
the parameter mum represents the step - size of the adaptive algorithm and the output - error coefficient epsiloni,k is computed as ( 4 ) epsiloni,k = d ~ i,k - omegam,ku ~ i,k , where d ~ i,k = di,k - gammai , with di,k being the desired signal , which can be computed at each instant k as ( 5 ) di,k =( 1 - alpha ) yi,k + alphadi,k - 1 , in which alpha is a scalar close to but less than 1 ( alpha = 0.95 is widely used ) .
moreover , the coefficients ci must satisfy sumiinnmci = 1 and are chosen in order to perform uniform or weighted cooperation .
when cooperation is uniform , weights are computed as ci = 1 / card ( nm ) .
weighted cooperation is carried out as a function of parameters such as number of linked nodes [ 31 ] , noise variance , or snr estimates [ 24 ] .
the selection of the weighted strategy shall depend on the available shared information from the neighbors at the m - th su. following the update process in ( 3 ) , the detection test is then performed : ( 6 ) omegam,k <=> h0h1gamma ~ m , where gamma ~ m is the new detection threshold for the neighborhood nm. assuming that the distribution of omegam,k at steady state can be approximated to a gaussian distribution [ 24 ] , we can express the probability of false alarm of the detector for a certain threshold gamma ~ m as ( 7 ) pf = pr ( omegam,k > gamma ~ m | h0 )= qgamma ~ m - eomegam,kh0varomegam,kh0 , where eomegam,kh0 and varomegam,kh0 are the expectation and variance of omegam,k , respectively , when hypothesis h0 holds .
the derivations of those values can be found in [ 24 ] .
the q - function is defined as qz = integralzinfinity12pie - x22dx .
consequently , from ( 7 ) , the threshold gamma ~ m can be obtained for a predefined pf as ( 8 ) gamma ~ m = eomegam,kh0 + q - 1pfvaromegam,kh0 .
3. implementation issues of adaptive ed this section deals with the main practical issues arising from the implementation of the previously described algorithm .
in real applications , the parameters which are usually assumed known or computed offline in theoretical works need to be updated online to make the algorithm practical and self - adjustable .
in this sense , we present a series of pragmatical solutions which enable the actual implementation of the adaptive ed algorithm described in the previous section in an sdr - based platform .
firstly , a practical method for the noise variance sigmam2 and snr estimation is presented .
secondly , we will propose a new version of the lms - based ed algorithm based on a variable step - size strategy in order to ensure the convergence of the algorithm in time - varying environments .
in addition , the behavior of the vss proposal is analyzed in the transient states .
finally , some aspects of data sharing in cooperative detection are addressed along with a general view of the new practical proposal .
3.1 .
noise variance and snr estimation in practical scenarios , it is necessary to estimate the noise variance in order to compute the thresholds gamma and gamma ~ ( sometimes , we shall omit the index that identifies the su node ( e.g. , m ) for the sake of notation simplicity ) .
such a task can be conducted before running the adaptive algorithm by considering that ym,k is drawn from a gaussian distribution whose parameters depend on the particular hypothesis .
more specifically , ym,k ~ n ( nsigmam2,2nsigmam4 ) if h0 holds , whereas ym,k ~ n ( n + netam,ksigmam2,2n + 2netam,ksigmam4 ) if h1 holds .
as dm,k =~ eym,k in the steady state , it immediately follows that dm,k =~ eym,kh1 when h1 holds and dm,k =~ eym,kh0 when h0 .
hence , one can estimate the snr during pu 's transmissions as : ( 9 ) eta ^ m,k = dm,knsigmam2 - 1 .
when the channel is idle , noise variance can be estimated from dm,k since dm,k =~ eym,kh0 = nsigmam2 after some iterations , while eta ^ m,k in ( 9 ) will tend to zero .
the snr estimates can be used to gauge the strength of the signal and decide the cooperation strategy when neighbors are available .
in addition , estimated values eta ^ m,k can be used for the proposed snr - based weighted cooperative method proposed in [ 24 ] .
3.2 .
a variable step - size lms - based ed proposal one of the main challenges associated with the use of lms algorithms is the proper choice of their step - size parameter .
when the step - size is chosen close to its maximum value ( that guarantees convergence ) , the algorithm converges rapidly but the resultant error floor is high .
in contrast , reducing the step - size enhances the error performance , but the transient state of the algorithm becomes longer .
in order to overcome this effect , variable step - size ( vss ) strategies have been suggested in the literature for different purposes [ 32,33,34 ] .
the many possible choices for the adaptation of the step - size come from the multitude of scenarios where adaptive algorithms can be applied [ 32 ] .
we shall analyze in this section the time - varying ed problem in order to propose a balanced vss strategy in terms of stability and performance .
convergence of the parameter omegam,k in ( 3 ) is ensured when 0 < mum < 1eu ~ m,k2 .
as the adaptive filter input can fluctuate between two states , namely presence and absence of signal , a good choice of mum can be performed following the criterion given by : ( 10 ) 0 < mum < mineu ~ m,k2h0 - 1,eu ~ m,k2h1 - 1 .
in figure 1 , the values of eu ~ m,k2 - 1 for hypotheses h0 and h1 are depicted for snrs within the interval [ - 10,10 ] db and pf within the interval [ 10 - 4,10 - 0.5 ] , considering the measured value of noise variance as sigmaw2 = 5.6x10 - 16 .
one can observe that the maximum limit of the step - size is given by the statistics of hypothesis h0 when snr is negative and the probability of false alarm is low .
however , when snr increases , eu ~ m,k2 under h1 is dominant , and , consequently , the step - size upper bound is given by eu ~ m,k2h1 - 1 .
as the sensed environment is usually time - varying due to ubiquitous shadowing effects , snr can fluctuate during the sensing , eventually modifying the convergence criterion of the algorithm .
in this context , the use of an adaptive strategy to compute mum allows for dealing with this time - varying effect .
as mentioned before , several vss algorithms have been previously proposed to increase the speed of convergence or to reduce the mean square error depending on the particular application .
in detection problems , one cannot usually estimate offline the noise variance of the equipment , for we do not know a priori which hypothesis holds .
as we have seen in figure 1 , the step - size upper bound may depend on h1 statistics in some particular scenarios .
for that reason , we need an adaptive strategy to compute a step - size satisfying the convergence criterion .
in order to do that , we propose computing the following ancillary parameters for each iinnm : ( 11 ) pi,k =( 1 - alpha ) u ~ i,k2 + alphapi,k - 1mu i,k = minmu i,k - 1,2 - log2 ( pi,k ) and then choose the step - size as ( 12 ) mum,k = miniinnmmu i,k. at this point , it is worth highlighting that the threshold gamma ~ in ( 8 ) must be updated when mum,k changes - - it is actually a parameter gamma ~ m,k , depending on the time - instant k as well .
in addition , reinitialization of ( 11 ) is recommended when significant changes are observed in the surrounding environment , i.e. , different number of neighboring sus or important differences in the estimated snr conditions .
additionally , the speed of convergence in the transient state can be approximated as 1mum,keu ~ m,k2 iterations to decrease to 1 / e of the initial value [ 35 ] .
since eu ~ m,k2 are different for h0 and h1 , transient states of both hypotheses would be different if the step - size were the same .
consequently , the overall probability of detection and the overall probability of false alarm will be degraded depending on the length of transient states compared with the length of steady state for the minimum lengths of hypotheses h1 and h0 given by the sampling rate of the adaptive ed algorithm. from figure 1 and taking the convergence criterion in ( 10 ) into account , the variable step - size will be selected according to mum,k < eu ~ m,k2h0 - 1 when snr is negative .
if we compute the 1 / e - th transient periods , we see 1mum,keu ~ m,k2h0 < 1mum,keu ~ m,k2h1 , and , consequently , the overall probability of detection , pd , could be more affected due to a longer transient state of h1 when compared with the steady state .
in contrast , when snr conditions correspond to values in the red area depicted on the right - hand side of figure 1 , the step - size mum,k is upper - bounded by eu ~ m,k2h1 - 1 and transient time in h0 will be higher than in h1 .
as a result , the probability of false alarm will be degraded as compared to the target pf. in figure 2 , we show the number of iterations that takes to decay 1 / e - th of the initial value for h0 and h1 using a step - size computed as in ( 12 ) , for the same parameters of snr , pf , and noise variance as in figure 1 .
as mentioned before , one can observe that the 1 / e - th transient period will be much greater for h0 (=~[ 103,4x103 ] iterations ) than for h1 (=~[ 1 , 10 ] iterations ) when snr > 5 db and target pf > 10 - 2 .
in contrast , when pf and snr correspond to values in the blue area depicted on the right - hand side of figure 1 , transient states for both h0 and h1 become much smaller (=~[ 1 , 100 ] iterations ) .
as a result , since transient states must be negligible compared with steady states in order to achieve reasonable performance in terms of real pf and pd , then the sampling rate associated with the signals feeding the adaptive algorithm must be chosen according to estimated snr , target pf , and the minimum average length between hypotheses h0 and h1 .
otherwise , transient states are not negligible and overall performance is deteriorated .
3.3 .
cooperative detection issues when cooperative detection is performed at a given node m , the sus belonging to the neighborhood nm ( i.e. , those users which can communicate with m using the control channel ) must share some parameters with the m - th node .
as shown in [ 24 ] , the local noise variance and the test statistic of each neighboring user are the necessary parameters to share .
additionally , if weighted strategies are used , local snrs could be also shared .
in order to compute omegam,k , a series of additional operations must be carried out in order to get the inputs u ~ i,k and desired signals d ~ i,k from the local noise variances and the test statistics of each neighboring user in the neighborhood nm. reducing the number of those extra operations at each node necessarily calls for a more efficient sharing strategy consisting of sharing directly the inputs u ~ i,k and desired signals d ~ i,k instead of the local noise variance and the test statistics ; this is indeed an efficient strategy since the proposed u ~ i,k and d ~ i,k are computed at each node anyway , i.e. , there is no extra computational burden for the rest of neighboring users .
on the other hand , due to the use of variable step - size algorithm , extra data must be shared in the proposed setup .
in table 1 , we show the proposed shared data compared with the original algorithm in [ 24 ] .
taking all the previous considerations into account , the flowchart of the practical ed algorithm is drawn in figure 3 .
firstly , the m - th su must be initialized estimating the input noise variance sigmam2 , which will be later used to calculate gammam and statistics of omegam,k. once the algorithm is initialized , the receiver can gather local and neighboring energy estimates , when cooperation is active , to perform the detection process .
the computation of several parameters of the adaptive algorithm are conducted using yi,kiinnm and the initialization values .
if the cooperation mode is active , the parameters shown in table 1 are shared .
afterwards , the vsslms - based ed is executed and the detection threshold gamma ~ m,k is updated .
finally , the detection test is carried out .
4. experimental sdr testbench the adaptive vsslms - based ed algorithm has been implemented by using three usrp devices ( n - 210 + radio frequency ( rf ) daughterboard wbx , ettus research ) and the labview software ( version 14.0f1 ( 32 bits ) , national instruments corporation , austin , tx , usa ) .
the setup consists of 1 pu , which can transmit in a random manner maintaining each hypothesis state active during a minimum length , and 3 sus , which can sense the environment in both single - node or cooperative modes .
as shown in figure 4 , each transmitter or receiver antenna is connected to one usrp platform , which is controlled with labview software via ethernet from one laptop or computer .
all equipments are interconnected using ethernet as a control channel in order to share data in cooperative mode .
in figure 5 and figure 6 , different parts of the labview control panel , used to configure the usrp device , are shown. from the panel in figure 5 , data acquisition physical layer ( phy ) parameters can be controlled and target pf can be selected .
usrps receive iq data with 33.3 msamples / s centered at 682 mhz .
iq data stream is split into frames of 1000 time - domain samples to be converted to frequency domain .
furthermore , detection thresholds are also displayed for the selected channels .
in figure 6 , we can set up the vss in ( 12 ) , pu / su roles of the usrp , weighting strategy in cooperative mode , ed modes ( single - node mode or cooperative mode ) , channel frequencies , and saving data .
additionally , the panel displays the power spectrum and the ed decisions for the selected channels .
the pu transmitter and su receivers are operating in white spaces of the television ( tv ) band , i.e. , free channels within the tv band ( 470 - 794 mhz ) .
the receiver collects n = 65 samples in the frequency domain from the selected channel bandwidth and computes the local energy estimates .
the generated data traffic from pu consists of video transmission .
the pre - defined probability of false alarm is fixed to 0.001 .
the hardware configuration and the parameter setting of the phy layer of pu and sus are summarized in table 2 .
the selected channel is free of external rf interfering sources since they have been chosen from tv white spaces at that location .
the minimum time length of each hypothesis is 10 s. in cooperative mode , the variables shown in table 1 are shared with all users .
5. results and discussion in this section , the proposed practical solutions in section 3 are analyzed through lab measurements with the previously detailed sdr - based hardware implementation .
firstly , we assess in section 5.1 how the transient - state affects the overall performance of the algorithm for different environments compared with the steady - state performance in terms of pd and pf. additionally , a comparison with the conventional ed method is also performed .
in section 5.2 , the performances of the algorithm in real conditions are presented and compared with a theoretical benchmark for single - node and two - node cooperative ed .
5.1 .
transient and steady state analysis as we have seen previously , the length of transient states highly depends on the snr at hypothesis h1 .
we have analyzed this behavior in figure 7 and figure 8 using single - node detection in different environments where snr varies in the ranges [ - 4,0.5 ] db and [ 3,5 ] db , respectively .
the performance values in terms of pd and pf are shown in table 3 , where we have computed the overall detection performance and probability of false alarm , both in steady state , i.e. , pd and pf after the adaptive ed algorithm converges .
in addition , we have compared the results with conventional ed. if we pay attention to figure 7 , we can see how the vsslms - based ed algorithm adapts their values to the time - varying nature of a receiving signal in real conditions .
in addition , we observe that the transient state can be neglected compared with the steady state .
in this sense , this effect is confirmed with results from table 3 for the snr range [ - 4,0.5 ] db ; transient state is similar in h0 and h1 , and , consequently , the overall pf and pd are slightly increased and reduced , respectively .
the ratio of false alarm is increased 0.035 and 0.038 compared with the traditional ed and steady - state pf , respectively .
in contrast , the pd performance is much higher than conventional ed despite the pd degradation induced by the transient state .
in figure 8 , we have measured time - varying pu signals in the interval [ 3,5 ] db. on one hand , one can see that the transient state is much longer now than the one in figure 7 , thus inducing a degradation of pd and pf empirical values .
as we have observed in figure 2 , a greater value of snr leads to a major difference between the transient state lengths of the h0 and h1 .
in this context , that behavior can be observed in figure 8b where transient state in h0 is longer than h1 .
hence , the effect on the overall performance cannot be neglected compared with steady state , as shown in table 3 .
this situation generates an important increase of pf ( 0.236 ) compared with the false alarm in steady - state ( 0.000 ) or in the conventional ed ( 0.013 ) .
it is worth noticing that both vsslms - based ed algorithm and conventional ed technique do not reach the target pf ( i.e. , 0.001 ) , the former due to transient - state behavior and the latter due to the error at the noise variance estimation ( the error in the noise variance estimation also affects the vsslms - based ed algorithm .
however , its effect into the overall performance is negligible compared with that arisen from transient behavior. ) .
as a final remark , we can highlight that the practical proposal outperforms by far the conventional ed technique in low snrs .
however , despite the pd performance in snrs above the interval [ 3,5 ] db being better than conventional ed , their values are similar since traditional ed achieves good results in high snrs .
furthermore , pf in adaptive ed is highly affected by transient states , providing an inefficient use of the idle channel .
in this sense , a blended solution which could switch between adaptive and conventional ed for low and high snrs , respectively , would be an interesting strategy to deal with all types of environments .
5.2 .
detection performance in real environments in this subsection , the performance of the proposed practical vsslms algorithm is analyzed for single - node and cooperative ed detections in real propagation conditions .
conventional ed performance is also empirically measured .
the experimental results are compared with theoretical simulation - based results employing matlab ( version r2012b , mathworks , natick , ma , usa ) .
theoretical results are computed using the same parameters as in the experimental setup for 5x105 iterations .
figure 9 shows pd and pf performances for different averaged measured levels of snr in single - node detection .
the results are compared with theoretical performance values of the lms - based ed , selecting the step - size to satisfy the convergence criterion in ( 10 ) , a theoretical vsslms - based ed , and the real performance of the conventional ed technique .
the snrs are averaged from the snr estimates eta ^ m,k computed as in ( 9 ) .
on one hand , one can see in figure 9a that the values of pd performance of the proposed algorithm outperform the conventional ed technique for the measured range of averaged snr .
it is worth noting that the experimental vsslms - based ed provides 0.86 < pd for averaged snr greater than - 3 db. if one pays attention to the probability of false alarm in figure 9b , one can observe the negative effect of the transient states in the pf values as snr increases compared with the conventional ed. on the other hand , when comparing the experimental results with theoretical values , we see a degradation on the pd values due to the time - varying environment in real conditions and possible estimation errors .
in the case of pf performance , results are similar in the snr interval [ - 7,1 ] db and theoretical values are higher than experimental ones .
this is due to the fact that , in real conditions , snr variations modify transient states being longer and shorter according to the pu receiving signal fluctuations .
however , in theoretical results , transient length is almost constant for the monte carlo simulation according to the pre - defined snr .
in addition , we can also see how the vsslms - based ed reduces pf compared with the lms - based ed , while maintaining the same pd performance .
in table 4 , we analyze the performance of cooperative detection employing two sus in cooperation mode with uniform weighting strategy ( cf. [ 24 ] for more details ) and we compare the performance results with the optimal linear cooperative strategy presented in [ 36 ] .
the averaged snr in su 2 has been kept almost stable and the averaged snr in su 1 has been reduced using an attenuator at the input of the receiving antenna .
the performance of the linear cooperative strategy has been computed using averaged snr values of the sus .
one can observe that su 2 with averaged snr around - 8.5 db highly improves their performances compared with the single - node detection in figure 9 , i.e. , pd < 0.1 for snr < 7 .
in contrast , su 1 maintains similar pd and pf as single - node performances when averaged snr > 3 db , whereas its pd values are degraded compared with single - node detection for eeta1,k < 3 db. from these results , we can conclude that cooperation among sus is adequate when snr levels are low , whereas sus with high averaged snr should share their local estimates with their neighbors with worse environment conditions but not to employ neighboring data in their local detection process proposed in figure 3 .
the decision of cooperating could be performed comparing their local snr estimates in ( 9 ) with a minimum snr threshold before taking sharing data from other neighboring sus .
if we compare empirical and theoretical values , we can observe that experimental pd results are quite similar to the theoretical values for the su 1 's snr range [ - 4.21,0.49 ] db. when the su 1 's snr is lower , theoretical pd becomes smaller .
if we pay attention to the probability of false alarm , we can clearly observe the effect of the transient state in the theoretical performance .
in contrast , empirical pf is almost stable for all measured averaged snrs excepting the case of su 1 's snr = - 1.77 db , whose pf is abnormally high , i.e. , pf = 0.117 .
finally , if we compare the vsslms - based ed performance with the optimal linear cooperative ed presented in [ 36 ] , we can observe that the proposed algorithm outperforms the linear ed strategy in terms of pd. nonetheless , the linear ed strategy presents a stable performance in terms of the desired pf maintaining its value as 0.001 for all cases .
6. conclusions in this paper , we have addressed the implementation issues of adaptive lms - based ed previously proposed in [ 24 ] from a practical viewpoint .
in this sense , a new practical vsslms - based ed proposal has been presented in order to deal with the convergence of the algorithm in real time - varying environments .
implementation guidelines of the new proposal for single - node and cooperative ed have been provided along with practical solutions to locally estimate the noise variance and snr .
the proposed vsslms - based ed has been implemented in an sdr - based hardware platform in order to assess its performance in real radio - propagation conditions .
experimental results show a good performance of the adaptive algorithm in terms of high pd ( pd > 0.9 ) maintaining an adequate pf ( pf ~ 0.05 ) for an snr range of [ - 4,1 ] db in a single - node ed model .
on the other hand , we have seen that an su with low snr ( snr ~ - 8 db ) can achieve pd performance higher than 0.9 by sharing data with a neighboring su with snr ranges around [ - 2,0.5 ] db. moreover , we have observed that the practical proposal outperforms the optimal linear cooperative solution presented in [ 36 ] in terms of pd at a cost of a reduction of the opportunistic spectrum access when a channel is idle .
a final remark is that the proposed adaptive ed solution is ideal for snr < 2 db since the transient state of the algorithm degrades the overall performance if ed sampling rate is not increased .
in this sense , blended solutions based on conventional ed in high snrs and adaptive ed for low snrs could be interesting for future research .
acknowledgments this work has been financially supported in part by the spanish ministry of economy and competitiveness under project 5g - newbros ( tec2015 - 66153 - p mineco / feder , ue ) , and in part by the basque government ( it - 683 - 13 and elkartek program under bid3a3 and bid3abi projects ) and the european regional development fund , erdf .
author contributions iker sobron , inaki eizmendi , wallace a. martins , paulo s.r. diniz , juan luis ordiales and manuel velez conceived and designed the experiments ; iker sobron and inaki eizmendi performed the experiments ; iker sobron analyzed data ; iker sobron and wallace a. martins wrote the paper ; iker sobron , inaki eizmendi , wallace a. martins , paulo s.r. diniz , juan luis ordiales and manuel velez reviewed the manuscript .
conflicts of interest the authors declare no conflict of interest .
the founding sponsors had no role in the design of the study ; in the collection , analyses , or interpretation of data ; in the writing of the manuscript , and in the decision to publish the results .
abbreviations the following abbreviations are used in this manuscript : cr cognitive radio su secondary user pu primary user lte long term evolution lsa licensed shared access rem radio - environment map mcd measurement - capable device ed energy detection snr signal - to - noise ratio sdr software defined radio usrp universal software radio peripheral lms least mean squares mac medium access control vss variable step - size rf radio frequency phy physical layer tv television references 1 .
mueck m. jiang w. sun g. cao h. dutkiewicz e. choi s. novel spectrum usage paradigms for 5gwhite paper ieee technical committee on cognitive networks ( tccn ) new york , ny , usa 2014 2 .
al - dulaimi a. al - rubaye s. ni q. sousa e .
5g communications race : pursuit of more capacity triggers lte in unlicensed band ieee veh. technol. mag .
2015 10 43 51 10.1109 / mvt.2014.2380631 3 .
yucek t. arslan h. a survey of spectrum sensing algorithms for cognitive radio applications ieee commun. surv. tutor .
2009 11 116 130 10.1109 / surv.2009.090109 4 .
lu l. zhou x. onunkwo u. li g. ten years of research in spectrum sensing and sharing in cognitive radio eurasip j. wirel. commun. netw .
2012 2012 28 10.1186 / 1687 - 1499 - 2012 - 28 5 .
axell e. leus g. larsson e.g. poor h.v. spectrum sensing for cognitive radio : state - of - the - art and recent advances ieee signal process. mag .
2012 29 101 116 10.1109 / msp.2012.2183771 6 .
li j. wang x. feng d. sheng m. quek t.q.s. share in the commons : coexistence between lte unlicensed and wi - fi ieee wirel. commun .
2016 23 16 23 10.1109 / mwc.2016.1600057wc 7 .
cept ecc working group fm 53ecc report 205 : licensed shared access cept electronic communications committee copenhagen , denmark 2014 8 .
etsietsi ts 103 154 : reconfigurable radio systems ( rrs ) ; system requirements for operation of mobile broadband systems in the 2300 mhz - 2400 mhz band under licensed shared access ( lsa ) etsi sophia antipolis , france 2014 9 .
matinmikko m. mustonen m. roberson d. paavola j. hoyhtya m. yrjola s. roning j. overview and comparison of recent spectrum sharing approaches in regulation and research : from opportunistic unlicensed access towards licensed shared access proceedings of the 2014 ieee international symposium on dynamic spectrum access networks ( dyspan ) mclean , va , usa1 - 4 april 2014 92 102 10 .
sobron i. martins w.a. de campos m.l.r. velez m. incumbent and lsa licensee classification through distributed cognitive networks ieee trans. commun .
2016 64 94 103 10.1109 / tcomm.2015.2500559 11 .
bhowmick a. chandra a. roy s.d. kundu s. double threshold - based cooperative spectrum sensing for a cognitive radio network with improved energy detectors iet commun .
2015 9 2216 2226 10.1049 / iet - com.2014.1098 12 .
chin w.l. li j.m. chen h.h. low - complexity energy detection for spectrum sensing with random arrivals of primary users ieee trans. veh. technol .
2016 65 947 952 10.1109 / tvt.2015.2405558 13 .
vien q.t. nguyen h.x. trestian r. shah p. gemikonakli o. a hybrid double - threshold based cooperative spectrum sensing over fading channels ieee trans. wirel. commun .
2016 15 1821 1834 10.1109 / twc.2015.2496598 14 .
vien q.t. nguyen h.x. nallanathan a. cooperative spectrum sensing with secondary user selection for cognitive radio networks over nakagami - m fading channels iet commun .
2016 10 91 97 10.1049 / iet - com.2015.0461 15 .
atapattu s. tellambura c. jiang h. energy detection based cooperative spectrum sensing in cognitive radio networks ieee trans .
wireless commun .
2011 10 1232 1241 10.1109 / twc.2011.012411.100611 16 .
vakili a. champagne b. an adaptive energy detection technique applied to cognitive radio networks proceedings of the 2011 ieee 22nd international symposium on personal indoor and mobile radio communications ( pimrc ) toronto , on , canada11 - 14 september 2011 509 514 17 .
deng r. chen j. yuen c. cheng p. sun y. energy - efficient cooperative spectrum sensing by optimal scheduling in sensor - aided cognitive radio networks ieee trans. veh. technol .
2012 61 716 725 10.1109 / tvt.2011.2179323 18 .
liu y. xie s. yu r. zhang y. yuen c. an efficient mac protocol with selective grouping and cooperative sensing in cognitive radio networks ieee trans. veh. technol .
2013 62 3928 3941 10.1109 / tvt.2013.2258952 19 .
cattivelli f. sayed a. distributed detection over adaptive networks using diffusion adaptation ieee trans .
signal process .
2011 59 1917 1932 10.1109 / tsp.2011.2107902 20 .
ribeiro f.c. de campos m.l.r. werner s. distributed cooperative spectrum sensing with selective updating proceedings of the 20th european signal processing conference ( eusipco ) bucharest , romania27 - 31 august 2012 474 478 21 .
sobron i. martins w.a. ribeiro f.c. de campos m.l.r. set - membership adaptive soft combining for distributed cooperative spectrum sensing proceedings of the tenth international symposium on wireless communication systems ( iswcs 2013 ) ilmenau , germany27 - 30 august 2013 1 5 22 .
sobron i. martins w.a. de campos m.l.r. velez m. data - selective cooperative spectrum sensing based on imperfect information exchange proceedings of the 2014 ieee international symposium on dynamic spectrum access networks ( dyspan ) mclean , va , usa1 - 4 april 2014 129 132 23 .
ainomae a. trump t. bengtsson m. distributed diffusion lms based energy detection proceedings of the 2014 6th international congress on ultra modern telecommunications and control systems and workshops ( icumt ) st. petersburg , russia6 - 8 october 2014 176 183 24 .
sobron i. diniz p.s.r. martins w.a. velez m. energy detection technique for adaptive spectrum sensing ieee trans. commun .
2015 63 617 627 10.1109 / tcomm.2015.2394436 25 .
dobre e.i. martian a. vladeanu c. usrp - based experimental platform for energy detection in cognitive radio systems proceedings of the 2016 international conference on communications ( comm ) bucharest , romania9 - 11 june 2016 185 188 26 .
gokceli s. karabulut kurt g. anarim e. cognitive radio testbeds : state of the art and an implementation spectrum access and management for cognitive radio networks matin m.a. springer singapore 2017 183 210 27 .
khattab a. perkins d. bayoumi m.a. design , implementation and characterization of practical distributed cognitive radio networks ieee trans. commun .
2013 61 4139 4150 10.1109 / tcomm.2013.090513.130060 28 .
soltani s. sagduyu y. shi y. li j. feldman j. matyjas j. distributed cognitive radio network architecture , sdr implementation and emulation testbed proceedings of the 2015 ieee military communications conference ( milcom 2015 ) tampa , fl , usa26 - 28 october 2015 438 443 29 .
sobron i. regueiro c. eizmendi i. gil u. velez m. design and experimental evaluation of c - mac solutions for heterogeneous spectrum sharing proceedings of the 2016 ieee 27th annual international symposium on personal , indoor , and mobile radio communications ( pimrc ) valencia , spain4 - 7 september 2016 1 6 30 .
rugini l. banelli p. leus g. small sample size performance of the energy detector ieee commun. lett .
2013 17 1814 1817 10.1109 / lcomm.2013.080813.131399 31 .
cattivelli f.s. sayed a.h. diffusion lms strategies for distributed estimation ieee trans .
signal process .
2010 58 1035 1048 10.1109 / tsp.2009.2033729 32 .
bismor d. czyz k. ogonowski z. review and comparison of variable step - size lms algorithms int. j. acoust. vib .
2016 21 24 39 10.20855 / ijav.2016.21.1392 33 .
bin saeed m.o. zerguine a. zummo s.a. a variable step - size strategy for distributed estimation over adaptive networks eurasip j. adv .
signal process .
2013 2013 135 10.1186 / 1687 - 6180 - 2013 - 135 34 .
kwong r.h. johnston e.w. a variable step size lms algorithm ieee trans .
signal process .
1992 40 1633 1642 10.1109 / 78.143435 35 .
diniz p.s.r. adaptive filtering : algorithms and practical implementation4th ed. springer new york , ny , usa 2013 36 .
quan z. cui s. sayed a.h. optimal linear cooperation for spectrum sensing in cognitive radio networks ieee j. sel. top .
signal process .
2008 2 28 40 10.1109 / jstsp.2007.914882 figure 1 step - size upper bound analysis .
figure 2 number of iterations to decrease to 1e of the initial value as a function of signal - to - noise ratio ( snr ) and pf for hypotheses h0 and h1 .
figure 3 flowchart of the adaptive variable - step - size - least - mean - squares ( vsslms ) - based energy detection ( ed ) algorithm .
figure 4 sdr framework formed by 1 primary user ( pu ) and 3 secondary users ( sus ) which can work in stand - alone or cooperative modes .
on the left - hand side , the pu antenna is marked by a yellow solid - line circle and su antennas are marked by brown dashed - line circles .
figure 5 the depicted control panel allows for configuring pf and the parameters of receiving the data acquisition process .
in addition , the panel shows on the left the computed detection thresholds for the selected channels .
figure 6 this control panel allows for configuring the variable step - size in ( 12 ) , pu / su roles , weighting strategy between uniform and snr weighted , ed modes ( single - node / cooperation ) , channel frequencies , and data saving .
the power spectrum and the ed decisions for the selected channels are also depicted .
in the snapshot , one can observe a pu transmission is detected in 670 mhz ; cooperative mode ( mode 2 ) with uniform weighting strategy is active ; the universal software radio peripheral ( usrp ) device is working as pu transmitter from the transmission ( tx ) antenna ( tx indicator on ) and the su receiver from the reception ( rx ) antenna ( detector ( dx ) indicator on ) ; vss is active (" ceil " and " min " flags on ) and , finally , data is not saved .
figure 7 behavior of the vsslms - based adaptive ed algorithm according to the pu states for single - node detection at snrs in the range of [ - 4,0.5 ] db. figure 8 behavior of the vsslms - based adaptive ed algorithm according to the pu states for single - node detection at snrs in the range of [ 3,5 ] db. figure 9 performance comparison for different values of snr for single - node detection .
sensors - 17 - 00932 - t001 _ table 1 table 1 shared parameters at each time slot k in cooperative detection .
theoretical lms - based ed [ 24 ] practical vsslms - based ed mandatory sigmam2,ym,k u ~ m,k,d ~ m,k,mu m,k optional eta ^ m,k eta ^ m,k sensors - 17 - 00932 - t002 _ table 2 table 2 physical layer ( phy ) parameters of primary ( pu ) and secondary users ( su ) .
user parameter value pu & su channel bandwidth 2 mhz channel frequencies 670,678,688,696 mhz pu modulation scheme qpsk symbol rate 1 mbaud waveform single carrier su iq sampling rate 33 mhz carrier frequency 682 mhz fft 1000 samples ed sampling period 20 ms alpha in ( 5 ) and ( 12 ) 0.95 sensors - 17 - 00932 - t003 _ table 3 table 3 empirical pd and pf performances of variable - step - size - least - mean - squares ( vsslms ) - based and conventional energy detection ( ed ) with and without transient state performance taken into account .
snr range ( db ) states adaptive ed ( pd / pf ) conventional ed ( pd / pf ) [ - 4,0.5 ] transient + steady 0.955 / 0.038 0.508 / 0.005 [ - 4,0.5 ] steady 1 / 0.000 [ 3,5 ] transient + steady 0.993 / 0.236 0.904 / 0.013 [ 3,5 ] steady 1 / 0.000 sensors - 17 - 00932 - t004 _ table 4 table 4 empirical and theoretical pd and pf performances for cooperative 2 - node vsslms - based energy detection .
performance comparison with the optimal linear ed cooperation algorithm in [ 36 ] .
eeta1,k ( db ) eeta2,k ( db ) exp .
vsslms ed theor .
vsslms ed optimal linear ed [ 36 ] ( pd / pf ) ( pd / pf ) ( pd / pf ) 0.49 - 16.20 0.984 / 0.044 0.995 / 0.039 0.966 / 0.001 - 1.48 - 8.12 0.968 / 0.020 0.971 / 0.032 0.754 / 0.001 - 1.77 - 7.84 0.954 / 0.113 0.965 / 0.032 0.706 / 0.001 - 2.72 - 8.56 0.801 / 0.017 0.890 / 0.027 0.517 / 0.001 - 4.21 - 8.53 0.468 / 0.023 0.431 / 0.021 0.274 / 0.001 - 4.88 - 8.64 0.339 / 0.023 0.269 / 0.018 0.197 / 0.001 - 6.80 - 8.32 0.187 / 0.015 0.090 / 0.009 0.082 / 0.001 - 7.48 - 8.66 0.103 / 0.038 0.051 / 0.006 0.058 / 0.001