pharm stat pharm stat 10.1002 /( issn ) 1539 - 1612 pst pharmaceutical statistics 1539 - 1604 1539 - 1612 john wiley and sons inc .
hoboken 27917593 5363348 10.1002 / pst.1794 pst1794 pst - 15 - 0096.r2 main papermain papers alpha markov model for longitudinal studies with incomplete dichotomous outcomes longitudinal studies with incomplete dichotomous outcomesefthimiou et al. efthimiou orestis oremiou @ gmail.com 1 welton nicky 2 samara myrto 3 leucht stefan 3 salanti georgia 1 4 on behalf of getreal work package 4 1 department of hygiene and epidemiologyuniversity of ioannina school of medicineioanninagreece 2 school of social and community medicineuniversity of bristolbristoluk 3 department of psychiatry and psychotherapytechnische universitat munchenmunichgermany 4 institute of social and preventive medicineuniversity of bernbernswitzerland * correspondence orestis efthimiou , department of hygiene and epidemiology , university of ioannina school of medicine , ioannina , greece .
email : oremiou @ gmail.com 05 12 2016 mar - apr 2017 16 2 10.1002 / pst.v16.2 122 132 13 10 2015 14 10 2016 21 10 2016 copyright ( c ) 2016 the authors pharmaceutical statistics published by john wiley & sons ltd .
this is an open access article under the terms of the creative commons attribution license , which permits use , distribution and reproduction in any medium , provided the original work is properly cited .
missing outcome data constitute a serious threat to the validity and precision of inferences from randomized controlled trials .
in this paper , we propose the use of a multistate markov model for the analysis of incomplete individual patient data for a dichotomous outcome reported over a period of time .
the model accounts for patients dropping out of the study and also for patients relapsing .
the time of each observation is accounted for , and the model allows the estimation of time - dependent relative treatment effects .
we apply our methods to data from a study comparing the effectiveness of 2 pharmacological treatments for schizophrenia .
the model jointly estimates the relative efficacy and the dropout rate and also allows for a wide range of clinically interesting inferences to be made .
assumptions about the missingness mechanism and the unobserved outcomes of patients dropping out can be incorporated into the analysis .
the presented method constitutes a viable candidate for analyzing longitudinal , incomplete binary data .
bayesian analysis missing data multistate models european union 's seventh framework programmefp7 / 2007 - 2013innovative medicines initiative joint undertaking115546trial methodology researchmr / k025643 / 1source - schema - version - number2.0component - idpst1794cover - datemarch / april 2017details - of - publishers - convertorconverter : wiley _ ml3gv2 _ to _ nlmpmc version : 5.0.9 mode : remove _ fc converted : 23.03.2017 efthimiou o , welton n , samara m , leucht s , salanti g . on behalf of getreal work package 4 .
alpha markov model for longitudinal studies with incomplete dichotomous outcomes . pharmaceut. statist .
2017 ; 16 : 122 - 132 . https :// doi.org / 10.1002 / pst.1794 1 introduction missing outcome data are frequently encountered in randomized control trials and may compromise the validity of inferences and increase the uncertainty in the effects of an intervention.1 missing data constitute a major problem for certain areas of medicine .
studies in mental health usually have a high dropout rate due to the nature of the conditions and the treatments involved .
studies in schizophrenia tend to have a dropout rates as large as 50 % or even higher , which leads to large amounts of missing outcome data.2 in the presence of missing data , the researcher can follow a number of different approaches for the analysis .
the simplest of all is to analyze only patients that completed the study after excluding patients that dropped out ( complete case analysis , cca ) .
this approach , however , will lead to a loss of precision and to biased results when data are not missing completely at random ( mcar ). 1 , 3 , 4 , 5 , 6 an mcar mechanism is implausible in many clinical contexts , where dropout rates are informative : in psychiatric trials , for example , dropout is strongly correlated to the clinical outcome and is often considered a proxy to both treatment efficacy and acceptability .
a common way to overcome the missing data problem is to employ some form of imputation , for example , the last observation is carried forward ( locf ) , 6 multiple imputations,6 , 7 or to use regression methods that do not impute data such as the mixed model for repeated measures ( mmrm ) 8 , 9 and selection models.10 the various available methods make different assumptions about the unobserved outcomes .
the missingness mechanism , however , is essentially untestable .
thus , researchers sometimes choose to analyze dropout separately as an additional ( and often primary ) outcome .
the aim of this paper is to present an alternative method for analyzing incomplete dichotomous outcomes .
we do this by employing a markov model previously proposed , after adapting it for the missing outcome data context .
markov models offer an intuitive approach for modeling patients' transitions between a number of discrete states over time11 , 12 , 13 , 14 and have been used in a variety of clinical settings such as modeling terminal and nonterminal events in coronary heart disease,15 cancer screening,16 and hiv progression.17 markov models can be either discrete time ( where transitions can only occur at fixed time points ) or continuous time ( where transitions can occur at any time ). 18 continuous - time markov models have both theoretical and practical advantages over their discrete - time counterparts.18 the model we use in this paper is a continuous - time markov model with 3 states,19 and our method is focused on the reconstruction of the various paths a patient may follow across these states .
it can be used to model dichotomous , patient - level outcomes reported over different time points while accounting for patients dropping out and for patients relapsing .
to the best of our knowledge , markov models have not been previously used to analyze missing patient outcomes .
the analysis is focused on the estimation of the transition rates between the different states rather than probabilities of transitions which depend on the elapsed time .
using these rates , the model can provide an array of clinically interesting estimates regarding treatments' effects on efficacy , acceptability , and relapse at any time point .
we also expand the model by including additional unobserved states so as to accommodate assumptions regarding the missingness mechanism and the outcomes of patients dropping out .
we adopt a bayesian framework throughout this paper because it offers increased flexibility in modeling .
we fit all presented models employing markov chain monte carlo ( mcmc ) techniques in winbugs .
a frequentist approach is also possible by using for example the msm package in r.20 the paper is structured as follows : in section 2 , we provide a brief description of the data that motivate our methods .
in section 3 , we present the model , we discuss how to estimate the model 's parameters from the available data , we describe how the model can be used to make various inferences on the relative treatment effects , and we present model extensions .
in section 4 , we present the results from the application , and in section 5 , we discuss the advantages and the limitations of our approach .
in appendix s1 , we provide mathematical details , additional results as well as the winbugs code that we use to implement the model .
2 data description to exemplify our methods , we use data from a randomized controlled trial comparing amisulpride with risperidone for patients in the acute phase of schizophrenia.21 for each patient and for each time point , the study provides information on whether or not the patient is a responder ( with response defined as a 50 % reduction in the brief psychiatric rating scale from baseline ) or has dropped out of the study .
a total of 115 patients were randomized in the amisulpride arm and 113 in the risperidone arm .
patients were followed - up at 1 , 2 , 4 , 6 , and 8 weeks after starting to receive medication .
the dropout rates were large for both study arms ( 31 % for amisulpride and 26 % for risperidone ) .
once a patient dropped out of the study , the trialists could not collect any efficacy data .
no information was available for the reasons of dropping out .
for the purposes of this paper , we coded as dropouts all patients that missed a visit and all subsequent ones .
in the dataset , we were given access there were no intermediate missing values ; that is , there were no missing observations for patients still in the study .
in section 1 of appendix s1 , we provide the aggregated outcome data at each time point .
3 methods in this section , we present the model and we discuss how to estimate the model parameters from the available data and how to use these estimates to make inferences about the relative treatment effects .
3.1 the 3 - state model the basic model that we use comprises 3 different markov states and is sometimes termed the " illness - death " model.14 state 1 is the starting state for all patients ( which we call "[ observed ] nonresponse ") , state 2 corresponds to a 50 % reduction of the score in the brief psychiatric rating scale from baseline ("[ observed ] response ") , and state 3 corresponds to the patient dropping out of the study (" study discontinuation ") .
transitions between states 1 and 2 are allowed in both directions .
state 3 is an all - absorbing state ; that is , no backward transitions are allowed and patients dropping out of the study cannot re - enter .
note , however , that a patient may miss a visit without dropping out of the study ; in such cases , the corresponding observation is missing but the patient is not coded in the dropout state .
the 3 states of the model and the allowed transitions are depicted in figure 1a .
the 4 gamma presented in the figure are the target parameters of the model , which we aim to estimate from the available data .
figure 1 ( a ) a 3 - state model with transitions between states 1 and 2 allowed both ways .
state 3 is an absorbing state and corresponds to a patient dropping out of the study .
each transition from state chi to state psi is associated with a transition rate gammachipsi .
( b - f ) four - state models with 2 unobserved states incorporating different assumptions about the missingness mechanism we employ the markov assumption14 that the probability of a transition from a state to another does not depend on the previous states visited or on the time spent in current state , and we also assume that the transition rates gammachipsi are constant through time and are common for all patients randomized in the same treatment arm .
the model can be extended to include patient - level random effects in the transition rates to make the transition rates dependable on patient - level covariates ( as we discuss in section 3.5 ) or to account for time - dependency in the transition rates ( see section 5 ) .
for patient k , randomized in treatment arm tk , ( tk = 1 , 2 ) , the matrix of transition rates is defined as follows : gtk = - gamma12tk + gamma13tkgamma12tkgamma13tkgamma21tk - gamma21tk + gamma23tkgamma23tk000 each diagonal element in row q ( where q = 1 , 2 , 3 ) in the matrix shows the total rate of transition out - of - state q. off - diagonal elements show how transitions from state q are distributed to all other states .
for example , g11tk = - gamma12tk + gamma13tk , which means that patients leave state 1 at a rate of gamma12tk + gamma13tk and these patients either go to state 2 ( with a transition rate equal to g12tk = gamma12tk ) or to state 3 ( with a transition rate equal to g13tk = gamma13tk ) .
because the state - space is exhaustive , the total number of patients in the system remains constant , and each row of the gtk matrix sums to 0 .
state 3 is an all - absorbing state , so the elements of the third row are all 0 .
the matrix of transitions , gtk , is related to the matrix of the transition probabilities pitkdeltat , pitk ( deltat )= pi1,1tkdeltatpi1,2tkdeltatpi1,3tkdeltatpi2,1tkdeltatpi2,2tkdeltatpi2,3tkdeltat001 .
the chipsi element of this matrix gives the probability of a patient receiving treatment tk , starting at state chi to be found at state psi after time deltat .
so , a patient situated at state 2 after time deltat will be at states 1 , 2 , or 3 , with probabilities pi2,1tkdeltat , pi2,2tkdeltat , and pi2,3tkdeltat , respectively ; of course , these probabilities must add up to 1 .
a patient situated at state 3 will remain there , so that pi3,1tkdeltat and pi3,2tkdeltat are 0 , while pi3,3tkdeltat equals 1 for all time points .
the transition probability matrix pitkdeltat can be calculated by using the transition rate matrix gtk via kolmogorov forward equation dpitkdeltatddeltat = pitkdeltatgtk .
this is a differential equation giving the evolution of pitk over time .
under regularity conditions which are readily satisfied in practice ( and which regard the derivatives of the probability functions22 ) , the solution is given by pitkdeltat = edeltatgtk = sumn = 0infinitydeltatnn ! gtkn .
because gtk is a matrix , a closed - form solution cannot be always obtained .
for the special case of a 3 - state model presented in figure 1a , analytic closed - form solutions are available.19 we first define the htk quantities as : ( 1 ) htk = lambda1tk - lambda2tk2 + 4gamma12tkgamma21tk,lambdaxtk = sumpsi != xgammaxpsitkwhere lambdachitkis the transition rate from state chi to all other states .
the transition probabilities are given by the following equations ( after dropping the tk index denoting treatment arm for simplicity ) : ( 2 ) pi1,1deltat = - lambda1 + lambda2 + he - 12lambda1 + lambda2 - hdeltat + lambda1 - lambda2 + he - 12lambda1 + lambda2 + hdeltat2h ( 3 ) pi1,2deltat = - lambda1 + lambda2 + hlambda1 - lambda2 + he - 12lambda1 + lambda2 - hdeltat - e - 12lambda1 + lambda2 + hdeltat4hgamma21 ( 4 ) pi1,3deltat = 1 - pi1,1deltat - pi1,2deltat ( 5 ) pi2,1deltat = gamma21e - 12lambda1 + lambda2 - hdeltat - e - 12lambda1 + lambda2 + hdeltath ( 6 ) pi2,2deltat = lambda1 - lambda2 + he - 12lambda1 + lambda2 - hdeltat + - lambda1 + lambda2 + he - 12lambda1 + lambda2 + hdeltat2h ( 7 ) pi2,3deltat = 1 - pi2,1deltat - pi2,2deltat given the 4 transition rates , all transition probabilities included in the pitk matrix can be computed as a function of time .
in what follows , we will see how to use the available data to estimate the 4 parameters of the model ( the 4 transition rates ) and how to make inferences on relative treatment effects .
before this , we introduce some notation that considerably simplifies the analysis .
3.2 data notation let us denote t1 , t2 ...
tf as the time points at which the observations for each patient are collected .
to each patient k , randomized in treatment arm tk , and for each time point tm ( m = 1 , 2 , ...
f ) , corresponds an observation of his state , smk ( 1 , 2 , or 3 ) .
we also code the patient 's state by using a vector xmk .
this vector conveys the same information as smk and takes values ( 1 , 0 , 0 ) for state 1 ( observed nonresponse ) , ( 0 , 1 , 0 ) for state 2 ( observed response ) , and ( 0 , 0 , 1 ) for state 3 ( study discontinuation ) .
all patients start from the nonresponse state , so that x0k = 100for - alli,k. these definitions are summarized in table 1 .
in section 2 of appendix s1 , we provide a list of all notations used in this paper .
table 1 data for patient k time point t0 = 0 t1 t2 tf state smk at time tm 1 2 1 3 observed nonresponse observed response observed nonresponse study discontinuation data coded as vectors x0k = 1,0,0 x1k = 0,1,0 x2k = 1,0,0 xfk = 0,0,1 observed transition - 1 - - > 2 2 - - > 1 sf - 1k - - > 3 transition probabilities being informed by the observed transition - pi1,1tkdeltat pi2,1tkdeltat pisf - 1k,1tkdeltat pi1,2tkdeltat pi2,2tkdeltat pisf - 1k,2tkdeltat pi1,3tkdeltat pi2,3tkdeltat pisf - 1k,3tkdeltat the numbers show an example where a patient responds to treatment at time point t1 , relapses to nonresponse at time point t2 , and has left the study at time point tf . each transition informs the corresponding set of probabilities and consequently the transition rates .
3.3 estimating the model parameters our target is to estimate the transition rates from the transition probabilities that are directly estimable from the data .
a transition from a starting state smk ( where the patient was observed to be at time tm ) is controlled by the transition probabilities pismk,1tkdeltat , pismk,2tkdeltat , and pismk,3tkdeltat given in equations ( 2 ) to ( 7 ) , where deltat = tm + 1 - tm corresponds to the time interval between the 2 observations .
in the example presented in table 1 , a patient was situated at state 1 at time t0 ( so that s0k = 1 ) and he was observed to be at state 2 in the next observation at time t1 ( s1k = 2 ) .
this corresponds to a transition 1 - - > 2 in time deltat = t1 - t0 .
this transition provides information about the corresponding transition probabilities pis0k,1tkdeltat = pi1,1tkdeltat , pis0k,2tkdeltat = pi1,2tkdeltat , and pis0k,3tkdeltat = pi1,3tkdeltat and informs the estimation of the 4 transition rates .
likewise , the second transition is a relapse ( transition 2 - - > 1 ) ; the corresponding time is deltat = t2 - t1 , and it informs the probabilities pis1k,1tkdeltat = pi2,1tkdeltat , pis1k,2tkdeltat = pi2,2tkdeltat , and pis1k,3tkdeltat = pi2,3tkdeltat , which in turn give information about the 4 transition rates gamma .
note here that a patient remaining at the same state for 2 consecutive observations also informs the corresponding probabilities .
also note that if a patient misses a visit without dropping out of the study ( i.e. , data on at least 1 subsequent visit is available ) , the likelihood is informed by the remaining observations and their corresponding deltat .
no further assumption is needed to employ the model in such a case .
in summary , each observed transition provides information about 3 of 6 transition probabilities included in pitkdeltat .
these 3 probabilities are selected for each transition smk - - > sm + 1k according to the starting state ( smk ) and can be written as the vector ( pismk,1tkdeltat,pismk,2tkdeltat,pismk,3tkdeltat )= xmk.pitkdeltat .
the likelihood for the observation on patient k , treatment tk , at the ( m + 1 ) time point is given by a multinomial distribution : ( 8 ) xm + 1k ~ multinomialxmk.pitkdeltat1 the full likelihood of the data can be obtained as l = productk = 1npproductm = 0f - 1fmxm + 1kxmk.pitkdeltatk,m + 11where np denotes the total number of patients , fm is the probability mass function of the multinomial distribution , and deltatk , m + 1 is the time interval between observations m and m + 1 for patient k. in this paper , we adopt a bayesian framework by using mcmc software to estimate the parameters of the model .
one can also use frequentist methods to maximize this likelihood ; see for example refs [ 13 , 23 ] .
3.4 making inferences on relative treatment effects having estimated the transition rates for each treatment arm , we can reuse equations ( 2 ) to ( 7 ) to estimate the probabilities of transition from a state to another , for any period of elapsed time .
note that the probability of making a transition between 2 states does not depend on time t per se ; rather , it depends on the elapsed time interval deltat considered .
so , for a patient in a given state at time t , the probability of the patient being found in any state at time t + deltat will only depend on the elapsed time deltat and not on t. subsequently , inference on relative treatment effects can be made at any time point deemed to be clinically interesting as delta = lpichi,psi1deltat - lpichi,psi2deltat , where l is a link function .
for instance , if l ( x ) = logit ( x ) , x = 1 , and psi = 2 , then delta corresponds to the log odds ratio for efficacy among completers .
if l ( x ) = ln ( x ) , x = 2 , and psi = 3 , then we obtain the log relative risk for dropping out after responding .
in section 3 of the appendix , we discuss in detail the relative effect measures that can be obtained by using the probabilities of transitions .
if multiple studies are analyzed so as to be included in a meta - analysis , then it would be appropriate to pool on the log - rate - ratio scale .
predictions on probabilities can then be made at any chosen time point .
one advantage of the proposed markov model is that it can also provide estimates which might be of interest to clinicians and which cannot be obtained by the currently available approaches for analyzing longitudinal data .
these include the following : the probability for a patient to drop out due to inefficacy .
this is defined as the probability to dropout after time deltat without ever experiencing a response to the treatment , that is , to drop out directly from the ( observed ) nonresponse state .
the probability of a patient to drop out after responding .
this is defined as the probability to dropout straight after the ( observed ) response state .
the expected time spent ( ets ) in each state can be a useful estimate as it summarizes the effect of the treatment in an easy - to - understand manner .
the formulas for these quantities are presented in section 4 of the appendix .
note that we have assumed all 4 transition rates to be treatment - specific .
depending on the clinical context , it might be desirable to set some of them equal across treatment arms.24 for example , a common gamma23 can be assumed for both treatments when the rate at which responders drop out is believed to be independent of the treatment received .
3.5 including random effects and patient - level covariates until now , we have assumed transition rates to be common for all patients within each treatment arm .
the model can be extended to include random effects after assuming that the transition rates for patients randomized in a treatment arm are not fixed but exchangeable , that is , coming from a common distribution .
more specifically , the logarithm of the transition rate for gammachipsik for patient k can be assumed to follow a normal distribution , lngammachipsik ~ nlngammachipsitk ( tauchipsitk2 ) , where tauchipsitk is the standard deviation of the random effects for the chipsi transition rate for treatment tk. various modeling assumptions can be made about the random effects structure ; for example , one can include random effects in some or all of the transitions rates , and the model can be further simplified by allowing a common tau2 for all transition rates across all treatments .
covariates can also be easily included in the model by setting lngammachipsik ~ nlngammachipsitk + bchipsitkck ( tauchipsitk2 ) , where ck is a patient - level covariate for patient k. in this equation , gammachipsitk corresponds to the average , treatment - specific transition rate centered at 0 value of the covariate ck. one can follow different approaches to model the coefficient b , such as to assume a common value for some of them ( e.g. , it might be reasonable to set b13tk = b23tk ) or to assume common coefficients across treatments ( to allow for a bchipsi instead of bchipsitk ) ; choices should be dictated by the clinical context at hand and after taking into account expert clinical opinion. with these changes , all probabilities of transitions presented in the analyses of the previous sections now also depend on patient covariates ( i.e. , we need to write pi1,2k instead of pi1,2tk ) , but the rest of the analysis remains unchanged .
adding more covariates is also straightforward .
note that the model without patient - level random effects and covariates is a population - averaged approach ; that is , it does not distinguish observations belonging to the same or different individuals. by including random effects and / or covariates in the model , we allow for patient - specific terms in the analysis .
the general 3 - state model assumes that the 2 dropout rates gamma13 and gamma23 may be different , and thus the transition into the dropout state depends on the current state of the patient .
this corresponds to a missing at random ( mar ) assumption ; that is , dropout is dependent on observed data ( state of the patient ) .
missing at random is also assumed when including covariates for gamma13 and gamma23 in the analysis .
in that case , dropout depends also on ( observed ) patient characteristics .
for an mcar assumption , one would need to set gamma13 = gamma23 and to exclude any covariates from the analysis .
in that case , the dropout rate does not depend on whether or not a patient has responded to the treatment or any other observable or unobservable characteristics .
in the following section , we discuss how to expand the model to also accommodate an mnar assumption and how to use the presented framework to make predictions on unobserved outcomes .
3.6 modeling unobserved response the analysis presented so far essentially treats response and dropout state as 2 mutually exclusive outcomes .
however , it is often of interest to researchers to make inferences about treatment effects in patients that drop out .
moreover , it has been recommended to perform sensitivity analyses regarding the unobserved data to assess the robustness of findings under different scenarios regarding the missingness mechanism.9 , 25 one can extend the method we have presented so far by assuming that patients who drop out continue to undergo transitions between an unobserved nonresponse and an unobserved response state .
several adaptations of such a 4 - state model are depicted in figure 1b to f. the quantity of interest is now the probability of either observed or unobserved response , that is , pi1,2tk + pi1,5tk .
in section 6 of the appendix , we provide the analytic formulas needed to calculate the transition probabilities for the general 4 - state model , given the 8 transition rates ( gamma12 , gamma21 , gamma14 , gamma15 , gamma24 , gamma25 , gamma45 , gamma54 ) .
these transition rates , however , cannot be directly estimated from the observed data ; unobserved data ( the outcomes of dropout patients ) would also be needed for fitting this model .
thus , to use the 4 - state model , one needs to first fit the 3 - state model of figure 1a and estimate the corresponding transition rates .
at the second stage , one can use the 4 - state model ( after making assumptions regarding the missingness mechanism ) to make predictions about the outcome in the patients who have dropped out .
several scenarios are discussed below : missing completely at random can be modeled by setting gamma14 = gamma25 , gamma24 = gamma15 = 0 , and also gamma45 = gamma12 and gamma54 = gamma21 ( figure 1b ) .
the first 2 of these equations impose the assumption that the dropout rates do not depend on either observed or unobserved data , and that they are equal among responders and nonresponders .
the latter 2 of these equations imply that the transitions between the unobserved response and nonresponse states follow the same pattern as the transitions of patients still in the study .
essentially , these 5 equations imply that dropout and response are 2 independent procedures .
note that for an mcar assumption , the transition rates gamma14 and gamma25 need to be independent of any covariates .
setting gamma14 = gamma15 != gamma24 = gamma25 corresponds to dropout rates being different across responders and nonresponders but to only depend on observed data ( mar ) .
this is depicted in figure 1c .
again , one should also assume that gamma45 = gamma12 and gamma54 = gamma21 , implying that unseen transitions can be predicted based on the observed data .
in a missing not at random ( mnar ) scenario ( figure 1d ) , the dropout rates depend on both observed and unobserved outcomes , and the unobserved outcomes cannot be predicted solely by using the observed data .
this can be modeled by setting gamma14 != gamma15 and gamma24 != gamma25. with this formulation , the dropout rate depends on both observed data ( state before dropping out ) as well as the unobserved data ( state after dropping out ) .
the transition rates between the unobserved states can then be assumed to be equal to the corresponding observed ones , that is , gamma45 = gamma12 and gamma54 = gamma21 , or researchers might adopt different scenarios to better reflect beliefs about the response patterns of dropout patients .
the " locf - like " missingness scenario : all dropouts remain in the last observed state .
this can be accomplished in the 4 - state scenario by setting gamma15 = gamma24 = gamma45 = gamma54 = 0 .
unlike the usual locf approach , however , estimation of transition rates and probabilities uses all available observations and not just the last observation from each patient .
this is depicted in figure 1e .
note that for locf , mcar is necessary , but not sufficient assumption.9 the " all dropout failure " scenario : this can be achieved by setting gamma14 = gamma24 = 0 and is depicted in figure 1f .
this scenario may be of interest to apply in only one of the treatment arms .
for example , patients receiving placebo may be expected to drop out only due to lack of effectiveness ( but not due to adverse events ) .
note that the 4 - state model can account for uncertainty regarding the missing values by using a stochastic approach to model the patient trajectories after dropping out ( this holds for scenarios 1 , 2 , and 3 above but not for scenarios 4 and 5 which do not model uncertainty in the dropout patients ) .
regarding how to choose between these models , we think that the choice should be primarily dictated by the research question , the medical context , and the plausibility of the assumptions that it involves .
different models use different assumptions regarding the dropout mechanism .
in a situation where , for example , dropout is thought to be irrelevant to the outcome , model 1 will be sufficient .
if , on the other hand , dropout is mainly due to inefficacy , an mnar assumption , such as in model 3 , will be more realistic .
measures of model fit and simulation studies might also help in deciding among models employing similar assumptions .
one of the most popular approaches for analyzing repeated observations of a dichotomous outcome is to employ some form of mmrm .
for the case of a binary outcome , a logistic link function is commonly used .
an example of an mmrm with random time trends is the following : ( 9 ) logitpik,j = beta0 + beta1tj + beta2tk + uktj + epsilonkj in this model , pik , j denotes the probability of response for patient k , at time tj ; it corresponds to pi1 , 2 + pi1 , 5 for the 4 - state model .
tk denotes the treatment received ( assumed here to be a binary covariate ) ; uk is a random , subject - specific slope ; and epsilonkj is the residual .
residuals are assumed to be correlated for each patient across time points , that is , epsilonk ~ n ( 0 , sigma ) , with sigma being a variance - covariance matrix that can be estimated from the data .
this model can be expanded by adding higher order terms of tj , treatment - time interaction terms , patient - level covariates , or by assuming a structure on sigma .
other link functions could be used instead of logit as long as they map ( 0 , 1 ) to ( - infinity , infinity ) .
instead of using an arbitrarily chosen link function to model the time dependency of the probability of response , in this paper , we have used a method that models the underlying mechanism of disease progression , starting from elementary concepts such as the transition rates .
the corresponding expressions , for example , equation ( 2 ) , are somewhat similar to equation ( 9 ) , in the sense that they are both exponential functions of t .
4 analysis of the schizophrenia data in this section , we apply our methods for the study described in section 2 .
we consider the markov assumption to be a useful approximation for this example ; that is , we assume that the patients' disease progression and dropout rates are only affected by their current state .
4.1 model implementation we fit our model by winbugs ; the code can be found in section 7 of the appendix .
we assume minimally informative prior distributions for the logarithm of the gammas in each arm , lngammachipsii ~ dunif - 105 .
these limits are chosen arbitrarily , for estimation reasons.24 because these refer to a logarithmic scale , including bigger or smaller values corresponds to extremely big and small transition rates which may hinder convergence ; in practice , changing these limits has little impact on the results .
we assume random effects on the log - transition rates as described in section 3.5 , assuming a common heterogeneity tau ~ dunif ( 0 , 1 ) .
a burn - in period of 20 000 iterations was used for the mcmc simulation .
all statistics that we present in the next section were obtained from the posterior distributions of the parameters , based on 2 independent chains with 20 000 iterations each .
convergence was confirmed by using the brooks - gelman - rubin criterion.26 4.2 results we first fit the 3 - state model depicted in figure 1a , assuming gamma13 != gamma23 .
we present the estimates of the 4 transition rates for each treatment in table 2 , and we also give the relative treatment effects of the log transition rate ratios .
the heterogeneity standard deviation for the log - transition rates ( assumed common ) was estimated to be 0.64 ( 95 % credible interval [ cri ] 0.31 to 0.92 ) .
table 2 median estimates and 95 % credible intervals ( cri ) for the transition rates and the relative treatment effects regarding the log transition rate ratios for the 3 - state model amisulpride risperidone median 95 % cri median 95 % cri gamma12 0.189 [ 0.143 ; 0.248 ] 0.136 [ 0.100 ; 0.180 ] gamma13 0.052 [ 0.032 ; 0.077 ] 0.047 [ 0.030 ; 0.070 ] gamma21 0.076 [ 0.042 ; 0.127 ] 0.056 [ 0.028 ; 0.196 ] gamma23 0.024 [ 0.009 ; 0.049 ] 0.009 [ 0.002 ; 0.027 ] transition rate ratios median 95 % cri gamma12ris / gamma12ami 0.72 [ 0.48 ; 1.07 ] gamma13ris / gamma13ami 0.92 [ 0.51 ; 1.64 ] gamma21ris / gamma21ami 0.73 [ 0.31 ; 1.62 ] gamma23ris / gamma23ami 0.39 [ 0.06 ; 1.83 ] an interesting observation is that all rates are higher in the amisulpride than in the risperidone arm .
this is because overall , the patients in the amisulpride arm were observed to make a larger number of transitions ; this might imply that all effects of amisulpride ( both beneficial and harmful ) take place relatively more quickly than that of risperidone .
another interesting ( although expected ) result is that both dropout rates are much higher for nonresponders than for responders ( gamma13 > gamma23 ) : patients not getting well tend to leave the study at higher rates regardless of the treatment they receive , another indication that dropout is related to response .
figure 2 depicts the fit of the model ; the lines correspond to the 3 - state model estimates for the probabilities of transition as a function of time , obtained from equations ( 2 ) to ( 4 ) ; dots correspond to the actual proportion of patients found at each state at each time point in the study .
given that all patients start at state 1 at time 0 , these observed proportions correspond to estimates for pi11 , pi12 , and pi13 .
in section 5 of the appendix , we provide graphs for the time dependency of all transition probabilities .
in table 3 , we present various measures estimated from the 3 - state model : or13 for dropout ( pi1 , 3 ) at study 's endpoint ( 8 weeks ) .
or12 for ( observed ) response at study 's endpoint ( 8 weeks ) , calculated by using pi1 , 2 for each arm .
or23 for a responder to dropout within 8 weeks after responding .
this is calculated by using pi2 , 3 ( deltat = 8 ) for each arm .
or21 , for a responder to be found in the nonresponse state 8 weeks after responding .
this is calculated by using pi2 , 1 ( deltat = 8 ) for each arm .
expected time spent ( etsx ) on each state x for each treatment for the duration of the study .
figure 2 model estimates from the 3 - state model ( lines ) and actual observations in the data ( dots ) .
the y - axis shows the probability of a patient being found in each state as a function of time ( shown on the x - axis ) .
dashed lines and white dots for amisulpride , thick lines and black dots for risperidone table 3 model estimates for various relative treatment effects at study 's endpoint ( 8 weeks ) model used measure median ( 95 % cri ) 3 - state model or13 ( values < 1 favor risperidone ) 0.81 [ 0.45 ; 1.50 ] or12 ( values < 1 favor amisulpride ) 0.93 [ 0.54 ; 1.60 ] or23 ( values < 1 favor risperidone ) 0.48 [ 0.17 ; 1.41 ] or21 ( values < 1 favor risperidone ) 0.96 [ 0.42 ; 2.15 ] ets1 expected time of stay is state 1 ( weeks ) amisulpride 4.0 [ 3.5 ; 4.5 ] risperidone 4.5 [ 4.0 ; 5.0 ] ets2 expected time of stay is state 2 ( weeks ) amisulpride 2.8 [ 2.2 ; 3.3 ] risperidone 2.4 [ 1.9 ; 3.0 ] ets3 expected time of stay is state 3 ( weeks ) amisulpride 1.2 [ 0.8 ; 1.7 ] risperidone 1.1 [ 0.7 ; 1.5 ] 4 - state model orresponsemcar ( values < 1 favor amisulpride ) 0.76 [ 0.42 ; 1.38 ] orresponsemar ( values < 1 favor amisulpride ) 0.82 [ 0.47 ; 1.41 ] orresponsemnar ( values < 1 favor amisulpride ) 0.93 [ 0.53 ; 1.50 ] mmrm orresponsemmrm ( values < 1 favor amisulpride ) 0.83 [ 0.35 ; 1.96 ] cca orresponsecca ( values < 1 favor amisulpride ) 0.68 [ 0.35 ; 1.30 ] locf orresponselocf ( values < 1 favor amisulpride ) 0.78 [ 0.47 ; 1.32 ] all odds ratios are for risperidone ( numerator ) versus amisulpride ( denominator ) .
according to the median estimates presented in table 3 , amisulpride is only slightly better than risperidone in response among completers ( or12 = 0.94 , 95 % cri 0.54 to 1.60 ) , even though gamma12 is considerably higher for amisulpride ; this is because both gamma21 and gamma23 are higher for this drug , so that responders tend to relapse and drop out more often .
regarding dropout , the median estimate is or13 = 0.81 ( 95 % cri 0.45 to 1.50 ) , suggesting risperidone to be slightly better , that is , associated with a smaller probability of study discontinuation .
regarding responders dropping out , the model estimates an or23 = 0.48 ( cri 0.17 to 1.41 ) , with values smaller than 1 corresponding to amisulpride being associated with higher probability of a responder dropping out .
finally , there is no notable difference among the treatments regarding relapse , or21 = 0.96 ( cri 0.42 to 2.15 ) .
note that all of these estimates correspond to 8 weeks after responding .
if deemed clinically interesting , then the model can provide estimates at different time points and the time dependency of the relative treatment effects can also be plotted .
using the ets in each state for each treatment , we can also calculate percentages of stay in each state .
patients on amisulpride spend on average 50 % of the time in nonresponse , 35 % in response and 15 % of the study .
patients in the risperidone arm spend on average 56 % of the time in the nonresponse state , 30 % in the response and 14 % to the study - discontinuation state .
we also use the various versions of the 4 - state model depicted in figure 1 to estimate the following : orresponsemcar for the probability of either observed or unobserved response ( pi1 , 2 + pi1 , 5 ) at the study 's endpoint ( 8 weeks ) , under the mcar scenario .
we first fit the 3 - state model setting gamma13 = gamma23 , and we estimate the transition rates gamma12 , gamma21 , and gamma13 = gamma23 .
we then use these estimates to calculate the probabilities of transition for the 4 - state model after setting gamma14 = gamma25 = gamma13 , gamma54 = gamma21 , and gamma24 = gamma15 = 0 .
orresponsemar for observed or unobserved response ( pi1 , 2 + pi1 , 5 ) at the study 's endpoint ( 8 weeks ) , under the mar scenario of section 3.6 .
we first fit the 3 - state model by assuming gamma13 != gamma23 and then use the 4 - state model , setting gamma14 = gamma15 = 0.5 gamma13 , gamma24 = gamma25 = 0.5 gamma23 , and gamma45 = gamma12 , gamma54 = gamma21 .
orresponsemnar for either observed or unobserved response ( pi1 , 2 + pi1 , 5 ) at study 's endpoint ( 8 weeks ) , under an mnar scenario .
we first fit the 3 - state model , and we then assume gamma14 = 0.9gamma13 , gamma15 = 0.1gamma13 , gamma24 = 0.9gamma23 , gamma15 = 0.1gamma23 , gamma45 = 0.1gamma12 , and gamma54 = 2gamma21 .
these choices of the parameters correspond to a scenario where 90 % of patients that drop out of the study go to the unobserved nonresponse state and where dropout patients tend to stay to the nonresponse state .
the results from these scenarios are presented in table 3 .
we also include in this table the estimate for orresponsemmrm corresponding to the mmrm described by equation ( 9 ) , as well as the locf and the cca estimates .
the results show considerable differences among the various models regarding point estimates .
when we adopted an mnar mechanism , assuming that dropout patients were more probable to end up in nonresponse for both treatments , the or was closer to 1 , as expected .
regarding precision , the locf and cca analyses showed the narrowest confidence intervals .
this was also anticipated , because these 2 approaches do not include any uncertainty regarding the unobserved data .
the mar approach of the 4 - state model gave a point estimate similar to the one obtained by using the mmrm ( which also assumes mar ) .
however , the 4 - state model showed a considerable increase in precision compared with mmrm .
to summarize , we conclude that the model suggests amisulpride to be associated with a slightly higher response ( even though the difference is not statistically significant ) .
this effect is less pronounced under the illustrative mnar scenario .
moreover , amisulpride patients tend to drop out more .
relapsing probability has been found to be comparable across treatments .
5 discussion this paper addresses the problem of missing data in randomized control studies by introducing a method based on multistate markov models .
our method allows a variety of clinically interesting relative effect measures to be estimated .
it can be used to analyze individual participant data on a binary outcome reported at multiple time points , taking into account patients dropping out of the study prematurely as well as information on patients relapsing .
the approach presented here is different than the methods usually applied in the literature for analyzing datasets with missing outcomes .
it is focused on modeling the paths patients follow and estimates the probability associated with each path .
all estimates follow from a small number of parameters , the transition rates .
assumptions on the unobserved outcomes of patients dropping out can be included in the model on a second stage , after estimating the model 's parameters .
this is achieved by introducing a set of hidden states as we discussed in section 3.6 .
using this 4 - state model , one can readily model the missingness mechanism and incorporate assumptions about unobserved responses of patients that dropped out of the study .
we believe that the proposed method offers considerable advantages compared with currently available methods for handling missing outcomes .
first , it can provide a wide range of clinically interesting effect measures and give estimates on their time dependency .
the 4 - state model allows for a great flexibility in modeling dropout .
in addition , the correlations between all effect measures are automatically incorporated in the model and can be easily estimated by using the code we used for the analysis , which we provide in the appendix .
this is particularly valuable for the case of a meta - analysis or a network meta - analysis of these measures .
when these correlations are not reported - - currently the case in most studies27 , 28 - - meta - analysts need to resort to complex modeling to correctly account for them.29 , 30 , 31 , 32 , 33 also , when studies have different durations , our method can be used to estimate treatment effects for each study at a predefined time before pooling them together in a meta - analysis .
our approach is based on the markov assumption , which implies that the future path of a patient depends only on the present state .
this assumption may be more plausible in disease areas where past states of response or nonresponse are expected to have small carry - over effects on future disease process .
moreover , it might be a suitable assumption to make for the case of chronic conditions , where patients undergo transitions between health states , for example , movements among depressive , manic , and normal states in patients with bipolar disorder .
clinical judgment should be used to assess the plausibility of this assumption depending on the medical context .
note that the markov assumption can be relaxed if deemed necessary by using several methods ; for a discussion , see ref 34 .
for example , instead of assuming that patients relapse from the response state back to nonresponse , it might be appropriate to include an additional relapse state in the model .
this would account for different future trajectories depending on whether or not patients had responded in the past .
also , we assumed that transition rates remain constant over time , which might be unrealistic for certain clinical conditions , especially for trials with long follow - up. when this is the case , the proposed methodology can be extended to allow for piecewise constant rates within smaller time periods .
in our illustrative example , we could relax the assumption of constant rates to be within time strata , for example , corresponding to first week , 1 to 2 weeks , 2 to 4 , 4 to 6 , and 6 to 8 weeks .
including different transition rates within each stratum will , of course , improve the fit of the model to the data , at the expense of model complexity .
in real - life practical applications , researchers might want to explore the trade - off between fit of the model and complexity , using model selection criteria such as deviance information criterion ( dic ) .
another important limitation of the method we presented is that it requires individual patient data ( ipd ) to be available .
given that ipd are usually not reported in published studies , if the proposed analysis is not implemented at study level , then it will be hard to use it within a meta - analysis .
we followed a bayesian approach to model fitting , and we used winbugs .
this choice allows for increased flexibility in modeling , but this does not come without a cost : the code we present in the appendix is computationally intensive and might be slow to converge , especially for very large studies and when multiple covariates are included in the model .
in principle , one could instead estimate the model parameters by using maximum likelihood estimate,13 , 23 for example , using the msm package in r20 ; however , further applied research is needed before the bayesian implementation of the models presented in this paper can be compared with their frequentist counterparts .
the method presented in this paper could be extended to allow for additional states , if this is supported by the data .
let us assume , for example , that a study provides information on the reason of dropping out for each patient : due to side effects , due to lack of efficacy , or due to other reasons .
for this case , a 5 - state model , with 3 distinct out - of - the - study states , could be used .
one should keep in mind , however , that adding states will , in general , lead to models that cannot be analytically solved by using kolmogorov forward equation .
in this case , a numerical solution can be performed instead,19 using winbugs differential interface , available from http :// winbugs - development.mrc - bsu.cam.ac.uk / wbdiff.html .
an additional measure that can be calculated by using the methods presented in this paper is the mean quality - adjusted duration in each state.35 , 36 this can be computed from the ets for each state after weighting them by a quality rate associated with the burden or desirability of each state .
another possible extension to the methodology presented here is about combining results from multiple studies in a meta - analysis ( or a network meta - analysis when trials comparing different sets of competing treatments are available ) .
price et al. propose a meta - analytical framework for markov models based on parameterizing relative treatment effects regarding log transition rates instead of probabilities.24 it would be interesting to explore methods for synthesizing information from studies for which ipd are available together with information coming from studies providing only aggregated data into a single , joint meta - analysis .
finally , a simulation study would be a very useful follow - up to the work presented in this paper , as it would allow the evaluation of the performance of the presented methods in comparison with alternative , established methods for analyzing incomplete dichotomous data .
funding oe and gs received funding from the innovative medicines initiative joint undertaking under grant agreement no 115546 , resources of which are composed of financial contribution from the european union 's seventh framework programme ( fp7 / 2007 - 2013 ) and efpia companies in kind contribution .
the research leading to these results was conducted as part of the getreal consortium .
for further information , please refer to www.imi - getreal.eu. nw was supported by the uk mrc conduct - ii hub for trial methodology research ( mr / k025643 / 1 ) .
this paper only reflects the personal views of the stated authors .
supporting information supporting info item click here for additional data file .
acknowledgements we thank the anonymous reviewers for their constructive comments , which helped us to improve our paper .
we would also like to thank ian white for all his valuable suggestions and sanofiaventis for allowing us to reanalyze their data .
references 1 d. g. altman , j. m. bland , bmj 2007 , 334 , 424 . 17322261 2 k. wahlbeck , a. tuunainen , a. ahokas , s. leucht , psychopharmacology 2001 , 155 , 230 . 11432684 3 r. little , d. rubin , statistical analysis with missing data , 2nd ed. , john wiley and sons , new york 2002 . 4 i. r. white , s. g. thompson , stat. med. 2005 , 24 , 993 . 15570623 5 a. r. t. donders , g. j. m. g. van der heijden , t. stijnen , k. g. m. moons , j. clin. epidemiol .
2006 , 59 , 1087 . 16980149 6 j. a. c. sterne , i. r. white , j. b. carlin , m. spratt , p. royston , m. g. kenward , a. m. wood , j. r. carpenter , bmj 2009 , 338 . 7 j. l. schafer , stat .
methods med. res .
1999 , 8 , 3 . 10347857 8 c. h. mallinckrodt , w. s. clark , s. r. david , j. biopharm. stat .
2001 , 11 , 9 . 11459446 9 g. molenberghs , h. thijs , i. jansen , c. beunckens , m. g. kenward , c. mallinckrodt , r. j. carroll , biostatistics 2004 , 5 , 445 . 15208205 10 j. w. hogan , j. roy , c. korkontzelou , stat. med. 2004 , 23 , 1455 . 15116353 11 j. r. beck , s. g. pauker , med. decis .
making 1983 , 3 , 419 . 6668990 12 f. a. sonnenberg , j. r. beck , med. decis .
making 1993 , 13 , 322 . 8246705 13 d. commenges , lifetime data anal .
1999 , 5 , 315 . 10650740 14 p. k. andersen , n. keiding , stat .
methods med. res .
2002 , 11 , 91 . 12040698 15 f. siannis , v. t. farewell , j. head , stat. med. 2007 , 26 , 426 . 16220522 16 z. uhry , g. hedelin , m. colonna , b. asselain , p. arveux , a. rogel , c. exbrayat , c. guldenfels , i. courtial , p. soler - michel , f. molinie , d. eilstein , s. w. duffy , stat .
methods med. res .
2010 , 19 , 463 . 20231370 17 g. a. satten , i. m. longini jr .
, j. r. stat. soc. ser. c. appl. stat .
1996 , 45 , 275 . 18 j. van rosmalen , m. toy , j. f. o'mahony , med. decis .
making 2013 , 33 , 767 . 23715464 19 n. j. welton , a. e. ades , med. decis .
making 2005 , 25 , 633 . 16282214 20 c. jackson , journal of statistical software 2011 , 38 , 1 . 21 j. peuskens , p. bech , h. j. moller , r. bale , o. fleurot , w. rein , psychiatry res .
1999 , 88 , 107 . 10622347 22 w. feller , an introduction to probability theory and its applications , vol. 1 , 3rd edition .
3rd edition , wiley , new york 1968 . 23 r. ocana - rilola , journal of modern applied statistical methods 2002 , 1 . 24 m. j. price , n. j. welton , a. e. ades , statmed 2011 , 30 , 140 . 25 r. j. little , r. d'agostino , m. l. cohen , k. dickersin , s. s. emerson , j. t. farrar , c. frangakis , j. w. hogan , g. molenberghs , s. a. murphy , j. d. neaton , a. rotnitzky , d. scharfstein , w. j. shih , j. p. siegel , h. stern , n. engl. j. med. 2012 , 367 , 1355 . 23034025 26 s. p. brooks , a. gelman , journal of computational and graphical statistics 1998 , 7 , 434 . 27 d. jackson , r. riley , i. r. white , stat. med. 2011 , 30 , 2481 . 21268052 28 r. d. riley , j. r. stat. soc. a. stat. soc .
2009 , 172 , 789 . 29 r. d. riley , j. r. thompson , k. r. abrams , biostatistics 2008 , 9 , 172 . 17626226 30 y. wei , j. p. higgins , stat. med. 2013 , 32 , 1191 . 23208849 31 s. bujkiewicz , j. r. thompson , a. j. sutton , n. j. cooper , m. j. harrison , d. p. m. symmons , k. r. abrams , stat. med. 2013 , 32 , 3926 . 23630081 32 o. efthimiou , d. mavridis , a. cipriani , s. leucht , p. bagos , g. salanti , stat. med. 2014 , 33 , 2275 . 24918246 33 o. efthimiou , d. mavridis , r. d. riley , a. cipriani , g. salanti , biostatistics 2014 . 34 h. putter , m. fiocco , r. b. geskus , stat. med. 2007 , 26 , 2389 . 17031868 35 m. c. weinstein , w. b. stason , annu. rev .
public health 1985 , 6 , 41 . 2859868 36 hazen gb , sounderpandian j , stochastic trees and medical decision making in economic and environmental risk and uncertainty .
edited by nau r , gronn e , machina m , bergland o springer netherlands ; 1997 : 65 [ theory and decision library , vol. 35 ]