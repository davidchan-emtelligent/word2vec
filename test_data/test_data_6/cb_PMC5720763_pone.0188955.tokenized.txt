plos one plos one plos plosone plos one 1932 - 6203 public library of science san francisco , ca usa 29216310 5720763 10.1371 / journal.pone.0188955 pone - d - 17 - 04858 research articleecology and environmental sciencesconservation sciencecomputer and information sciencessoftware engineeringsoftware toolsengineering and technologysoftware engineeringsoftware toolsscience policyscience and technology workforcecareers in researchscientistspeople and placespopulation groupingsprofessionsscientistsbiology and life sciencesmarine biologymarine conservationearth sciencesmarine and aquatic sciencesmarine biologymarine conservationbiology and life sciencesmarine biologyfisheries scienceearth sciencesmarine and aquatic sciencesmarine biologyfisheries sciencebiology and life sciencesdevelopmental biologymodes of reproductionsexual reproductionspawningbiology and life sciencesecologycommunity ecologyecology and environmental sciencesecologycommunity ecologybiology and life sciencesagriculturefisheries gbm.auto : a software tool to simplify spatial modelling and marine protected area planning gbm.auto : a software tool to simplify spatial modelling and marine protected area planning http :// orcid.org / 0000 - 0002 - 9108 - 972x dedman simon conceptualizationdata curationformal analysisfunding acquisitioninvestigationmethodologyproject administrationsoftwarevalidationvisualizationwriting - original draftwriting - review & editing12 * officer rick conceptualizationfunding acquisitionmethodologyproject administrationsupervisionvalidationwriting - review & editing1 clarke maurice conceptualizationfunding acquisitionmethodologysupervision2 reid david g. conceptualizationfunding acquisitionmethodologyproject administrationsupervisionwriting - review & editing2 brophy deirdre conceptualizationfunding acquisitionmethodologyproject administrationsupervisionvalidationwriting - review & editing1 1 marine and freshwater research centre , galway - mayo institute of technology , galway , ireland 2 marine institute , rinville , oranmore , co. galway , ireland meador james p. editor northwest fisheries science center , united states competing interests : the authors have declared that no competing interests exist .
* e - mail : simondedman @ gmail.com 7 12 2017 2017 12 12 e0188955 6 2 2017 16 11 2017 ( c ) 2017 dedman et al 2017 dedman et althis is an open access article distributed under the terms of the creative commons attribution license , which permits unrestricted use , distribution , and reproduction in any medium , provided the original author and source are credited .
boosted regression trees .
excellent for data - poor spatial management but hard to use marine resource managers and scientists often advocate spatial approaches to manage data - poor species .
existing spatial prediction and management techniques are either insufficiently robust , struggle with sparse input data , or make suboptimal use of multiple explanatory variables .
boosted regression trees feature excellent performance and are well suited to modelling the distribution of data - limited species , but are extremely complicated and time - consuming to learn and use , hindering access for a wide potential user base and therefore limiting uptake and usage .
brts automated and simplified for accessible general use with rich feature set we have built a software suite in r which integrates pre - existing functions with new tailor - made functions to automate the processing and predictive mapping of species abundance data : by automating and greatly simplifying boosted regression tree spatial modelling , the gbm.auto r package suite makes this powerful statistical modelling technique more accessible to potential users in the ecological and modelling communities .
the package and its documentation allow the user to generate maps of predicted abundance , visualise the representativeness of those abundance maps and to plot the relative influence of explanatory variables and their relationship to the response variables .
databases of the processed model objects and a report explaining all the steps taken within the model are also generated .
the package includes a previously unavailable decision support tool which combines estimated escapement biomass ( the percentage of an exploited population which must be retained each year to conserve it ) with the predicted abundance maps to generate maps showing the location and size of habitat that should be protected to conserve the target stocks ( candidate mpas ) , based on stakeholder priorities , such as the minimisation of fishing effort displacement .
gbm.auto for management in various settings by bridging the gap between advanced statistical methods for species distribution modelling and conservation science , management and policy , these tools can allow improved spatial abundance predictions , and therefore better management , decision - making , and conservation .
although this package was built to support spatial management of a data - limited marine elasmobranch fishery , it should be equally applicable to spatial abundance modelling , area protection , and stakeholder engagement in various scenarios .
http :// dx.doi.org / 10.13039 / 501100004963seventh framework programme289257 reid david g. research funding was received from the european community 's seventh framework programme ( fp7 / 2007 - 2013 ) under grant agreement myfish number 289257 .
dgr also acknowledges funding from a beaufort marine research award , carried out under the sea change strategy and the strategy for science technology and innovation ( 2006 - 2013 ) , with the support of the marine institute , funded under the marine research sub - programme of the national development plan 2007 - 2013 .
the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript.data availabilitydata are available within the gbm.auto package available at github.com / simondedman / gbm.auto as detailed within the paper .
data availability data are available within the gbm.auto package available at github.com / simondedman / gbm.auto as detailed within the paper .
introduction spatial management of data - limited species some of the key barriers to implementation of scientific research are accessibility of evidence , quality of evidence , and organisational capacity / resources [ 1 ] .
a lack of data commonly complicates conservation of marine and terrestrial species [ 2 ] .
marine spatial management typically involves the selection of appropriate marine protected areas ( mpas ) [ 3 ] .
fisheries managers and scientists recommend various spatial management tools to support mpa selection [ 4 - 6 ] .
these methods generally involve predictive mapping of species distribution and abundance in relation to available habitat and human activities such as fishing ( e.g. [ 7 - 10 ]) , and there are a number of such approaches available .
however , predicting abundance ( especially to fine spatial scales ) is often hampered by lack of data [ 8,11 ] .
evaluating the suitability of an mpa is often difficult due to incomplete knowledge of specific ecologically important habitats such as nursery and spawning areas [ 12,13 ] , and uncertainty regarding species movement and larval dispersal patterns [ 14,15 ] .
mpas that ignore the biology of the species to be conserved ( e.g. home range size ) may be inappropriately sized and subsequently fail [ 16,17 ] .
brts compared to other spatial management tools various spatial management tools exist , with different capabilities and strengths , one of which is boosted regression tree ( brt ) modelling .
compared to other such tools , brts are robust to poor or absent data , which marxan may not be [ 18 - 20 ] , and can use abundance data , unlike maximum entropy ( maxent ) models .
they are relatively insensitive to the effects of missing predictor values , outliers , and multicollinearity [ 21,22 ] and can accommodate large numbers of explanatory variables without penalty .
they can provide more robust predictions than generalised linear and additive models ( glms and gams )[ 20 ] , with less variance ( oversensitivity to noise leading to overfitting / imprecision ) and bias ( false assumptions in the algorithm leading to underfitting / inaccuracy ) , a lower risk of misspecification , and the ability to model complex interactions ( see comparative evaluation in [ 23 ]) .
brts have a demonstrated ability to generate predicted abundance maps at fine spatial scales for data - poor stocks [ 7,24,25 ] , as well as for age - and gender - subsets of those stocks [ 26 ] .
species may be managed as an assemblage [ 27,28 ] , which brts can assist with [ 7,29 ] .
the case for simplified brts functions exist in the repository of the r programming language [ 30 ] to run brts on sparse datasets [ 31,32 ] , and one can then display the resulting predicted abundance data tables using either a geographic information system ( gis ) package or functions within r ( e.g. mapplots ) , thus producing fine - spatial - scale predicted abundance maps for data - poor stocks and their subsets .
however , despite guidance existing for the stepwise running of some of these functions [ 33 ] , much time and technical proficiency is required to understand and run the complicated programming functions in a piecemeal fashion .
even when successfully run , brts are complex , acknowledged as being " challenging to understand " , with the model object often treated as a " black box " [ 31 ] .
the application of these methods therefore requires time , technical and financial resources that are often unavailable to scientists or marine managers ( e.g. [ 1,34,35 ]) , and could disincentivise potential users .
a software tool that automates and simplifies the brt mapping process could greatly reduce the barriers preventing access to these methods by the potential user base , and thus increase the uptake of this high performance method [ 20 ] , assisting and improving fisheries management .
managing multiple species or life history groups protection of spawning and / or nursery grounds is often proposed as a spatial management solution for species conservation [ 4,12,36,37 ]. this can be achieved by mapping the abundance of a particular life history stage ( such as mature females ( e.g. [ 38 ]) and brt mapping can support this approach .
however , simply summing predicted abundance maps ( e.g. [ 7 ]) , sees more abundant ( probably less threatened ) subsets obfuscating less abundant ( more threatened ) subsets .
there is a need for a software function that allows users to generate synthesis maps for multiple species or life history groups and to weight each subset according to conservation priorities , to facilitate management of multiple species and their subsets .
decision support tools for mpa selection generating predictive maps of species distribution and abundance from the available data only addresses half of the problem of species conservation within an impacted multi - use environment .
while mpas can improve decision making [ 39 ] , a common mistake made when designing them is failing to acknowledge that conservation plans are prioritisations [ 40 ] .
this means that socioeconomic costs must be considered [ 14,41 ] , not only to the primary stressor ( e.g. fishermen ) but all affected parties ( e.g. tourism , oil and gas extraction , etc. ) .
insufficient stakeholder engagement - - often by involving them only at the final stage of the process - - is a common reason for mpas to fail [ 16,39,42 ] .
unfortunately , the tools and guidance required to incorporate biologically - derived mpa candidates into a multi - stakeholder environment are lacking ([ 43,44 ] in [ 45 ]) .
while tools to support qualitative evaluation of candidate mpas are available [ 35,45 ] , they could be enhanced by the incorporation of quantitative metrics ( e.g. maximum sustainable yield ( msy ) , fishing effort ) [ 43,46 ] .
there is a need for a dst that can generate mpa candidates across a whole region , which weigh harvest - limit - based conservation against quantified displacement of the stressor , e.g. fishing effort , catch per unit effort ( cpue ) , or profit .
this would allow much - needed [ 43 ] evaluation of trade - offs within a framework of scientist , manager , and stakeholder discussion .
a review of 39 mpa - generation and decision support tools found that most were only usable by scientists , and custom - tailored rather than generic ; they concluded a practical and simple tool is required [ 41 ] .
aims in this paper we present the gbm.auto package that we have written , and describe its usage and functionality .
its core function - - also named gbm.auto - - assists decision makers in mapping species distributions by addressing the need for a simplified brt mapping process .
it reduces thousands of lines of code to as few as two , and automatically outputs maps of predicted abundance and representativeness maps of those abundance maps .
it produces bar plots of the relative influence of explanatory variables , dot and line plots describing the relationships between explanatory variables and response variables , and databases of the processed model objects .
these outputs provide insight into the factors underlying observed distribution and abundance patterns that can be disseminated to all stakeholders to catalyse and enrich discussions .
finally , the function produces a report detailing the steps taken by the model , the optimal brt argument combinations , the size of variable influence and variable interactions , and performance statistics of the final models .
this provides the user with the important technical information the model used , and allows them to evaluate the robustness of the outputs in running the gbm.auto function , functions gbm.rsb , gbm.map , and gbm.basemap are called and run .
users can test optimal parameters beforehand with gbm.bfcheck , and run any of the aforementioned functions independently .
gbm.cons can then be used to generate maps synthesising the predicted abundances of multiple subset components of stocks , such as juveniles and mature females , a highly desirable output for marine managers .
separate from the machine - learning spatial - modelling function gbm.auto , the other major function within the gbm.auto package is a dst called gbm.valuemap .
the function combines an msy - based conservation value metric with the predicted abundance maps from gbm.auto to propose mpas that ensure the target stocks are harvested sustainably , while also minimising fishing effort displacement as a proxy for stakeholder priorities .
this bridges the gap between species distribution modelling and decision - making , whereas most existing tools specialize in one or the other .
this is a dst software package that vastly simplifies the process of generating fine - spatial - scale predicted abundance maps for data - poor species , then produces mpas combining fisheries stock science with quantified stakeholder preferences .
the process of spatial conservation is thus facilitated with a rich collection of tools and outputs .
scientists , conservation managers and policymakers can benefit from the power of these statistical methods without a significant upfront penalty of time and effort .
the availability of this specialist software package will increase the uptake of this class - leading analysis method , vastly the diminishing the work required to produce a suite of valuable outputs , and facilitating the engagement of stakeholders into the management process .
guide to software functions we wrote the gbm.auto package in r. it incorporates existing packages calibration , roc , gbm.predict.grids ( from [ 31 ]' s appendix , bundled into gbm.utils by dedman ) , beepr , dismo , gbm , mapplots , mgcv , raster , rgdal and vegan , and functions also built by the authors for this task : gbm.map , gbm.basemap , gbm.rsb , gbm.cons , gbm.valuemap , gbm.bfcheck and gbm.loop .
all r source code is publicly available via github ( see ' availability ' and s3 file ) .
below follows a brief explanation of the usage of brts which are the central engine of the gbm.auto modelling process , then an introduction to the case study for which this software was initially developed , and a description of the required data format .
subsequently , the individual functions are introduced and explained .
see fig 1 for a schematic describing the functionality of gbm.auto functionality .
10.1371 / journal.pone.0188955.g001 fig 1 conceptual diagram of main modelling processes and outputs .
delta log - normal brt models for abundance predictions a high proportion of zeros and few very high values are common features of marine species abundance data acquired through fisheries sampling methods such as trawling ; in fisheries science these issues are commonly addressed using a delta log - normal approach .
delta log - normal boosted regression trees split the data into zero / non - zero catches ( a binary response variable ) , and log - normalised non - zero catches ( a continuous variable representing abundance ) .
the model then uses machine learning to infer a relationship between the explanatory variables and these two sets of response variables , separately predicting the probability of occurrence , and the expected abundance ( this is the delta process , also known as a hurdle model ) .
the abundance variable is reverse log - transformed and the two datasets combined into one abundance probability metric which is mapped to the whole study area , including areas with explanatory data but no response data .
for more detailed explanation see reference 7 ] and references therein , including r packages ; the conceptual diagram ( fig 1 ) ; and [ 26,29 ] for expounded applications to these sample data .
an explanation of the history and mathematics of brts is comprehensively covered by reference 31 ] .
if data are not zero - inflated and long - tailed , the log - normalisation and reversal stages can be omitted , and the brt run only a single time using the distribution model most appropriate for the data ( e.g. binomial , gaussian , poisson ) , as opposed to using the delta / hurdle model .
users are able to specify which model ( s ) gbm.auto should direct brts to fit to their data , if they wish .
sample dataset management bodies and scientists recommend exploration of novel spatial approaches to conserve vulnerable elasmobranch species , as an alternative to typical total allowable catch ( tac ) based management , which often fails such species [ 4,12 ]. of the 1088 chondrichthyan species in the iucn red list , 480 ( 44 %) are categorised as data deficient [ 47 ] and a high percentage of these could qualify as threatened [ 48 ] .
chondrichthyans are thus appropriate candidates for this data - poor spatial approach [ 49,50 ] .
in the worked example we use a dataset of cpues from surveys for four rays ( cuckoo ray ( leucoraja naevus ) , thornback ray ( raja clavata ) , blonde ray ( raja brachyura ) and spotted ray ( raja montagui )) from 1447 survey stations in the irish sea over 12 years .
relationships with fishing pressure , environmental correlates ( bottom temperature , depth , salinity , current speed , substrate grain size , and distance from shore ) , and juvenile ray and eggcase reducing variables ( fishing effort , predatory fish cpue , scallop dredging effort , whelk cpue ) are used to map predicted cpues for the whole study area .
the example data set and images can be retrieved from github ( see ' availability ' section ) .
while the example pertains to marine fishes , the gbm.auto approach may be equally applicable for the management of marine , estuarine , riverine , or terrestrial species .
input data format for predicting abundance , two data tables are expected - ' samples ' , containing the response variable ( e.g. cpue of fish ) and predictor variables ( e.g. environmental variables such as temperature , depth , etc. ) at various sites ; and ' grids ' , containing the same environmental variables at ( ideally regularly - spaced ( gridded )) sites where the response variable was not measured .
' grids' can be omitted if the objective is not to predict abundance at new sites .
a model object of the relationship between predictor and response variables will still be created , and the dot , bar , and line plots , and progress report will all be generated in r. in our example , these data come from a variety of sources ; an explanation of how they were compiled and treated is provided in ' data sources and processing ' ( s2 file ) .
worked examplepre - run parameter scoping with gbm.bfcheck before starting often - lengthy gbm.auto runs , the gbm.bfcheck function allows users to calculate the minimum binary and gaussian brt bag fraction sizes ( the portion of the data that is randomly selected at each iteration to train the model ) , as insufficiently sized datasets or over - large subsampling rates can cause brt runs to fail .
its arguments are ' samples ' , ' resvar ' and ' zi ' , all as per gbm.auto .
gbm.bfcheck ( samples = mysamples , resvar = 11 ) # run code with defaults abundance predictions with gbm.auto the gbm.auto code loops through the arguments resvar , tc , lr and bf , either left as default or provided by the user , then checks whether the response variable data are zero inflated , and that the data are correctly formatted .
for a binomial distribution or delta log - normal approach ( which includes binomial ) , zeroes are expected to be present in the raw data , denoting zero catches .
column names in the samples data must match those in the grids data .
binary and non - zero gaussian data vectors are then created from the original samples data , for input to the subsequent brt model runs .
the remaining argument loops are then begun , with bag fraction nested within learning rate nested within tree complexity .
binomial and gaussian brts are run on the binary and non - zero gaussian data respectively ( assuming the model families have been left at their defaults ) , with the best - performing combination of arguments selected then tested for simplicity , in case it performs better with any explanatory variables omitted .
line plots of partial deviance are created , first all on one matrix figure , then for each variable separately , for binary and gaussian as usual .
next are dot plots of the spread of partial deviance against the explanatory variable values .
the influence of each variable 's contribution to the model is then tabulated and saved as a comma - separated - values ( csv ) file , then output as binary and gaussian bar plots .
gaussian data are reverse log - transformed if they were zero inflated and thus log - normalised earlier , using duan 's smearing estimator [ 51 ] .
binary and gaussian data are then multiplied to give a single index of predicted abundance which is saved as a csv file twice : once alongside all of the explanatory variables and once alongside just the cell centroid latitude and longitudes .
the binary and gaussian model objects are saved - - these can be loaded back into r for re - processing outputs and additional analysis later .
a report of all model metrics , which allow the model performance to be quantified , is also saved as a csv file ( see s1 file for more ) .
the predictions are then mapped , followed by the representativeness surface builder maps ( fig 2a and 2b respectively ) for binary , then gaussian , then both combined , in colour then greyscale .
10.1371 / journal.pone.0188955.g002 fig 2 ( a ) predicted cpue map , from gbm.auto .
( b ) representativeness surface builder map , from gbm.auto .
here we run the gbm.auto function with all option parameters left at their default values .
explanatory variable columns are 4 to 9 and 11 ; the response variable column is 12 .
gbm.auto ( grids = mygrids , samples = mysamples , expvar = c ( 4:8,10 ) , resvar = 11 ) acquiring global coastlines with gbm.basemap the acquisition and processing of coastline data at the appropriate scale and resolution is usually required for mapping , but can be time - and technically demanding .
gbm.basemap automates the acquisition and cropping of noaa 's global coastline shapefiles database to user - defined extents , for gbm.map .
this lowers memory use and processing time , and allows the user to set the map resolution .
the difference in resolution between the highest ( full , " f ") and the lowest ( coarse , " c ") of the noaa datasets used by gbm.basemap is shown in fig 3 using the example of the british isles .
while the coarse dataset sacrifices a large amount of detail , this may be acceptable for large - area maps focusing more on mid - oceans than coastlines .
10.1371 / journal.pone.0188955.g003 fig 3 comparison of noaa basemaps at full ( f ; black , under ) and coarse ( c ; red , over ) resolution basemaps from gbm.basemap .
mymap < - gbm.basemap ( grids = grids , gridslat = 2 , gridslon = 1 ) # run the function with defaults representativeness surface builder with gbm.rsb the representativeness surface builder function compares the frequency distribution of the explanatory variables from the ' grids' data with those from the ' samples' data , summing ( the modulus of ) the differences into a score which indicates how well the samples data captures that variable 's full range .
this is calculated for every cell in ' grids' and exported to a csv file , which gbm.auto has gbm.map output to a figure .
higher values signify poor coverage of those explanatory variable range sections by the samples data , and thus where users should be more cautious when drawing conclusions from the corresponding predicted abundance maps .
expvar = c ( 4:10 ) # list explanatory variable columns ( as gbm.auto ) resvar = 11 # list explanatory variable columns ( as gbm.auto ) rsbdf _ bin < - gbm.rsb ( samples = mysamples , grids = mygrids , expvarnames = names ( mysamples [ expvar ]) , gridslat = 2 , gridslon = 1 ) # create binary data rsb mapping with gbm.map the gbm.map function handles the mapping , calculating the cell size automatically and allowing the user to alter most elements of the output .
this can be run manually within r 's standard plotting framework , and is called by gbm.auto , cons , and valuemap .
data < - gbm.auto : : allpreds _ e # load abundance predictions produced by gbm.auto png ( filename = paste ("./ cuckoo _ map2.png " , sep = "") , width = 4 * 1920 , height = 4 * 1920 , units = " px " , pointsize = 4 * 48 , bg = " white " , res = na , family = "" , type = " cairo - png ") # opens the png image format writing process ; change type to " quartz " for non - linux systems .
par ( mar = c ( 3.2,3,1.3,0 ) , las = 1 , mgp = c ( 2.1,0.5,0 ) , xpd = false ) # sets plot boundaries and sizes gbm.map ( x = data [ , 2 ] , y = data [ , 1 ] , z = data [ , 3 ]) # run gbm.map function dev.off () # closes the png writing device , saving the image .
conservation mapping with gbm.cons gbm.cons runs gbm.auto for multiple subsets of the dataset , scaling and amalgamating the combined results , producing maps which highlight areas of high conservation importance for multiple species in the same study area .
in a previous study [ 24 ] this function was used to map predicted cpues for juvenile and adult subsets and to locate potential nursery grounds and spawning areas .
the code maps the results via gbm.map as well as saving the data as a csv file .
stepwise guides for running gbm.map , gbm.basemap , gbm.rsb , gbm.loop and gbm.cons are provided in s1 file .
mygrids < - gbm.auto : : grids # load grids file juveniles < - gbm.auto : : juveniles # load juveniles subset adult _ females < - gbm.auto : : adult _ females # load adult females subset gbm.cons ( mygrids = mygrids , subsets = c (" juveniles " , " adult _ females ") , resvars = c ( 43:44,10:11 ) , expvars = list ( c ( 4:10,14,16,20,24,28,36 ) , c ( 4:10,14,17,21,25,29,37 ) , 4:9 , 4:9 ) , tcs = list ( c ( 2,13 ) , c ( 2,13 ) , c ( 2,6 ) , c ( 2,6 )) , lrs = list ( c ( 0.01,0.005 ) , c ( 0.01,0.005 ) , 0.0001 , 0.0005 ) , zeroes = rep ( false,4 )) # 4 entries , 4 gbm.auto runs , small lrs fail for the more data - limited subsets and were removed , zero category removed for maps , all other arguments omitted and default to their gbm.auto defaults ( mostly true ) .
closed area generation with gbm.valuemap once the predicted abundance maps have been produced by gbm.map in gbm.auto , gbm.valuemap is the dst that can generate mpa options using those species' predicted abundance maps .
effort displacement was chosen as the value to minimise since it is the classic problem of fisheries management [ 16,41,52 ] , but other proxies for the preferences of that stakeholder group ( e.g. cpue , profit ) or any other stakeholder group ( e.g. windfarms , fossil fuel or aggregate extraction ) can be used instead - - see reference [ 29 ] for further details .
the conservation value metric used by this function is based on the msy principle of escapement biomass .
this is the percentage of the stock which must be retained each year to conserve it , expressed as harvest rate at msy ( hrmsy ) .
in the s1 file we generate closed areas under four different scenarios , to demonstrate the effect of different weighting choices .
gbm.valuemap scales the response variable data based on importance ratios specified by the user , maps a user - defined explanatory variable to be avoided , e.g. fishing effort ( fig 4a ) , then combines the response variable data ( e.g. cuckoo ray cpue ) with reversed avoid - variable data ( fishing effort ) , both scaled to 1 .
this results in a combined map ranging from areas to avoid closing ( value 0 : maximum high fishing effort and no cuckoo ray cpue ) to areas to preferentially close ( value 1 : no fishing effort and maximum cuckoo ray cpue )( fig 4b ) .
the data are then sorted by one of four sorting schemes and the rows summed until bpa - - the precautionary biomass required to protect the spawning stock - - is reached .
these rows correspond to a closed area / mpa candidate map for each ( combination sort example in fig 4c ) .
10.1371 / journal.pone.0188955.g004 fig 4 ( a ) fishing effort map , from gbm.valuemap ; ( b ) predicted cpue of cuckoo ray plus reversed fishing effort map , from gbm.valuemap ; ( c ) predicted cpue of cuckoo ray plus reversed fishing effort map , with overlaid closed area , from gbm.valuemap .
the code then builds a growing mpa , starting with mpa map for the most conservationally at - risk species ( as set by the user ) , then counting those mpa data rows against the next species , before beginning that species' bpa cumulative sum .
in essence , this is asking ' how much of blonde ray 's bpa is already protected by the cuckoo ray mpa ?' .
this results in one mpa map per species , and a single four - colour mpa map , with colours corresponding to the species responsible for that part of the mpa ( four - species cumulative closure maps for all four sorting scenarios shown in fig 5 ) .
all maps generated by gbm.valuemap list the percentage of the avoid - variable 's total that is overlapped by the mpa , in the map legend .
finally a report is produced ( see s1 file ) .
10.1371 / journal.pone.0188955.g005 fig 5 cumulative area closure maps derived under the biomass ( top left ) , effort ( top right ) , combination ( bottom left ) and conservation ( bottom right ) sorting techniques , from gbm.valuemap .
the sorting strategies mentioned earlier are as follows .
the first is the combination metric as previously discussed (' combination sort ') , combining the response variable ( ray cpue ) with reversed avoid - variable ( fishing effort ) .
the second (' biomass sort ') is response variable only , preferentially protecting the areas of highest cpue with no regard for fishing effort .
the third is the opposite , preferentially avoiding fishing effort reductions (' effort sort ') .
the fourth is a conservation sort , preferentially closing areas of high nursery area or spawning ground cpue based on the conservation map produced by gbm.cons , ignoring fishing effort like the biomass sort .
conserve < - gbm.auto : : allscaleddata # load data from gbm.cons .
mydata < - gbm.auto : : allpreds _ e # load dataset with latitude , longitude , fishing fleet effort and all four rays' predicted cpue .
mydata < - cbind ( mydata , conserve = conserve [ , 3 ]) # add conservation data from gbm.cons as a column to mydata .
to run gbm.valuemap with standard weightings and known hrmsy values : gbm.valuemap ( dbase = mydata , loncolno = 2 , latcolno = 1 , goodcols = c ( 3,5,6,4 ) , badcols = 7 , conservecol = 8 , hrmsy = c ( 0.08,0.14,0.08,0.15 )) calculating the coefficient of variation of predicted abundance with gbm.loop gbm.loop repeats exactly the same gbm.auto run a user - specified number of times and collates the multiple outputs .
before the prediction stage it calculates the minimum , average , maximum , and variance of the variable influence values as seen in the bar plots , as well as plotting the minimum , average , and maximum partial dependence values for each x value in the variable 's range , for the partial dependence line plots .
after the prediction stage it calculates the coefficient of variation for the predicted abundance surface , i.e. the variance of values at each cell in ' grids ' .
map and csv files are produced , enabling users to further quantify the robustness of their predictions .
gbmlooptest < - gbm.loop ( loops = 5 , grids = mygrids , samples = mysamples , expvar = c ( 4:10 ) , resvar = 11 , simp = f ) # run code with most defaults .
overview and benefits of gbm.auto the gbm.auto suite of functions develop the brt functions previously available in r 's ' cran ' repository into an easily - usable and feature - rich resource primarily for fisheries , scientists to disseminate to managers and stakeholders , putting the power of these powerful mathematical tools into the hands of those who need their answers most .
the package allows users to easily produce predicted abundance maps , explanatory variable diagnoses , conservation priority area maps and area closure proposals , with little work or prior knowledge required .
this can facilitate and expedite fisheries managers' jobs of conserving data - poor species using mpas that balance competing priorities with the full engagement of stakeholders .
the ability to run subfunctions separately and reload saved model objects allows users to adjust and re - run sections of the analyses without having to re - run the whole brt modelling process .
the ability to switch off most elements in the functions ( e.g. producing maps , saving data ) means users can reduce analyses to the essentials they require .
the default formatting , plus customisation options , allow users to quickly generate high quality outputs from these functions ( gbm.map , gbm.cons , gbm.valuemap ) for use in presentations and academic journals , without the need for lengthy or repeated formatting .
together these options can save users much time , accelerating the management process .
here we have demonstrated the use of the gbm.auto package to map predicted abundances for four irish sea ray species , predicated on environmental and human inputs , including mapping nursery area and spawning ground candidates with gbm.cons ( see s1 file ) , and finally resulting in mpa prediction maps under four scenarios with gbm.valuemap .
these output maps and their complementary variables plots can drive collaborative mpa siting discussions with stakeholders and fisheries managers , leading to biologically - underpinned mpa proposals that have the full buy - in of the impacted industry .
such discussions should also include the range of diagnostic tools provided by gbm.auto in order to assess the strength and representativeness of the outputs , such as the rsb maps , coefficient of variation map , and model reports .
this software is generalizable to other fields , other areas of marine biology most intuitively , but conceptually any spatially distributed abundance data one wishes to predictively map based on associated variables .
the main improvement scheduled for the gbm.auto package is to complete the design and build of a javascript frontend that will incorporate the outputs of the gbm.auto package and allow stakeholders to design their own closed areas , with displayed levels of species conservation dynamically changing as their designs evolve .
this will allow stakeholders to propose mpas underpinned by their own preferences and harvest - rate fisheries science .
they could do this alone or collaboratively as a collective of fishermen , handled within the existing management framework and leading to a scientist / manager / stakeholder discussion as normal .
this would increase stakeholder buy - in and allow the industry a greater degree of autonomy .
in addition , many processing speed increases , completion time estimates , argument auto - optimisation , and similar performance improvements are planned .
the hope is that this software becomes established as the standard tool for scientists to conduct spatial predictions using brts in r. we intend to submit the package to the cran repository , and continue to develop and maintain it there and on github , where collaborations are fuelling its on - going development .
conclusion the novel tool we have built and showcase here greatly simplifies the process of predictively mapping the distribution of species and their subsets using powerful machine - learning mathematics , without the need for rich datasets .
socioeconomic costs and harvest - rate data are then integrated into a closed - area generating decision support tool that allows ( fisheries ) scientists and managers to fully involve stakeholders in the conservation processes .
this tool facilitates the use of powerful brt mapping to assess and manage single species as well as multiple species and subsets collectively , assisting practitioners and benefiting managers with a rich suite of graphical outputs and statistical results. by making spatial brt analysis more readily available to the ecological - and wider scientific community , we anticipate that adoption of this approach will grow , improving the quality of spatial prediction analyses .
supporting information s1 file a supplementary document explaining the running of the code in more detail , listing the functions' arguments and their usage , a guide to running the functions together and separately , as well as additional results outputs , accompanies this manuscript .
( pdf ) click here for additional data file .
s2 file a short document detailing the data sources and their processing techniques .
( pdf ) click here for additional data file .
s3 file r functions and packages used .
( pdf ) click here for additional data file .
the authors appreciate the statistical and programming expertise of john froeschke , hans gerritsen , elliott hazen , coilin minto , jane elith and greg ridgeway .
we gratefully acknowledge the critical comments of the reviewers , which helped to improve the present paper .
abbreviations bpa precautionary reference point for spawning stock biomass brt boosted regression tree cpue catch per unit effort dst decision support tool gam generalised additive modelling glm generalised linear modelling hr harvest rate marxan marine spatially explicit annealing maxent maximum entropy mpa marine protected area msy maximum sustainable yield references 1 walsh jc ( 2015 ) an inventory of the barriers and solutions to bridging the conservation research - practice divide .
barriers and solutions to implementing evidence - based conservation .
cambridge , uk .
2 ices wklife ( 2012 ) ices' implementation of rglife advice on data limited stocks ( dls ) draft .
3 cbd ( 2012 ) aichi biodiversity targets .
http :// www.cbd.int / sp / targets / .
accessed 3 - 5 2016 .
4 ices wgef ( 2012 ) report of the working group on elasmobranch fishes ( wgef ) .
lisbon , portugal : ices cm .
5 speed cw , field ic , meekan mg , bradshaw c ( 2010 ) complexities of coastal shark movements and their implications for management . marine ecology progress series 408 : 275 - 293 . 6 ellis jr , clarke mw , cortes e , heessen hj , apostolaki p , et al ( 2008 ) management of elasmobranch fisheries in the north atlantic . advances in fisheries science 50 : 184 - 228 . 7 dedman s , officer r , brophy d , clarke mw , reid dg ( 2015 ) modelling abundance hotspots for data - poor irish sea rays . ecological modelling 312 : 77 - 90 . doi : 10.1016 / j.ecolmodel.2015.05.010 8 fulton ea , bax nj , bustamante rh , dambacher jm , dichmont c , et al ( 2015 ) modelling marine protected areas : insights and hurdles . philosophical transactions of the royal society b : biological sciences 370 : 20140278 . 9 rassweiler a , costello c , siegel da ( 2012 ) marine protected areas and the value of spatially optimized fishery management . proc natl acad sci usa 109 : 11884 - 11889 . doi : 10.1073 / pnas.1116193109 22753469 10 klein cj , steinback c , watts m , scholz aj , possingham hp ( 2009 ) spatial marine zoning for fisheries and conservation . frontiers in ecology and the environment 8 : 349 - 353 . doi : 10.1890 / 090047 11 warton di , foster sd , de'ath g , stoklosa j , dunstan pk ( 2015 ) model - based thinking for community ecology . plant ecology 216 : 669 - 682 . 12 ellis jr , silva jf , mccully sr , evans m , catchpole t ( 2010 ) uk fisheries for skates ( rajidae ) : history and development of the fishery , recent management actions and survivorship of discards . ices .
13 delavenne j , metcalfe k , smith rj , vaz s , martin cs , et al ( 2011 ) systematic conservation planning in the eastern english channel : comparing the marxan and zonation decision - support tools . ices journal of marine science : fsr180 .
14 kelleher g ( 1999 ) guidelines for marine protected areas .
cambridge , uk : iucn . 15 sale pf , cowen rk , danilowicz bs , jones gp , kritzer jp , et al ( 2005 ) critical science gaps impede use of no - take fishery reserves . trends in ecology & evolution 20 : 74 - 80 . 16701346 16 agardy t , di sciara gn , christie p ( 2011 ) mind the gap : addressing the shortcomings of marine protected areas through large scale marine spatial planning . marine policy 35 : 226 - 232 . 17 halpern bs , warner rr ( 2003 ) matching marine reserve design to reserve objectives . proceedings of the royal society b : biological sciences 270 : 1871 - 1878 . doi : 10.1098 / rspb.2003.2405 14561299 18 vincent ma , atkins sm , lumb cm , golding n , lieberknecht lm , et al .
( 2004 ) marine nature conservation and sustainable development - - the irish sea pilot .
peterborough , uk .
19 loos sa ( 2006 ) exploration of marxan for utility in marine protected area zoning [ masters thesis ] .
bc , canada : university of victoria .
20 elith j , graham ch , anderson rp , dudik m , ferrier s , et al ( 2006 ) novel methods improve prediction of species' distributions from occurrence data . ecography 29 : 129 - 151 . doi : 10.1111 / j.2006.0906 - 7590.04596.x 21 dormann cf , elith j , bacher s , buchmann c , carl g , et al ( 2013 ) collinearity : a review of methods to deal with it and a simulation study evaluating their performance . ecography 36 : 27 - 46 . doi : 10.1111 / j.1600 - 0587.2012.07348.x 22 hastie t , tibshirani r , friedman j ( 2009 ) the elements of statistical learning : data mining , inference , and prediction .
second springer . 23 abeare sm ( 2009 ) comparisons of boosted regression tree , glm and gam performance in the standardization of yellowfin tuna catch - rate data from the gulf of mexico longline fishery [ ph.d thesis ] .
gauteng , south africa : university of pretoria .
24 froeschke jt , froeschke bf ( 2011 ) spatio - temporal predictive model based on environmental factors for juvenile spotted seatrout in texas estuaries using boosted regression trees . fisheries research 111 : 131 - 138 . 25 froeschke j , drymon m ( 2013 ) atlantic sharpnose shark : standardized index of relative abundance using boosted regression trees and generalized linear models .
sedar34 - wp - 12 sedar , north charleston , sc 31 pp .
26 dedman s , officer r , brophy d , clarke m , reid dg ( 2017 ) advanced spatial modeling to inform management of data - poor juvenile and adult female rays . fishes 2 : 12 doi : 10.3390 / fishes2030012 27 babcock r , shears n , alcala a , barrett n , edgar g , et al ( 2010 ) decadal trends in marine reserves reveal differential rates of change in direct and indirect effects . proceedings of the national academy of sciences 107 : 18256 - 18261 . 28 barrett ns , edgar gj , buxton cd , haddon m ( 2007 ) changes in fish assemblages following 10 years of protection in tasmanian marine protected areas . journal of experimental marine biology and ecology 345 : 141 - 157 . 29 dedman s , officer r , brophy d , clarke mw , reid dg ( 2016 ) towards a flexible decision support tool for msy - based marine protected area design for skates and rays . ices journal of marine science : fsw147 .
doi : 10.1093 / icesjms / fsw147 30 r core team ( 2013 ) r : a language and environment for statistical computing .
r foundation for statistical computing , v3.4.1 www.r - project.org .
accessed 1 - 8 2017 .
31 elith j , leathwick jr , hastie t ( 2008 ) a working guide to boosted regression trees . journal of animal ecology 77 : 802 - 813 . doi : 10.1111 / j.1365 - 2656.2008.01390.x 18397250 32 ridgeway g ( 2006 ) generalized boosted models : a guide to the gbm package . r - project.org 1 : 1 - 12 . 33 elith j , leathwick jr , hastie t ( 2008 ) a working guide to boosted regression trees , supplementary material 1 & 2 . journal of animal ecology 77 : 802 - 813 . 18397250 34 sale pf ( 2008 ) management of coral reefs : where we have gone wrong and what we can do about it . marine pollution bulletin 56 : 805 - 809 . doi : 10.1016 / j.marpolbul.2008.04.009 18456286 35 teh lcl , teh lsl , pitcher tj ( 2012 ) a tool for site prioritisation of marine protected areas under data poor conditions . marine policy 36 : 1290 - 1300 . 36 edgar gj , stuart - smith rd , willis tj , kininmonth s , baker sc , et al ( 2014 ) global conservation outcomes depend on marine protected areas with five key features . nature 506 : 216 - 228 . doi : 10.1038 / nature13022 24499817 37 ices wgef ( 2012 ) ices advice : rays and skates in subarea vi and divisions viia - c , e - j ( celtic sea and west of scotland ) .
38 johnston g , tetard a , santos ar , kelly e , clarke mw ( 2014 ) spawning and nursery areas of selected rays and skate species in the celtic seas .
marine institute , oranmore .
39 katsanevakis s , stelzenmuller v , south a , sorensen tk , jones pj , et al ( 2011 ) ecosystem - based marine spatial management : review of concepts , policies , tools , and critical issues . ocean & coastal management 54 : 807 - 820 . 40 game et , kareiva p , possingham hp ( 2013 ) six common mistakes in conservation priority setting . conservation biology 27 : 480 - 485 . doi : 10.1111 / cobi.12051 23565990 41 klein cj , tulloch vj , halpern bs , selkoe ka , watts me , et al ( 2013 ) tradeoffs in marine reserve design : habitat condition , representation , and socioeconomic costs . conservation letters 6 : 324 - 332 . 42 christie p ( 2004 ) marine protected areas as biological successes and social failures in southeast asia . american fisheries society symposium. vol. 42 pp .
155 - 164 . 43 kendall ms , eschelbach ka , mcfall g , sullivan j , bauer l ( 2008 ) mpa design using sliding windows : case study designating a research area . ocean & coastal management 51 : 815 - 825 . 44 young jc , jordan a , searle kr , butler a , chapman ds , et al ( 2013 ) does stakeholder involvement really benefit biodiversity conservation ?
biological conservation 158 : 359 - 370 . 45 stortini ch , shackell nl , o'dor rk ( 2015 ) a decision - support tool to facilitate discussion of no - take boundaries for marine protected areas during stakeholder consultation processes . journal for nature conservation 23 : 45 - 52 . http :// dx.doi.org / 10.1016 / j.jnc.2014.07.004 .
46 derous s , agardy t , hillewaert h , hostens k , jamieson g , et al ( 2007 ) a concept for biological valuation in the marine environment . oceanologia 49 . 47 iucn ( 2015 ) iucn red list category summary for all classes and orders 19 / 11 / 2015 .
http :// cmsdocs.s3.amazonaws.com / summarystats / 2015 - 4 _ summary _ stats _ page _ documents / 2015 _ 4 _ rl _ stats _ table _ 4a.pdf .
accessed 19 - 2 2016 .
48 walsh jc , watson je , bottrill mc , joseph ln , possingham hp ( 2013 ) trends and biases in the listing and recovery planning for threatened species : an australian case study . oryx 47 : 134 - 143 . 49 musick ja , bonfil r ( 2005 ) management techniques for elasmobranch fisheries .
food & agriculture organisation . 50 musick j , burgess g , cailliet g , camhi m , fordham s ( 2000 ) management of sharks and their relatives ( elasmobranchii ) . fisheries 25 : 9 - 13 . 51 duan n ( 1983 ) smearing estimate : a nonparametric retransformation method . journal of the american statistical association 78 : 605 - 610 . 52 suuronen p , jounela p , tschernij v ( 2010 ) fishermen responses on marine protected areas in the baltic cod fishery . marine policy 34 : 237 - 243 .