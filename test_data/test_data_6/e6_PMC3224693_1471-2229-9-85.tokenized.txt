bmc plant biol bmc plant biology 1471 - 2229 biomed central 19575805 3224693 1471 - 2229 - 9 - 85 10.1186 / 1471 - 2229 - 9 - 85 research article sequence diversity in three tomato species : snps , markers , and molecular evolution jimenez - gomez jose m 1 jmjimenez @ ucdavis.edu maloof julin n 1 jnmaloof @ ucdavis.edu 1 department of plant biology , college of biological sciences , university of california davis , davis , ca , 95616 , usa 2009 3 7 2009 9 85 85 16 9 2008 3 7 2009 copyright ( c ) 2009 jimenez - gomez and maloof ; licensee biomed central ltd .
2009 jimenez - gomez and maloof ; licensee biomed central ltd.this is an open access article distributed under the terms of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 2.0 ) , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
background tomato species are of significant agricultural and ecological interest , with cultivated tomato being among the most common vegetable crops grown .
wild tomato species are native to diverse habitats in south america and show great morphological and ecological diversity that has proven useful in breeding programs .
however , relatively little is known about nucleotide diversity between tomato species .
until recently limited sequence information was available for tomato , preventing genome - wide evolutionary analyses .
now , an extensive collection of tomato expressed sequence tags ( ests ) is available at the sol genomics network ( sgn ) .
this database holds sequences from several species , annotated with quality values , assembled into unigenes , and tested for homology against other genomes .
despite the importance of polymorphism detection for breeding and natural variation studies , such analyses in tomato have mostly been restricted to cultivated accessions .
importantly , previous polymorphisms surveys mostly ignored the linked meta - information , limiting functional and evolutionary analyses .
the current data in sgn is thus an under - exploited resource .
here we describe a cross - species analysis taking full - advantage of available information .
results we mined 20,000 interspecific polymorphisms between solanum lycopersicum and s. habrochaites or s. pennellii and 28,800 intraspecific polymorphisms within s. lycopersicum .
using the available meta - information we classified genes into functional categories and obtained estimations of single nucleotide polymorphisms ( snp ) quality , position in the gene , and effect on the encoded proteins , allowing us to perform evolutionary analyses .
finally , we developed a set of more than 10,000 between - species molecular markers optimized by sequence quality and predicted intron position .
experimental validation of 491 of these molecular markers resulted in confirmation of 413 polymorphisms .
conclusion we present a new analysis of the extensive tomato est sequences available that represents the most comprehensive survey of sequence diversity across solanum species to date .
these snps , plus thousands of molecular makers designed to detect the polymorphisms are available to the community via a website .
evolutionary analyses on these polymorphism uncovered sets of genes potentially important for the evolution and domestication of tomato ; interestingly these sets were enriched for genes involved in response to the environment .
background tomato ( solanum lycopersicum ) is the second most popular vegetable crop in the world [ 1 ] .
in addition , tomato is being developed as a model organism and is more closely related to important crops like lettuce and coffee than other models such as arabidopsis , poplar or rice [ 2 ] .
tomato also has an interesting natural history , which includes a single domesticated species and a number of wild relatives that have wide morphological variability and are adapted to very diverse environments [ 3,4 ] .
the comparative study of tomato wild species can help us identify key genetic factors involved in domestication and will benefit breeding programs .
despite the advent of high throughput genomic techniques and bioinformatics , comprehensive genome - wide information remains unavailable for most species , including tomato .
since the tomato genome sequence is currently incomplete and the microarray platforms for this species do not feature most of the loci predicted to exist [ 5 - 7 ] , genetic studies have focused on the analysis of particular loci and segregating populations .
these studies led to in - depth information on a few loci and uncovered the potential usefulness of the natural variation existing in related species [ 3,4 ] .
a major goal for tomato geneticists is the acquisition of comprehensive genome - wide information that can be used in the improvement of resistance , quality , aspect , flavor and growth in cultivated varieties [ 8 ] .
a large amount of genetic and molecular information is available for tomato , most of which has been deposited at the sgn http :// sgn.cornell.edu .
in this database there are more than 320,000 ests from several tomato species .
this abundant sequence repository has been used to develop polymerase chain reaction - based ( pcr - based ) molecular markers to build on the original , time consuming and cost ineffective restriction fragment length polymorphisms ( rflps ) [ 9 - 12 ] recently , bioinformatic surveys of genome sequences have revealed the importance of snps in shaping evolution and also in serving as molecular markers [ 13 ] .
in tomato , initial genomic work on snp discovery involved de novo sequencing of est libraries and comparison to the existing databases [ 14 ] , or faster and less expensive computer - aided mining of the available sequences [ 15,16 ] .
in these analyses only the information from the plain sequence was used .
as a consequence there were high numbers of both false positives created by sequencing errors , and false negatives resulting from data that did not meet the conditions set by the researchers , such as minimum number of sequences or sequence similarity surrounding a snp .
furthermore , low rates of validation were often obtained , in part because of lack of information on sequence quality and on intron position .
for example , if a predicted marker spans an intron it will be difficult to detect by pcr .
there is now an increasing wealth of resources in the tomato databases and similar repositories such as sequence qualities , unigene assemblies , open reading frame ( orf ) predictions , sequence similarity with other plant species and localization to genetic maps [ 17 ] .
the use of this metadata allows for more sophisticated experimental designs that increase the quality of snp prediction and information on the snp 's effects .
for example , by comparing tomato and arabidopsis thaliana databases a set of markers was developed that targeted loci conserved throughout evolution both in sequence and copy number [ 18,19 ] .
this conserved orthologous set ( cos ) has been proven an invaluable resource for comparative and evolutionary studies among plants [ 20 - 22 ] .
similarly , a recent publication used intron positions conserved between tomato and arabidopsis thaliana to detect intraspecific snps in noncoding regions , demonstrating the possibilities of bioinformatics predictions [ 23 ] .
despite the availability of sequence - associated metadata and the need for functional genomic studies in tomato , there is surprisingly little information about the relevance and levels of variation found in coding regions .
previous snp mining efforts are either based on noncoding regions or have no information about the effect of the polymorphisms on protein sequence .
moreover , most snps mined from est sequences have little probability of being functionally important , since the majority are expected to fall in the un - translated regions ( utr ) , where the polymorphism rate increases more than five fold in comparison with coding regions , [ 23 ] .
information about the number , localization and type of non - synonymous polymorphisms will help unravel useful information about the evolution of genes that may have adaptive significance [ 24 ] , serving as a primer for more profound studies on natural variation of interesting traits .
to perform reliable evolutionary and phylogenetic analyses sufficient polymorphism data can be obtained from the sequences of the wild species already available .
however , most studies have focused on finding intraspecific molecular markers between cultivated tomato cultivars .
the few attempts to infer rates of polymorphism and selection on tomato genes among its wild relatives are reduced to small sets of genes likely providing biased estimations [ 25 ] .
to fill the gap in knowledge about sequence similarities and differences among cultivated and wild tomato species , we mined the est and unigene tomato database from sgn in search for substitutions and insertions / deletions between and within the three species with highest representation : s. lycopersicum , s. habrochaites and s. pennellii .
we used additional metadata from the database to effectively predict snps and infer levels of polymorphism in coding versus noncoding regions and in gene families .
we surveyed this dataset for signatures of sequence evolution , selection and / or adaptation using the mcdonald - kreitman test [ 26 ] and codon - based maximum likelihood analyses [ 27,28 ] .
based on the polymorphisms detected we also developed a set of specific molecular markers and a website to make these available to the community at http :// www.plb.ucdavis.edu / labs / maloof / tomatosnp / index.html .
results and discussion est assembly the unigene database version 200607 build 1 from sgn consists of 239,172 ests grouped into 34,829 unigenes , each one containing between 1 and 1087 ests , with an average of 6.9 ests per unigene ( data not shown ) .
unigenes can be formed by est sequences from any tomato race or species , although most unigenes ( 87 %) contain sequences from a single species ( figure 1 ) .
figure 1 number , origin and distribution of ests in the sgn unigene collection .
( a ) number of est included in the unigene collection at sgn divided by species of origin .
species names are followed by the number of ests found for each species .
other species include s. lycopersicoides , s. cheesmaniae , s. peruvianum and s. pimpinellifollium .
( b ) number of unigenes with ests from the species analyzed in this work .
we mined sequence assemblies of s. lycopersicum ( l ) ests for intraspecific polymorphisms and assemblies containing sequences from both s. lycopersicum and s. habrochaites ( lxh ) or s. lycopersicum and s. pennellii ( lxp ) for interspecific snps .
to reduce the complexity of each analysis we reassembled the unigenes using only ests from the species relevant to the analysis .
the consensus sequence for each reassembled contig was then aligned to the original unigene sequence and , when available ( 88.89 % of the unigenes , data not shown ) , to the predicted coding sequence ( cds ) .
in the cases where a predicted cds was available , each nucleotide in the assembly was annotated as 5 ' utr , cds or 3 ' utr .
we assigned quality scores to each position in the assemblies by calculating separately for each species the sum of the qualities of all nucleotides at that particular position .
several filters were applied to diminish the number of false positive snps predicted in our analyses .
assembly regions that did not align with unigene sequences were removed .
we also discarded positions where only a single sequence was found and , in the interspecific analyses , assembly regions where sequences from only one of the species assayed were detected .
using the remaining portions of the assemblies we determined an optimum quality threshold for each analysis at which the average sequence quality was maximized ( see methods , figure 2 ) .
assembly positions that did not pass the quality threshold were removed , leaving for snp mining a total of 4,712 unigenes spanning 1,736 kb of interspecific assemblies and 19,159 unigenes including 11,058 kb of intraspecific s. lycopersicum data ( table 1 ) .
table 1 unigenes , snps , and snp rates analysis lxp lxh l cds utr na cds utr na cds utr na unigenes analyzed 2249 2463 19159 kb analyzed 504.9 116.8 21.5 860.1 203.6 29.7 8446.3 1962.1 649.6 3728 / 1104 / 8457 / 3501 / 349 / 14455 / 8229 / 919 / snps / indels 206 534 92 / 30 614 1611 64 1980 3006 221 unigenes with snps 1341 1934 5084 snp rate 0.8852 1.3349 0.2605 snp rate per region 0.779 1.4025 0.5682 1.0546 2.5107 1.3925 0.1946 0.5726 0.1755 only nonconsecutive snps are displayed .
na - gene region is not available for unigenes in which a cds could not be predicted .
snp rates are calculated as the number of snps per 100 bp. figure 2 quality threshold estimation .
est assemblies were analyzed at different quality thresholds by removing those positions of the assemblies whose sum of qualities were below the threshold ( see methods ) .
the average quality of the sequences in the remaining positions was plotted ( y - axis ) against the range of quality thresholds tested ( x - axis ) .
l - s. lycopersicum assemblies , lxh - assemblies including s. habrochaites and s. lycopersicum ests , lxp - assemblies including s. lycopersicum and s. pennellii ests .
maximum average sequence quality is achieved with thresholds of 40 for lxh and lxp and 50 for the l assemblies .
in every analysis the majority of nucleotides assembled were located in predicted coding regions. between 2.8 and 6.2 % of the positions could not be assigned to a gene region due to the lack of predicted cds ( table 1 ) .
the average quality of the nucleotides considered in the assemblies was always highest in the 5 ' regions and lowest in the 3 ' regions ( figure 3 ) .
this could be explained by the bias towards sequencing the ests from the 5 ' , as an average of 95.87 % of the sequences from each library were readings from the top strand ( data not shown ) .
interestingly , assemblies from unigenes for which there is no predicted cds had overall average qualities similar to the 5 ' region ( figure 3 ) .
this raises the possibility that those unigenes contain mostly 5 ' utr sequence , in turn explaining why estscan [ 29,30 ] was not able to predict a cds .
figure 3 differences in average sequence quality between gene regions .
average quality of the sequences mined for snps in each analysis grouped by estimated gene region .
error bars represent standard deviation .
lxp - assemblies including s. lycopersicum and s. pennellii ests , lxh - assemblies including s. habrochaites and s. lycopersicum ests , l - s. lycopersicum assemblies .
snp mining we mined the resulting sequence assemblies for nonconsecutive snps taking into account the position of the snp with respect to the predicted gene regions .
in total 40,834 substitutions and 8,266 insertions / deletions ( indels ) were detected ( summarized in table 1 ; see additional files 1 , 2 , 3 & 4 for full data ) .
several observations confirm the performance of our snp detection algorithms .
as shown in table 1 , indels appear between 2.6 and 8.7 times more frequently in utrs than in the cds .
insertion and deletion of nucleotides are likely to produce changes in the open reading frames disrupting correct translation , therefore selection against them is expected in coding regions .
similarly , predicted noncoding regions yielded between 1.8 and 2.9 times more snps per kilobase analyzed than coding regions ( table 1 ) , as reported in previous tomato analyses [ 15,19,23,25 ] .
we next used the estimated cds for each unigene to calculate the codon position for each snp .
in translated regions the majority of the mutations are located in the third position of the codon ( figure 4 ) .
this result was expected since selective pressure in coding regions reduces the number of non - synonymous substitutions and the redundancy of the genetic code is mainly in the third base of the codons .
we then calculated hypothetical codons in the utrs by extending the orf from the origin of transcription in the predicted cds .
the third position bias disappeared in these hypothetical noncoding regions ( figure 4 ) suggesting that on average the snp , cds , and codon position predictions are accurate .
in addition , when looking at all snps in coding regions together , the percentage of non - synonymous snps is 46.37 % , similar to genome - wide analyses in arabidopsis ( 45.34 %) [ 31 ] and humans ( 46.46 %) [ 32 ] .
figure 4 percentage of polymorphism in each codon position .
percentage of total snps found at each codon position in the assayed regions .
( a ) assembly positions falling in predicted coding regions were assigned to the first , second or third codon positions .
the percentage of non - consecutive snps found in each codon position is shown .
( b ) codon positions in the utrs were calculated by extrapolating the predicted orf , and the percentage of non - consecutive snps found in each hypothetical codon position is shown .
regarding the differences between intra and interspecific analyses , we found only 26.5 % of the analyzed loci to be polymorphic when mining a single species versus the 69.5 % when analyzing pairs ( table 1 ) .
for interspecific analysis the snp rates were comparable to those published before between s. pennellii and s. lycopersicum ( 1.02 to 1.61 snps / 100 bp ) making no distinction between coding and non coding regions [ 14,33 ] .
the same holds true for s. lycopersicum intraspecific analyses , where reported snp rates range between 0.0117 and 0.585 snps / 100 bp on all est sequences analyzed regardless of their location in the gene [ 14 - 16,25 ] .
snp representation in gene ontology classes we reasoned that certain gene families might be more variable among tomato cultivars and species than others .
for example , since tomato species are adapted to diverse environments , genes involved in environmental response might accumulate a higher number of non - synonymous snps due to selection .
we used gene ontology ( go ) categories [ 34 ] , which group genes into functionally related classes , to assess the differential polymorphic rates of unigenes encoding specific classes of proteins .
we assigned go categories to each nucleotide position in the assemblies based on the closest arabidopsis thaliana homolog , and looked for categories with over - or under - representation of non - synonymous snps .
to achieve higher power we grouped together the data from the interspecific analyses .
the larger number of sequences available in the intraspecific analysis allowed greater statistical power , although the most over - and underrepresented gene classes are in agreement in both analyses ( figure 5 ) .
as expected , go categories related to environment interaction , such as responses to stress and abiotic stimulus , had an over - representation of non - synonymous polymorphisms both between and within species ( p < 0.001 , figure 5 ) .
on the other hand , categories involved in basic biological processes and transcription regulation showed a relative lack of polymorphisms , as had been found in arabidopsis thaliana accessions [ 31 ] .
surprisingly , genes encoding ribosomal proteins also presented more snps that expected , perhaps due to the challenge of distinguishing homologs from paralogs in this gene family , which shows complex patterns of copy number variants in arabidopsis [ 35 ] .
figure 5 polymorphism occurrence by gene ontology categories .
go over - and under - representation was calculated using the number of non - synonymous snps and the total number of nucleotides analyzed in predicted coding regions .
interspecific analysis was performed pooling the unigenes from the lxh and the lxp analyses as described in methods .
red boxes indicate over - representation of snps in a specific go category at p < 0.05 and blue boxes under - representation at p < 0.05 .
mcdonald - kreitman test the neutral evolution theory holds that most within species polymorphisms and between species differences have little fitness consequence [ 36 ] .
as a result , the ratio of non - synonymous to synonymous substitutions should be similar for a particular gene both within and between species .
deviations from this can be a sign of non - neutral evolution [ 26 ] .
to examine this prediction , we constructed alignments of the wild and cultivated consensus sequences containing only the good quality positions and the snps predicted by our algorithms , and surveyed each alignment for signatures of positive selection using the mcdonald - kreitman test [ 26 ]. with this method we tested 1425 unigenes from the s. lycopersicum and s. habrochaites analysis and 924 unigenes from the s. lycopersicum and s. pennellii analysis .
before correction for multiple testing we found significant excess of non - synonymous mutations ( p < 0.05 ) in 16 unigenes in the lxh analysis and 3 unigenes in the lxp analysis ( data not shown ) .
however , none of those unigenes survived the benjamini and hochberg correction for multiple testing [ 37 ] .
maximum likelihood codon - substitution models the mcdonald - kreitman test compares variation between and within two species .
an alternative approach is to simultaneously analyze all the sequences in a phylogenetic tree [ 38 ] .
following this method , we surveyed the unigenes for signals of positive selection using maximum likelihood estimates from codon - substitution models [ 27,28 ] .
we reasoned that genes important for domestication might show a higher rate of non - synonymous to synonymous substitutions specifically in the s. lycopersicum lineage .
to test this idea , we fit two different models for each unigene using alignments of the coding regions from cultivated tomato , arabidopsis thaliana and s. habrochaites or s. pennellii .
one of the models used assumed similar non - synonymous / synonymous rates ( dn / ds ) in every branch of the evolutionary tree ( one - branch rate model ) .
the second model allowed for different dn / ds estimates in the branch leading to s. lycopersicum relative to the rest of the tree ( two - branch rates model ) .
for each gene we used a likelihood ratio test to ask if the two - branch model fit significantly better than the one - branch model .
support for two - branch rates is suggestive of directional selection on the branch leading to domesticated tomato , therefore raising the possibility of identifying genes important for domestication [ 38 ] .
alternatively , s. lycopersicum - specific dn / ds ratios could occur due to natural selection acting after the s. lycopersicum lineage split from s. pennellii or s. habrochaites but before domestication .
we were able to test 1682 unigenes from the s. lycopersicum and s. habrochaites analysis and 1384 unigenes from the s. lycopersicum and s. pennellii analysis. from those , 9 and 1 unigenes respectively presented evidence of elevated non - synonymous substitution rates on the branch leading to s. lycopersicum after correction for multiple testing ( table 2 ) , suggesting these genes as possible targets of selection during domestication .
we cannot discard , however , the possibility that some or all of these genes have an excess of fixed polymorphisms in the cultivated tomato lineage due to a population bottleneck during domestication [ 39 ] , or because of the effect of natural selection due to differing environments .
among these genes we found that the three go categories most represented were responses to abiotic and biotic stimulus , responses to stress and protein metabolism .
this finding is in concordance with our analysis of snp over - representation in gene families .
table 2 unigenes under positive selection detected by the likelihood codon substitution models .
analysis unigene annotation1 p - value2 sites3 dn / ds4 dn / ds 15 dn / ds 26 lnl7 lnl28 lxh sgn - u314303 aldehyde dehygrogenase 0.00132 491 0.0665 0.0343 998.99 - 3184.6 - 3173.1 lxh sgn - u317105 unknown protein 0.00132 286 0.2677 0.0058 145.99 - 1821.6 - 1810.1 lxh sgn - u315058 tropinone reductase 0.00211 275 0.1361 0.0836 998.99 - 1902.2 - 1891.5 lxh sgn - u315796 alcohol dehydrogenase 0.00276 399 0.0924 0.0036 0.35 - 2899.9 - 2890.1 lxh sgn - u317449 fe ( ii )/ ascorbate oxidase 0.00276 441 0.0569 0.0019 193.75 - 2443.7 - 2433.8 lxh sgn - u317968 hypothetical protein 0.00276 253 0.2771 0.0053 3.34 - 1058.9 - 1049.1 lxh sgn - u319889 putative kinesin light chain 0.00941 437 0.1566 0.0032 121.86 - 1966.2 - 1957.8 lxh sgn - u314953 unknown protein 0.01001 176 0.2633 0.0485 998.99 - 1305.9 - 1297.6 lxh sgn - u318509 hypothetical protein 0.03006 547 0.1026 0.0172 0.52 - 2158.9 - 2151.8 lxp sgn - u314632 ubiquitin extension protein 2 / 60s ribosomal protein l40 0.00099 155 0.0580 0.0017 998.99 - 512.5 - 500.2 lxp - s. lycopersicum and s. pennellii analysis , lxh - s. lycopersicum and s. habrochaites analysis .
1annotation - based on the annotation from the best blast hit in arabidopsis thaliana .
2 p - value - multiple testing corrected p - values for the differences in the maximum likelihood estimates of the two models fit .
3 sites - number of codons analyzed , 4 dn / ds - dn / ds for the model where one dn / ds ratio is estimated for the entire evolutionary tree .
5 dn / ds 1 - dn / ds for the non s. lycopersicum lineages in the model where a different dn / ds ratio is estimated for the branch leading to s. lycopersicum .
6 dn / ds 2 - dn / ds for the s. lycopersicum lineage in the model with two dn / ds ratios .
the very high dn / ds ratios observed for some genes are a consequence of relatively little diversity between wild and domesticated tomato and are likely to be an overestimate of the true rate .
7 lnl - likelihood estimate for the model with one dn / ds ratio .
8 lnl2 - likelihood estimate for the model with two dn / ds ratios .
molecular marker design using the information gathered from the assemblies we developed a set of molecular markers for detecting the predicted snps .
successful design of pcr based molecular markers from est sequences requires the ability to avoid amplifying introns .
since many arabidopsis intron positions are conserved in tomato [ 23 ] , we used this information ( see methods ) to inform the design of molecular markers for the polymorphisms identified in the interspecific analyses .
first , we tested our intron predictions by designing three primer pairs surrounding predicted introns .
one of those produced a band 700 bp greater than expected without introns and the other two did not amplify , suggesting the existence of introns where predicted ( data not shown ) .
we did not carry out similar analysis for the intraspecific snps due to the lack of information within sgn regarding the s. lycopersicum accessions used .
although it is well known that s. lycopersicum ests in sgn come from several cultivars , the information for each individual est library is not available .
for each high - quality , interspecific snp we developed a database containing suggested primers to amplify the snp region , restriction enzymes to detect the polymorphism , and predicted fragment sizes before and after digestion of each allele .
this information can be accessed at http :// www.plb.ucdavis.edu / labs / maloof / tomatosnp / index.html .
we validated a subset of markers by using 491 primer pairs designed to amplify fragments from s. lycopersicum and from s. pennellii , s. habrochaites , or both .
we calculated the size differences between the amplified products cut with the appropriate restriction enzymes when needed or uncut in the case of indels. from the 491 primer pairs , 6 pairs amplified fragments that were smaller than expected and were discarded .
another 48 pairs failed to amplify fragments in at least one species , leaving us with 437 primer pairs that would test 281 polymorphisms between s. lycopersicum and s. habrochaites and 228 polymorphisms between s. lycopersicum and s. pennellii .
among these , 30 primers pairs yielded bands that were bigger than expected , probably due to the existence of non - conserved introns , nevertheless 23 of these were polymorphic as expected after restriction enzyme digestion .
for the remaining amplifications we found 87 % ( 220 of 261 lxh and 193 of 210 lxp ) of the molecular markers to work as predicted .
it is worth noting that 10 % of the successful markers showed bands corresponding to both alleles in at least one of the species tested , suggesting heterozygosity in the lines used or the amplification of fragments from a family of genes sharing that sequence .
markers that failed could be due to undetected snps in the sequence that modify the predicted restriction sites , or errors in snp prediction .
all tested markers are available in the additional file 5 .
conclusion we report in this work more than forty - nine thousand inter and intraspecific polymorphisms mined from the est databases of the cultivated and two wild species of tomato. by taking advantage of the additional information linked to each sequence we were able to more accurately estimate the quality and the position of each snp with respect to the coding region , which allowed us to distinguish those polymorphisms more likely to have phenotypic effects .
comparison of the sequences to homologs from better characterized species also allowed us to functionally classify the predicted unigenes and perform gene evolution analysis and tests for positive selection .
we were able to suggest candidate genes and gene families that may be related to domestication of the cultivated tomato and / or environmental adaptation of wild species , providing hypotheses for more involved evolutionary studies .
the information obtained was also used to design a set of markers that we make available to the community via a website .
to our knowledge this is the first time that substantial meta - information including quality values , open reading frame predictions and homology to genes in arabidopsis thaliana , has been used on tomato sequences to perform a pre - genomic analysis of gene variability and evolution .
methods sequence data fasta files containing version 200607 build 1 of the unigene sequences , est sequences , est qualities and estimated coding region for each unigene were downloaded from sgn .
ests in this database originated from the sequencing of at least 43 s. lycopersicum cdna libraries belonging to at least two different accessions , 2 s. pennellii and 2 s. habrochaites cdna libraries plus some individual cdnas .
unigenes are the consensus sequences of these ests assembled with cap3 software as described in [ 17 ] .
cdss for the unigenes were calculated by sgn with estscan software [ 29,30 ] .
this software returns an optimum open reading frame based on markov models and the nucleotide usage found in coding regions .
lukas mueller at sgn kindly generated a custom list of all the unigenes and their constituent ests .
the highest blast hit of every unigene versus the arabidopsis thaliana genome was bulk queried and downloaded from sgn .
arabidopsis thaliana sequences were downloaded from tair ( version 20080412 , http :// www.arabidopsis.org ) assembly construction we mined intraspecific snps in s. lycopersicum ( l ) ests and interspecific snps between s. lycopersicum and s. habrochaites ( lxh ) and between s. lycopersicum and s. pennellii ( lxp ) ests .
intraspecific analysis of s. pennellii and s. habrochaites ests were not performed as the est libraries for those species were developed from a single accession .
for each unigene we used cap3 with relaxed parameters ( - p 66 - b 99 - e 200 ) to assemble the est sequences from the species participating in each of the analyses into analysis - specific contigs .
using these assemblies we calculated the sum and average of the qualities for each nucleotide call at every position and obtained analysis - specific consensus sequences .
these consensus sequences were aligned to the original unigene sequence and the predicted cds to estimate the beginning and end of the coding region .
every step in this process was carried out and verified using custom perl scripts .
perl and r [ 40 ] scripts were developed to estimate the quality score thresholds for sequence inclusion in snp discovery .
once a threshold was determined we exclusively considered the positions in the assemblies above the threshold as follows .
for interspecific analyses we required the sum of all the qualities of the nucleotides from each species to be over the threshold .
for the intraspecific analysis we developed an algorithm that partitions all qualities at a given position into two groups with the minimum difference of the sums .
we then considered only those positions in the assemblies at which the sum of the qualities of both groups was over the threshold .
the threshold was defined as the quality score that maximizes the average sequence quality calculated separately for each species ( interspecific analyses ) , or for each group of qualities ( intraspecific analysis ) taking into account only those positions over the threshold ( figure 2 ) .
we determined a quality threshold score of 50 for the intraspecific s. lycopersicum analysis and of 40 for both interspecific analyses ( figure 2 ) .
snp discovery we defined snps in the intraspecific analysis as any assembly position where two and only two different bases were registered and for which the sum of qualities for each nucleotide call was over the quality threshold imposed for the analysis .
for the interspecific analysis we considered snps whose positions within the assemblies presented a single and different nucleotide call for each species , and whose sum of qualities was greater than the imposed quality threshold .
for quantification , snps that were consecutive in the assemblies were counted as a single polymorphisms .
snp rates were calculated as the number of non - contiguous snps per 100 bases .
amino acid translation , snp codon position and transitions / transversion ratios were evaluated with custom perl and r scripts that analyzed the est assemblies , the unigene sequence and the predicted cds sequences .
differential representation of snps in go terms each nucleotide in the est assemblies was assigned one or more go categories based on the terms from the homologous arabidopsis thaliana locus .
to increase the accuracy of the test , we used only the parts of the assemblies that corresponded to coding regions and only those snps that has been predicted to produce amino acid changes .
go categories text files ( version 20080712 ) were downloaded from tair [ 34 ] .
for the interspecific analyses , we pooled the nucleotide calls for both ( lxh and lxp ) analyses .
for duplicate loci we removed the locus with the shortest sequence .
r scripts were developed to calculate over and under - representation of snps in nucleotide pools of each go category versus all snps / nucleotides detected in the analysis using fisher 's exact test .
tests for selection we performed mcdonald - kreitman tests and estimated maximum likelihood from codon - substitution models on those unigenes that contained s. lycopersicum together with s. pennellii or s. habrochaites sequences .
for the mcdonald - kreitman test we built fasta files for each unigene with the estimated cds for the wild species alleles and two s. lycopersicum alleles differing in the snps identified in the l analysis .
to maintain the fidelity of the analysis , those positions that did not pass the quality threshold using the methods described above were substituted with the ' unknown ' character and not considered in the subsequent analysis .
the number of synonymous and non - synonymous substitutions and p - values were calculated using the previously described mk.pl perl script [ 41 ] .
two maximum likelihood codon - substitution models were fit to test the hypothesis of existence of positive selection in each unigene [ 27,28 ] .
first , we fit the null model with a single dn / ds ratio with equal ratios in every branch .
the second model allowed for two dn / ds ratios : one for the s. lycopersicum lineage and one for the rest of the tree .
then , a likelihood ratio test of the hypothesis of two branch rates was calculated by comparing the likelihood values from both models as in [ 42 ] .
to do this we created perl scripts that used clustalw [ 43 ] to align the cultivated and wild species predicted cds and the homologous arabidopsis thaliana coding sequences .
alignments whose sum of qualities were not over the imposed quality threshold were substituted with the ' unknown ' character .
we also removed the parts of the alignments that lacked sequences from any of the three species .
we constructed a phylogenetic tree of the three species and used paml ( v 3.14 [ 44 ]) to calculate the maximum likelihood of the models .
the resulting p - values from these experiments were corrected for multiple testing using the benjamini and hochberg algorithm in the bioconductor multtest package [ 37,45 ] .
molecular marker design for each polymorphic unigene in the interspecific analysis we aligned its predicted protein sequence with the protein sequence of its arabidopsis best blast hit using standalone blast and custom perl scripts .
we calculated intron positions in the unigene based on intron positions in the arabidopsis cds .
for each snp we designed primers using primer3 [ 46 ] with the unigene sequences as input , adjusting the program to design the primers within the predicted exon where the snp was located .
we used bioperl to generate virtual pcr fragments for each snp allele based on the primers designed , and to find restriction endonucleases that would differentially cut the fragments , thus creating molecular markers .
a set of these molecular markers was tested on genomic dna from s. lycopersicum vf36 , s. pennellii la716 and s. habrochaites la1347 .
touchdown pcr was performed in a mj research ptc - 200 thermocycler with a starting annealing temperature of 58degreesc , which decreased 0.5degreesc per cycle for 15 cycles and stayed constant at 55degreesc for 30 cycles .
extension time was 40 seconds and denaturizing steps were performed for 30 seconds at 96degreesc .
pcr products were digested with the appropriate restriction enzymes to detect the polymorphisms .
we developed a database and a website holding the molecular marker information for each interspecific snp .
all r and perl scripts are available by request .
abbreviations cds : coding sequence ; cos : conserved orthologous set ; est : expressed sequence tag ; go : gene ontology ; l : s. lycopersicum intraspecific analysis ; lxh : s. lycopersicum versus s. habrochaites interspecific analysis ; lxp : s. lycopersicum versus s. pennellii interspecific analysis ; orf : open reading frame ; pcr : polymerase chain reaction ; rflp : restriction fragment length polymorphism ; sgn : solanaceae genomics network ; snp : single nucleotide polymorphism ; utr : untranslated regions .
authors' contributions jmjg wrote the manuscript , conceived and designed the study and the website hosting the results .
jmjg also performed the assemblies , snp mining , evolutionary analysis and molecular marker design and essays .
jnm conceived and participated in the design of the study , and helped to draft the manuscript .
all authors read and approved the final manuscript .
supplementary material additional file 1 non - synonymous snps .
consecutive and non - consecutive non - synonymous polymorphisms .
" analysis " column , lxp : s. lycopersicum and s. pennellii interspecific analysis , lxh : s. lycopersicum and s. habrochaites interspecific analysis .
l : s. lycopersicum intraspecific analysis .
" position " indicates the nucleotide position in the unigene sequence from the sgn database .
" nt1 " and " nt2 " : nucleotide call ( reverse nucleotide if the sequence is in reverse orientation ) .
"# of seqs 1 " and "# of seqs 2 " : number of ests in the assembly with that nucleotide call .
" quality sum 1 " and " quality sum 2 " : sum of qualities of all nucleotides with that call .
" cds orientation " : u if plus strand , c if minus strand .
" codon 1 " and " codon 2 " : estimated codon including the snp , " amino acid 1 " and " amino acid 2 " : translation for codon 1 and codon 2 respectively .
for all headings " 1 " refers to cultivated tomato in every analysis whereas " 2 " indicates the wild species in the interspecific analyses and a second allele of cultivated tomato in the intraspecific analysis .
click here for file additional file 2 synonymous snps .
consecutive and non - consecutive synonymous polymorphisms .
legend as in additional file 1 click here for file additional file 3 snps affecting stop codons .
consecutive and non - consecutive polymorphisms causing premature stop codons or disrupting stop codons .
legend as in additional file 1 click here for file additional file 4 snps in utrs .
consecutive and non - consecutive polymorphisms located in the predicted utr regions .
" region " indicates if the snp was found in the 3 ' or 5 ' utr region .
other headings as in additional file 1 .
click here for file additional file 5 molecular markers experimentally tested .
molecular markers that returned amplification products both polymorphic and non - polymorphic .
" mns " , minimum number of sequences of any species at the snp position ; " mqs " , minimum average sequence quality at the snp position ( see methods ) .
in the column names , l stands for s. lycopersicum and w for the wild species s. pennellii or s. habrochaites .
" predicted _ restriction _ sizes " gives the sizes of the predicted fragments after digestion , separated by underscores if multiple bands are predicted .
" comments " : ' ok ' if the sizes were as expected , ' extra bands' if additional bands amplified in addition to the ones expected , ' good pattern ' if the sizes of the amplifications obtained were different than expected but the polymorphism was recognizable after restriction , ' het / gene family ' if at least one of the parents presented both alleles at the same time , or empty is the polymorphism was not found .
click here for file acknowledgements we thank lukas mueller for his very helpful information on the sgn datasets and for generating the list relating unigene and ests names .
we thank katherine s. pollard for her advice on the evolutionary analyses and dan koenig and matt jones for helpful comments on the manuscript .
thanks to the perlmonks for invaluable code and educational discussions on partition algorithms .
this work was supported by nsf pgrp grants dbi - 0227103 and dbi - 0820854 .
faostat http :// faostat.fao.org international solanaceae genomics project ( sol ) : systems approach to diversity and adaptation http :// www.sgn.cornell.edu / solanaceae - project / index.pl foolad mr genome mapping and molecular breeding of tomato int j plant genomics 2007 2007 64358 18364989 zamir d improving plant breeding with exotic genetic libraries nat rev genet 2001 2 12 983 989 10.1038 / 35103589 11733751 international tomato sequencing project home http :// www.sgn.cornell.edu / about / tomato _ sequencing.pl genechip ( r ) tomato genome array http :// www.affymetrix.com / products _ services / arrays / specific / tomato.affx tomato functional genomic database http :// ted.bti.cornell.edu / barone a chiusano ml ercolano mr giuliano g grandillo s frusciante l structural and functional genomics of tomato int j plant genomics 2008 2008 820274 820274 18317508 frary a xu y liu j mitchell s tedeschi e tanksley s development of a set of pcr - based anchor markers encompassing the tomato genome and evaluation of their usefulness for genetics and breeding experiments tag theoretical and applied genetics 2005 111 2 291 312 10.1007 / s00122 - 005 - 2023 - 7 areshchenkova t ganal mw comparative analysis of polymorphism and chromosomal location of tomato microsatellite markers isolated from different sources theor appl genet 2002 104 2 - 3 229 235 10.1007 / s00122 - 001 - 0775 - 2 12582691 bai y feng x hulst r van der lindhout p a set of simple pcr markers converted from sequence specific rflp markers on tomato chromosomes 9 to 12 molecular breeding 2004 13 3 281 287 10.1023 / b : molb.0000022535.82602.79 jimenez - gomez jm alonso - blanco c borja a anastasio g angosto t lozano r martinez - zapater jm quantitative genetic analysis of flowering time in tomato genome 2007 50 3 303 315 10.1139 / g07 - 009 17502904 rafalski a applications of single nucleotide polymorphisms in crop genetics curr opin plant biol 2002 5 2 94 100 10.1016 / s1369 - 5266 ( 02 ) 00240 - 6 11856602 yamamoto n tsugane t watanabe m yano k maeda f kuwata c torki m ban y nishimura s shibata d expressed sequence tags from the laboratory - grown miniature tomato ( lycopersicon esculentum ) cultivar micro - tom and mining for single nucleotide polymorphisms and insertions / deletions in tomato cultivars gene 2005 356 127 134 10.1016 / j.gene.2005.04.026 15975739 yang w bai x kabelka e eaton c kamoun s knaap e van den david f david f discovery of single nucleotide polymorphisms in lycopersicon esculentum by computer aided analysis of expressed sequence tags molecular breeding 2004 14 1 21 34 10.1023 / b : molb.0000037992.03731.a5 labate ja baldo a tomato snp discovery by est mining and resequencing molecular breeding 2005 16 4 343 349 10.1007 / s11032 - 005 - 1911 - 5 mueller la solow th taylor n skwarecki b buels r binns j lin c wright mh ahrens r wang y the sol genomics network : a comparative resource for solanaceae biology and beyond plant physiol 2005 138 3 1310 1317 16010005 10.1104 / pp.105.060707 fulton tm hoeven r van der eannetta nt tanksley sd identification , analysis , and utilization of conserved ortholog set markers for comparative genomics in higher plants plant cell 2002 14 7 1457 1467 12119367 10.1105 / tpc.010479 wu f mueller la crouzillat d petiard v tanksley sd combining bioinformatics and phylogenetics to identify large sets of single copy , orthologous genes ( cosii ) for comparative , evolutionary and systematic studies : a test case in the euasterid plant clade genetics 2006 174 3 1407 1420 16951058 10.1534 / genetics.106.062455 bauer p thiel t klatte m bereczky z brumbarova t hell r grosse i analysis of sequence , map position , and gene expression reveals conserved essential genes for iron uptake in arabidopsis and tomato plant physiol 2004 136 4 4169 4183 15531708 10.1104 / pp.104.047233 beraldi d picarella me soressi gp mazzucato a fine mapping of the parthenocarpic fruit ( pat ) mutation in tomato tag theoretical and applied genetics 2004 108 2 209 216 10.1007 / s00122 - 003 - 1442 - 6 nakitandwe j trognitz f trognitz b reliable allele detection using snp - based pcr primers containing locked nucleic acid : application in genetic mapping plant methods 2007 3 2 2 17286854 10.1186 / 1746 - 4811 - 3 - 2 van deynze ae stoffel k buell rc kozik a liu j knaap e van der francis d diversity in conserved genes in tomato bmc genomics 2007 8 1 465 18088428 10.1186 / 1471 - 2164 - 8 - 465 ehrenreich im purugganan md the molecular genetic basis of plant adaptation am j bot 2006 93 7 953 962 10.3732 / ajb.93.7.953 nesbitt tc tanksley sd comparative sequencing in the genus lycopersicon : implications for the evolution of fruit size in the domestication of cultivated tomatoes genetics 2002 162 1 365 379 12242247 mcdonald jh kreitman m adaptive protein evolution at the adh locus in drosophila nature 1991 351 6328 652 654 10.1038 / 351652a0 1904993 yang z swanson wj codon - substitution models to detect adaptive evolution that account for heterogeneous selective pressures among site classes mol biol evol 2002 19 1 49 57 11752189 yang z likelihood ratio tests for detecting positive selection and application to primate lysozyme evolution mol biol evol 1998 15 5 568 573 9580986 iseli c jongeneel cv bucher p estscan : a program for detecting , evaluating , and reconstructing potential coding regions in est sequences proc int conf intell syst mol biol 1999 138 148 10786296 lottaz c iseli c jongeneel cv bucher p modeling sequencing errors by combining hidden markov models bioinformatics 2003 19 suppl 2 ii103 112 14534179 clark rm schweikert g toomajian c ossowski s zeller g shinn p warthmann n hu tt fu g hinds da common sequence polymorphisms shaping genetic diversity in arabidopsis thaliana science 2007 317 5836 338 342 10.1126 / science.1138632 17641193 hinds da stuve ll nilsen gb halperin e eskin e ballinger dg frazer ka cox dr whole - genome patterns of common dna variation in three human populations science 2005 307 5712 1072 1079 10.1126 / science.1105436 15718463 suliman - pollatschek s kashkush k shats h hillel j lavi u generation and mapping of aflp , ssrs and snps in lycopersicon esculentum cell mol biol lett 2002 7 2a 583 597 12378264 ashburner m ball ca blake ja botstein d butler h cherry jm davis ap dolinski k dwight ss eppig jt gene ontology : tool for the unification of biology .
the gene ontology consortium nat genet 2000 25 1 25 29 10.1038 / 75556 10802651 woo hr richards ej natural variation in dna methylation in ribosomal rna genes of arabidopsis thaliana bmc plant biol 2008 8 1 92 18783613 10.1186 / 1471 - 2229 - 8 - 92 kimura m evolutionary rate at the molecular level nature 1968 217 5129 624 626 10.1038 / 217624a0 5637732 benjamini y hochberg y controlling the false discovery rate : a practical and powerful approach to multiple testing journal of the royal statistical society 1995 57 1 289 300 yang z computational molecular evolution 2006 new york : oxford university press rick c simmonds nw tomato lycopersicon esculentum ( solanaceae ) evolution of crop plants 1976 london : longman 268 273 r development core teamr : a language and environment for statistical computing 2009 vienna , austria holloway ak lawniczak mk mezey jg begun dj jones cd adaptive gene expression divergence inferred from population genomics plos genet 2007 3 10 2007 2013 17967066 10.1371 / journal.pgen.0030187 clark ag glanowski s nielsen r thomas pd kejariwal a todd ma tanenbaum dm civello d lu f murphy b inferring nonneutral evolution from human - chimp - mouse orthologous gene trios science 2003 302 5652 1960 1963 10.1126 / science.1088821 14671302 thompson jd higgins dg gibson tj clustal w : improving the sensitivity of progressive multiple sequence alignment through sequence weighting , position - specific gap penalties and weight matrix choice nucl acids res 1994 22 22 4673 4680 7984417 10.1093 / nar / 22.22.4673 yang z paml : a program package for phylogenetic analysis by maximum likelihood comput appl biosci 1997 13 5 555 556 9367129 gentleman rc carey vj bates dm bolstad b dettling m dudoit s ellis b gautier l ge y gentry j bioconductor : open software development for computational biology and bioinformatics genome biol 2004 5 10 r80 15461798 10.1186 / gb - 2004 - 5 - 10 - r80 rozen s skaletsky h primer3 on the www for general users and for biologist programmers methods mol biol 2000 132 365 386 10547847