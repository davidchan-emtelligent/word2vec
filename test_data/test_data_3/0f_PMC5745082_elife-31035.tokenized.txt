elife elife elife elife 2050 - 084x elife sciences publications , ltd 29280730 5745082 31035 10.7554 / elife.31035 tools and resourcescomputational and systems biologymicrobiology and infectious disease phenotype inference in an escherichia coli strain panel galardini marco http :// orcid.org / 0000 - 0003 - 2018 - 8242 marco @ ebi.ac.uk 1 koumoutsi alexandra http :// orcid.org / 0000 - 0001 - 8368 - 4193 alexandra.koumoutsi @ embl.de 2 herrera - dominguez lucia lucia.herrera @ embl.de 2 cordero varela juan antonio http :// orcid.org / 0000 - 0002 - 7373 - 5433 jacordero - ibis @ us.es 1 telzerow anja anja.telzerow @ embl.de 2 wagih omar wagih @ ebi.ac.uk 1 wartel morgane morgane.wartel @ embl.de 2 clermont olivier 34 denamur erick erick.denamur @ inserm.fr 345 typas athanasios typas @ embl.de 2 beltrao pedro http :// orcid.org / 0000 - 0002 - 2724 - 7703 pbeltrao @ ebi.ac.uk 1 1 european molecular biology laboratoryeuropean bioinformatics institute ( embl - ebi ) hinxtonunited kingdom 2 genome biology uniteuropean molecular biology laboratory ( embl ) heidelberggermany 3 inserm , iame , umr1137parisfrance 4 universite paris diderotparisfrance 5 aphp , hopitaux universitaires paris nord val - de - seineparisfrance barkai naama reviewing editor weizmann institute of scienceisrael 27 12 2017 2017 6 e31035 04 8 2017 13 12 2017 ( c ) 2017 , galardini et al 2017 galardini et alhttp :// creativecommons.org / licenses / by / 4.0 / this article is distributed under the terms of the creative commons attribution license , which permits unrestricted use and redistribution provided that the original author and source are credited .
understanding how genetic variation contributes to phenotypic differences is a fundamental question in biology .
combining high - throughput gene function assays with mechanistic models of the impact of genetic variants is a promising alternative to genome - wide association studies .
here we have assembled a large panel of 696 escherichia coli strains , which we have genotyped and measured their phenotypic profile across 214 growth conditions .
we integrated variant effect predictors to derive gene - level probabilities of loss of function for every gene across all strains .
finally , we combined these probabilities with information on conditional gene essentiality in the reference k - 12 strain to compute the growth defects of each strain .
not only could we reliably predict these defects in up to 38 % of tested conditions , but we could also directly identify the causal variants that were validated through complementation assays .
our work demonstrates the power of forward predictive models and the possibility of precision genetic interventions .
reference panel phenotypic diversity genotype to phenotype research organism e. coli http :// dx.doi.org / 10.13039 / 100005156alexander von humboldt - stiftungsofja kovaleskaja award typas athanasios http :// dx.doi.org / 10.13039 / 501100002915fondation pour la recherche medicaleequipe frm 2016 , deq20161136698 denamur erick the funders had no role in study design , data collection and interpretation , or the decision to submit the work for publication.author impact statementthe mechanistic impact of genetic variants can be combined with previous knowledge on gene function to deliver conditional growth predictions and pave the way for personalized genetic interventions .
introduction understanding the genetic and molecular basis of phenotypic differences among individuals is a long - standing problem in biology .
genetic variants responsible for observed phenotypes are commonly discovered through statistical approaches , collectively termed genome - wide association studies ( gwas , bush and moore , 2012 ) , which have dominated research in this field for the past decade .
while such approaches are powerful in elucidating trait heritability and disease associations ( yang et al. , 2010 ; welter et al. , 2014 ) , they often fall short in pinpointing causal variants , either due to lack of power to resolve variants in linkage disequilibrium ( edwards et al. , 2013 ) or for the dispersion of weak association signals across a large number of regions across the genome ( boyle et al. , 2017 ) .
furthermore , by definition gwas studies are unable to assess the impact of previously unseen or rare variants , which can often have a large effect on phenotype ( bodmer and bonilla , 2008 ) .
therefore , the development of mechanistic models that address the impact of genetic variation on the phenotype can bypass the current bottlenecks of gwas studies ( lehner , 2013 ) .
in principle , phenotypes could be inferred from the genome sequence of an individual by combining molecular variant effect predictions with prior knowledge on the contribution of individual genes to a phenotype of interest .
such knowledge is now readily available by chemical genetics approaches , in which genome - wide knock - out ( ko ) libraries of different organisms are profiled across multiple growth conditions ( kamath et al. , 2003 ; dietzl et al. , 2007 ; hillenmeyer et al. , 2008 ; nichols et al. , 2011 ; price et al. , 2016 ) .
one output of such screens are genes whose function is required for growth in a given condition ( also termed ' conditionally essential genes ') .
variants negatively affecting the function of those genes are likely to be associated with individuals displaying a significant growth defect in that same condition .
this approach would then effectively be a way to prioritize variants with respect to their impact on the growth on a particular condition .
the impact of variants on gene function can be reliably inferred using different computational approaches ( thusberg et al. , 2011 ; kulshreshtha et al. , 2016 ) , which can offer mechanistic insights into how such variants impact on a protein 's structure and function .
as rare or previously unseen variants can also be used by this approach , there lies the possibility to deliver predictions of phenotypes at the level of the individual , with no prior model training .
combining variant effector predictors with gene conditional essentiality has been previously tested with some success in the budding yeast saccharomyces cerevisiae , but only on a limited number of individuals and conditions ( 15 and 20 , respectively , jelier et al. , 2011 ) .
given the continuous increase in genome - wide gene functional studies , there is an opportunity to apply such an approach more broadly .
in contrast to eukaryotes , diversity within the same bacterial species can result in two individuals differing by as much as half of their genomic content .
escherichia coli is not only one of the most studied organisms to date ( blount , 2015 ) , but also one of the most genetically diverse bacterial species ( lukjancenko et al. , 2010 ; tenaillon et al. , 2010 ) .
individuals of this species ( strains ) , exhibit a diverse range of genetic diversity , from highly homologous regions to large differences in gene content , collectively termed ' pan - genome ' ( medini et al. , 2005 ) .
phenotypic variability is therefore likely to arise from a combination of single nucleotide variants ( snvs ) and changes in gene content .
since gene conditional essentiality has been heavily profiled for the reference e. coli strain ( k - 12 , nichols et al. , 2011 ; price et al. , 2016 ) , here we set out to systematically test the applicability of such genotype - to - phenotype predictive models for this species .
we reasoned that it would also test the limits of the underlying assumption of this model , which is that the effect of the loss of function of a gene is independent of the genetic background ( dowell et al. , 2010 ) .
we therefore collected a large and diverse panel of e. coli strains ( n = 894 ) , for which we measured growth across 214 conditions , as well as obtained the genomic sequences for the majority of the strains ( n = 696 ) .
for each gene in each sequenced strain we calculated a ' gene disruption score ' by evaluating the impact of non - synonymous variants and gene loss .
we then applied a model that combines the gene disruption scores with the prior knowledge on conditional gene essentiality to predict conditional growth defects across strains .
the model yielded significant predictive power for 38 % of conditions having a minimum number of strains with growth defects ( at least 5 % of tested strains ) .
we independently validated a number of causal variants with complementation assays , demonstrating the feasibility of precision genetic interventions .
since our predictions did not apply equally well for all conditions , we conclude that the set of conditionally essential genes has diverged substantially across strains .
overall , we anticipate that the e. coli reference panel presented here will become a community resource to address the multiple facets of the genotype to phenotype research , ultimately enabling the development of biotechnological and personalized medical applications .
results the phenotypic landscape of the e. coli collection we have assembled a large genetic reference panel of 894 e. coli strains able to capture the genetic and phenotypic diversity of the species .
these are broadly divided into natural isolates ( n = 527 ) and strains derived from evolution experiments ( n = 367 ) .
out of these , 321 had available genome sequences , and we obtained the genomes of additional 375 , reaching a total of 696 strains .
the full list of strains , including name , collection of origin and links to relevant references is provided in supplementary file 1 and online at https :// evocellnet.github.io / ecoref .
to test our capacity to develop genotype - to - phenotype predictive models we measured the fitness of this strain collection on a large variety of conditions ( n = 214 ) .
we used high - density colony arrays and measured colony size as a proxy for fitness , similar to what has been applied before for the e. coli k - 12 knockout ( ko ) library ( nichols et al. , 2011 ) .
we used the deviation of each strain 's colony size from itself across all conditions and all other strains in the same condition as our final phenotypic measure ( collins et al. , 2006 ) .
thereby we obtained a list of conditions for which we know whether a tested strain has grown significantly less than the expectation ( figure 1a and materials and methods ) .
both biological replicates ( figure 1b ) and strains present in two distinct plates ( figure 1 - - figure supplement 1 ) were positively correlated ( pearson 's r 0.693 and 0.648 , respectively ) , indicating that we measured phenotypes with high confidence .
clustering of conditions based on phenotypic profiles across all strains was consistent with the conditions macro - categories ( e.g. stresses versus nutrient sources ) and with the number of sensitive strains ( figure 1c ) .
the correlation of phenotypic profiles also clustered drugs with same mode of action ( moa ) , as shown by comparing the clusters' purity against those of random clusters ( figure 1d ) .
the full phenotypic matrix for each strain across all conditions contains 114,004 single measurements ( supplementary file 1 ) .
10.7554 / elife.31035.002 figure 1 .
the phenotypic landscape of the e. coli strain collection .
( a ) phenotypic screening experimental design and data analysis .
( b ) phenotypic measurements replicability , as measured by pairwise comparing the s - scores of all three biological replicates .
( c ) hierarchical clustering of condition correlation profiles ; the threshold is defined as the furthest distance at which the minimum average pearson 's correlation inside each cluster is above 0.3 .
the two colored bands on top indicate the number of strains with growth defects for each condition and its category , showing consistent clustering .
gray - colored cells in the matrix represent missing values due to poor overlap of strains tested in the two conditions .
( d ) clusters purity ( computed for drug targets ) for each hierarchical distance threshold , against that of random clusters ( 100 repetitions ) shows that drugs with similar target tend to cluster together .
( e ) pearson 's correlation between phylogenetic and phenotypic distances , based on phylogenetic independent contrasts ( see materials and methods ) .
( f ) core genome snp tree for all strains in the collection .
grey shades in the inner ring indicate the number of conditions tested for each strain , red shades in the outer ring indicate the proportion of tested conditions in which the strain shows a significant growth defect .
the black arrow indicates the reference strain .
10.7554 / elife.31035.003 figure 1 - - figure supplement 1 .
phenotypic measurements reproducibility and correlation with genetic distance .
( a - c ) s - scores for each replicate are compared against each other ( d ) s - scores comparison between strains present in multiple 1536 plates .
if all genetic variants were to contribute to phenotypic divergence between strains we would expect to observe a strong positive correlation between those two metrics .
this was not the case even when taking into account the phylogenetic dependencies between strains ( r = 0.07 , see materials and methods ) .
this finding reinforces the idea that most variants across these strains have a neutral impact on their phenotypes. of particular interest are those strains derived from evolution experiments , such as the members of the ltee collection ( tenaillon et al. , 2016 ) .
while most strains ( 189 out of 266 tested ) grew as expected in all tested conditions , a significant fraction ( n = 77 ) exhibited at least one conditional growth defect phenotype .
again , the phylogenetic distance from the parental strains ( rel606 and rel607 ) is not correlated with the proportion of growth phenotypes ( pearson 's r : 0.08 ) , even though hypermutators exhibit a slightly higher number of phenotypes ( cohen 's d : 0.513 ) .
these results clearly underline that simple metrics of phylogenetic similarity are not predictive of differences in phenotype .
instead , few dna variants are sufficient to cause clear phenotypic differences , indicating the importance of statistical or predictive strategies to prioritize those variants .
in toto , we have assembled an e. coli reference strain panel , which we have broadly phenotyped .
this phenotyping resource recapitulates known biology , surveying a rich phenotypic space and providing insights into the evolution of phenotypes within the species .
gene level predictions of variant effects as most dna variants are likely to be neutral in their impact on gene function , variant effect predictors are required to build phenotype predictive models for each strain .
for this we derived structural models and protein alignments covering 60.2 % and 94.7 % of the e. coli k - 12 proteome , respectively ( or 50.9 % and 95.9 % of all protein residues ) and used them to compute the impact of all possible nonsynonymous variants ( see materials and methods , available at http :// mutfunc.com ) .
the impact of multiple non - synonymous variants within a gene was then combined using a probabilistic approach ( jelier et al. , 2011 ) , into a single likelihood measure of gene disruption ( here termed ' gene disruption score ' , figure 2a and materials and methods ) .
we also assumed that reference genes missing completely from a strain would have a high gene disruption score .
10.7554 / elife.31035.004 figure 2 .
the ' gene disruption score ' , a gene - level prediction of the impact of genetic variants .
( a ) schematic representation of how all substitutions affecting a particular gene are combined to compute the gene disruption score .
( b ) average gene disruption score across all strains for four categories of genes conserved in all strains (' core genome ') .
conserved genes are defined as those genes found in more ( or less ) than 95 % of the bacterial species present in the eggnog orthology database ( huerta - cepas et al. , 2016a ) .
statistically significant differences ( cohen 's d value > 0.3 ) are reported .
( c ) gene - gene correlation profile of gene disruption across all strains shows clusters of potentially functionally related proteins .
( d - e ) the gene disruption profiles as a predictor of genes function .
( d ) pairwise correlation of gene disruption scores inside each annotation set ( colored boxes ) and inside a random set of genes of the same size ( grey boxes ) .
( e ) gene - gene correlation profile of gene disruption scores in protein complexes ; shown here a subset with high disruption score correlation .
10.7554 / elife.31035.005 figure 2 - - figure supplement 1 .
additional properties of the gene disruption score .
( a ) correlation between phylogenetic distance from the reference strain and average disruption across all reference genes .
( b ) significant reduction in correlation after correction of the disruption score ( see materials and methods ) .
( c - e ) prediction of gene functional associations using disruption score profiles .
( c ) roc curve using disruption score profiles across all genes .
( d - e ) higher predictive power of the gene disruption profile when restricted to accessory genes , including ( d ) or not ( e ) the information about gene presence absence .
10.7554 / elife.31035.006 figure 3 .
prediction of growth - defect phenotypes in the e.coli strain collection .
( a ) schematic representation of the computation of the prediction score and its evaluation ; for each condition the predicted score is computed using the disruption score of the conditionally essential genes .
the score is then evaluated against the actual phenotypes through a precision - recall curve .
( b ) higher predictive power for conditions with higher proportion of growth phenotypes .
for each condition set , the pr - auc value for each condition is reported , together with the median and mean value ( c ) significance of the pr - auc value reported for the condition ' clindamycin 3 mug / ml ' , against the distribution of three randomization strategies .
' shuffled strains' indicates a prediction in which the actual strains' phenotypes have been shuffled ; ' shuffled sets' indicates a prediction where the conditionally essential genes of a different condition have been used , and ' random set ' indicates a prediction where a random gene set has been used as conditionally essential genes .
for all three randomizations we report a significant difference between the actual prediction and the distribution of the randomizations ( q - values of 1e - 30 , 0.05 and 1e - 22 , respectively ) .
see figure 3 - - figure supplement 2 for the other conditions .
( d ) genome - wide gene associations are in agreement with the predictive score ; the enrichment of conditionally essential genes in the results of the gene association analysis is significantly higher in conditions with higher pr - auc .
10.7554 / elife.31035.007 figure 3 - - figure supplement 1 .
detailed view of the predicted growth score and its properties .
( a ) influence of the different predictors of the impact of mutations on each condition pr - auc .
' snps' indicates single nucleotide variants only , ' accessory genome ' gene presence - absence patterns , ' all predictors' the combination of both , plus stop codon substitutions .
( b - c ) proportion of well - predicted conditions ( pr - auc >= 0.1 and pearson 's fdr - corrected p - value <= 0.01 ) over total conditions with at least 1 % and 5 % sick strains .
marker 's size is proportional to the - log10 of the fdr - corrected p - value .
( e ) conditions with higher predictive power ( measured as pr - auc ) also have an enrichment of sick strains at the top of the predicted score , as measured by the gene set enrichment analysis ( gsea ) ; sick strains are used as ' gene sets ' .
a pseudocount of 10 - 4 has been added to the gsea p - values .
( f ) prediction performance improves when using the weighting scheme to account for conservation of gene essentiality , especially for well - predicted conditions .
10.7554 / elife.31035.008 figure 3 - - figure supplement 2 .
significance of the pr - auc value reported for all conditions with at least 5 % of the tested strains showing a sick phenotype , against the distribution of three randomization strategies .
' shuffled strains' indicates a prediction in which the actual strains' phenotypes has been shuffled ; ' shuffled sets' indicates a prediction where the conditionally essential genes of a different condition have been used , and ' random set ' indicates a prediction where a random gene set has been used as conditionally essential genes .
conditions are ordered by the significance of the difference between the actual prediction and the ' random genes' bootstrap .
the proportion of conditions where the actual prediction is significantly different than the randomizations ( q - value < 0.05 ) are 52 % , 21 % and 33.3 % for the ' shuffled strains ' , ' shuffled sets' and ' random genes' randomizations , respectively .
10.7554 / elife.31035.009 figure 4 .
detailed example on the computation and evaluation of the predicted score on two conditions .
( a ) precision - recall curve for the two example conditions .
dashed lines represent the average precision - recall curve for the same predictions carried out using 10'000 random gene sets of the same size of the actual conditionally essential genes for both conditions .
vertical lines represent the mean absolute deviation for the precision across the randomizations .
the two randomization sets are significantly different than the actual predictions ( q - values of 1e - 33 and 0.02 , respectively ) .
( b ) receiver operating characteristic curve for the two example conditions .
dashed lines represent the same randomizations as in ( a ) .
( c - d ) for each condition , the gene disruption score for the conditionally essential gene across all strains is reported , together with the resulting predicted conditional score and actual binary phenotypes ( pale red : healthy and red : growth defect ) .
strains are sorted according to the predicted conditional score , while genes are sorted according to their weight in the predictive model ; only the top 10 conditionally essential genes are shown .
the inset reports the disruption score , predicted score and actual phenotypes for the top 25 strains .
the gene disruption score can be considered as a relevant measure of the impact of mutations on gene function .
essential and phylogenetically conserved genes show lower average gene disruption scores across all strains , as compared to less conserved or random ones ( figure 2b ) .
we also observed that genes that are predicted to lose their function together across all strains ( figure 2c ) tend to be functionally associated ( figure 2d and e ) , in particular for genes belonging to the accessory genome ( i.e. genes not present in all strains , figure 2 - - figure supplement 1 ) .
these observations suggest that the gene disruption score is a biologically relevant measure of the impact of mutations at the gene level and that it could be used for growth phenotype predictions .
predictive models of conditional growth defects we combined the gene disruption scores for each gene in each strain with the genes' conditional essentiality to obtain conditional growth predictive models .
for each condition , we evaluated the impact of those variants affecting the genes that are essential for that same condition in the reference k - 12 strain .
we selected 148 conditions in which at least one strain displayed a growth defect and the e. coli k - 12 ko collection had also been tested for ( nichols et al. , 2011 and herrera - dominguez et al. , unpublished ) .
for those , we computed a conditional score that would rank the strains according to their predicted growth level in the tested condition , from normal growth to the most defective growth phenotype ( see materials and methods ) .
briefly , if a strain has many detrimental variants in genes important for growth in a given condition , our predictive score will rank that strain as being highly sensitive in that condition .
we then compared this predicted ranking with the experimental fitness measurements .
the area under the curve of a precision - recall curve ( pr - auc ) was used for assessing our predictive power ( figure 3a and materials and methods ) .
we note that this predictive score is condition specific and no parameter fitting or training was used .
our predictive score is able to discriminate strains with normal growth from ones with growth defects with significantly higher power than randomized scores .
both the predicted impact of single nucleotide variants and gene presence / absence patterns contribute to the predictive power of the model ( figure 3 - - figure supplement 1 ) .
the predictive power increases for conditions in which more strains displayed growth defects ( figure 3b ) .
we verified the significance of our predictions through the comparison against three randomization strategies : shuffled strains , shuffled gene sets and random gene sets ( see materials and methods ) .
for all three strategies we observed a clear dependency between the pr - auc value and the significance of our predictions ( figure 3c and figure 3 - - figure supplement 2 ) .
since some conditions are similar and share a significant fraction of their conditionally essential genes , we sometimes observe a skew in the performance of the ' shuffled set ' randomizations ( figure 3c ) .
we correctly predicted 20 % of conditions that have at least 1 % of poorly growing strains , with higher predictive capacity for conditions with larger number of strains with growth defects , reaching 38 % for all conditions with more than 5 % of poorly growing strains ( figure 3 - - figure supplement 1 ) .
weighting the contribution of the conditionally essential genes to each condition also improved the predictive power , particularly for well - predicted conditions ( figure 3 - - figure supplement 1 , materials and methods ) .
to independently validate our predictive models , we carried out a gwas analysis based on genes presence / absence and the growth phenotypes .
consistent with the validity of our models , we found that for conditions we predict with higher confidence ( pr - auc >= 0.1 ) , there is a significant overlap between the k - 12 genes predicted to be essential in the condition and the genes associated with poor growth by the association analysis ( figure 3d , fisher 's exact test , p - value 0.005 ) .
we further examined two well predicted conditions ( pr - auc > 0.35 ) , pseudomonic acid 2 mug / ml ( the antibiotic mupirocin ) and minimal media with the addition of amino acid mix , to inspect our predictive model ( figure 4 ) .
both conditions showed an enrichment of strains with growth defects at high predicted scores ( gsea p - values of 0.001 and < 10 - 6 , respectively ) , which is a common property of conditions with higher pr - auc ( figure 3 - - figure supplement 1 ) .
the reference k - 12 strain harbors many conditionally essential genes in minimal media ( n = 181 ) , providing an example for which growth phenotypes are well predicted from deleterious effects across a large number of genes in different strains .
in contrast , pseudomonic acid is a condition with few ( n = 10 ) conditionally essential genes , thus making it easier to evaluate the contribution of single genes to the phenotype. of the 25 strains with highest predicted score in pseudomonic acid , 13 have been misclassified by the model .
seven misclassified strains had high disruption scores in either lpca or rfae , two genes involved in the biosynthesis of a lipopolysaccharide ( lps ) precursor ( l - glycero - beta - d - manno - heptose ) .
both , when deleted in k - 12 , cause a strong growth defect under pseudomonic acid .
only 1 of the correctly predicted strains had a mutation in one of those two genes ( iai36 ) , suggesting that this pathway might be conditionally essential only in k - 12 .
another example of incorrect predictions involves two strains ( ecor - 27 and ecor - 58 ) that share very similar disruption score profiles for the conditionally essential genes in pseudomonic acid ( figure 4c ) , but only ecor - 27 had a growth defect in this condition .
both strains harbor a single nonsynonymous mutation in acrb ( e414g for ecor - 27 and i466t for ecor - 58 ) , which , in both cases , is predicted as highly deleterious .
changes in conditional essentiality or epistatic effects are possible explanations for this misclassification , and therefore mapping and incorporating this information in our models could significantly benefit predictions in the future .
experimental validation of causal variants since we use mechanistic models in our phenotype predictions to calculate the impact of non - synonymous genetic variants , we can then also directly pinpoint the causal variants and implement genetic therapies to correct growth phenotypes .
we tested this by ranking the mutated conditionally essential genes in each condition according to their predicted ability to rescue growth phenotypes ( figure 5a and materials and methods ) .
several genes were predicted to restore many growth phenotypes ( figure 5b ) , including the genes forming the acrab - tolc multidrug efflux pump , which were predicted to restore growth in up to ~ 1000 condition - strain pairs ( 1012 acrb , 494 acra and 517 tolc , respectively ) , reflecting the importance of this efflux system in drug resistance ( li et al. , 2015 ) .
10.7554 / elife.31035.010 figure 5 .
experimental confirmation of the predicted phenotype - causing genotypes .
( a ) schematic representation of the experimental approach .
( b ) distribution of the number of predicted restored phenotypes per gene ; red stripes indicate the genes that were experimentally tested .
( c ) growth change between the target strain with the empty plasmid against the one expressing the reference copy of the target gene ( complementation ) .
strains for which a change in phenotype is predicted are compared to those where no change is predicted .
( d - f ) detailed representation of the results of the complementation experiment in three conditions .
mean colony area and the 95 % confidence intervals are reported .
significant differences ( t - test p - value < 0.01 ) between colony area of the strains with the empty and complemented plasmids are reported .
' other complementation ' reports strains expressing a different gene than the focal one , indicated between parenthesis .
( g ) cartoon representation of acrb 3d structure ( pdb entry : 2dr6 ) .
only one of the three monomers is highlighted in blue ; colored spheres represent known non - synonymous variants in the reported strains .
10.7554 / elife.31035.011 figure 5 - - figure supplement 1 .
detailed view of the experimental confirmation of the predicted phenotype - causing genotypes .
( a ) replicability in colony size ( measured in pixels ) after outer frame and spatial correction between the two replicates .
( b ) overview of the results of the complementation experiments .
mean colony area and the 95 % confidence intervals are reported .
significant differences ( t - test p - value < 0.01 ) between colony area of the strains with the empty and complemented plasmids are reported .
conditions chir090.mecillinam , mecillinnam and oxacillin.5um have been excluded from further analysis , as the deletion strain from the keio collection ( positive control ) does not show a sick phenotype with an empty plasmid .
we selected eight genes to experimentally verify our predictions , including genes involved in either drug resistance ( acrab , soxsr and slt ) or auxotrophic growth ( glnd and proab ) .
we then selected conditions for which the introduction of the reference allele in the target strains was predicted to restore growth , and controls where no improvement in phenotype was expected ( materials and methods ) .
we also introduced the plasmid expressing the reference allele in the reference strain as a negative control and in the corresponding deletion strain from the keio collection ( baba et al. , 2006 ) as a positive control .
overall , we observed a high correlation between replicates of this experiment ( pearson 's r : 0.94 , figure 5 - - figure supplement 1 ) .
in total , we tested 64 strain - condition combinations , detecting a significant difference ( p - value 8.4e - 11 , two - sided t - test ) in colony size change between strain - condition pairs in which we had predicted growth will be restored ( n = 14 ) versus ones we had not ( n = 50 ) ( figure 5c and materials and methods ) .
this validated the effectiveness of our predictive models and more generally confirmed that genetic variants can be used to predict causal mutations and prioritise strategies for reverting / modifying phenotypes .
we investigated three conditions in more detail : pseudomonic acid 2 mug / ml with an acrb complementation , pyocyanin 10 mug / ml ( a toxic secondary metabolite produced by pseudomonas aeruginosa ) with a soxsr complementation and the l - glutamine amino acid as nitrogen source with a proab complementation ( figure 5d - f and figure 5 - - figure supplement 1 for all conditions and strains ) .
in all cases , strains harboring the gene ( s ) predicted to restore the phenotypes grew significantly better than strains carrying the empty plasmid ( t - test p - value < 0.01 ) .
in contrast , none of the strains harboring a different complementation gene showed a significant increase in colony size .
in one case we detected an unexpected increase in colony size for one of the strains where we had n't predicted any change ( strain iai39 expressing acrb , figure 5d ) .
we hypothesize that the original growth phenotype is either due to an incorrectly classified variant in acrb or due to another variant that acts on the expression of this efflux pump. of the five strains expressing the reference allele of acrb tested in pseudomonic acid , three harbored nonsynonymous variants in their chromosomal copy .
one of them ( iai30 ) was predicted to increase its colony size after the complementation , whereas the other two ( ecor - 42 and ecor - 28 ) were not predicted to be affected by the complementation ( figure 5d ) .
we mapped those nonsynonymous variants to the three - dimensional structure of acrb ( murakami et al. , 2006 ) to inspect their potential impact on the protein function ( figure 5g ) .
both ecor - 42 and ecor - 28 harbor a single deleterious nonsynonymous variant ( sift , p - value ~ 0.01 ) in the transmembrane domain of the protein ( a915d and t1013i , respectively ) .
strain iai30 on the other hand carries two nonsynonymous variants : e567v and h596n , both located in the acrb pc1 subdomain , which is involved in the entry of the ligand that will be then extruded by the efflux pump ( murakami et al. , 2006 ; seeger et al. , 2006 ) .
since the e567v variant is predicted to be highly deleterious ( sift , p - value ~ 0.001 ) , we presume that it impairs the fundamental drug uptake function of the acrab - tolc multidrug efflux pump , while the variants in the other two strains might not be significantly affecting the pump 's function .
this example shows how mechanistic interpretations of the impact of genetic variants can direct insights into the emergence of fitness defects and suggest potential gene therapeutic strategies , down to the level of the single genetic variant .
discussion as part of this study , we have assembled and phenotyped a large , phylogenetically diverse e. coli resource strain collection .
we observed little to no correlation between genotypic and phenotypic distance across strains .
this demonstrates the need of assessing the impact of genetic variability as most variants are likely to be neutral .
we combined these mechanistic interpretations of the impact of non - synonymous variants in the genomes of all these strains with prior knowledge on e. coli k - 12 gene conditional essentiality to predict conditional growth defects of strains in the collection .
this resulted in reliable predictions for up to 38 % of the tested growth conditions .
our mechanistic - based model directly pinpoints the causal variants and allows us to design successful genetic therapies , something that is often the bottleneck in traditional gwas approaches .
moreover , our approach opens up the door for predicting strain functional capacities in less studied microbes , such as those present in the human microbiome , with sole requirements being the strain genome sequence and knowledge of gene function in a model strain .
despite the significant predictive power , we still could not reliably predict the strains phenotypic response in a number of conditions .
epistatic interactions , the impact of synonymous variants , variants in non - coding regions and the large accessory genome are four possible factors influencing phenotypic diversity .
models that account for these factors could therefore be required for more accurate predictive models .
as compared to the previous application of this method to s. cerevisiae strains ( jelier et al. , 2011 ) , we observed a lower overall accuracy .
the larger and more diverse strains cohort , the higher diversity in conditions tested , including several concentrations for each chemical , and the larger genetic diversity in bacteria are potential causes for the differences we have observed .
most importantly , we postulate that conditional essentiality may not be conserved across strains and therefore that it interacts with each specific genetic background .
previous work in two closely related s. cerevisiae strains and five human cancer cell lines has shown that gene - specific phenotypes can diverge considerably ( ryan et al. , 2012 ; hart et al. , 2015 ) .
given their higher genetic variability , this genetic background dependence of gene - specific phenotypes is expected to be stronger in e. coli and other bacteria , even though this remains to be tested .
despite these limitations we believe that we have demonstrated how gene function assays and genetic variant prioritization can be leveraged to deliver growth predictions and genetic intervention strategies .
future iterations based on a more complete understanding on conservation of conditional essentiality should improve these predictions .
finally , we propose this strain collection as a valuable community resource to develop and test genotype - to - phenotype models , following the example of previous successful genetic reference panels ( ayroles et al. , 2009 ; liti et al. , 2009 ; bennett et al. , 2010 ; atwell et al. , 2010 ; 1001 genomes consortium , 2016 ; weinstein et al. , 2013 ; 1000 genomes project consortium et al. , 2015 ) .
any additional molecular and phenotypic measurement on the collection members will amplify the benefit for the entire research community , moving us closer to understanding the basic biological question of how genetic variation translates to differences among individuals .
materials and methods genome sequencing , assembly and annotation strains whose genome sequence were not yet available were sequenced using various illumina paired - end platforms ( supplementary file 1 ) .
the resulting sequencing reads were quality checked using fastqc version 0.11.3 , and contaminating sequencing adapters were removed using seq _ crumbs version 0.1.9 .
reads were assembled with spades ( bankevich et al. , 2012 ) version 3.5.0 , using different k - mer sizes according to reads length and with the ' careful ' option to reduce assembly errors ; contigs below 200 base pairs were excluded .
resulting assembled contigs were annotated for coding genes , ribosomal rnas and trnas using prokka ( seemann , 2014 ) version 1.11 .
strains not belonging to the e. coli species were excluded from subsequent analysis after being highlighted by kraken ( wood and salzberg , 2014 ) version 0.10.5 .
when available , typing information was used to spot incorrect genome sequences due to culture contaminations or other factors ; known strains typing was compared to the ones predicted from the genome sequence using mlst version 2.8 .
strain names were amended when possible ( see the ' notes' column in supplementary file 1 ) .
the ecor collection was carefully checked for inconsistencies , as it is well known that different ' versions' of this collection are circulating in the scientific community ( johnson et al. , 2001 ; clermont et al. , 2015 ) .
the genome sequences were further checked for duplicated genomes : strains with highly similar genomes but highly divergent phenotypes ( phenotypes s - score correlation below 0.6 ) were flagged and the genome belonging to the most likely incorrect strain was removed .
if the conflict could not be resolved ( i.e. using known typing information ) both genomes were removed .
highly similar genomes were defined as those genomes whose distance was found to be below 0.001 , as measured by mash ( ondov et al. , 2016 ) , version 1.1 .
despite the draft status of the genomes presented in this study , we observed a similar core genome size as the one computed using a set of 376 complete e. coli genomes downloaded from ncbi 's refseq ( data not shown ) .
snp calling and annotation due to the variability in sequencing technologies or lack of the original reads for the already sequenced strains in the collection ( n = 373 ) , snps were called through a whole genome alignment between each strain and the genome of the reference individual ( escherichia coli str .
k - 12 substr .
mg1655 , refseq accession : nc _ 000913.3 , strain collection identifier nt12001 ) , using parsnp ( treangen et al. , 2014 ) version 1.2 .
repeated regions in the reference genome were highlighted and masked through nucmer ( kurtz et al. , 2004 ) version 3.1 and bedtools ( quinlan and hall , 2010 ) version 2.26.0 .
snps were then phased , and annotated using snpeff ( cingolani et al. , 2012 ) version 4.1g .
pangenome analysis genes present in the reference individual but absent in each strain were highlighted by computing hierarchical orthologous group using oma ( altenhoff et al. , 2013 ) version 1.0.6 .
each strain was previously re - annotated using prokka ( seemann , 2014 ) version 1.11 to harmonize gene calls .
phylogenetics strains phylogenetic tree was computed using a single parsnp ( treangen et al. , 2014 ) analysis , which generates a whole genome nucleotide alignment across all strains , which is then used as an input for fasttree ( price et al. , 2010 ) version 2.1.7 .
the tree was visualized using the ete3 library ( huerta - cepas et al. , 2016a ) version 3.0.0 .
phylogenetic distances between pairs of strains has been computed using phylogenetic independent contrasts , in order to account for phylogenetic interdependencies between strains ( felsenstein , 1985 ) .
in short , we have first restricted the phenotypic data to those strains and conditions with less than 10 % missing data ; we then imputed the rest using the average s - score for each strain , using the scikit - learn library ( pedregosa et al. , 2011 ) version 0.17.1 .
for each condition we then computed the phylogenetic independent contrasts across the internal nodes of the strains' tree , using the ape , geiger and phytools libraries ( paradis et al. , 2004 ; harmon et al. , 2008 ; revell , 2012 ) , versions 5.0 , 2.0.6 and 0.6 - 20 , respectively .
the phenotypic distance between nodes was then computed using the euclidean distance between the phylogenetic independent contrasts across all conditions , using the nadist library version 0.1.0 .
computation of all possible mutations and their effect the impact of all possible nonsynonymous substitutions on the reference individual has been precomputed to speed up the lookup process .
functional impact of nonsynonymous substitutions has been computed using sift ( ng and henikoff , 2001 ) version 5.1.1 , using uniref50 as a sequence search database .
structural impact of nonsynonymous substitutions has been computed using foldx ( guerois et al. , 2002 ) version 4 ; both 3 - d structures present in the pdb database and homology models were used .
homology models were created using modpipe ( pieper et al. , 2014 ) version 2.2.0 .
conversion from pdb to uniprot residues coordinates was derived from the sifts ( velankar et al. , 2013 ) database .
pdb structures were ' repaired ' to fix residues' torsion angles and van der waals clashes before computing the impact of non - synonymous variants on structural stability .
all the precomputed impacts of all possible nonsynonymous substitutions are available through the mutfunc database ( http :// mutfunc.com ) .
computation of the disruption score for each strain and each protein coding genes we have computed the overall impact of all nonsynonymous and nonsense substitutions , in a similar approach as the one used for saccharomyces cerevisiae ( jelier et al. , 2011 ) .
the output of each predictor ( a deleterious probability for sift and a deltadeltag value for foldx ) has been converted to the probability of the substitution being neutral p ( neutral ) .
mutations with known impact on the reference individual have been downloaded from uniprot ( uniprot consortium , 2015 , n = 3673 ) and used to derive such conversion ; since only 580 mutations are reported to have a neutral impact , we added all observed nonsynonymous variants affecting known essential genes ( as reported in the ogee database , chen et al. , 2017 ) to the list of tolerated mutations .
the distribution of the negative natural logarithm of the sift probability ( plus a pseudocount equivalent to the lowest observed sift probability ) for all the 6460 mutations was binned and the p ( neutral ) was computed as the proportion of tolerated mutations over the total number of mutations in each bin .
a logistic regression curve was then fitted to the binned distribution to derive the conversion between the sift probability and p ( neutral ) .
for foldx we used a similar approach , but using the computed deltadeltag value .
the fitted logistic regression curves resulted in the following p ( neutral ) functions : p ( neutralsift )= 1 ( 1 + e - ( 0.625log ( sift + 1.527e - 4 )+ 1.971 )) p ( neutralfoldx )= 1 ( 1 + e - ( 1.465foldx + 1.201 )) the p ( neutral ) value attributed to nonsense mutations was assigned through heuristics : if the new stop codon was found within the last 16 residues of the protein it was given a p ( neutral ) value of 0.99 , reflecting its unlikelihood of disrupting the function of the protein , 0.01 otherwise .
losing a start or a stop codon was given a p ( neutral ) value of 0.01 , as they are very likely to impair protein function .
we gave a p ( neutral ) value of 0.01 to those genes that were found to be present in the reference individual but absent in the target strain , reflecting the fact that their function is most likely to be absent from the target strain .
we inferred the probability that each gene had its function affected by the ensemble of the substitutions in each strain by computing a disruption score , equivalent to the p ( af ) ( probability of the function being affected ) used in s. cerevisiae study ( jelier et al. , 2011 ). p ( af )= 1 - producti = 1kpi ( neutral ) where k is the ensemble of nonsynonymous and nonsense substitutions observed in each gene .
when both foldx and sift predictions were available for a given substitution , we used the sift prediction only .
variants with relatively high frequency (>= 10 %) in the strains collection were not considered , as well as those reference genes that are absent in a significant number of strains (>= 10 %) , as we reasoned that they are unlikely to be deleterious given their high observed frequency .
given that many strains of the collection are closely related ( e.g. strains derived from the ltee collection ) , we clustered them based on phylogenetic distance before applying the filtering .
we also did n't consider variants and absent reference genes shared by all members of the ltee strain collection , as those variants are present in the collection founder strain and therefore unlikely to affect the evolved clones phenotypes .
disruption scores for all proteins across all strains can be found in supplementary file 5 .
use of the disruption score as a functional association predictor we used the proteins pairwise pearson 's correlation of disruption scores as a predictor of genes functional associations .
we used four benchmarking sets : operons , as derived from the door database ( mao et al. , 2014 ) , protein complexes and pathways derived from the ecocyc database ( keseler et al. , 2013 ) , and protein - protein interactions derived from a recent yeast two - hybrid experiment ( rajagopala et al. , 2014 ) .
the distribution of the disruption score correlation for each pair of related genes was compared against the same number of gene pairs randomly drawn from all reference genes .
we also assessed the predictive power of the disruption score correlations by drawing a receiving operator characteristics curve ( roc ) across each correlation threshold , using the scikit - learn library ( pedregosa et al. , 2011 ) version 0.17.1 .
strains phenotyping the strains phenotypes were measured in a similar way as the e. coli reverse genetic screen ( nichols et al. , 2011 ) .
the strain collection was plated in three solid agar plates , each one containing 1536 single colonies , so that each strain was plated at least four times in each plate , each time with different neighboring strains .
for each condition we prepared three replicates ( each one using a different source plate to reduce batch effects ) with the concentrations indicated in supplementary file 2 and the addition of the cosmos dye ( cas number 573 - 58 - 0 ) and coomasie brilliant blue r - 250 ( cas number 6104 - 59 - 2 ) .
the solution stains colonies when biofilm is being developed .
plates were stored in darkness at room temperature , unless otherwise required by the specific condition ( i.e. higher temperature ) , and photographs of the plates were taken until colonies were found to be overgrowing into each other .
most of the conditions ( n = 197 ) were tested at the same time and under the same laboratory conditions as the keio ko collection ( herrera - dominguez et al. , unpublished ) .
a series of colony parameters were extracted from each photograph , using iris ( kritikos et al. , 2017 ) version 0.9.4.71 : colony size , opacity , roundness and color intensity .
the most appropriate time point for each condition was determined by imposing a restriction on median colony size ; between 1900 and 3600 pixels for the first two plates , and between 1300 and 3600 for the last plate , which contained the strains derived from evolution experiments , which tend to grow less than the natural isolates .
the time points passing the first threshold were then sorted by the proportion of colonies with high roundness (> 0.8 ) , which is indicative of the overall quality of the plate , proportion of colonies over the minimum median colony size threshold , the spread of the colony size distribution ( the lower the better ) , and mean colony size correlation across replicates .
a series of additional quality control measures were taken on the colony parameters .
in order to remove systematic pinning defects , colonies appearing to be missing ( colony size of zero pixels ) in more than 66 % of the tested plates were removed , unless all the internal replicates were found to be missing .
colonies with abnormal circularity were removed , as they were mostly due to incorrect colony recognition by the software : colonies with size below 1000 pixels and circularity below 0.5 and colonies with size above 1000 pixels and circularity below 0.3 were removed .
putative contaminations were spotted and removed through a variance jackknife approach : first , the size of two outermost rows and columns colonies was corrected to match the median of the rest of the plate , then for each strain , each of the four replicates inside the plate was tested whether it contributed to more than 90 % of the total colony size variance .
if so , the replicate was flagged as a contamination and removed .
the same approach was repeated using colony circularity , with a variance threshold of 95 % .
the final colony sizes were used as an input for the emap algorithm ( collins et al. , 2006 ) , with default parameters , in order to derive an s - score , which informs on the deviation of each strain from the expected growth in each condition .
final s - scores were quantile - normalized , and significant phenotypes were highlighted using a 5 % fdr correction similar to the one used in the e. coli reverse genetic screen ( nichols et al. , 2011 ) , using the statsmodels library version 0.6.1 .
the phenotypic data is available in supplementary file 4 .
computation of the conditional score and its assessment conditionally essential genes were derived for each condition of the e. coli reverse genetic screen overlapping with the conditions tested on the natural isolates collection .
mutants with a significant growth phenotype were considered to derive the list of conditionally essential genes .
the conditional score for each strain , indicating the growth prediction , was computed as follows : ss,c = sumg = 1l1eswg,clog ( 1 - ps,g ( af )) where s and c represent the strain and condition , respectively , g each conditionally essential gene for condition c ( with size l ) , and esrepresenting a correction term for the disruption score , in order to remove the effect of phylogenetic distance ( figure 2 - - figure supplement 1 ). es = 1nsumg = 1nlog ( 1 - ps,g ( af )) where n represents all the reference genes .
the term wg,c is used to weight the contribution of each conditionally essential gene to the conditional score , and it is computed as follows : wg,c = - log10 ( fg,c ) cgnc where fg,c is the fdr - corrected p - value of gene g in condition c , cg is the number of conditions in the chemical genomics screen where gene g shows a significant phenotype , and nc the total number of tested conditions in the chemical genomics screen .
the conditional score was assessed by computing a precision - recall curve , whose area ( pr - auc ) was used as a direct measure of the predictive power of the method ; the growth phenotypes were considered true positives .
the pr curve and its auc were computed using the scikit - learn library ( pedregosa et al. , 2011 ) version 0.17.1 .
three randomization approaches were used to generate control conditional scores : one using strains shuffling , one using conditionally essential gene sets shuffling , and one using random conditionally essential gene sets .
each randomization strategy has been used to generate 10,000 randomized scores , which were scaled to the actual one before assessment .
the conditionally essential gene sets , the conditional score and the pr - auc values are available in supplementary file 5 .
association of accessory genes with phenotypes accessory genes from the strains collection pangenome were computed from the harmonized genome annotations made by prokka ( seemann , 2014 ) , using roary ( page et al. , 2015 ) version 3.6.1 .
the accessory genes were associated to each condition 's phenotypes using scoary ( brynildsrud et al. , 2016 ) version 1.4.0 , with default parameters .
genes with corrected p - value ( benjamini - hochberg ) of association below 0.05 were considered significant .
the enrichment of conditionally essential genes among the significant reference gene hits was assessed through a fisher 's exact test , as implemented in the scipy library , version 0.17.0 .
systematic in - silico complementation of conditionally essential genes the potential to restore growth phenotypes through the introduction of reference alleles was predicted systematically in each strain by changing the disruption score to zero in each conditionally essential gene , and reporting the change in the conditional score : with respect to the maximum possible conditional score : ss,cmax = sumg = 1l1eswg,clog ( 1 - pmax ( af )) where pmax ( af ) is the maximum disruption score observed across all genes and strains .
any deltass,c higher than 1 % of ss,cmax was considered as potentially able to restore a growth phenotype .
experimental complementation of predicted phenotype - causing genes in order to experimentally verify our predictions , we introduced the reference ( bw25113 ) gene in a low copy plasmid .
for the slt gene , we used the available plasmid from the transbac library ( h. dose and h. mori , unpublished resource , otsuka et al. , 2015 ) .
for acra , acrb and glnd , we used the available plasmid from the mobile plasmid library ( saka et al. , 2005 ) .
we amplified acrab , soxsr , proab from bw25113 and ligated into pntr - sd ( the backbone plasmid for the mobile plasmid library ) .
deletions of acrab , soxsr , proab in the reference strain were made using the lambda red recombination approach ( datsenko and wanner , 2000 ) .
the resulting seven plasmids and the two empty plasmid controls were introduced into bw25113 ( negative control ) , in the deletion strains from the keio collection or constructed by us ( positive control ) and in the targets strains .
all resulting strains were pinned using a singer rotor robot in 10 different conditions , on two solid agar plates , so that each strain is pinned at least four times per plate .
the plates were incubated at room temperature and multiple photographs were taken until colonies were found to be overgrowing into each other .
iris ( kritikos et al. , 2017 ) version 0.9.7 was used to extract colony size from the pictures .
code , data and strains collection availability new genomic sequences have been deposited at the european nucleotide archive ( ena ) with accession number prjeb20550 .
the source code used to perform the analysis reported here and generate the figures is available as source code 1 and at the following urls : https :// github.com / mgalardini / screenings , https :// github.com / mgalardini / pangenome _ variation , https :// github.com / mgalardini / ecopredict ( copies archived at https :// github.com / elifesciences - publications / screenings , https :// github.com / elifesciences - publications / pangenome _ variation and https :// github.com / elifesciences - publications / ecopredict ) .
code is mostly based on the python programming language , and using the following libraries : numpy ( vanvan derder walt et al. , 2011 ) version 1.10.4 , scipy version 0.17.0 , pandas ( mckinney , 2010 ) version 0.18.0 , biopython ( cock et al. , 2009 ) version 1.68 , scikit - learn ( pedregosa et al. , 2011 ) version 0.17.1 , fastcluster ( mullner , 2013 ) version 1.1.20 , statsmodels version 0.6.1 , pyvcf version 0.6.8 , ete3 ( huerta - cepas et al. , 2016a ) version 3.0.0 , matplotlib ( hunter , 2007 ) version 1.5.1 , seaborn ( waskom et al. , 2016 ) version 0.7.1 and svgutils version 0.2.0 .
genomic and phenotypic data , as well as relevant information on how to obtain the members of the strain collection is available at the following url : https :// evocellnet.github.io / ecoref .
funding information this paper was supported by the following grants : http :// dx.doi.org / 10.13039 / 100005156alexander von humboldt - stiftung sofja kovaleskaja award to athanasios typas .
http :// dx.doi.org / 10.13039 / 501100002915fondation pour la recherche medicale equipe frm 2016 , deq20161136698 to erick denamur .
acknowledgements we are particularly grateful to the various people providing us with many of the strains of this e. coli genetic reference panel , specifically ( in alphabetical order ) : alfredo g torres , catharina svanborg , david clarke , erick denamur , ewa bok and pawel pusz , isabel gordo and lilia perfeito , jorg weinreich and peter schierack , kc huang , lisa nolan , mark goulian , mathew upton , olin silander , richard lenski , scott hultgren and wanderley dias da silveira .
we thank amanda miguel for helping in the phenotypic screen .
we also thank the embl gene core , and especially rajna hercog and vladimir benes for the support in genome sequencing .
we thank ewan birney , oliver stegle , kc huang and zam iqbal for critical reading of the manuscript .
this work was partially supported by the sofja kovaleskaja award of the alexander von humboldt foundation to aty and a grant from the fondation pour la recherche medicale ( equipe frm 2016 , deq20161136698 ) to ed. additional information competing interests no competing interests declared .
author contributions conceptualization , formal analysis , investigation , methodology , writing - - original draft , project administration , writing - - review and editing. investigation. investigation. investigation. investigation. investigation. investigation .
resources , data curation , validation .
resources , validation , writing - - review and editing .
conceptualization , supervision , funding acquisition , writing - - original draft , writing - - review and editing .
conceptualization , supervision , writing - - original draft , project administration , writing - - review and editing .
additional files 10.7554 / elife.31035.012 source code 1 .
code used to analyze the genetic and phenotypic data , predict phenotypes and draw all the manuscript figures .
10.7554 / elife.31035.013 supplementary file 1 .
detailed list of the members of the strain collection 10.7554 / elife.31035.014 supplementary file 2 .
detailed list of conditions on which the strain collection has been tested 10.7554 / elife.31035.015 supplementary file 3 .
categorization and mode of action ( moa ) of each chemical used in the phenotypic screening 10.7554 / elife.31035.016 supplementary file 4 .
s - scores , fdr corrected p - values and binary growth defect matrix of the e. coli phenotypic screening ( 869 strains across 214 conditions ) 10.7554 / elife.31035.017 supplementary file 5 : . disruption scores , conditional scores and prediction assessments .
10.7554 / elife.31035.018 transparent reporting form references 1000 genomes project consortium auton a brooks ld durbin rm garrison ep kang hm korbel jo marchini jl mccarthy s mcvean ga abecasis gr 2015 a global reference for human genetic variation nature 526 68 74 10.1038 / nature15393 26432245 1001 genomes consortium 2016 1,135 genomes reveal the global pattern of polymorphism in arabidopsis thaliana cell 166 481 491 10.1016 / j.cell.2016.05.063 27293186 altenhoff am gil m gonnet gh dessimoz c 2013 inferring hierarchical orthologous groups from orthologous gene pairs plos one 8 e53786 10.1371 / journal.pone.0053786 23342000 atwell s huang ys vilhjalmsson bj willems g horton m li y meng d platt a tarone am hu tt jiang r muliyati nw zhang x amer ma baxter i brachi b chory j dean c debieu m de meaux j ecker jr faure n kniskern jm jones jd michael t nemri a roux f salt de tang c todesco m traw mb weigel d marjoram p borevitz jo bergelson j nordborg m 2010 genome - wide association study of 107 phenotypes in arabidopsis thaliana inbred lines nature 465 627 631 10.1038 / nature08800 20336072 ayroles jf carbone ma stone ea jordan kw lyman rf magwire mm rollmann sm duncan lh lawrence f anholt rr mackay tf 2009 systems genetics of complex traits in drosophila melanogaster nature genetics 41 299 307 10.1038 / ng.332 19234471 baba t ara t hasegawa m takai y okumura y baba m datsenko ka tomita m wanner bl mori h 2006 construction of escherichia coli k - 12 in - frame , single - gene knockout mutants : the keio collection molecular systems biology 2 2006.0008 10.1038 / msb4100050 16738554 bankevich a nurk s antipov d gurevich aa dvorkin m kulikov as lesin vm nikolenko si pham s prjibelski ad pyshkin av sirotkin av vyahhi n tesler g alekseyev ma pevzner pa 2012 spades : a new genome assembly algorithm and its applications to single - cell sequencing journal of computational biology 19 455 477 10.1089 / cmb.2012.0021 22506599 bennett bj farber cr orozco l kang hm ghazalpour a siemers n neubauer m neuhaus i yordanova r guan b truong a yang wp he a kayne p gargalovic p kirchgessner t pan c castellani lw kostem e furlotte n drake ta eskin e lusis aj 2010 a high - resolution association mapping panel for the dissection of complex traits in mice genome research 20 281 290 10.1101 / gr.099234.109 20054062 blount zd 2015 the unexhausted potential of e. coli elife 4 e05826 10.7554 / elife.05826 bodmer w bonilla c 2008 common and rare variants in multifactorial susceptibility to common diseases nature genetics 40 695 701 10.1038 / ng.f.136 18509313 boyle ea li yi pritchard jk 2017 an expanded view of complex traits : from polygenic to omnigenic cell 169 1177 1186 10.1016 / j.cell.2017.05.038 28622505 brynildsrud o bohlin j scheffer l eldholm v 2016 rapid scoring of genes in microbial pan - genome - wide association studies with scoary genome biology 17 238 10.1186 / s13059 - 016 - 1108 - 8 27887642 bush ws moore jh 2012 chapter 11 : genome - wide association studies plos computational biology 8 e1002822 10.1371 / journal.pcbi.1002822 23300413 chen w - h lu g chen x zhao x - m bork p 2017 ogee v2 : an update of the online gene essentiality database with special focus on differentially essential genes in human cancer cell lines nucleic acids research 45 d940 d944 10.1093 / nar / gkw1013 27799467 cingolani p platts a wang lel coon m nguyen t wang l land sj lu x ruden dm 2012 a program for annotating and predicting the effects of single nucleotide polymorphisms , snpeff : snps in the genome of drosophila melanogaster strain w1118 ; iso - 2 ; iso - 3 fly 6 80 92 10.4161 / fly.19695 22728672 clermont o gordon d denamur e 2015 guide to the various phylogenetic classification schemes for escherichia coli and the correspondence among schemes microbiology 161 980 988 10.1099 / mic.0.000063 25714816 cock pj antao t chang jt chapman ba cox cj dalke a friedberg i hamelryck t kauff f wilczynski b de hoon mj 2009 biopython : freely available python tools for computational molecular biology and bioinformatics bioinformatics 25 1422 1423 10.1093 / bioinformatics / btp163 19304878 collins sr schuldiner m krogan nj weissman js 2006 a strategy for extracting and analyzing large - scale quantitative epistatic interaction data genome biology 7 r63 10.1186 / gb - 2006 - 7 - 7 - r63 16859555 datsenko ka wanner bl 2000 one - step inactivation of chromosomal genes in escherichia coli k - 12 using pcr products pnas 97 6640 6645 10.1073 / pnas.120163297 10829079 dietzl g chen d schnorrer f su kc barinova y fellner m gasser b kinsey k oppel s scheiblauer s couto a marra v keleman k dickson bj 2007 a genome - wide transgenic rnai library for conditional gene inactivation in drosophila nature 448 151 156 10.1038 / nature05954 17625558 dowell rd ryan o jansen a cheung d agarwala s danford t bernstein da rolfe pa heisler le chin b nislow c giaever g phillips pc fink gr gifford dk boone c 2010 genotype to phenotype : a complex problem science 328 469 10.1126 / science.1189015 20413493 edwards sl beesley j french jd dunning am 2013 beyond gwass : illuminating the dark road from association to function the american journal of human genetics 93 779 797 10.1016 / j.ajhg.2013.10.012 24210251 felsenstein j 1985 phylogenies and the comparative method the american naturalist 125 1 15 10.1086 / 284325 guerois r nielsen je serrano l 2002 predicting changes in the stability of proteins and protein complexes : a study of more than 1000 mutations journal of molecular biology 320 369 387 10.1016 / s0022 - 2836 ( 02 ) 00442 - 4 12079393 harmon lj weir jt brock cd glor re challenger w 2008 geiger : investigating evolutionary radiations bioinformatics 24 129 131 10.1093 / bioinformatics / btm538 18006550 hart t chandrashekhar m aregger m steinhart z brown kr macleod g mis m zimmermann m fradet - turcotte a sun s mero p dirks p sidhu s roth fp rissland os durocher d angers s moffat j 2015 high - resolution crispr screens reveal fitness genes and genotype - specific cancer liabilities cell 163 1515 1526 10.1016 / j.cell.2015.11.015 26627737 hillenmeyer me fung e wildenhain j pierce se hoon s lee w proctor m st onge rp tyers m koller d altman rb davis rw nislow c giaever g 2008 the chemical genomic portrait of yeast : uncovering a phenotype for all genes science 320 362 365 10.1126 / science.1150021 18420932 huerta - cepas j serra f bork p 2016a ete 3 : reconstruction , analysis , and visualization of phylogenomic data molecular biology and evolution 33 1635 1638 10.1093 / molbev / msw046 26921390 huerta - cepas j szklarczyk d forslund k cook h heller d walter mc rattei t mende dr sunagawa s kuhn m jensen lj von mering c bork p 2016b eggnog 4.5 : a hierarchical orthology framework with improved functional annotations for eukaryotic , prokaryotic and viral sequences nucleic acids research 44 d286 d293 10.1093 / nar / gkv1248 26582926 hunter jd 2007 matplotlib : a 2d graphics environment computing in science & engineering .
ieee computer society 90 95 jelier r semple ji garcia - verdugo r lehner b 2011 predicting phenotypic variation in yeast from individual genome sequences nature genetics 43 1270 1274 10.1038 / ng.1007 22081227 johnson jr delavari p stell al prats g carlino u russo ta 2001 integrity of archival strain collections : the ecor collection asm news - american society for microbiology 67 288 289 kamath rs fraser ag dong y poulin g durbin r gotta m kanapin a le bot n moreno s sohrmann m welchman dp zipperlen p ahringer j 2003 systematic functional analysis of the caenorhabditis elegans genome using rnai nature 421 231 237 10.1038 / nature01278 12529635 keseler im mackie a peralta - gil m santos - zavaleta a gama - castro s bonavides - martinez c fulcher c huerta am kothari a krummenacker m latendresse m muniz - rascado l ong q paley s schroder i shearer ag subhraveti p travers m weerasinghe d weiss v collado - vides j gunsalus rp paulsen i karp pd 2013 ecocyc : fusing model organism databases with systems biology nucleic acids research 41 d605 d612 10.1093 / nar / gks1027 23143106 kritikos g banzhaf m herrera - dominguez l koumoutsi a wartel m zietek m typas a 2017 a tool named iris for versatile high - throughput phenotyping in microorganisms nature microbiology 2 17014 10.1038 / nmicrobiol.2017.14 kulshreshtha s chaudhary v goswami gk mathur n 2016 computational approaches for predicting mutant protein stability journal of computer - aided molecular design 30 401 412 10.1007 / s10822 - 016 - 9914 - 3 27160393 kurtz s phillippy a delcher al smoot m shumway m antonescu c salzberg sl 2004 versatile and open software for comparing large genomes genome biology 5 r12 10.1186 / gb - 2004 - 5 - 2 - r12 14759262 lehner b 2013 genotype to phenotype : lessons from model organisms for human genetics nature reviews genetics 14 168 178 10.1038 / nrg3404 23358379 li xz plesiat p nikaido h 2015 the challenge of efflux - mediated antibiotic resistance in gram - negative bacteria clinical microbiology reviews 28 337 418 10.1128 / cmr.00117 - 14 25788514 liti g carter dm moses am warringer j parts l james sa davey rp roberts in burt a koufopanou v tsai ij bergman cm bensasson d o'kelly mj van oudenaarden a barton db bailes e nguyen an jones m quail ma goodhead i sims s smith f blomberg a durbin r louis ej 2009 population genomics of domestic and wild yeasts nature 458 337 341 10.1038 / nature07743 19212322 lukjancenko o wassenaar tm ussery dw 2010 comparison of 61 sequenced escherichia coli genomes microbial ecology 60 708 720 10.1007 / s00248 - 010 - 9717 - 3 20623278 mao x ma q zhou c chen x zhang h yang j mao f lai w xu y 2014 door 2.0 : presenting operons and their functions through dynamic and integrated views nucleic acids research 42 d654 d659 10.1093 / nar / gkt1048 24214966 mckinney w 2010 data structures for statistical computing in pythonin proceedings of the 9th python in science conference 51 56 medini d donati c tettelin h masignani v rappuoli r 2005 the microbial pan - genome current opinion in genetics & development 15 589 594 10.1016 / j.gde.2005.09.006 16185861 murakami s nakashima r yamashita e matsumoto t yamaguchi a 2006 crystal structures of a multidrug transporter reveal a functionally rotating mechanism nature 443 173 179 10.1038 / nature05076 16915237 mullner d 2013 fastcluster : fast hierarchical , agglomerative clustering routines forrandpython journal of statistical software 53 10.18637 / jss.v053.i09 ng pc henikoff s 2001 predicting deleterious amino acid substitutions genome research 11 863 874 10.1101 / gr.176601 11337480 nichols rj sen s choo yj beltrao p zietek m chaba r lee s kazmierczak km lee kj wong a shales m lovett s winkler me krogan nj typas a gross ca 2011 phenotypic landscape of a bacterial cell cell 144 143 156 10.1016 / j.cell.2010.11.052 21185072 ondov bd treangen tj melsted p mallonee ab bergman nh koren s phillippy am 2016 mash : fast genome and metagenome distance estimation using minhash genome biology 17 132 10.1186 / s13059 - 016 - 0997 - x 27323842 otsuka y muto a takeuchi r okada c ishikawa m nakamura k yamamoto n dose h nakahigashi k tanishima s suharnan s nomura w nakayashiki t aref wg bochner br conway t gribskov m kihara d rudd ke tohsato y wanner bl mori h 2015 genobase : comprehensive resource database of escherichia coli k - 12 nucleic acids research 43 d606 d617 10.1093 / nar / gku1164 25399415 page aj cummins ca hunt m wong vk reuter s holden mt fookes m falush d keane ja parkhill j 2015 roary : rapid large - scale prokaryote pan genome analysis bioinformatics 31 3691 3693 10.1093 / bioinformatics / btv421 26198102 paradis e claude j strimmer k 2004 ape : analyses of phylogenetics and evolution in r language bioinformatics 20 289 290 10.1093 / bioinformatics / btg412 14734327 pedregosa f varoquaux g gramfort a michel v thirion b grisel o blondel m 2011 " scikit - learn : machine learning in python. " journal of machine learning research : jmlr 12 2825 2830 pieper u webb bm dong gq schneidman - duhovny d fan h kim sj khuri n spill yg weinkam p hammel m tainer ja nilges m sali a 2014 modbase , a database of annotated comparative protein structure models and associated resources nucleic acids research 42 d336 d346 10.1093 / nar / gkt1144 24271400 price mn dehal ps arkin ap 2010 fasttree 2 - - approximately maximum - likelihood trees for large alignments plos one 5 e9490 10.1371 / journal.pone.0009490 20224823 price mn wetmore km waters rj callaghan m ray j 2016 deep annotation of protein function across diverse bacteria from mutant phenotypes biorxiv 10.1101 / 072470 quinlan ar hall im 2010 bedtools : a flexible suite of utilities for comparing genomic features bioinformatics 26 841 842 10.1093 / bioinformatics / btq033 20110278 rajagopala sv sikorski p kumar a mosca r vlasblom j arnold r franca - koh j pakala sb phanse s ceol a hauser r siszler g wuchty s emili a babu m aloy p pieper r uetz p 2014 the binary protein - protein interaction landscape of escherichia coli nature biotechnology 32 285 290 10.1038 / nbt.2831 24561554 revell lj 2012 phytools : an r package for phylogenetic comparative biology ( and other things ) methods in ecology and evolution 3 217 223 10.1111 / j.2041 - 210x.2011.00169.x ryan o shapiro rs kurat cf mayhew d baryshnikova a chin b lin zy cox mj vizeacoumar f cheung d bahr s tsui k tebbji f sellam a istel f schwarzmuller t reynolds tb kuchler k gifford dk whiteway m giaever g nislow c costanzo m gingras ac mitra rd andrews b fink gr cowen le boone c 2012 global gene deletion analysis exploring yeast filamentous growth science 337 1353 1356 10.1126 / science.1224339 22984072 saka k tadenuma m nakade s tanaka n sugawara h nishikawa k ichiyoshi n kitagawa m mori h ogasawara n nishimura a 2005 a complete set of escherichia coli open reading frames in mobile plasmids facilitating genetic studies dna research 12 63 68 10.1093 / dnares / 12.1.63 16106753 seeger ma schiefner a eicher t verrey f diederichs k pos km 2006 structural asymmetry of acrb trimer suggests a peristaltic pump mechanism science 313 1295 1298 10.1126 / science.1131542 16946072 seemann t 2014 prokka : rapid prokaryotic genome annotation bioinformatics 30 2068 2069 10.1093 / bioinformatics / btu153 24642063 tenaillon o barrick je ribeck n deatherage de blanchard jl dasgupta a wu gc wielgoss s cruveiller s medigue c schneider d lenski re 2016 tempo and mode of genome evolution in a 50,000 - generation experiment nature 536 165 170 10.1038 / nature18959 27479321 tenaillon o skurnik d picard b denamur e 2010 the population genetics of commensal escherichia coli nature reviews microbiology 8 207 217 10.1038 / nrmicro2298 20157339 thusberg j olatubosun a vihinen m 2011 performance of mutation pathogenicity prediction methods on missense variants human mutation 32 358 368 10.1002 / humu.21445 21412949 treangen tj ondov bd koren s phillippy am 2014 the harvest suite for rapid core - genome alignment and visualization of thousands of intraspecific microbial genomes genome biology 15 524 10.1186 / s13059 - 014 - 0524 - x 25410596 uniprot consortium 2015 uniprot : a hub for protein information nucleic acids research 43 d204 212 10.1093 / nar / gku989 25348405 van der walt s colbert sc varoquaux g 2011 the numpy array : a structure for efficient numerical computation computing in science & engineering 13 22 30 10.1109 / mcse.2011.37 velankar s dana jm jacobsen j van ginkel g gane pj luo j oldfield tj o'donovan c martin mj kleywegt gj 2013 sifts : structure integration with function , taxonomy and sequences resource nucleic acids research 41 d483 d489 10.1093 / nar / gks1258 23203869 waskom m botvinnik o drewokane ph david yh lukauskas s 2016 seabornv0.7.1https :// doi.org / 10.5281 / zenodo.54844 weinstein jn collisson ea mills gb shaw kr ozenberger ba ellrott k shmulevich i sander c stuart jm cancer genome atlas research network 2013 the cancer genome atlas pan - cancer analysis project nature genetics 45 1113 1120 10.1038 / ng.2764 24071849 welter d macarthur j morales j burdett t hall p junkins h klemm a flicek p manolio t hindorff l parkinson h 2014 the nhgri gwas catalog , a curated resource of snp - trait associations nucleic acids research 42 d1001 d1006 10.1093 / nar / gkt1229 24316577 wood de salzberg sl 2014 kraken : ultrafast metagenomic sequence classification using exact alignments genome biology 15 r46 10.1186 / gb - 2014 - 15 - 3 - r46 24580807 yang j benyamin b mcevoy bp gordon s henders ak nyholt dr madden pa heath ac martin ng montgomery gw goddard me visscher pm 2010 common snps explain a large proportion of the heritability for human height nature genetics 42 565 569 10.1038 / ng.608 20562875 10.7554 / elife.31035.023 decision letter barkai naama reviewing editor weizmann institute of scienceisrael in the interests of transparency , elife includes the editorial decision letter and accompanying author responses .
a lightly edited version of the letter sent to the authors after peer review is shown , indicating the most substantive concerns ; minor comments are not usually included .
thank you for submitting your article " phenotype inference in an escherichia coli strain panel " for consideration by elife .
your article has been reviewed by two peer reviewers , and the evaluation has been overseen by naama barkai as the senior editor and reviewing editor .
the reviewers have opted to remain anonymous .
the reviewers have discussed the reviews with one another and the reviewing editor has drafted this decision to help you prepare a revised submission .
as you will see below , the reviewers appreciated the extensive analysis and believe that the data will be a useful resource for the community .
please see below technical issues that were raised by the reviewers , which should be addressed in full , as you revise your submission for the tools and resources section .
reviewer # 1 : this paper does an extensive analysis and prediction of phenotypes caused by mutations in a large e. coli strain panel evaluated over several hundred conditions .
overall , my concern with this paper applies similarly to many large - scale , high - throughput works i see : the authors have done so much , and are trying to present so many different results and approaches in one paper , that it 's difficult to evaluate what exactly was achieved .
this paper is either a monumental achievement or a collection of trivial results , and i find it difficult to distinguish between the two possibilities .
i am tentatively willing to give the authors the benefit of the doubt , but i have specific questions and concerns that would strengthen my confidence in the work .
- " we detected no strong positive correlation " this is a strange sentence , in particular if it then lists a significant negative correlation .
i think the authors need to explain first why they would expect a positive correlation .
also , with regards to these correlations , because of the phylogenetic dependency among strains they should be calculated on phylogenetic independent contrasts .
alternatively , it would be better to not report a p value than to report an incorrect one .
- figure 3a : the precision - recall curves do n't look particularly impressive .
they rapidly decay to a precision below 0.5 , at which point more cases are called incorrectly than correctly .
- figure 3b : this figure is not properly explained .
first , what are the small gray dots ?
second , what are the three thick gray dots labeled as shuffled strains , shuffled sets , and random sets ?
each randomization should provide a distribution which then is compared to one pr - auc value .
if the true pr - auc value is rare under reshuffling , then it is significant .
this relationship is not in any way visible in the figure .
- figure 4 : again , the precision - recall curve looks pretty bad .
i grant that there 's some enrichment of phenotypes towards the top end of the predicted phenotype scale , but the prediction quality is not impressive and it 's not clear to me whether a trivial predictor ( e.g. , one only evaluating whether an amino acid has been changed towards a highly biochemically dissimilar one ) could do just as well .
- section on " experimental validation of causal variants " : it is not entirely clear to me what has been achieved here .
if a mutation knocks out an essential gene then clearly that defect can be rescued via complementation .
so the achievement would have to be to predict that a gene is essential only under specific conditions. is that what was done ? and if so , how ? was essentiality simply observed , by noting that strains with mutations in certain genes would n't grow under specific conditions ? or was it somehow inferred from some other data ?
- " with prior knowledge on gene essentiality " i 'm not entirely convinced that gene essentiality matters all that much .
a mutation in a non - essential gene can have a substantial fitness effect , and a mutation in an essential gene that does n't fully disable that gene 's function may have only a minor fitness effect .
- it is unclear to me whether the code underlying the mutfunc database has been provided or not .
the database looks nice , but i 'm generally wary of any bioinformatics tool that i ca n't download and run on my own machine .
the authors provide several pipelines ( https :// github.com / mgalardini / screenings , https :// github.com / mgalardini / pangenome _ variation , https :// github.com / mgalardini / ecopredict ) , but none seems to perform the task of the mutfunc database .
reviewer # 2 : we have read the study entitled " phenotype inference in an escherichia coli strain panel " by galardini et al. this study performs phenotypic screens for 894 e. coli strains across 214 growth conditions .
most of the strains ( 696 ) have full genome sequence available .
gene - level functional predictions were correct in up to 38 % of cases .
this dataset will become an important and useful resource for the systems biology and microbiology community .
we would appreciate of the authors addressed our minor comments below : we commend the authors for putting all of their data in easily accessible format on github with links out to all of the available assemblies and phenotype measurements .
this inclusion will ensure that the resource is easy to use for the research community .
however , one question remains regarding the new annotations for each strain. are these available anywhere ?
it was difficult to find them both on the web or in the authors' supplemental files .
the authors previously used this approach on yeast with a median predictive performance of 0.76 ( jelier et al .
2011 ) , but were only able to reliably predict 38 % of the conditions tested in this instance .
could the authors comment on why their performance was lower ?
why did the authors use parsnp to compute phylogeny rather than other methods ( such as mlst , whole genome alignment , etc ) .
the authors look for a correlation between phylogeny and genotype .
could the lack of correlation be due to assumptions made when calculating the phylogeny ?
why did the authors choose to incubate the most of the conditions at room temperature rather than the more common 37c ?
might this significantly impact their results ( i.e. would growth capabilities change if incubated at 37c ?) .
how do the authors define the " accessory genes / genome ". are these simply all genes that are not part of the core genome ?
could the authors comment on the completeness of the genomic sequences in the data set ? were snps only called for sequences in common with the reference e. coli k12 genome ?
would that potentially explain some of the discrepancies between the model predictions and the experimental outcome ?
does the term " mechanistic " appropriately describe the method used ?
especially when one considers disruption scores in many areas of a genome and the conditional essentiality of genes ?
10.7554 / elife.31035.024 author response reviewer # 1 : this paper does an extensive analysis and prediction of phenotypes caused by mutations in a large e. coli strain panel evaluated over several hundred conditions .
overall , my concern with this paper applies similarly to many large - scale , high - throughput works i see : the authors have done so much , and are trying to present so many different results and approaches in one paper , that it 's difficult to evaluate what exactly was achieved .
this paper is either a monumental achievement or a collection of trivial results , and i find it difficult to distinguish between the two possibilities .
we can understand the reviewer 's reluctance towards large - scale projects and of course we hope to convince him / her that this is not simply a large collection of data .
we are in fact trying to ask a very fundamental biological question : given all that we currently know about e. coli biology , can we predict how a specific strain of e. coli will grow in a given condition based on its genome ?
it is not trivial at all to be able to take a genome sequence of an e. coli strain and determine in which conditions this strain is going to grow poorly in. by asking this question we are testing the limits of our knowledge of how dna variation affects phenotypes .
working towards these predictions implies the capacity to encapsulate in computational models all of this understanding .
we upfront admit that we are not yet fully capable of making such predictions , but we also think it is very important to test these limits and to challenge ourselves and the scientific community to improve on what we have achieved in this manuscript .
in particular , we have used the knowledge on e. coli gene function as defined by the chemical genomic screens done in one particular strain , the lab e. coli k - 12 .
we then make the assumption that a gene that is essential for growth in a given condition in the k - 12 strain will also be essential for growth in the same condition in any other strain of e. coli .
based on this knowledge we then compute the effects of non - synonymous variants from genomes of different strains , using folding and sequence conservation algorithms .
this allows us to predict which strains will have growth defects in specific conditions .
our predictions are significantly better than random and we can show in the complementation assays that we are in fact predicting the genes that are causing the growth defects in the right conditions. of course , there is much room for improvement and many ways to try to extend the predictions made here as we discuss in the manuscript .
for example , we have not yet taken into account mutations that could alter the expression of the genes .
as we and others incorporate such additional information the predictive models will become even more accurate .
at the same time , there is also great opportunity for new biology from the deficiencies in the predictions .
as we mentioned in the manuscript we see cases where loss of function of a gene is known to cause a condition specific growth defect in e. coli k - 12 but the same is not observed in specific strains .
we and others can now try to understand why this is the case .
finally , in order to ask this fundamental question we also needed the genomes of many strains of e. coli and their growth phenotypes across a large number of conditions as well .
this large - scale data gathering effort is in itself useful as a resource , but we would like to re - emphasize that the main focus of this paper is on the fundamental biological question we are asking .
i am tentatively willing to give the authors the benefit of the doubt , but i have specific questions and concerns that would strengthen my confidence in the work .
- " we detected no strong positive correlation " this is a strange sentence , in particular if it then lists a significant negative correlation .
i think the authors need to explain first why they would expect a positive correlation .
also , with regards to these correlations , because of the phylogenetic dependency among strains they should be calculated on phylogenetic independent contrasts .
alternatively , it would be better to not report a p value than to report an incorrect one .
we agree with the reviewer that we have failed in properly explaining what our expectations were with respect to this analysis .
the message we wanted to convey was that if all genetic variation contributed equally to phenotypic variation we would observe a strong positive correlation between these two variables , which is not the case .
the overall negative correlation presented in the main text is present merely because of the highly genetically similar strains coming from the ltee collection ( long term evolution experiment ) .
given this confounding factor and the suggestion to use phylogenetic independent contrasts to account for the strains' dependencies , we have changed figure 1e ( now figure 2e ) .
as suggested by the reviewer we are now deriving the correlation between genetic and phenotypic distance using the phylogenetic independent contrasts computed along the core genome tree of the strains .
we show that we did not observe a positive correlation between genetic and phenotypic distance ( pearson 's r : 0.07 ) , confirming the assumption that not all genetic variation contributes equally to differentiate phenotypes .
we have also updated the materials and methods section (" phylogenetics ") to indicate how this analysis has been performed .
we have also removed the last two panels of figure 1 - - figure supplement 1 .
- figure 3a : the precision - recall curves do n't look particularly impressive .
they rapidly decay to a precision below 0.5 , at which point more cases are called incorrectly than correctly .
we thank the reviewer for raising this point .
while the curves displayed in figure 3a are merely part of the schematic used to explain the prediction and scoring strategies , they mimic some of the real curves we observed in our data , and therefore this comment is relevant and important .
we address the concerns of the reviewer with respect to the drop in precision and general aspect of the curves in the comment about figure 3b and figure 4 .
in a nutshell , we would like to point out that the predictions are indeed significantly better than the various randomization strategies we have proposed .
- figure 3b : this figure is not properly explained .
first , what are the small gray dots ?
second , what are the three thick gray dots labeled as shuffled strains , shuffled sets , and random sets ?
each randomization should provide a distribution which then is compared to one pr - auc value .
if the true pr - auc value is rare under reshuffling , then it is significant .
this relationship is not in any way visible in the figure .
we agree with the reviewer that the visualization we chose does n't provide sufficient information and , most importantly , hides the relationship between the distribution of the actual predictions versus the three randomization strategies we have adopted .
we therefore decided to remove the thick gray dots that corresponded to the median results of the randomizations (" shuffled strains " , " shuffled sets " , and " random sets ") and leave the small grey dots , which represent the pr - auc value of each condition separately .
to better illustrate the randomisations we have added a panel to figure 3 ( panel c ) , showing an example condition ( clindamycin 3 mug / ml ) .
as suggested by the reviewer we now show the distribution of the randomizations and in a red line the result for the actual predictor for this condition .
in the figure legend we have indicated the q - value related to the likelihood that the actual predictions has been drawn from the distribution of each randomization .
furthermore , we have added a new supplementary figure ( figure 3 - - figure supplement 2 ) , which shows for each condition a similar plot as the one presented in figure 3c .
we have also updated the results section to better explain this point .
we believe that these changes will help the readers understanding why the predictions presented in this work are relevant .
- figure 4 : again , the precision - recall curve looks pretty bad .
i grant that there 's some enrichment of phenotypes towards the top end of the predicted phenotype scale , but the prediction quality is not impressive and it 's not clear to me whether a trivial predictor ( e.g. , one only evaluating whether an amino acid has been changed towards a highly biochemically dissimilar one ) could do just as well .
the points raised by the reviewer are important .
indeed , the precision in the two example conditions drops at relatively low recall values .
it is important to point out that the number of strains with growth defects in a given condition are a small fraction of the total and it is therefore a very unbalanced set of true and false positives .
achieving high precision is particularly challenging in such an unbalanced set .
nevertheless the rankings we predict are noticeably better than expected by random chance .
author response image 1 shows the comparison against the predicted score computed using random conditionally essential gene sets .
in that respect the comments about figure 3b allowed us to make this significance more evident .
finally , we would like to point out how the choice of showing a precision - recall curve as the sole visual indicator of our prediction accuracy may be actually undermining the value of our approach .
author response image 1 shows two additional metrics for the two example conditions presented in figure 4a ( the " bootstrap " curves representing the average performance of 100 predictions using random gene sets ) : 10.7554 / elife.31035.020 author response image 1 .
as evident from the plots in author response image 1 , the predictions made in these two conditions are significantly better than using random gene sets .
this is especially obvious in the roc curve , where the randomizations are very similar to a random predictor ( roc auc ~= 0.5 ) , as opposed to very high roc auc for both conditions for the " real " predictions (~ 0.76 ) .
we have now updated figure 4a to show how the predictions are significantly different than the " random sets " bootstraps .
we have also added a new panel to figure 4b to include the roc curve .
while we recognize that our predictions are far from perfect , we believe they represent an important demonstration that is indeed possible to combine chemical genomics data from the reference k - 12 strain with mutation data to infer conditional growth defects for other strains .
in particular , leveraging the information on condition - dependent essentiality is key to the significance of our predictions ; if we were to only use the predicted impact of non - synonymous variants we would not be able to deliver condition specific predictions .
we have expanded our discussion to point out this important conclusion of our study .
the reviewer asked if the same predictions could be achieved with a " trivial " variant predictor such as one that evaluates the effect of mutations based on amino - acids categories .
our predictions are a combination of variant effect predictions with gene function information from the k - 12 reference strains .
we assume that the reviewer is here asking about how much information is added by the interpretation of the variant effects only , keeping the gene function information unchanged .
we have tested a more trivial variant effect predictor for the impact of nonsynonymous substitutions as suggested by the reviewer , and as can be seen from the three plots in author response image 2 , its predictive power is inferior to the one we propose .
10.7554 / elife.31035.021 author response image 2 .
in short , we have divided the 20 amino acids into 8 categories : hydrophobic ( a , i , l , m , v ) , hydrophobic ( aromatic ) ( f , w , y ) , polar ( n , q , s , t ) , acidic ( d , e ) , basic ( r , h , k ) , cysteine ( c ) , proline ( p ) and glycine ( g ) .
we then have assigned a p ( neutral ) value of 0.99 ( tolerated ) for amino acid substitutions within each category , and 0.01 ( deleterious ) otherwise .
again , all the other predictors ( accessory genes and stop codons ) have been kept the same as our proposed predictor , including the use of conditionally essential genes .
the two top plots show the precision recall curves for 2 conditions comparing variant effect prediction approaches .
the boxplots in the bottom figure summarize the results across all conditions that have at least 5 % of strains with significant growth defects .
we believe that this test demonstrates that there is added value in using variant effect predictors that take into account conservation and structural information as we are able to achieve higher precision .
we have decided not to include this result in the main text , as introducing an additional predictor might generate confusion in the reader .
finally , as indicated in the discussion , we of course concede that these predictions have room for improvement , and suggest future directions on how to do so .
- section on " experimental validation of causal variants " : it is not entirely clear to me what has been achieved here .
if a mutation knocks out an essential gene then clearly that defect can be rescued via complementation .
so the achievement would have to be to predict that a gene is essential only under specific conditions. is that what was done ? and if so , how ? was essentiality simply observed , by noting that strains with mutations in certain genes would n't grow under specific conditions ? or was it somehow inferred from some other data ?
looking at this and the subsequent comment by the reviewer , we suspect that we might have failed in properly explaining the approach we have taken and the terminology we are using .
we therefore have updated the introduction , results and discussion sections to make it easier to understand what exactly our approach consists of. in short , we have used the information on gene conditional essentiality derived from pre - existing chemical genomics screens from the e. coli lab strain k - 12 .
we therefore know which genes are essential for growth in k - 12 in a given condition , and we can therefore focus on interpreting genetic variation on those genes only , as they would be more likely to influence growth if a mutation has an impact on its function in another e. coli strain .
this assumes that a given gene that is essential for growth in a condition in the e. coli strain k - 12 will still be equally important for that same condition in any other strain of e. coli .
as we described in the discussion one of the potential reasons why we have achieved only moderate success could very well be because the genes essential for growth under specific conditions in the k - 12 strain may not be essential for growth in those same conditions for other strains .
while we have not proved this in this study , this would be an extremely important finding that would highlight the plasticity of gene function .
going back to the experimental validation of our model , based on the mutations that we observed in the genome of a given strain we can then predict : 1 ) if a mutation will severely impact on the function of a giving gene ; 2 ) if that gene is known to be essential for growth in a specific condition ( in k - 12 ) .
we can then predict a strain that has a damaging mutation in a gene essential to grow in a certain condition should also grow poorly in that condition .
purely from the genome sequence of a strain we can then rank all mutated genes as the most likely mutated gene that is causing a grown defect in a specific condition .
these sets of complementation experiments show that we can in fact predict why a given strain of e. coli is growing poorly in a specific condition .
this is the reason why we believe we have demonstrated the long - term potential of our approach to pave the way for precision genetic intervention strategies .
our approach is specific and , to a certain extent , accurate .
we believe that figure 5c is an appropriate demonstration of this statement ; in the experiments we have carried out we observe a clear difference between those complementations that were predicted to restore growth in specific conditions versus those that were not predicted to have an impact .
- " with prior knowledge on gene essentiality " i 'm not entirely convinced that gene essentiality matters all that much .
a mutation in a non - essential gene can have a substantial fitness effect , and a mutation in an essential gene that does n't fully disable that gene 's function may have only a minor fitness effect .
we believe that we have addressed this concern in the reply to the previous question .
we indeed believe that conditional essentiality ( i.e. essential for a given condition ) matters , and we believe to have demonstrated it when showing how our predictions compare to the randomisations with shuffled and random gene sets ( figure 3c , 4a and b and figure 3 - - figure supplement 2 ) .
again , we thank the reviewer for pointing out how we have failed in making these points clear .
we hope that our revised text improves how we explain this key concept .
- it is unclear to me whether the code underlying the mutfunc database has been provided or not .
the database looks nice , but i 'm generally wary of any bioinformatics tool that i ca n't download and run on my own machine .
the authors provide several pipelines ( https :// github.com / mgalardini / screenings , https :// github.com / mgalardini / pangenome _ variation , https :// github.com / mgalardini / ecopredict ) , but none seems to perform the task of the mutfunc database .
the mutfunc database contains all the precomputed non - synonymous substitutions and their predicted impact using a variety of computational approaches .
as we described in the manuscript it includes predictions made with sift and foldx which are tools that are available as standalones .
a lot of work on our part went into running the calculations but the database itself is a front - end for all of the precomputed scores that we have obtained after many days of total compute time .
no actual computation is done by the mutfunc server as all possible variants along the genome are already pre - computed .
for these reasons there is no standalone tool as such that we can create .
as the reviewer may imagine , the results of the pre - computed consequences of all possible variants along the genomes of the 3 species currently in mutfunc are also not something that can be easily provided as a standalone tool .
the webservice we provide in mutfunc is not limited to searching small numbers of variants .
full genome variants can be queried with a very fast response time , since it is essentially looking up the pre - computed scores .
there is also no limit in getting the outputs of large numbers of queries .
we have added a few more details in the materials and methods section (" computation of all possible mutations and their effect ") regarding how we have run sift and foldx .
if the reviewer found specific limitations from the webserver we can try to address them .
we did try very hard to make all of the work associated with this publication available even before the work is published .
to further facilitate the re - use of our results , we have now added the sift and foldx scores for all the nonsynonymous variants observed in the strain collection to the ecoref website , in the download section ( https :// evocellnet.github.io / ecoref / download /) .
reviewer 2 : [...] we commend the authors for putting all of their data in easily accessible format on github with links out to all of the available assemblies and phenotype measurements .
this inclusion will ensure that the resource is easy to use for the research community .
however , one question remains regarding the new annotations for each strain. are these available anywhere ?
it was difficult to find them both on the web or in the authors' supplemental files .
we also believe that making this resource easy to use for the community is a crucial point to our manuscript and long - term vision .
we recognize that the gene annotations are important for the use of this resource and we therefore thank the reviewer to raise this point .
we have released the annotated genomes in the ecoref website (" strains " section ) .
the annotation for each strains are available in the standard and popular gff3 format .
the authors previously used this approach on yeast with a median predictive performance of 0.76 ( jelier et al .
2011 ) , but were only able to reliably predict 38 % of the conditions tested in this instance .
could the authors comment on why their performance was lower ?
if we understood the reviewer 's comment correctly , there might have been a misunderstanding .
we are not the authors of the 2011 yeast paper ( jelier et al. , 2011 ) .
as we highlighted in the introduction , jelier and coauthors have applied their predictive approach to a much smaller cohort of 15 strains across 20 conditions , most of which are related to metabolism .
we therefore postulate that one potential reason for our lower performance when compared to the previous study is the larger variety in the type of conditions in our screen , but also in their strength .
in fact some chemicals have been tested with multiple concentrations ( e.g. amoxicillin ) , some of which might be suboptimal to elicit a strong response from the tested strains , making a prediction potentially more difficult .
another reason may be the larger genetic diversity in bacteria in general , and of our library in particular .
we have added a short sentence in the discussion to explain the potential causes of these differences .
why did the authors use parsnp to compute phylogeny rather than other methods ( such as mlst , whole genome alignment , etc ) .
the authors look for a correlation between phylogeny and genotype .
could the lack of correlation be due to assumptions made when calculating the phylogeny ?
we believe that we might have failed to properly explain the procedure we followed to obtain the strains' phylogeny .
as the reviewers suggests , a whole genome alignment is one of the best way to obtain a phylogeny .
in fact , this is exactly what parsnp does : it aligns the whole genome of the input genomes and it then feeds such alignment to fasttree ( price et al. , 2010 ) which computes the final phylogeny .
we have updated the methods section to explicitly state how the method works .
why did the authors choose to incubate the most of the conditions at room temperature rather than the more common 37c ?
might this significantly impact their results ( i.e. would growth capabilities change if incubated at 37c ?) .
we did the strain collection phenotyping together with that of the keio gene - knockout collection - latter is part of a manuscript currently in preparation ( herrera - dominguez et al. ) .
we opted for room temperature because then we could simultaneously measure two readouts : growth and biofilm formation. e. coli forms biofilms only at 30c or below .
we have still not analyzed the biofilm readout , but will do in the future .
how do the authors define the " accessory genes / genome ". are these simply all genes that are not part of the core genome ?
could the authors comment on the completeness of the genomic sequences in the data set ?
as suggested by the reviewer , we indeed consider those genes that are not present in the " core genome " ( shared by all strains ) as part of the so - called " accessory genome " .
we are in fact following the definitions set up in the seminal pangenomics paper ( medini et al. , 2005 ) .
regarding the completeness of the genome sequences , we believe that this is a fair point of discussion whenever draft genomes are involved .
however , we are confident that the draft genomes we have collected / generated as part of this manuscript are of sufficient quality for nearly all genes to be correctly annotated .
as a way of example we have compared the pangenome size rarefaction curves ( computed using roary , page et al. , 2015 ) between a cohort of 376 complete e. coli genomes vs. the genomes from our collection .
in short , we have downloaded the complete genomes from ncbi 's refseq using the ncbi - genome - download script and annotated using prokka .
we have then computed their pangeome using roary , using the same options that were used for the strains presented in our study .
we have then plotted the pangenome size rarefaction curves , based on 10 shufflings of the strain 's order ( author response image 3 ) .
10.7554 / elife.31035.022 author response image 3 .
the rarefaction curves are indeed very similar to each other ; as expected the complete genomes set has a slightly higher number of total genes .
this is expected given the completeness of these genomes .
the difference with the strains presented in our study is however negligible .
furthermore , the core genome size of the refseq strains is composed of 2889 genes , versus 2815 for the genomes presented here , when considering 376 genomes .
we have updated the methods section to report on the completeness of the presented genomes. were snps only called for sequences in common with the reference e. coli k12 genome ?
would that potentially explain some of the discrepancies between the model predictions and the experimental outcome ?
as the conditionally essential genes are derived from the reference strain ( e. coli k12 ) , we decided to call genetic variants with respect to this strain .
as we have addressed in the discussion , we also believe that taking into account the impact of non - synonymous variants and the presence / absence of genes not present in the reference strain could improve our predictions .
however , at the moment we cannot reliably assign a function to accessory genes in order to extend the predictive models in this way .
does the term " mechanistic " appropriately describe the method used ?
especially when one considers disruption scores in many areas of a genome and the conditional essentiality of genes ?
we decided to adopt the term " mechanistic " as a contrast to more classical gwas - like studies , which are based on statistical inference .
since the impact of nonsynonymous variants can be related to a protein 's functional constraints ( i.e. sift ) or structural stability ( i.e. foldx ) , we believe that the term " mechanistic " is appropriate .
we have however added a short sentence in the introduction explaining what we intend when using this term .