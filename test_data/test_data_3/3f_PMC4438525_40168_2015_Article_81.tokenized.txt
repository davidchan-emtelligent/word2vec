microbiome microbiome microbiome 2049 - 2618 biomed central london 25995836 4438525 81 10.1186 / s40168 - 015 - 0081 - x research stability of operational taxonomic units : an important but neglected property for analyzing microbial diversity he yan bioyanhe @ gmail.com caporaso j gregory gregcaporaso @ gmail.com jiang xiao - tao biofuture.jiang @ gmail.com sheng hua - fang shenghuafang0727 @ 163.com huse susan m susan _ huse @ brown.edu rideout jai ram jai.rideout @ gmail.com edgar robert c robert @ drive5.com kopylova evguenia jenya.kopylov @ gmail.com walters william a waw49 @ cornell.edu knight rob robknight @ ucsd.edu zhou hong - wei biodegradation @ gmail.com state key laboratory of organ failure research , department of environmental health , guangdong provincial key laboratory of tropical disease research , school of public health and tropical medicine , southern medical university , guangzhou , 510515 china department of biological sciences , northern arizona university , po box 5640 , flagstaff , az 86011 - 5640 usa center for microbial genetics and genomics , northern arizona university , po box 4073 , flagstaff , az 86011 - 4073 usa department of pathology and laboratory science , warren alpert medical school , brown university , 70 ship street , providence , ri 02912 usa . , tiburon , ca 94920 usa department of pediatrics , university of california at san diego , 9500 gilman drive mc0763 , la jolla , ca 92093 - 0763 usa department of molecular biology and genetics , cornell university , 526 campus road , ithaca , ny 14853 usa department of computer science and engineering , university of california at san diego , 9500 gilman drive mc0763 , la jolla , ca 92093 - 0763 usa 20 5 2015 20 5 2015 2015 3 20 5 1 2015 3 4 2015 ( c ) he et al. ; licensee biomed central .
2015 this is an open access article distributed under the terms of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 4.0 ) , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly credited .
the creative commons public domain dedication waiver ( http :// creativecommons.org / publicdomain / zero / 1.0 /) applies to the data made available in this article , unless otherwise stated .
background the operational taxonomic unit ( otu ) is widely used in microbial ecology .
reproducibility in microbial ecology research depends on the reliability of otu - based 16s ribosomal subunit rna ( rrna ) analyses .
results here , we report that many hierarchical and greedy clustering methods produce unstable otus , with membership that depends on the number of sequences clustered .
if otus are regenerated with additional sequences or samples , sequences originally assigned to a given otu can be split into different otus .
alternatively , sequences assigned to different otus can be merged into a single otu .
this otu instability affects alpha - diversity analyses such as rarefaction curves , beta - diversity analyses such as distance - based ordination ( for example , principal coordinate analysis ( pcoa )) , and the identification of differentially represented otus .
our results show that the proportion of unstable otus varies for different clustering methods .
we found that the closed - reference method is the only one that produces completely stable otus , with the caveat that sequences that do not match a pre - existing reference sequence collection are discarded .
conclusions as a compromise to the factors listed above , we propose using an open - reference method to enhance otu stability .
this type of method clusters sequences against a database and includes unmatched sequences by clustering them via a relatively stable de novo clustering method .
otu stability is an important consideration when analyzing microbial diversity and is a feature that should be taken into account during the development of novel otu clustering methods .
electronic supplementary material the online version of this article ( doi : 10.1186 / s40168 - 015 - 0081 - x ) contains supplementary material , which is available to authorized users .
issue - copyright - statement ( c ) the author ( s ) 2015 background rapid advances in dna sequencing technologies over the past decade have allowed us to study communities of microorganisms in far greater depth than was previously possible .
many of these studies involve pcr amplification and sequencing of marker genes ( often the 16s small ribosomal subunit rna ( rrna )) from complex communities of organisms , which can then be compared to databases of known sequences to identify the taxa present in the microbial community .
these methods have led to the discovery of new organisms at a much faster rate than taxonomists can describe and name .
to facilitate taxonomy - independent analyses and to reduce the computational resources necessary for such , marker gene sequence reads are typically clustered based on sequence similarity , under the assumption that sequences with greater similarity represent more phylogenetically similar organisms .
these clusters , or operational taxonomic units ( otus ) , are widely used as an analytical unit in microbial ecology studies [ 1 ] .
due to the lack of a gold standard of ' correct ' otus , several measurements have been used to evaluate the performance of clustering methods , for example , rationality of otu structure [ 2,3 ] , computational efficiency ( that is , runtime and memory requirements ) [ 4 ] , and the ability to cope with otu inflation [ 5 ] .
however , otu stability has rarely been studied to date , despite the importance of this property .
here , we define the stability of an otu by whether it contains the same clustered sequence ( s ) regardless of the number of sequences that are clustered .
if otus are found to be unstable when clustering different numbers of sequences in different clustering runs , the sequences in a given otu may be assigned to different otus .
alternatively , sequences assigned to different otus can be assigned to a single otu .
roesch et al .
[ 6 ] reported the above detailed clustering artifact soon after next - generation sequencing was applied to 16s rrna .
using six different sequence subset sizes ( ranging from 10,000 to 53,632 sequences ) from a single canadian soil dataset , they showed that larger input sequence counts produced steeper rarefaction curves ( figure 1a ) .
rarefaction curves plot the alpha - diversity ( for example , the number of species or otus ) found within a given number of observations ( dna sequences ) .
rarefaction curves are widely used to test whether an environment has been sufficiently sequenced to observe all taxa and to extrapolate the total diversity of the sampled community [ 1,3 ] .
a rarefaction curve where the slope changes when calculated from a different number of initial sequences directly conflicts with the expected behavior of such a curve and challenges the fundamental principle that the diversity of a whole community can be estimated from a sequenced sample .
figure 1 rarefaction curves , principles underlying unstable complete linkage ( cl ) clustering , and pcoa based on the bray - curtis distance .
( a ) rarefaction curves generated with cl clustering at five different depths .
point a is the number of otus at 30,000 sequences from the 100 % dataset , and point b is the number of otus at 30,000 sequences from the 60 % dataset .
( b ) principles underlying unstable cl clustering at two sampling depths .
white circles indicate individual sequences that were included in both the small and the large subsamples , and dark circles indicate sequences that were added only in the large subsample .
lines indicate pairs of sequences with distances equal to or smaller than the threshold , which could therefore be linked into a single otu .
large circles in red or blue indicate otus in the small and the large subsamples , respectively .
( c ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using cl. all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
in this study , we reveal that unstable otus lead to non - overlapping rarefaction curves .
we further show that these unstable otus can also affect beta - diversity analyses .
we also evaluated existing de novo and reference - based clustering methods to show that all de novo clustering methods are unstable to some extent , while closed - reference clustering generates stable otus .
closed - reference clustering has the considerable limitation of excluding any otus that are not defined in a pre - existing reference set , which in turn excludes novel otus from analysis .
as a compromise between generating otu instability and the potential elimination of novel taxa , we recommend using open - reference otu clustering [ 7 ] , which we show to result in more stable otus than fully de novo clustering methods .
results and discussion changing membership of otus at different sequencing depths ( otu instability ) - a neglected but important property for analyses of microbial diversity to illustrate the problem created by unstable otus , we reproduced the non - overlapping rarefaction curves using the same dataset ( canada soil dataset ) and the same clustering method ( complete linkage clustering , referred to as cl clustering ) employed by roesch et al .
( figure 1a ) .
we randomly subsampled the raw sequences at four sequencing depths ( 20 % , 40 % , 60 % , and 80 % of the input sequences ) using 30 replicates of each .
we then used complete linkage ( cl ) clustering to cluster each of the subsamples ( definitions of all clustering methods can be found in additional file 1 ) and generated rarefaction curves for each sampling depth .
in the case of cl clustering , the rarefaction curve produced by a larger subsample is steeper than that produced by a smaller subsample .
one goal when generating rarefaction curves is to support interpolation , meaning that if we create a rarefaction curve from a full dataset , we would like to use that curve to determine how many species would be observed for some number of sequences that amounts to less than the total .
for example , when we interpolate from the rarefaction curve created from a full dataset , we estimate that we have approximately 4,500 species if we randomly select 30,000 sequences from the full dataset ( point a in figure 1a ) .
the problem that non - overlapping rarefaction curves pose for interpolation , however , is that if we instead randomly subsampled 30,000 sequences from an 80 % subsample of the full dataset , we would estimate that only 4,200 species are represented by these 30,000 sequences ( point b in figure 1a ) .
this scenario would essentially be true in cases where only a few sequences were collected per sample , a phenomenon that conflicts with the expected behavior of rarefaction curves .
we have observed that the non - overlapping of rarefaction curves , as illustrated in figure 1a , is actually caused by the instability of otu clustering methods .
in other words , the cluster that a sequence is assigned to can be affected by the number of sequences being clustered .
an illustration of this hypothesis is shown in figure 1b .
if we observe only two sequences , s1 and s2 , within the similarity threshold ( indicated by linking with a bar ) , they are clustered into a single otu ( otu1 ) .
we then add three more sequences , s3 , s4 , and s5 , which could be linked to s1 or to s2 , but several pairwise distances exceed the threshold ( these pairs are not linked by bars ). by definition of cl , pairwise distances for all sequences assigned to a single otu must fit within the distance threshold [ 8,9 ] , which could allow s1 and s2 to be separated into otu2 and otu3 .
otu1 disappears at this sequencing depth , and its sequences are reassigned to two different otus , illustrating the problem of otu instability .
theoretically , adding more sequences tends to split existing otus when using the cl algorithm .
as a result , when being clustered with a larger dataset versus a smaller dataset , the same sequences will be grouped into more otus .
this will result in a steepening of the rarefaction curve that is derived from the larger sample and the conclusion that it has a higher alpha - diversity .
rarefaction curves that arise from cl are therefore more sensitive to sequencing depth .
though this effect is weak , it still partially illustrates why , in some cases , the collecting of a number of sequences that is based on a smaller sample size would be expected to produce a rarefaction curve that reaches a plateau , and instead a continually increasing rarefaction curve is produced .
this phenomenon of an individual being assigned to different otus simply because of increased or decreased sampling depth is obviously problematic .
an analogous situation based on traditional ( macro - scale ) ecology would be if counting different numbers of birds within a fixed area led to the redefinition of which individual birds group together as a species .
however , the above - described instability is not due to the occasional identification of novel species , as might be the case in traditional ecology .
in contrast , these changes to otu membership occur systematically within a large proportion of the sequences being reassigned between otus .
to further investigate the effect of unstable otus on biological interpretation , we next explored beta - diversity using ordination .
using principal coordinate analysis ( pcoa ) , we compared the microbial communities against the full dataset using subsamples comprising 60 % of the full dataset .
we repeated this subsampling 30 times to create replicates .
we then used cl clustering to cluster all of the subsamples , as well as the full dataset , and combined the clustering results by representative otu sequence ( defined as the most abundant sequence in each otu ) .
the samples were then randomly rarefied to include 30,000 sequences per sample , including the 30 replicate rarefactions that resulted from the clustering of the full dataset .
following rarefaction , all samples contained the same number of sequences so that the only differences among them were the number of sequences that were initially clustered .
pcoa demonstrated that these samples separated according to the number of sequences that were initially clustered , indicating that otu instability results in the same samples appearing to have different compositions ( figure 1c ) .
a similar result was observed when comparing the 20 % , 40 % , and 80 % subsamples against the full dataset ( additional file 2 : figure s1 ) .
furthermore , 125 otus ( after false discovery rate ( fdr ) correction ) and 26 otus ( after bonferroni correction ) were determined to be significantly different between these two groups using the mann - whitney u test .
we also tested the effect that unstable otus have on calculating taxonomic composition and found the effect to be very limited ( additional file 3 : figure s2 and additional file 4 ) .
this is because these otus are still assigned to the same taxa as a consequence of their phylogenetic proximity , despite the fact that they are changing when more sequences are added using cl ( also discussed below in the section detailing the tolerance of pcoa to using phylogenetic metrics with unstable otus ) .
alternative hierarchical and greedy clustering methods also produce unstable otus all hierarchical methods that are used to determine otu membership are based on pairwise distances between the sequences in otus .
cl clustering requires the pairwise distance between all sequences in one otu to fit within the distance threshold .
single linkage ( sl ) clustering requires the pairwise distance between any pair of sequences in one otu to fit within the distance threshold .
average linkage ( al ) clustering requires the average pairwise distances between all sequences in one otu to fit within the distance threshold .
as would be expected when using sl clustering ( figure 2a ) , otus tend to be merged when more sequences are added , which is the opposite of the splitting problem that is observed with cl. accordingly , rarefaction curves created using sl become less steep as subsample size increases ( figure 2b ) .
beta - diversity is also affected by unstable sl clustering of otus ( figure 2c ) .
for example , 167 otus ( after fdr correction ) and 36 otus ( after bonferroni correction ) were determined to be differentially represented across both the 60 % subsample and the full dataset .
figure 2 principles underlying unstable single linkage ( sl ) clustering , rarefaction curves , and pcoa based on the bray - curtis distance .
( a ) principles underlying unstable sl clustering at two sampling depths .
white circles indicate individual sequences that were included in both the small and the large subsamples , and dark circles indicate sequences that are added only in the large subsample .
lines indicate pairs of sequences with distances equal to or smaller than the threshold , which could therefore be linked into a single otu .
large circles in red or blue indicate otus in the small and the large subsamples , respectively .
( b , d ) rarefaction curves generated with sl ( b ) and average linkage ( al ) ( d ) clustering at five different depths .
( c , e ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using sl ( c ) and al ( e ) .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
the instability produced by average linkage is more complicated because both otu splitting and otu merging can occur .
these conflicting effects lead to more subtle differences in otu counts , and the resultant rarefaction curves that are created with al overlap at different depths ( figure 2d ) .
furthermore , the al otus themselves are unstable ( additional file 5 : figure s3 ) due to the large number of otu splitting and merging events that occur .
additionally , even though these unstable otus affect beta - diversity ( adonis , r = 0.16 , p = 0.001 ) , the major separation in pcoa appears to be caused by factors other than sample size ; for example , the possible inclusion of differences that result from the input order of the sequences or the presence or absence of certain key sequences within different subsamples ( figure 2e ) .
this observation may result from the sensitivity of al to the order of input sequences , which would result in different clustering patterns .
when using al , 804 otus ( after fdr correction ) and 5 otus ( after bonferroni correction ) were differentially represented across the two sampling depths .
greedy clustering , such as that which is implemented in usearch , is another commonly used de novo clustering method that is more computationally efficient than cl , sl , and al. when using greedy clustering , a sequence must be within the distance threshold of a single otu centroid to be clustered in that otu .
furthermore , sequences are processed in a defined order , and each query sequence will either be assigned to an existing otu or as the centroid of a new otu .
if one query sequence is within the distance threshold of multiple existing otu centroids , it can be assigned to either the closest centroid ( here referred to as distance - based greedy clustering ( dgc )) or the most abundant centroid ( here referred to as abundance - based greedy clustering ( agc )) ( additional file 1 ) .
alternative approaches exist for breaking such ties ; however , we chose to limit our focus to those that are the most commonly employed .
in the present study , we evaluate usearch as a method for greedy clustering ( we did not evaluate uparse because its clustering algorithm is the same as that used in usearch ) .
otu instability is also a problem in greedy clustering methods and arises from several sources .
first , the choosing of centroids is highly dependent on the order in which sequences are processed .
therefore , when the size of a sample is changed , the order of sequences may also be changed .
second , when using dgc , even if the choice of centroids remains stable when the size of the sample is increased , the added sequences can become new centroids and attract members from existing otus ( this generally will not happen in agc ) .
for example , imagine that s10 , s11 , and s12 form otu7 with s10 as the centroid ( figure 3a,b ) .
if in a subsequent sequencing run another sequence , s13 , is added , the processing order of the larger sample may become s10 , s13 , s11 , and s12 .
in this case , s10 will still be a centroid , but s13 will also become a centroid .
s13 then recruits s11 , as the distance between the two is smaller than the distance between s11 and s10 .
in dgc , s11 will end up clustering with s13 rather than s10 , and the original otu7 will be split into otu8 and otu9 ( figure 3a ) .
in agc , s11 will still cluster with s10 and the original otu7 will retain its original structure ( figure 3b ) .
figure 3 principles underlying unstable distance - based greedy clustering ( dgc ) and abundance - based greedy clustering ( agc ) , rarefaction curves , and pcoa based on the bray - curtis distance .
( a , b ) principles underlying unstable dgc ( a ) and agc ( b ) at two sampling depths .
white circles indicate individual sequences that were included in both the small and the large subsamples , and dark circles indicate sequences that were added only in the large subsample .
yellow dots indicate otu centroids .
lines indicate pairs of sequences with distances equal to or smaller than the threshold , which could therefore be linked into a single otu .
large circles in red or blue indicate otus in the small and the large subsamples , respectively .
( c , d ) rarefaction curves generated with dgc ( c ) and agc ( d ) at five different depths .
( e , f ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using agc ( e ) and dgc ( f ) .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
we used greedy clustering on alpha rarefaction curves and beta - diversity pcoa to analyze the effects generated by unstable otus .
as stated above , dgc and agc both suffer from centroid changeability ( this effect is not biased towards otu splitting or merging ) , and dgc additionally suffers from the splitting of existing otus .
as a result , dgc and cl clustering produced similar curves , which became steeper as subsample size increased ( figure 3c ) .
in contrast , agc produced overlapped curves that were unaffected by depth ( figure 3d ) .
however , as with al clustering , this does not mean that the otus were stable , but only that similar numbers of ( possibly different ) otus were obtained at the different subsampling depths .
the unstable otus produced in dgc and agc effect estimations of beta - diversity ( figure 3e,f ) .
in the case of agc , 392 otus ( after fdr correction ) and 14 otus ( after bonferroni correction ) were determined to be differentially represented across the two depths , and in the case of dgc , these numbers were 370 and 15 , respectively .
to quantify the differences between these unstable methods , we compared the proportion of unstable sequences and unstable otus ( figure 4a,b ; additional file 6 : table s1 ) .
cl produced the highest proportion of unstable sequences ( approximately 22 %) , while al ( 13 %) and agc ( 12 %) performed slightly better than sl ( 15 %) and dgc ( 14 %) .
these results were not always consistent when comparing the use of alternative datasets ( additional file 7 : figure s6 ) ; however , agc generally demonstrated the best performance versus the other de novo methods .
for unstable otus , cl and dgc produced the highest proportion of unstable otus : approximately 60 % of otus with centroids with frequencies greater than or equal to 10 were observed to be unstable in each of the methods (> 90 % were found to be unstable when analyzing certain datasets , as shown in additional file 7 : figure s6 ) .
al and sl are more stable than either cl or dgc but still resulted in greater than 30 % otu instability for centroids being observed at least 10 times .
agc was found to be the most stable de novo method , especially for otus with highly abundant centroids .
figure 4 proportion of unstable sequences , proportion of unstable otus , and mcc value of each method .
( a ) proportion of unstable sequences as created by method .
unstable sequences are defined as sequences that are clustered to one centroid in the 60 % subsample but clustered to a different centroid in the 100 % ( full ) dataset .
( b ) proportion of unstable otus as created by method and by frequency of cluster centroids ( the values for closed - reference and dereplication are zero and are thus not included in this figure ) .
if an otu was identical in the 60 % and 100 % datasets ( not including sequences that are not present in the 60 % subsample ) , it is defined as stable .
( c ) mcc value of each method .
higher values correspond to greater stability .
one de novo clustering method that does produce stable otus is dereplication or the clustering of sequences that are identical and of equal length ( additional file 8 : figure s4a ) .
as with closed - reference otu clustering , all otus remain absolutely stable across different sequencing depths because clustering is not affected by the composition of the sequence collection being clustered .
as a result , rarefaction curves produced using dereplication are overlapping across different depths ( additional file 8 : figure s4b ) , and beta - diversity is not affected by the size of the subsamples ( additional file 8 : figure s4c ) .
moreover , not a single otu is determined to be significantly different between the two groups .
it is important to note that dereplication is highly vulnerable to identifying spurious otus that result from sequencing error .
due to its stability in binning otus , it also produces overlapping rarefaction curves across different depths , indicating that unstable otus ( rather than sequencing errors ) are the main cause of non - overlapping rarefaction curves .
furthermore , the stability of the dereplication method suggests that a higher similarity threshold for clustering may reduce the occurrence of unstable otus , as de novo clustering methods become more similar to dereplication as the similarity threshold increases .
in practice , dereplication clustering yields high numbers of otus , which is computationally expensive to employ downstream .
thus , modern dataset sizes prevent us from working with sequences that have only been dereplicated .
it is possible that future methods may use approaches based on dereplication to manage the problem of otu instability .
another extreme example would be the clustering of all sequences into one otu while that otu remains absolutely stable .
nevertheless , unlike dereplication , otus can be utilized in further analyses , such as alpha - diversity , beta - diversity , and taxonomic composition .
furthermore , clustering all sequences into one otu can hardly be called ' clustering ' and is completely useless for downstream analysis .
reference - based methods minimize the problem of unstable otus one feature that all unstable clustering methods have in common is that cluster definitions are dependent upon the input sequences .
closed - reference otu clustering avoids this dependence with one major practical limitation : during closed - reference otu clustering , reads are clustered against a reference dataset ( for example , the greengenes database [ 9 ]) of pre - calculated centroids and no new centroids are created during clustering , which results in perfectly stable otus ( figure 5a ) .
as a result , alpha - and beta - diversity estimations based on closed - reference clustering are not affected by the size of samples ( figure 5b,c ) , and no otus are determined to be significantly different between the two depths .
in addition to producing stable otus , closed - reference clustering provides several other convenient features .
first , the names of the reference sequences can be used as universal otu identifiers rather than using arbitrarily assigned names , thus facilitating the direct comparison of otus across studies .
second , sequence reads from different marker gene regions can be clustered together if the reference dataset consists of full - length marker genes .
finally , closed - reference clustering can parallelize otu clustering for large datasets .
the major limitation of closed - reference otu clustering is that reads that are outside the similarity threshold to any reference centroids are discarded , such that only the otus that are already represented in the database can be ' observed . '
in processing the canada soil dataset , approximately 14 % of the sequences could not be matched to the reference sequences and were therefore discarded after clustering .
this limitation of closed - reference otu clustering may become trivial as projected improvements are made to reference datasets , leading the corresponding references needed for specific research projects ( for example , the gut microbiome ) to become more highly developed .
figure 5 principles underlying stable closed - reference clustering , rarefaction curves , and pcoa based on the bray - curtis distance .
( a ) principles underlying stable closed - reference clustering at two sampling depths .
white circles indicate individual sequences that were included in both the small and the large subsamples , and dark circles indicate sequences that were added only in the large subsample .
diamonds indicate reference sequences .
lines indicate pairs of sequences with distances equal to or smaller than the threshold , which could therefore be linked into a single otu .
large circles in red or blue indicate otus in the small and the large subsamples , respectively .
( b ) rarefaction curves generated with closed - reference clustering at five different depths .
( c ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using closed reference clustering .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
to overcome the limitations of closed - reference otu clustering , open - reference otu clustering can be used .
open - reference clustering begins in the same way as closed - reference clustering but continues to cluster the sequences that do not match the reference collection in a de novo manner .
although existing de novo clustering methods produce unstable otus , open - reference clustering can be much more stable than such methods because many sequences are initially clustered by the closed - reference approach .
we evaluated otu stability in open - reference clustering using agc for the de novo clustering step ( figure 4a,b,c ) and found it to be a much more effective method than using de novo methods alone .
the majority of the unstable otus were low abundance sequences with no reference match ( a category of sequences that is commonly considered to be error - prone ) .
open - reference otu clustering produces overlapping rarefaction curves ( additional file 9 : figure s5a ) , and even though the instability of open - reference otu clustering still affects pcoa analysis ( additional file 9 : figure s5b ) , the pc and r value ( by adonis , r = 0.03 ) is lower than with any other de novo method alone , as is the number of otus that are differentially represented across the two groups ( 104 otus after fdr correction and 2 otus after bonferroni correction ) .
we compared open - reference clustering methods with other de novo methods on additional datasets , focusing on the proportion of unstable sequences and unstable otus and found that these results are generally consistent across environment types and sequencing technologies ( additional file 7 : figure s6 ) .
in addition to quantifying the instability of otus , we used the mcc index to investigate how the clustering of sequence pairs changed based on clustering of the full dataset versus the 60 % subset ( figure 4b , additional file 6 : table s2 ) .
it is clear that the two reference - based methods and dereplication clustering have the highest stability by this metric and that agc is the most stable of the de novo clustering methods ( kruskal - wallis test , p < 0.05 ) .
al had the lowest mcc value , indicating that the clustering of many sequences pairs changed when using this method .
alternatively , sl produced a higher mcc value than most of the de novo methods , including al and cl. nevertheless , part of the reason for the high mcc value of sl is that its fp value equals 0 ( sequences that are separated in a smaller subsample will be merged into a single otu in a larger subsample , but the reverse situation does not happen at all ) .
thus , due to its severe problems with otu merging , sl should not be considered a much more stable method .
phylogenetic beta - diversity metrics minimize the effect of otu instability unlike non - phylogenetic metrics , where all otus are considered equally dissimilar from each other , phylogenetic metrics such as unifrac take into account the phylogenetic relationship between otus when calculating distances between samples .
unstable otu clustering methods will move sequences between otus that would usually be closely related evolutionarily so that the calculated distance between samples should generally remain more similar than it would when using non - phylogenetic diversity metrics .
we re - analyzed the effect of unstable otus on beta - diversity using cl , sl , al , agc , and dgc based on unifrac distance ( additional file 10 : figure s7 ) .
the results show that unstable otus of cl , agc , and dgc minimally affect beta - diversity using unifrac distance , confirming the hypothesis that when sequences are changing between closely related otus with these unstable methods , phylogenetic metrics are more tolerant to that instability .
nevertheless , in sl clustering , distantly related otus can ultimately be joined into a single otu , so that beta - diversity can be affected even when using unifrac distance .
in al , the major separation is still caused by different clustering patterns , as with the non - phylogenetic metrics .
conclusions assigning an organism to a different species based on the number of individuals included in a given census is obviously problematic in traditional macro - ecology .
unfortunately , due to an artifact of many otu clustering methods , the equivalent situation is common in microbial ecology studies that use taxonomic - independent methods .
this study demonstrated for the first time that the problem of depth - dependent rarefaction curves that is inherent in most of the de novo clustering algorithms arises from unstable otus and not from sequencing errors .
furthermore , unstable otus may also contribute to depth - dependent beta - diversity estimates and otu membership .
our results demonstrate that the closed - reference otu clustering method provides stable otus , while all other de novo clustering methods ( except dereplication ) produce unstable otus .
unfortunately , the closed - reference otu method is limited by the availability of databases of known marker gene sequences , which excludes novel otus from analysis .
to balance this caveat of closed - reference otu clustering against the problem of otu instability , we recommend using open - reference otu clustering employing agc ( for example , as implemented using uclust [ 4 ] in qiime [ 7 ]) , a relatively stable de novo method , to cluster sequences that did not map to the reference database .
this allows for clustering of all sequences and introduces minimal otu instability compared to de novo otu clustering methods ( which also cluster all sequences ) .
as new otu clustering algorithms continue to be rapidly developed , we suggest that otu stability should be an important consideration in future endeavors .
however , we do not argue that otu stability is the most important quality of clustering methods .
other attributes of clustering methods , such as diminishing sequencing errors , rational otu structure , niche consistency , and time efficiency , should also be considered when choosing a method for a specific type of analysis or evaluating a novel approach to clustering .
furthermore , as the 16s rrna gene database is expanding , closed - reference otu clustering and new algorithms that bypass otu clustering altogether during microbiome analysis may render problems concerning otu instability obsolete .
methods the ' canada soil ' dataset [ genbank : ef308591 - ef361836 ] was originally used to describe that rarefaction curves generated from the same dataset but at different depths often do not overlap [ 6 ] and is used here to demonstrate unstable otus .
this dataset was one of the earliest reported 454 datasets , and quality information was not available for the sequences contained therein .
although we demonstrated in the results section ( via the dereplication method ) that otu instability is introduced by clustering algorithms and not by sequencing errors , we nevertheless removed sequences that contained ambiguous bases ( n ) , potential chimeras identified by uchime using the de novo mode ( using - - minchunk 20 - - xn 7 - noskipgaps 2 ) [ 10 ] , and sequences that were of a length that ranged outside of two standard deviations from the mean .
such sequences were removed for quality control purposes ( in the absence of quality scores ) .
the original dataset contained a total of 53,246 sequences , and 13,469 unique sequences remained after dereplication .
following our quality control measures , a total of 50,542 sequences with 13,293 unique tags remained , ranging in length from 86 to 120 bp. the hierarchical clustering algorithms , cl , al , and sl , were run using mothur 1.27 [ 11 ] .
the same pairwise needleman - wunsch distance matrix ( with default parameters ) was calculated for each pair of unique sequences and used in the three clustering algorithms at a 97 % identity threshold .
we used the qiime 1.7.0 [ 12 ] usearch 6.1 wrapper [ 4 ] for the agc and dgc greedy clustering algorithms .
we used qiime 1.7.0 [ 12 ] with the greengenes 13 _ 8 database for closed - and open - reference clustering .
these clustering methods are further defined in additional file 1 , along with commands used the execute them .
to investigate the effect of sequencing depths on rarefaction curves , we subsampled our input data ( prior to otu clustering ) at 5 depths ( 20 % , 40 % , 60 % , 80 % , and 100 % of the total data ) , with 30 replicates at each depth .
we then clustered each of these datasets with each of the clustering methods and created rarefaction curves .
the presented data included the average rarefaction curve across all replicates for each clustering method at each depth .
to demonstrate the effect of sequencing depth on beta - diversity , we subsampled our input data to include 60 % of sequences prior to otu clustering and compared it with the full dataset ( the first round of subsampling was to create a 60 % subsample to compare with the full dataset ) .
because de novo clustering methods do not provide universal otu identifiers , after clustering each of these datasets , we combined the clustering results according to a representative sequence of each otu ( which we chose to be the most abundant sequence in each otu ) .
in this way , otus with the same representative sequences were merged into a single otu .
we then created a biom file [ 13 ] from the merged otus for further analyses .
we computed beta - diversity using qiime 1.7.0 with all samples rarefied to 30,000 sequences per sample ( 60 % of the total dataset , the second round of subsampling ; to diminish the effect of depth on pcoa , we only tested the effect of unstable otus on pcoa ) .
to accomplish this , we employed the bray - curtis distance ( a non - phylogenetic metric ) and weighted unifrac ( a phylogenetic metric ) .
adonis was used to test whether the samples from the full dataset and the 60 % subset clustered independently of each other and to quantify the size of that effect ( this was performed by running compare _ categories.py - - method adonis - i dm.txt - m map.txt - c treatment - o adonis _ out - n 999 ) .
we used a proportion of unstable sequences , a proportion of unstable otus , and matthews 's correlation coefficient ( mcc ) to quantify otu stability .
unstable sequences were defined to include unique sequences that were represented by different otu centroids at the different sequencing depths .
unstable otus were defined to include otus whose membership changed at different sequencing depths ( in other words , if an otu is composed of the same sequences at different sequencing depths , excluding sequences that were not included in the smaller subsample , then that otu is defined as being stable ) .
to compute the percent of unstable sequences and unstable otus , we compared the clustering result of the full dataset with that of the 60 % subsample using different clustering methods to analyze 30 replicates for each method .
if a unique sequence was represented by the same representative sequence in both the 60 % and the full dataset ( excluding sequences not present in the 60 % dataset ) , we considered the sequence to be stable .
otherwise , the sequence was considered to be unstable .
if an otu in the 60 % subsample contained all of the same sequences as the full dataset ( not including any sequences not present in the 60 % subsample ) , we considered the otu to be stable .
otherwise , we considered the otu to be unstable .
we additionally grouped all of the otus according to the frequency of their centroid at counts of 1 , 2 , 3 to 5 , 6 to 10 and higher than 10 , for the purpose of evaluating the stability of each of these groups .
to compute mcc , we recorded how each pair of sequences was clustered in the 60 % subsample and the full dataset .
the mcc value is calculated as follows :\ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ \ mathrm { m }\ mathrm { c }\ mathrm { c }=\ frac {\ left (\ mathrm { t }\ mathrm { p }\ times \ mathrm { t }\ mathrm { n } - \ mathrm { f }\ mathrm { p }\ times \ mathrm { f }\ mathrm { n }\ right )}{\ sqrt {\ left (\ mathrm { t }\ mathrm { p }+\ mathrm { f }\ mathrm { p }\ right )\ times \ left (\ mathrm { t }\ mathrm { p }+\ mathrm { f }\ mathrm { n }\ right )\ times \ left (\ mathrm { t }\ mathrm { n }+\ mathrm { f }\ mathrm { p }\ right )\ times \ left (\ mathrm { t }\ mathrm { n }+\ mathrm { f }\ mathrm { n }\ right )}} $$\ end { document } mcc = tpxtn - fpxfntp + fpxtp + fnxtn + fpxtn + fn if two sequences were clustered together in the full dataset and also in the 60 % subsample , we recorded it as a true positive ( tp ) .
if two sequences were clustered separately in the full dataset and also in the 60 % subsample , we recorded it as a true negative ( tn ) .
if two sequences were clustered together in the full dataset but not in the 60 % subsample , we recorded it as a false negative ( fn ) .
finally , if two sequences were clustered separately in the full dataset but together in the 60 % subsample , we recorded it as a false positive ( fp ) .
higher mcc values indicate enhanced stability of the clustering method .
additional files additional file 1 : box 1 .
definitions of otu clustering algorithms and executing commands , as used in this paper .
additional file 2 : figure s1 .
pcoa based on the bray - curtis distance , comparing 20 % , 40 % , 60 % , and 80 % subsamples with the full datasets using cl. all of the subsamples were rarefied to 10,000 sequences per sample ( 20 % of the full dataset ) to be included in this analysis .
additional file 3 : figure s2 .
phylum level composition , comparing 60 % and full datasets using cl. all of the subsamples were rarefied to 30,000 sequences per sample ( 60 % of the full dataset ) to be included in this analysis .
additional file 4 : taxonomic composition from phylum to genus level , comparing 60 % and full datasets using cl. all of the subsamples were rarefied to 30,000 sequences per sample ( 60 % of the full dataset ) to be included in this analysis .
additional file 5 : figure s3 .
cytoscape network diagram showing the changes in otus at 60 % and 100 % subsamples of datasets using the al method .
red dots represent otus in the 60 % dataset , and blue dots represent otus in the full dataset .
the size of the otu is in proportion to the frequency of the centroid or representative sequence in each otu .
otus that changed between datasets but that share the same sequences are linked , and the line width is in proportion to the number of shared sequences between the two otus .
otus that are exactly the same in the two datasets are not shown in the picture , such that each dot in this figure represents an unstable otu .
additional file 6 : tables s1 and s2 table 1 .
multiple comparisons of unstable sequences between different clustering methods after the kruskal - wallis test .
table 2 .
multiple comparisons of mcc values between different clustering methods after the kruskal - wallis test .
additional file 7 : figure s6 .
rarefaction curve analyses and percentage of changed otus with seven additional datasets ( a1 - f1 ) agc ; ( a2 - f2 ) closed - reference ; ( a3 - f3 ) open - reference ; ( a4 - f4 ) proportion of unstable sequences by method ; ( a5 - f5 ) percentage of unstable otus for different centroid frequencies .
( a1 - a5 ) illumina sequencing of v6 regions from azorean shallow marine vents ( srx011425 ) ; ( b1 - b5 ) 454 sequencing of v3 v5 regions of hmp project data male stool ( srs011410 ) ; ( c1 - c5 ) 454 sequencing of v5 v6 regions from little sippewissett marsh ( srx210127 ) ; ( d1 - d5 ) 454 sequencing of v3 region of a stool sample ( srp005150 ) ; ( e1 - e5 ) 454 sequencing of v3 region of a stool sample ( srs052471 ) ; ( f1 - f5 ) illumina sequencing of v6 region ( overlapped sequence ) of a mangrove sediment sample ( mg - rast 4490068.3 ) .
additional file 8 : figure s4 .
principles underlying stable dereplication clustering , rarefaction curves , and pcoa based on the bray - curtis distance .
( a ) principles underlying stable dereplication clustering at two sampling depths .
white circles indicate individual sequences that were included in both the small and the large subsamples , and dark circles indicate sequences that were added only in the large subsample .
large circles in red or blue indicate otus in the small and the large subsamples , respectively .
( b ) rarefaction curves generated with dereplication clustering at five different depths .
( c ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using de - replication clustering .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
additional file 9 : figure s5 .
rarefaction curves and pcoa based on the bray - curtis distance .
( a ) rarefaction curves generated with open - reference otu clustering at five different depths .
( b ) pcoa based on the bray - curtis distance , comparing 60 % subsamples with the full datasets using open - reference otu clustering .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
additional file 10 : figure s7 .
pcoa with weighted unifrac , comparing 60 % subsamples with the full datasets using de novo clustering methods .
all of the subsamples were rarefied to 30,000 sequences per sample to be included in this analysis .
competing interests the authors declare that they have no competing interests .
authors' contributions yh , xtj , smh , rk , and hwz conceived the method ; jgc , jrr , rce , and waw implemented the software ; yh , xtj , jgc , hfs , smh , and hwz performed the experiments and analyzed the data ; yh , smh , jgc , jk , ek , rk , and hwz wrote the manuscript .
all authors read and approved the final manuscript .
acknowledgements this work was supported by the national natural science foundation of china ( nsfc 31270152 and 31322003 ) , the comra project ( dy125 - 15 - r - 01 ) , the program for new century excellent talents in university ( ncet - 11 - 0921 ) , the guangdong natural science foundation ( s2011010004136 ) , the educational commission of guangdong province , china ( 2012kjcx0031 ) , a grant awarded by the united states national science foundation [ nsf / bdi 0960626 to smh ] , and grants awarded by the national institutes of health and the howard hughes medical institute .
references 1 .
the human microbiome project consortium a framework for human microbiome research nature 2012 486 215 21 10.1038 / nature11209 22699610 2 .
jiang x - t zhang h sheng h - f wang y he y zou f zhou h - w two - stage clustering ( tsc ) : a pipeline for selecting operational taxonomic units for the high - throughput sequencing of pcr amplicons plos one 2012 7 e30230 10.1371 / journal.pone.0030230 22253923 3 .
schloss pd westcott sl assessing and improving methods used in operational taxonomic unit - based approaches for 16s rrna gene sequence analysis appl environ microbiol .
2011 77 3219 26 10.1128 / aem.02810 - 10 21421784 4 .
edgar rc search and clustering orders of magnitude faster than blast bioinformatics .
2010 26 2460 1 10.1093 / bioinformatics / btq461 20709691 5 .
edgar rc uparse : highly accurate otu sequences from microbial amplicon reads nat methods .
2013 10 996 8 10.1038 / nmeth.2604 23955772 6 .
roesch lfw fulthorpe rr riva a casella g hadwin akm kent ad pyrosequencing enumerates and contrasts soil microbial diversity isme j .
2007 1 283 90 18043639 7 .
rideout jr he y navas - molina ja walters wa ursell lk gibbons sm subsampled open - reference clustering creates consistent , comprehensive otu definitions and scales to billions of sequences peer j .
2014 2 e545 10.7717 / peerj.545 25177538 8 .
huse sm welch dm morrison hg sogin ml ironing out the wrinkles in the rare biosphere through improved otu clustering environ microbiol .
2010 12 1889 98 10.1111 / j.1462 - 2920.2010.02193.x 20236171 9 .
mcdonald d price mn goodrich j nawrocki ep desantis tz probst a an improved greengenes taxonomy with explicit ranks for ecological and evolutionary analyses of bacteria and archaea isme journal .
2011 6 610 8 10.1038 / ismej.2011.139 22134646 10 .
edgar rc haas bj clemente jc quince c knight r uchime improves sensitivity and speed of chimera detection bioinformatics .
2011 27 2194 200 10.1093 / bioinformatics / btr381 21700674 11 .
schloss pd westcott sl ryabin t hall jr hartmann m hollister eb introducing mothur : open - source , platform - independent , community - supported software for describing and comparing microbial communities appl environ microbiol .
2009 75 7537 41 10.1128 / aem.01541 - 09 19801464 12 .
caporaso jg kuczynski j stombaugh j bittinger k bushman fd costello ek qiime allows analysis of high - throughput community sequencing data nat methods .
2010 7 335 6 10.1038 / nmeth.f.303 20383131 13 .
daniel mcdonald jcc justin k jai ram r jesse s doug w andreas w the biological observation matrix ( biom ) format or : how i learned to stop worrying and love the ome - ome giga science .
2013 1 7 10.1186 / 2047 - 217x - 1 - 7 23587224