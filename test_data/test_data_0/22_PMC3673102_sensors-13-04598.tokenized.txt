sensors ( basel ) sensors ( basel ) sensors ( basel , switzerland ) 1424 - 8220 molecular diversity preservation international ( mdpi ) 23567527 3673102 10.3390 / s130404598 sensors - 13 - 04598 article optical system error analysis and calibration method of high - accuracy star trackers sun ting 12 xing fei 12 * you zheng 12 1 department of precision instruments and mechanology , tsinghua university , beijing 100084 , china ; e - mails : sunting09 @ mails.tsinghua.edu.cn ( t.s. ) ; yz - dpi @ mail.tsinghua.edu.cn ( z.y . )
2 state key laboratory of precision measurement technology and instruments , tsinghua university , beijing 100084 , china * author to whom correspondence should be addressed ; e - mail : xingfei @ mail.tsinghua.edu.cn ; tel. : + 86 - 10 - 6277 - 6000 ; fax : + 86 - 10 - 6278 - 2308 .
4 2013 08 4 2013 13 4 4598 4623 29 12 2012 27 3 2013 03 4 2013 ( c ) 2013 by the authors ; licensee mdpi , basel , switzerland .
2013 this article is an open access article distributed under the terms and conditions of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 3.0 /) .
the star tracker is a high - accuracy attitude measurement device widely used in spacecraft .
its performance depends largely on the precision of the optical system parameters .
therefore , the analysis of the optical system parameter errors and a precise calibration model are crucial to the accuracy of the star tracker .
research in this field is relatively lacking a systematic and universal analysis up to now .
this paper proposes in detail an approach for the synthetic error analysis of the star tracker , without the complicated theoretical derivation .
this approach can determine the error propagation relationship of the star tracker , and can build intuitively and systematically an error model .
the analysis results can be used as a foundation and a guide for the optical design , calibration , and compensation of the star tracker .
a calibration experiment is designed and conducted .
excellent calibration results are achieved based on the calibration model .
to summarize , the error analysis approach and the calibration method are proved to be adequate and precise , and could provide an important guarantee for the design , manufacture , and measurement of high - accuracy star trackers .
star tracker error analysis calibration parameter estimation 1 .
introduction with the development of earth - observing satellites and deep - space exploration satellites , requirements for attitude measurement accuracy are increasing .
thus , error analysis of the accuracy and calibration of the star tracker have become particularly important .
at present , research and analysis of the effect factors on the star tracker accuracy are being conducted .
references [ 1 ] and [ 2 ] provides a general overview of the effects of the optical parameters .
references [ 3 ] and [ 4 ] use a geometric method to establish a complicated error model , and obtain variations in accuracy for a certain range of optical parameters , but most of the existing analysis methods discuss the effects of factors separately and qualitatively .
up to now systemic error analysis and accurate error propagation model are inadequate .
factors such as misalignment , aberration , instrument aging and temperature effects [ 5 ] could cause a departure of the star trackers from the ideal pinhole image model , and contribute to the attitude measurement error .
misalignment and aberration are time - independent , or static errors , which need to be calibrated prior to launch , and can be called ground - based calibration. by contrast , instrument aging and temperature effects are time - varying , or dynamic errors , which must be calibrated in real time , and can be called on - orbit calibration .
this paper focuses only on the ground - based calibration method .
the ground - based calibration of star trackers generally includes real night sky observation and laboratory calibration .
real night sky observation can take advantage of the characteristics of the star tracker utilizing the star angular distance .
this method is relatively easy to apply , whereas the model parameters interact with one another .
obtaining the global maximum is difficult , and this method is greatly influenced by the environment .
laboratory calibration could use a star simulator as the source .
however , it is not easy to manufacture a high - accuracy star simulator .
camera calibration techniques [ 6 - 10 ] can be choices for calibrating the star tracker considering that they are both optical imaging devices .
however , there are problems for the star tracker to apply the calibration methods of the camera .
first , most of these methods need to establish a complicated calibration model with scores of parameters .
good calibration results depend largely on the initial values and large amounts of calculation are needed for the optimization .
observability and convergence can be problematic .
second , the star tracker focuses more on the accuracy of the position of the image point , while the camera focuses more on the mtf or other image quality .
since the noteworthy parameters of the calibration methods of the camera and the star tracker are not exactly the same , the accuracy of general camera calibration techniques is not enough for the calibration requirement of the star tracker , which is one of the highest precision attitude measurement devices on the satellite .
moreover , majority of the camera calibration techniques have not considered the inclination of the image plane .
last but not the least , the optical imaging principle and focus matters of the star tracker and the camera are not the same due to their functions .
the camera uses a finite distance imaging mode , while the star tracker adopts an infinite distance imaging mode .
general camera calibration methods are not suitable for the star tracker .
taking reference [ 11 ] as an example , the cubic 3 - d calibration object applies to camera calibration as the camera can take a clear photograph of a finite distance object , but the star tracker is used to take pictures of infinite distance stars , so it cannot take a clear photograph of the 3 - d calibration object .
even though there are a few reports about how to add another high accuracy lens to make this finite imaging calibration method apply to the star tracker , the accuracy and the position of the added lens , the accuracy of the 3 - d cubic object all need to be discussed .
these bring new troubles and are not easy to carry out .
therefore , the calibration method provided in literature [ 11 ] or other similar camera calibration methods work better on short focal length , small view field camera .
convenient calibration methods for large fov and high accuracy star tracker are still problems needed to be figure out .
the calibration method using composite mode of high accuracy autocollimator theodolite and the features of the star tracker proposed in the manuscript is a good choice for this topic .
to summarize , the literature on the analysis and evaluation of the error sources of star trackers has not been adequate until now .
this paper proposes a systematic method for weight analysis of the error source .
optical parameters that play key roles in the accuracy of the star tracker ( such as the principal point deviation , focal length error , imaging plane inclination error and distortion ) [ 1,12 ] are analyzed by the proposed method. from the analysis results , a calibration method is put forward .
the calibration can separate the radial distortion from the image plane inclination , thus the optimization processes are simplified .
the calibration result proves that the analysis of the optical systematic error and the calibration method for the high - accuracy star trackers proposed in this paper are reasonable and adequate , and can improve the accuracy of the star tracker .
2. star tracker mesurement model the star tracker is a high - accuracy attitude measurement device , which considers the stars as the measuring object .
it obtains the direction vector from the celestial inertial coordinate system by detecting the different locations of the stars on the celestial sphere .
after many years of astronomical observations , star positions on the celestial sphere are predictable .
stars in the celestial sphere coordinate system can be expressed in the right ascension and declination ( alpha,delta ) .
based on the relationship between the rectangular coordinate system and the spherical coordinate system , the direction vector of the stars in the rectangular coordinate system is expressed as follows : ( 1 ) v =[ cosalphacosdeltasinalphacosdeltasindelta ] navigation stars are selected from the star catalog to meet the imaging requirement , and their data are stored in the memory of the star tracker .
when a star tracker with attitude matrix a is in the celestial coordinate system , the ideal measurement model of the star tracker can be considered as a pinhole imaging system .
navigation star si with direction vector vi under the celestial coordinate system can be detected through the lens , whereas the vector of its image can be expressed as wi in the star tracker coordinate system , as shown in figure 1 .
the position of the principal point of the star tracker on the image plane is ( x0 , y0 ) .
the position of the image point of navigation star si on the image plane is ( xi , yi ) .
the focal length of the star tracker is f. vector wi can be expressed as follows [ 13 ] : ( 2 ) wi = 1 ( xi - x0 ) 2 +( yi - y0 ) 2 + f2 [ - ( xi - x0 ) - ( yi - y0 ) f ] the relationship between wi and vi under the ideal condition can be expressed as follows , where a is the attitude matrix of the star tracker : ( 3 ) wi = avi when the number of navigation stars is more than two , the attitude matrix can be solved by the quest algorithm [ 14 ] .
in this method , the optimal attitude matrix aq in the inertial space of the star tracker can be calculated .
3. star tracker error analysis 3.1 .
summary of the error sources of the star tracker the existence of errors and noise in the system are inevitable .
according to the pinhole model shown in figure 1 and equation ( 2 ) , the factors that directly affect the results of the attitude measurement of the star tracker include the extraction error of star point position , principal point error , error of focal length , direction vectors of the navigation stars , and attitude solution algorithm error .
the accuracy is also related to the number of stars in the field of view ( fov ) .
further , the effect factors of the star tracker are classified as follows [ 1 - 5 ] : 3.1.1 .
star vector measurement error star vector measurement error concerns the accuracy of vector wi in equation ( 3 ) .
star vector measurement error includes : ( 1 ) extraction error of the star point position the process in which the star tracker detects the navigation stars includes background radiation , optical systems , photoelectric detectors and signal processing .
each segment affects the extraction quality of the target signal .
stars are far from the earth , thus , starlight rays are considered as parallel light rays and can converge to a point on the focal plane .
however , most star trackers adopt the defocus form [ 15 ] so that the image point can be diffused to cover several pixels .
using the signal energy of multiple pixels enables the star point - extraction accuracy to achieve a sub - pixel level .
this process means that after considering the various factors , the extraction error of the star tracker can be considered as 0.1 pixels [ 16 ] .
this concept lays the foundation of the following analysis .
( 2 ) star tracker optical parameter errors the star tracker system cannot achieve the ideal image model because of the principal point deviation , focal length error , inclination of the image plane , distortion in practical use .
therefore , it is necessary to establish a calibration model for above parameter errors , and analyze parameter error and model error .
3.1.2 .
star catalog error star catalog errors concern the accuracy of vector vi in equation ( 3 ) .
the number of stars is very large ; hence , we must select the appropriate ones for storage in the memory and meet the performance requirements of the star tracker .
the different stars selected may influence the star numbers that appear in the fov .
the star catalog set - up time could also contribute small errors in the direction vectors of the stars in the celestial coordinate system .
but the influence can be ignored if the star catalog can be corrected every once in a while considering proper motion of stars .
3.1.3 .
star tracker internal algorithm error star tracker internal algorithm error concerns the accuracy of the final attitude matrix a of the star tracker .
however , algorithm errors such as star pattern recognition methods and attitude solution algorithm are irrelevant to this work .
among the errors enumerated above , those described in section 3.1.1 exert a relatively larger effect .
the error analysis in this paper focuses mainly on this error source .
3.2 .
error propagation model in the following analysis , we use the angle measurement error ( xia ) to represent the star tracker accuracy .
according to the pinhole image model , xia is expressed as follows : the change in the angle between the incident ray and the optical axis in the fov is called the angle of real light change ( xiar ) , and the light calculated from the star position and focal length is called the calculated light .
the change in the angle between the calculated light and the optical axis is called the angle of calculated light change ( xiac ) .
the deviation in the xiar and xiac is called the xia .
the xia represents the star tracker attitude measurement accuracy .
the optical parameter errors such as the principal point error , error of focal length , inclination of the image plane and distortion influence the xia and cause a difference betwe en the xiar and xiac .
therefore , analysis of the effect of the different optical parameter errors on xia could identify the key factors that must be calibrated , which is important in improving the star tracker accuracy and can provide optimization guidelines for the star tracker design .
figure 2 shows the sketch of complete error propagation .
betari is defined as the angle between the incident ray and the optical axis .
the initial value of betari is betar0 , betar0 = 0degrees .
the maximum value of betari is equal to the angle of the fov .
deltabetari is the xiar , and deltabetari = betari - betar0 .
betaci is the angle between the calculated light and the optical axis .
deltabetaci is the xiac , and deltabetaci = betaci - betac0 .
we made the following assumptions : axis e1 is along the direction of the maximum error of the principal point , and the inclination angle of the image plane in this direction is also the maximum of all directions .
this can represent the worst case of error conditions .
axis e3 is the ideal optical axis of the system , and e'3 represents the actual optical axis .
deltas represents the deviation of the optical axis .
deltaf is the deviation of the focal length .
deltax represents the star point - extraction error and deltad is the distortion value .
the distortion discussed in this paper concerns radial distortion only .
( 4 ) o'b '= f + deltaf + deltas.tan ( theta ) sin ( 90 - theta - betari ). sin ( betari )+ deltax + deltad ( 5 ) ob = ob '= o'b ' - o'o angle betaci is obtained as : ( 6 ) betaci = arctan ( obf ) the xia is calculated based on the above analysis : ( 7 ) xia = arctan (( f + deltaf + deltas.tan ( theta ) cos ( theta + betari ). sin ( betari )+ deltascos ( theta )+ deltax + deltad ) f ) - arctan ( deltasfcos ( theta )) - betari when the actual optical axis is along the positive direction of the ideal optical axis , deltas is defined as positive .
when the inclination angle theta is in the clockwise direction , it is defined as positive .
another xia form is expressed as follows : ( 8 ) xip = o'b ' - ftan ( betari )= f + deltaf + deltas.tan ( theta ) cos ( theta + betari ). sin ( betari )+ deltax + deltad - ftan ( betari ) we define xip as the position measurement error of the incident light ray .
xia and xip describe the measurement error in different views , however , they can be transformed from one form to the other .
xia is more concerned with the accuracy of the star tracker , whereas xip is more suitable for using in the calibration .
3.3 .
star tracker optical parameter errors simulation we adopt two methods to discuss the error effects .
first , we use the monte carlo ( mc ) stochastic modeling method .
in this method , it is assumed that the errors after calibration , such as noise , inclination angle , focal length and principal point errors are random errors .
these errors are considered to coincide with the normal distribution .
in addition , the number of stars that can be captured in the sky is more than 6,000 .
therefore , it is reasonable to consider the incident angle in the fov as uniformly distributed .
based on the two statistical assumptions , we can combine the geometry and mc random models , and develop the complete error effect analysis .
second , we use the maximum error method to prove the simulation result of the mc method .
this method can easily identify the error distribution of the different incident angles .
analysis of the position of the maximum error can also provide information for further study .
the object analyzed in this paper is a star tracker of 7 '' accuracy and the fov is 17degrees .
the focal length of the system is approximately 49.74 mm. the star tracker adopts the aps cmos image sensor with 1,024 x 1,024 pixels , and the size of each pixel is 0.015 mm .
3.3.1 .
mc error analysis method the mc method [ 17 ] used the statistical rule of random numbers for the calculation and simulation .
the following subjects analyze the single factor and the combination of factors using the mc method .
using a 1,000,000 times simulation , the statistical results are obtained .
the simulation is conducted with an 8.5degrees incident angle .
then , combination error analysis using the mc stochastic simulation is conducted .
the xia satisfies the distribution rule : mu = - 0.0225 , sigma = 4.4218 '' .
the accuracy is in the range of mu - 3sigma ~ mu + 3sigma = - 13.2881 ~ 13.2430 '' .
considering that at least 4 stars can be captured in the normal working state , the simulation boresight accuracy can be calculated as : - 13.2881 / 4 ~ 13.2430 / 4 =( - 6.6440 ''~ 6.6215 '') .
thus , the allocation of permissible errors of the star tracker with a 7 '' accuracy is obtained .
table 1 and figure 3 show that , for the analyzed system , error of star point extraction , error of principal point , error of focal length , error of inclination of the image plane and distortion are respectively distributed in the range of 0.1 pixels , 4.5 pixels , 0.6 pixels , 0.075degrees and twenty thousandth , they bring the xia to the same level .
considering their combined effects can ensure the accuracy of the star tracker .
3.3.2 .
simulation of the maximum error method we conduct a simulation using maximum error method to compare with the method in section 3.3.1 based on the error propagation model in section 3.2 and the system parameters of the star tracker , as well as the range of the star point extraction error , the principal point error , focal length error , inclination of the image plane and distortion .
the incident angle betari is in the range of 0 - 8.5degrees and the focal length is approximately 49.74 mm. under the simulation conditions , the effect of the error of star point extraction on the star tracker accuracy , along with the incident angle is shown in figure 4 .
under the simulation conditions , the effect of the error of the principal point on the star tracker accuracy , along with the incident angle is shown in figure 5 .
under the simulation conditions , the effect of the error of focal length on the star tracker accuracy , along with the incident angle is shown in figure 6 .
under the simulation conditions , the effect of the error of inclination image plane on the star tracker accuracy , along with the incident angle is shown in figure 7 .
under the simulation conditions , the effect of the error due to distortion on the star tracker accuracy , along with the incident angle is shown in figure 8 .
the simulation results show that the error effects obtained by the maximum error method agree with the results obtained by the mc simulation method .
we can also find that inclination of the image plane and the distortion are two key factors that need to be calibrated .
the calibration method will be elaborated in the next section .
3.4 .
conclusion of the star tracker error analysis optical systematic error analysis method proposed in this paper can perform analysis on the sensitivity of factors ( such as the error of star position extraction error , position error of principal point , error of focal length , inclination of the image plane and the distortion ) that may influence the accuracy of the star tracker .
the above analysis of the system error can be applied in the following areas : ( 1 ) reference for the calibration target , i.e. , if the five indicators are simultaneously satisfied , the calibration results could meet the requirements ; ( 2 ) analysis for the highest accuracy of the system ; and ( 3 ) determining the major factors that emphasized the calibration experiment .
for application ( 1 ) above , because of the limitations in the calibration method , the effect factors cannot be separated from one another .
thus , determining whether the five indicators are all satisfied is difficult .
therefore , the proposed method is used primarily in the determination and demonstration of the design indicators .
for application ( 3 ) , some of the restrictions in certain error range can easily meet , such as the principal point position error , whereas satisfying the others are more difficult .
these error factors need to be calibrated elaborately , such as the inclination angle of the image plane and the distortion .
therefore , emphasis on the calibration method is related to the system parameters .
the calibration method and the processes are designed according to the characteristics of the system , so that the xia or xip of the star tracker is within the design range .
4. laboratory calibration method 4.1 .
star tracker calibration device the calibration object of this paper is a star tracker with 7 '' accuracy .
based on the result of the above analysis , optical parameters of the system are calibrated .
the laboratory calibration of the star tracker can be performed using a three - axis turntable and a collimator or an autocollimator theodolite .
in essence , their operating principle is the same .
however , because the collimator does not have a self - collimation function , which could introduce trouble to the calibration of the principal point , we adopt the autocollimator theodolite .
the autocollimator theodolite we employ in the experiment is the leica 6100a .
figure 9 ( a ) shows its external view .
it has a small size , high accuracy 0.5 '' and simple operation .
we can use its auto - collimation eyepiece to determine whether the crosslines coincide , as shown in figure 9 ( b ) .
other experiment devices consist of the optical table and auxiliary fixtures .
it is worth noting that the aperture of the autocollimator should be comparable or larger than the aperture of the star tracker in order to avoid vignetting .
4.2 .
calibration algorithm and experiment according to the analysis in section 3 , the calibration objective should be focused on the inclination of the image plane and the distortion .
the basic block diagram of the calibration process is shown in figure 10 .
4.2.1 .
coordinate system for better representation of the location and the relationship , we create the coordinate systems as in figure 11 .
axes xc yc in coordinate system csc represent the movement directions of the outgoing light rays of the theodolite in the two orthogonal axes , respectively .
zc , xc and yc comply with the right - hand rule .
coordinate system csn represents the normalized coordinate of the focal plane .
the positive directions of xc yc are consistent with the directions of the increase in the image pixel value .
the coordinate origin is the same as the optical system principal point .
the distance between csn and the pinhole is normalized to one .
coordinate system csoxy has the same direction as that of csn , and the only difference is that the distance between csoxy and the pinhole is equal to the focal length f. csouv represents the actual coordinate system of the image plane .
the positive directions of u , v are consistent with the directions of the increase in the image pixel value .
the coordinate origin is at the zero pixel of the image plane , and the optical system principal point can be expressed as ( u0 , v0 ) .
the distance between csouv and the pinhole is f. the axes of cso'u'v ' and csouv have the same direction , with the coordinate origin o ' is the same as the principal point .
ideally , cso'u'v ' coincides with csoxy .
angle alpha is the longitude value of the outgoing light ray of theodolite in coordinate system csc , whereas delta is the latitude value .
angle phi is the angle between the axis xc and axis xn. thus , the coordinates of the ideal pinhole imaging model are established as shown in figure 11 .
the relationship of the parameters are presented in equations ( 9 ) - ( 11 ) .
( 9 ) { xn = tan ( alpha ) cos ( phi ) - tan ( delta ) cos ( alpha ). sin ( phi ) yn = tan ( alpha ) sin ( phi )+ tan ( delta ) cos ( alpha ). cos ( phi ) ( 10 ) { x = fxn = f. ( tan ( alpha ) cos ( phi ) - tan ( delta ) cos ( alpha ). sin ( phi )) y = fyn = f. ( tan ( alpha ) sin ( phi )+ tan ( delta ) cos ( alpha ). cos ( phi ) ( 11 ) { u = x + u0v = y + v0 angle alpha is positive along the positive direction of xc , whereas it is negative along the negative direction of xc. angle delta is positive along the positive direction of yc , whereas it is negative along the negative direction of yc. when the angle from xn to xc is counterclockwise , angle phi is considered as positive .
the ideal pinhole imaging model cannot be achieved in practical application .
there are position errors of principal point , focal length error , inclination of image plane and distortion to cause the cso'u'v ' departure from csoxy as shown in figure 12 , and the equations above are invalid .
it is necessary to estimate the parameters by calibration .
4.2.2 .
description of the calibration experiment operating first , we adjust the theodolite to ensure that its outgoing light travels only along the longitude direction .
the latitude value does not change during this process .
imaging conducted at every 0.5degrees can yield a series of measured values that determines the external parameters .
then , according to the 17degrees fov of the star tracker , we adjust the theodolite so that its light travels along the two orthogonal directions as shown in figure 13 while conducting imaging at every 0.5degrees .
if any of the two directions satisfies the requirement of the first step , two steps can be combined to determine the internal parameter of the star tracker .
because the outgoing rays of the theodolite are crosslines , the images on the image plane appear similar to that shown in figure 13 ( b ) .
it is worth mentioning that the star tracker is supposed to be settled on the same optical table with the auto - collimation theodolite to avoid relative vibration .
considering that our experiment is conducted at the state key laboratory of precision measurement technology and instruments , the floor of the laboratory has been treated with vibration isolation .
so the relative vibration could be reduced and ignored in the calibration form in figure 13 ( a ) , and it is easier to adjust the relative position of the theodolite and the star tracker with the tripod .
4.2.3 .
image processing the image obtained by the star tracker is shown in figure 14 .
an appropriate image processing method should be adopted to obtain the precise center position of the crossline which represents the outgoing ray of the theodolite .
for the pixels in the first area , we regard the pixels in the same row as a group , and determine their gray value center of gravity ( i.e. , weighted average ) .
for the pixels in the second area , we consider pixels in the same column as a group , and also determine their gray value center .
the centers of gravity are marked with a circle as shown in figure 15 .
finally , we use the least square method to fit the two straight lines .
the point of intersection of the two lines is considered as the center of the crossline .
this work provides a basis for further algorithm .
since the light intensity of the theodolite could be adjusted by a knob , obtaining image before experiment and observing whether the image is saturation is also important .
4.2.4 .
calibration process external parameter estimation the series of point coordinate values obtained in section 4.2.2 can be used to solve angle phi between the xc - axis of coordinate system csc and the xn - axis of csn .
symbol n represents the number of sampling points : ( 12 ) phi = sumi = 1n ( acos (| uri - u0 |(( uri - u0 ) 2 +( vri - v0 )) 1 / 2 ) n ) linear fitting can also be adopted to solve the value of phi besides equation ( 12 ) .
optical parameter estimation the positions of the series of specific points are obtained according to the above discussion and preparation .
the characteristics of these points include the following : the test points are distributed in two orthogonal directions and the test points in the same direction are almost centrosymmetrical .
taking advantage of relationship between the symmetric points , we build a calibration model , shown in figure 16 .
in the actual calibration process , we try to make one of alpha , delta equal to zero for simplicity of the calculation .
in reality , no restriction is imposed on the theodolite longitude and latitude angle , and the two orthogonal directions formed by the test points do not necessarily coincide with any of the defined coordinates .
for the general situation , we name the two orthogonal directions distributed with the test points as l1 and l2 .
betai is the synthesis angle of the theodolite longitude and latitude .
when there are distortion and inclination of the image plane in the system , the imaging model is shown in figure 16 .
betai + and betai - respectively represent the incident angles of the two centrosymmetric points in the same test direction .
pii + and pii - are the ideal image point positions corresponding to the incident light rays when no distortion and inclination of image plane occurs .
pdi + and pdi - are the positions of the image points when distortion is present but with no inclination of the image plane .
pti + and pti - are the positions of the image points with the presence of image plane inclination but with no distortion .
pri + and pri - are the positions of the image points when both distortion and inclination of the image plane are present .
the longitude and latitude values ( alphai , deltai ) corresponding to the incident rays and the coordinate positions ( uri , vri ) on the image plane can be used to solve the principal point position ( u0 , v0 ) , focal length f , distortion coefficients alpha1 , alpha2 , alpha3 , alpha4 , alpha5 and the inclination angle corresponding to the test direction .
finally , the calibration model for the entire image plane is obtained .
this method is elaborated as follows : ( 1 ) firstly , we adjust the auto - collimation theodolite , and ensure that the crossline in the theodolite eyepiece is coincident with the specular reflection image of the star tracker glass shield , as shown in figure 17 .
we consider that the boresight of the theodolite is coincident with the spindle of the star tracker lens .
the imaging position of the crossline on the image plane is considered as the principal point ( u0 , v0 ) of the system .
( 2 ) secondly , we can obtain a series of focal lengths utilizing the incident light in different directions and their image point ( uri , vri ) .
the average focal length is considered as the focal length value of the system .
n represents the number of test points except for the principal point : ( 13 ) betai = acos ( cos ( alphai ) cos ( deltai )) ( 14 ) f = sumi = 1n (( uri - u0 ) 2 +( vri - v0 ) 2 ) 1 / 2tan ( betai ) n ( 3 ) the simulation results shown in figure 18 prove that when the incident angle | betai | < 8.5degrees , inclination angle | theta | < 0.8degrees , there are following rules of example points : | pti + pti - | = | pii + pii - | .
as shown in figure 18 , the errors between the two segments are less than 0.1 pixels , which is less than the extraction accuracy of the star tracker .
using the same simulation method , we find that the segments | pri - pti - | , | pri + pti +| , | pdi + pii +| and | pdi - pii - | are equal to one another , whereas the errors are extremely small as shown in figure 19 .
therefore , we consider (| pii + pii - | - | pri + pri - |)/ 2 as the radial distortion value at point pri + or pri - , and this concept is an important basis of our calibration method. from the multiple groups of symmetrical points , we can obtain optimized distortion coefficients a1 , a2 , a3 , a4 , a5 by linear least - squares fitting .
the form of distortion can be chosen according to the distortion values in different cases .
here we adopt sumk = 15akrik : ( 15 ) ri =| pri + pri - | 2 ( 16 ) deltai =| pdi + pii +|=| pdi - pii - |=| pri + pti +|=| pri - pti - |=(| pii + pii - | - | pri + pri - |) 2 ( 17 ) { ri =(( uri + - uri - ) 2 +( vri + - vri - ) 2 ) 1 / 22sumk = 15akrik =((( xii + - xii - ) 2 +( yii + - yii - ) 2 ) 1 / 2 - (( uri + - uri - ) 2 +( vri + - vri - ) 2 ) 1 / 2 )/ 2 ( 4 ) when the principal point , focal length and distortion coefficients are determined , the inclination angle of the image plane can be obtained using the geometric relationship , and the average value can be calculated using the multiple - set of symmetrical points .
( 18 ) | thetai |=| arccos (| opii || opri |+ deltai ) - betai |=| arccos (( xii2 + yii2 ) 1 / 2 (( uri - u0 ) 2 +( vri - v0 ) 2 ) 1 / 2 + deltai.cos ( betai )) - betai | equation ( 18 ) is suitable for the symmetric points .
when | opri | + deltai > | opii | , thetai is defined positive ; when | opri | + deltai < | opii | , thetai is defined negative .
so far , the principal point , the focal length , the radial distortion coefficients and the inclination angle of image plane in one direction are obtained .
the principal point , focal length , and radial distortion coefficients are suitable for the entire plane .
inclination angle in the other measurement direction can be obtained in the same manner .
calibration model applied to the entire image plane the inclination angle in the two measurement directions is not sufficient .
the ultimate goal of calibration experiment is to obtain an ideal image position of incident rays from any direction in the fov .
based on the parameters obtained above , there are many methods to solve this problem .
we adopt a coordinate transformation method , and establish a coordinate transformation framework for incident rays .
therefore , we make the following analysis .
we can obtain the position of point pii + as ( xii + , yii + , 0 ) in the coordinate system csoxy by considering the longitude and latitude of the incident ray , external parameter phi , focal length f and equations ( 9 ) - ( 11 ) .
then , the straight line ocpii + can be expressed as : ( 19 ) xti + xii += yti + yii += kti + - f - f considering the angle /_ pii + opti + = | thetai | and the positive or negative of the angle value , the position of point pti + in coordinate system csoxy can be solved though the following equations : ( 20 ) { xti + xii += yti + yii += kti + - f - f ( xti + , yti + , kti +).( xii + , yii + , 0 )=|( xti + , yti + , kti +)||( xii + , yii + , 0 )| cos ( thetai ) thus , the position of point pti + is obtained ( xti + , yti + , kti +) .
the position of point pti - can also be obtained in the same way .
so far , the positions of the multiple sets of points as pti + and pti - in both the two measurement direction in csoxy can be obtained .
therefore , the plane equation of actual image plane with inclination o'u'v ' in coordinate system csoxy can be expressed as p ( o'u'v ') .
the transformation matrix from coordinate system csoxy to coordinate system cso'u'v ' can be obtained at the same time : ( 21 ) cso'u'v '= csoxyr1 ( - epsilon ) r2 ( - eta ) r1 and r2 are the coordinate system transformation matrices .
r1 ( - epsilon )=( 1000cos ( - epsilon ) sin ( - epsilon ) 0 - sin ( - epsilon ) cos ( - epsilon )) , r2 ( - eta )=( cos ( - eta ) 0 - sin ( - eta ) 010sin ( - eta ) 0cos ( - eta )) thus , the whole parameter estimation model of the optical system of the star tracker is completed .
for any point on the image plane of the incident ray , we can determine its position in cso'u'v ' as ( uri + - u0 , vri + - v0 , 0 ) .
the position of point pti + can be calculated by considering the distortion as ( uti + - u0 , vti + - v0 , 0 ) .
according to the coordinate system transformation matrix , the position of point pti + in csoxy can be calculated as : ( 22 ) ( xti + , yti + , kti +)'= r1 ( - epsilon ) r2 ( - eta )( uti + - u0,vti + - v0,0 )' the equation for straight line ocpti + can be obtained .
further , by solving the position of the point of intersection of straight line ocpti + and plane oxy , the point of intersection gii + is the ideal position of point pri + .
thus , the ideal image position of the incident ray can be obtained .
this solution is particularly important for the star pattern recognition and attitude solution of the star tracker .
4.3 .
calibration results and discussions 4.3.1 .
error analysis in the calibration process described in section 4.2.4.2 , the principal point position is obtained and considered as its true position .
in reality however , due to lens installation , accuracy in manufacture as well as the limitations in the eyepiece alignment when using the theodolite , a deviation error of the optical axis is inevitable. that is to say , there may be an error beta0 between the optical axis obtained in section 4.2.4.2 and the true optical axis of the lens .
maximum value of beta0 is approximately 40 '' in this calibration system , consisting of 30 '' installation error of the lens and 10 '' eyepiece alignment error .
in this situation , the optical axis error will cause the deviation error of principal point , the focal length and inclination angle .
the specific effect analysis is described as follows : as shown in figure 20 ( b ) , assuming the deviation error of the optical axis is 40 '' as analyzed above , the position error of principal point is about f.tan ( 40 '') ( equal to 0.64 pixels ) ; the error of inclination angle is approximately 0.01degrees .
the errors due to the focal length and the distortion are merged and the residual error of the distortion after calibration is within 0.1 pixels .
because the light ray is brighter than a real star in practical use , the signal to noise ratio is higher and the extraction error of the light ray position can reach approximately 0.05 pixels .
we can use the mc error analysis method described in section 3.3.1 to determine the xia and xip .
the xia meets distribution rule : mu = 0.0034 , sigma = 2.1192 '' .
the xip meets distribution rule : mu = 0.0007 , sigma = 0.0338 pixels .
we adopt xip as the basis of the calibration target. that means the calibration residual error should in the range of mu + 3sigma distribution of xip .
4.3.2 .
calibration results and discussion the calibration experiment is conducted in the laboratory. from the above analysis , we can know the longitude angle alphai and latitude angle deltai of the incident ray of the theodolite .
we also can obtain the position of point as pri + or pri - by the image processing mentioned in section 4.2.3 .
then we do the same procedure as section 4.2.4.3 , and calculate the position of point gii + .
the position of point pii + can be also obtained through equations ( 9 ) - ( 11 ) .
comparing the two positions , the calibration model is proved to be effective and adequate if the error between the two positions is less than the xip for points on the image plane at any incident light angle .
in the experiment , we conduct two orthogonal direction measurements to get the parameters and the calibration model .
then we conducted measurements in another two independent and orthogonal directions that have an angle of 45degrees or 135degrees with the 1st measurement direction l1 to prove the analysis and calibration model in this paper .
( 1 ) as described in section 4.2.4.1 , we can firstly obtain external parameter phi using a linear fitting method .
measurement points and linear fitting curve are showed in figure 21 .
solving the slope of the line can determine the value of phi .
in our experiment , the slope of the two lines are - 0.003968 and 0.003949 , and root mean squared errors ( rmse ) are 0.1614 and 0.0576 pixels .
so the values of phi are 0.2273degrees and 0.2263degrees .
we adopt 0.2268degrees as the value of phi .
( 2 ) as described in section 4.2.4.2 - - ( 1 ) , we can obtain the position of the principal point as ( 515.1859 , 514.2069 ) pixels .
( 3 ) as described in section 4.2.4.2 - - ( 2 ) , we can obtain a series of focal lengths utilizing the incident light in different directions and their image point ( uri , vri ) .
the estimations of f is shown in figure 22 .
theoretically , the values of the calculated focal lengths are equal .
however , distortion can cause departure of the calculated focal lengths in different incident angles .
inclination of the image plane may cause deviation even when points are in centrosymmetry incident angles .
therefore , the estimations of f in figure 22 is reasonable .
we determine the focal length of the system as 3319.15 pixels using equation ( 14 ) .
an initial estimate of f is adequate for calibration model as long as the radial distortion and other calibration parameters are matched with it .
( 4 ) as described in section 4.2.4.2 - - ( 3 ) , we can obtain the distortion values deltai using equation ( 16 ) .
the values are shown in table 2 .
( 5 ) we use linear least squares fitting to obtain the distortion curve .
the fitting result is shown as follows , and figure 23 ( b ) shows that the residual error of the distortion after calibration can meet the calibration requirement analyzed in section 3.3 .
calibration result is summarized in table 3 : after calibration , we can obtain the calibrated image point position of the incident light in different directions .
the estimations of f can be conducted again to show the effect of the calibration ( figure 24 ) compared to the initial values in figure 22 .
we can see from figure 24 that the values of focal length do not change with the incident angles any more .
they are in a range of 1 pixels ( standard deviation =~ 0.23 pixels ) .
this can also demonstrate that the residual errors are improved after calibration .
the position error between points gii + and pii + is shown in figure 25 .
we can see from figure 25 that the position errors in the entire fov are within the xip and in accordance with analysis in section 4.3.1 .
the results demonstrate that the point position errors can be kept within the xip after calibration .
based on mc analysis , the accuracy of this calibration method can reach 7 '' , which related to the focal length and the fov of the system .
the accuracy of the star tracker is supposed to be better than 4.5 '' after calibration , compared with the worse accuracy of more than 10 '' if no calibration is conducted .
5. summary and conclusions a synthetic error analysis approach for the star tracker has been proposed in detail in this paper .
this approach can provide the error propagation relationship of the star tracker .
based on the analysis results , a calibration experiment is designed and conducted .
excellent calibration results are achieved .
the calibration experiment can not only guarantee the accuracy to meet the design requirement , but can even improve the accuracy of the star tracker to a higher level .
to summarize , the error analysis approach and the calibration method are proved to be adequate and precise , and are very important for the design , manufacture , and measurement of high - accuracy star trackers .
this work is partially supported by a grant from the national high technology research and development program of china ( 863 program ) ( no. 2012aa121503 ) .
the laboratory calibration is performed in the state key laboratory of precision measurement technology and instruments at tsinghua university .
both of them are gratefully acknowledged .
references 1 .
liebe c.c. accuracy performance of star tracker - a tutorial ieee trans. aerosp. electron. syst .
2001 38 587 599 2 .
griffith d.t. singla p. junkins j.l. autonomous on - orbit calibration of approaches for star tracker cameras adv. astronaut. sci. 2002 112 39 57 3 .
wang h.t. luo c.z. wang y. zhao s.f. star sensor model parametric analysis and calibration method study j. univ. electron. sci. technol .
china 2010 39 880 885 4 .
hao x.t. zhang g.j. jiang j. star sensor model parameter analysis and calibration method opto - electron. eng .
2005 2 5 8 5 .
xing f. dong y. you z. laboratory calibration of star tracker with brightness independent star identification strategy opt. eng .
2006 45 10.1117 / 1.2213996 6 .
faig w. calibration of close - range photogrammetry systems : mathematical formulation photogramm. eng .
remote sens .
1975 41 1479 1486 7 .
abdel - aziz y.i. karara h.m. direct linear transformation into object space coordinates in close - range photogrammetry proceedings of symposium on close - range photogrammetryurbana , il , usajanuary 1971 1 18 8 .
tsai r.y. a versatile camera calibration technique for high accuracy 3d machine vision metrology using off - the - shelf tv cameras and lenses ieee j. robot. automon .
1987 3 323 344 9 .
weng j. cohen p. herniou m. camera calibration with distortion models and accuracy evaluation ieee trans .
pattern anal. mach. intell .
1992 14 965 980 10 .
xiang z.y. sun b. dai x. the camera itself as a calibration pattern : a novel self - calibration method for non - central catadioptric cameras sensors 2012 12 7299 7317 22969346 11 .
heikkila j. silven o. a four - step camera calibration procedure with implicit image correction proceedings of 1997 ieee computer society conference on computer vision and pattern recognitionsan juan , argentina17 - 19 june 1997 1106 1112 12 .
liu h.b. li x.j. tan j.c. yang j.k. yang j. su d.z. jia h. novel approach for laboratory calibration of star tracker opt. eng .
2010 49 10.1117 / 1.3462042 13 .
gwanghyeok j. autonomous star sensing , pattern identification , and attitude determination for spacecraft : an analytical and experiment study ph.d. thesis texas a & m university texas , tx , usa 2001 14 .
wahba g. a least squares estimate of satellite attitude siam rev .
1996 8 384 386 15 .
liebe c.c. star trackers for attitude determination ieee aerosp. electron. syst. mag .
1995 10 10 16 16 .
yang j. liang b. zhang t. song j.y. a novel systematic error compensation algorithm based on least squares support vector regression for star sensor image centroid estimation sensors 2011 11 7341 7363 22164021 17 .
roth j.p. diagnosis of automata failures : a calculus and method ibm j. res. dev .
1966 10 278 291 figure 1 .
star tracker ideal imaging model .
figure 2 .
sketch of complete error propagation .
figure 3 .
synthetic analysis result using mc stochastic simulation .
figure 4 .
influence of the star point extraction error on the star tracker accuracy .
( a ) is obtained when the star point extraction error deltax is among the range from - 0.1 pixels to 0.1 pixels ; ( b ) is the contour line of ( a ) .
figure 5 .
influence of the principal point error on the star tracker accuracy .
( a ) is obtained when deltas is among the range from - 4.5pixels to 4.5 pixels ; ( b ) is the contour line of ( a ) .
figure 6 .
influence of the focal length error on the star tracker accuracy .
( a ) is obtained when deltaf is within the range from - 0.6 pixels to 0.6 pixels ; ( b ) is the contour line of ( a ) .
figure 7 .
influence of the inclination angle error on the star tracker accuracy .
( a ) is obtained when theta is in the range from 0degrees to 0.075degrees. ( b ) is the contour line of ( a ) .
( c ) is obtained when theta is in the range from - 0.075degrees to 0degrees , and ( d ) is the contour line of ( c ) .
figure 8 .
influence of the distortion on the star sensor accuracy .
( a ) is obtained when the relative distortion is approximately 2 / 10,000th ; and ( b ) is obtained when the relative distortion is approximately 1 / 1,000th .
figure 9 .
( a ) external view ; ( b ) internal structure of the autocollimator theodolite 6100a .
figure 10 .
calibration flow diagram .
figure 11 .
coordinate systems in the ideal pinhole imaging model .
figure 12 .
coordinate systems in the case of errors .
figure 13 .
( a ) calibration experiment device ; ( b ) imaging method sketch map .
figure 14 .
image of the emergent crossline of the theodolite .
( a ) is original image ; ( b ) is partially enlarged view .
figure 15 .
sketch map of the solution of the gravity center of the cross - line .
figure 16 .
calibration schematic diagram .
figure 17 .
principal point measurement principle .
figure 18 .
error between the ideal and real distances of the symmetric points .
the z - axis represents the value (| pti + pti - | - | pii + pii - |)/ pixel .
figure 19 .
relationship of the different distortion expressions .
z - axis of ( a ) represents (| pti - pri - | - | pti + pri +|)/ pixel ; z - axis of ( b ) represents (| pti - pri - | - | pii - pdi - |)/ pixel ; z - axis of ( c ) represents (| pti + pri +| - | pii - pdi - |)/ pixel .
figure 20 .
( a ) principal optic axis deviation error and its effect ; ( b ) its effect on the calibration process .
figure 21 .
measurement points and linear fitting curve ( a ) .
( b ) and ( c ) show the two fitting curves separately .
figure 22 .
estimations of f .
( a ) is the result of 1st measurement direction l1 , and ( b ) is the result of 2nd measurement direction l2 .
points in red and in blue represent centrosymmetry incident light rays separately .
figure 23 .
distortion curve .
( a ) is fitting distortion curve and ( b ) is residual errors of distortion after calibration .
figure 24 .
re - estimations of f .
( a ) is the result of 1st measurement direction l1 ; and ( b ) is the result of 2nd measurement direction l2 .
points in red and in blue represent centrosymmetry incident light rays separately .
figure 25 .
calibration residual error .
table 1 .
single - error factor analysis using mc stochastic simulation .
item distribution of the item distribution ofxia error of star point extraction : mu = 0 , sigma = 0.1 / 3 pixels ( gaussian distribution ) mu = 0.0073 , sigma = 2.0281 ('') error of principal point : mu = 0 , sigma = 4.5 / 3 pixels ( gaussian distribution ) mu = - 0.0139 , sigma = 2.0400 ('') error of focal length : mu = 0 , sigma = 0.6 / 3 pixels ( gaussian distribution ) mu = - 0.0079 , sigma = 1.8182 ('') error of inclination angle : mu = 0 , sigma = 0.075degrees / 3 ( gaussian distribution ) mu = 0.0097 , sigma = 1.9703 ('') distortion : mu = 0 , sigma = 0.1 / 3 pixels ( gaussian distribution ) mu = - 0.0185 , sigma = 2.0325 ('') table 2 .
distortion values .
item 1st measurement direction 2nd measurement direction ri deltai ri deltai 1 29.0039 - 0.021951 28.9778 - 0.041757 2 58.0162 - 0.050355 57.9644 - 0.042748 3 87.0237 - 0.065911 86.9740 - 0.061112 4 116.0016 - 0.076456 115.9721 - 0.061893 5 145.0044 - 0.079762 144.9961 - 0.067778 6 174.0553 - 0.082395 174.0393 - 0.065835 7 203.1132 - 0.079229 203.0897 - 0.048521 8 232.1929 - 0.063527 232.1630 - 0.019044 9 261.2868 - 0.037760 261.2486 0.018263 10 290.4139 0.007676 290.4194 0.039629 11 319.5688 0.084626 319.6433 0.061659 12 348.7565 0.164076 348.8699 0.095181 13 378.0469 0.194652 378.0526 0.226332 14 407.3608 0.258506 407.3291 0.330992 15 436.6681 0.383765 436.7842 0.321828 16 466.1053 0.461704 466.1020 0.503454 17 495.6124 0.545419 495.6529 0.536663 table 3 .
calibration result .
item value phi ( degrees ) 0.2268 principal point ( pixels ) ( 515.1859 , 514.2069 ) focal length f ( pixels ) 3319.15 a1 - 7.038e - 04 a2 - 2.344e - 06 a3 2.4705e - 08 a4 - 2.7031e - 11 a5 3.1804e - 15 inclination angle of the image plane ( degrees ) ( l1 direction ) 0.1469 ( sigma = 0.0413 ) inclination angle of the image plane ( degrees ) ( l2 direction ) 0.0524 ( sigma = 0.0221 )