bioessays bies bioessays 0265 - 9247 1521 - 1878 wiley - vch verlag 21853451 3193375 10.1002 / bies.201100062 prospects & overviews orthology prediction methods : a quality assessment using curated protein families trachana kalliopi 1 ) larsson tomas a 1 ) 2 ) powell sean 1 ) chen wei - hua 1 ) doerks tobias 1 ) muller jean 3 ) 4 ) bork peer 1 ) 5 )* 1 ) structural and computational biology unit , european molecular biology laboratoryheidelberg , germany 2 ) developmental biology unit , european molecular biology laboratoryheidelberg , germany 3 ) institute of genetics and molecular and cellular biology , cnrs , inserm , university of strasbourgstrasbourg , france 4 ) genetic diagnostics laboratory , chu strasbourg nouvel hopital civilstrasbourg , france 5 ) max - delbruck - centre for molecular medicineberlin - buch , germany * corresponding author : peer bork e - mail : bork @ embl.de supporting information online 10 2011 33 10 769 780 copyright ( c ) 2011 wiley periodicals , inc .
2011 re - use of this article is permitted in accordance with the creative commons deed , attribution 2.5 , which does not permit commercial exploitation .
the increasing number of sequenced genomes has prompted the development of several automated orthology prediction methods .
tests to evaluate the accuracy of predictions and to explore biases caused by biological and technical factors are therefore required .
we used 70 manually curated families to analyze the performance of five public methods in metazoa .
we analyzed the strengths and weaknesses of the methods and quantified the impact of biological and technical challenges. from the latter part of the analysis , genome annotation emerged as the largest single influencer , affecting up to 30 % of the performance .
generally , most methods did well in assigning orthologous group but they failed to assign the exact number of genes for half of the groups .
the publicly available benchmark set ( http :// eggnog.embl.de / orthobench /) should facilitate the improvement of current orthology assignment protocols , which is of utmost importance for many fields of biology and should be tackled by a broad scientific community .
metazoan orthology quality assessment introduction the analysis of fully sequenced genomes offers valuable insights into the function and evolution of biological systems 1 .
the annotation of newly sequenced genomes , comparative and functional genomics , and phylogenomics depend on reliable descriptions of the evolutionary relationships of protein families .
all the members within a protein family are homologous and can be further separated into orthologs , which are genes derived through speciation from a single ancestral sequence , and paralogs , which are genes resulting from duplication events before and after speciation ( out - and in - paralogy , respectively ) 2 , 3 .
the large number of fully sequenced genomes and the fundamental role of orthology in modern biology have led to the development of a plethora of methods ( e.g. 4 - 11 ) that automatically predict orthologs among organisms .
current approaches of orthology assignment can be classified into ( i ) graph - based methods , which cluster orthologs based on sequence similarity of proteins , and ( ii ) tree - based methods , which not only cluster , but also reconcile the protein family tree with a species tree ( box 1 ) .
despite the fact that orthology and paralogy are ideally illustrated through a phylogenetic tree , where all pairwise relationships are evident , tree - based methods are computationally expensive and at times fail due to the complexity of the family or to the substantial number of species in the comparison 12 .
as a trade - off between speed and accuracy , the evolutionary relationships among proteins in comparisons that include a large number of species are better explored using graph - based methods .
during the first large - scale orthology assignment project of multiple species , the concept of clusters of orthologous groups ( cogs ) was introduced 4 .
a cog consists of proteins that have evolved from a single ancestral sequence existing in the last common ancestor ( lca ) of the species that are being compared , through a series of speciation and duplication events 4 .
the orthologous / paralogous relationships among proteins of multiple species are better resolved through orthologous groups ( ogs ) rather than pairs of orthologs .
this is particularly evident in the instances of complex protein family histories ( e.g. tubulins ) or families over significant phylogenetic distances ( e.g. proteins conserved across all domains of life ) 13 .
box 1 comparison of orthology prediction methods orthology prediction methods can be classified based on the methodology they use to infer orthology into ( i ) graph - based and ( ii ) tree - based methods 12 , 16 , 17 .
different graph - based methods are designed to assign orthology for two ( pairwise ) or more ( multiple ) species .
graph - based methods assign proteins into ogs based on their similarity scores , while tree - based methods infer orthology through tree reconciliation .
pairwise species methods ( e.g. bhr , inparanoid , roundup ) : based on these methods , orthologs are best bi - directional hits ( bbh ) between a pair of species .
brh 46 is the first automated method and does not detect paralogs .
inparanoid 47 implements an additional step for the detection of paralogs .
roundup 48 uses evolutionary distances instead of bbh .
in addition to the restriction of only two - species at a time , these methods are disadvantageous for long evolutionary distances .
multi - species graph - based methods ( e.g. cog , eggnog , orthodb , orthomcl , oma ) : due to the fast implementation and high scalability , there are many graph - based methods for multi - species comparisons .
so far , all of them use either blast or smith - waterman ( e.g. paralign , simg ) as sequence - similarity search algorithms .
however , they are quite diverse regarding the clustering algorithms .
cog , eggnog , and orthodb share the same methodology : they identify three - way bbhs in three different species and then merge triangles that share a common side .
orthomcl is a probabilistic method that uses a markov clustering procedure to cluster bbh into ogs .
oma removes from the initial graph bbhs characterized by high evolutionary distance ; a concept similar to roundup .
after that , it performs clustering based on maximum weight cliques .
unique database characteristics are the hierarchical groups ( ogs in different taxonomic levels ) and " pure orthologs " ( generate groups of one - to - one orthologs without paralogs ) , which has been introduced only by oma ( indicated as ** in the figure ) .
hierarchical groups can substitute the view of phylogenetic trees .
multi - species tree - based methods ( e.g. treefam , ensembl compara , phylomedb , loft ) : tree - based prediction methods can be separated into approaches that do ( like ensemblcompara , treefam , and phylomedb ) and do not , e.g. loft 49 , use tree - reconciliation .
tree - based methods also initially use homology searches ; however , their criteria are more relaxed , as the orthology is resolved through tree topology .
although a reconciled phylogenetic tree is the most appropriate illustration of orthology / paralogy assignment , there are a few caveats to such an approach , namely their scalability and sensitivity to data quality .
for a more detailed and extensive discussion of the differences among orthology methodology , we recommend refs .
12 , 16 , 17 .
phylogenetic distribution describes the species range of each database .
homology search shows a few technical differences for recruiting orthologs .
s : supplies ogs whose members share only orthologous relationships .
* : the user can compare any two genomes spanning a phylogenetic distance from bacteria to animals .
despite the clear definition of ogs , their automated prediction is challenged by a number of biological and technical factors exemplified by the evolution of mucins ( see fig. 1 ) , a family with a complex evolutionary history 14 .
the phylogenetic tree of mucins resolves the orthologous relationships among the members of the family at every evolutionary level ( fig. 1 ) .
still , how they are grouped into ogs depends on the phylogenetic range of the species compared .
for instance , a vertebrate - specific og will include otogelin and vwf mucins , but not the additional gel - forming mucins ( muc5 , muc2 , and muc6 ) .
conversely , all gel - forming mucins encompass a large og when considering bilaterians ( an animal clade that includes vertebrates , insects , and nematodes among others ) as the level of comparison .
analyzing the ogs at different taxonomic levels ( e.g. vertebrates vs. bilaterians ) sheds light on the evolutionary history of the family ; however , big protein families , which have expanded and contracted many times in the history of a lineage , require an increased resolution of orthologous - paralogous relationships within the same taxonomic level .
the inclusion of outgroup species of a taxonomic level delineates the aforementioned relationships .
for instance , hydra sequences revealed the existence of two paralogous sequences in the lca of bilaterians ( marked by an asterisk in fig. 1 ) ; thus , according to the og definition , membrane - bound and gel - forming mucins should be clustered into two different ogs .
despite the lineage - specific duplications and losses of domains 14 , many complex domain architectures are found across the family but not always conserved , which contributes to erroneous assignments of orthologs .
repeated domains and fast - evolving mucin domains also hamper the automatic sequence alignment of the family 15 .
all these factors and more ( see fig. 1 ) can influence the accuracy of the many emerging resources for orthology assignment 13 , 16 , 17 .
to understand the impact on individual resources , one needs to understand the design of different orthology prediction methods ( briefly introduced in box 1 ) .
however , an appropriate comparison is extremely difficult for two major reasons , both of which contribute to conflicting orthology assignments : ( i ) each method differs in technical ( e.g. species distribution , similarity cut - offs ) and conceptual ( e.g. og definition ) aspects , and ( ii ) the lack of a common set of species obtained from the same release of genome repositories and tested across all methods 16 .
figure 1 mucins : a challenging family for orthology prediction .
this figure shows the phylogenetic tree and domain architecture of aligned mucins .
the identification of cnidarian ( an outgroup for bilaterians ) mucin2 / 5 orthologs separates the gel - forming mucins from other mucins , defining a bilaterian - specific og ( gray box ) .
an alternative topology of hydra in respect to the lca of bilaterian species ( shown schematically in the red box ) would propose that those two different classes of mucins should be clustered together at the bilaterian level .
the bilaterian og can be further resolved at the vertebrate level into og.a ( blue ) and og.b ( red ) , illustrating the hierarchical nature of ogs .
this family , besides its large size due to vertebrate - specific duplications , exemplify five additional problems that often lead to orthology misassignment : ( 1 ) uneven evolutionary rate illustrated as branch lengths , lowering the sequence similarity among members of the family ; ( 2 ) quality of genome annotation : the particular zebrafish protein can be either a derived member of the mucin family or a erroneous gene prediction ; ( 3 ) repeated domains : the domain combination vwd - c8 - vwc , which is the core of the family , is repeated multiple times within the protein ; ( 4 ) complexity of domain architectures : there are multiple unique domain combinations ( e.g. the vwd domain is combined with the f5 - f8 type c domain only in the drosophila ortholog ) ; and ( 5 ) low complexity regions : internal repeats within the amino acid sequences and other low complexity features impede the correct sequence alignment of the mucins .
* possible orthologous sequence at the lca of cnidarians bilaterians .
benchmarking orthology prediction methods using a phylogeny approach despite the acknowledged necessity of a phylogeny - based evaluation of orthology , thus far the majority of quality assessment tests are based on the functional conservation of predicted orthologs 18 - 21 .
however , orthology is an evolutionary term defined by the relationships among the sequences under study , and functional equivalences are not always inferable 13 .
moreover , the functional divergence between orthologs and paralogs ( sub - / neo - functionalization of paralogs ) or alteration of function during long evolutionary distances 13 suggests that those tests are biased toward single copy genes or conserved families and less suited for large diversified families .
it has been proposed that the inclusion of synteny information limits the errors arisen due to low sequence similarity and increases orthology accuracy 22 .
however , this requires a certain level of synteny conservation among the compared species .
it has been illustrated that synteny information combined with sequence similarity identifies accurately the paralogs that have arisen through wgd in six closely related yeast species 23 .
further refinement of this dataset using tree reconciliation 24 , 25 ends up with a phylogeny - based dataset .
however , it is still biased toward simple evolutionary scenarios , highlighting mostly the impact of lineage - specific losses in orthology prediction 26 .
for a much more fine - grained analysis that also involves complex ogs , we developed a phylogeny - based benchmark set and applied it to a much more diverse taxonomic clade , namely metazoans .
the set involved the manual curation of the phylogeny of 70 protein families that range from single copy orthologs to ogs with 100 members ( table s1 of supporting information ) .
the phylogenetic analysis of each protein family for 12 reference bilaterian species and 4 basal metazoans as outgroups ( box 2 ) resulted in the reference orthologous groups ( refogs ) , including in total 1,638 proteins .
box 2 phylogenetic analysis of the 70 protein families selecting families for exploring caveats of orthology prediction : we focused on five major affecting factors of orthology prediction , mostly related with metazoan ( eukaryotic ) biology : rate of evolution ( fast - vs. slow - evolving families ) , domain architecture ( single domain vs. multiple repeated domains ) , low complexity / repeats , lineage - specific loss / duplication ( single copy families vs. multiple duplication events ) , and alignment quality ( high - vs. low - quality alignment ) .
we used the eggnog database to select 70 families ( supporting information ) that we refer to as " homology seeds. " of the selected families , 35 exemplify known biological and technical challenges .
five additional slow - evolving , well - aligned families were chosen as counterbalance , while the remaining 30 families were chosen randomly to avoid prior biases ( table s1 of supporting information ) .
defining of reference species : for an applicable comparison of the five databases studied , we had to confine the analysis to 12 reference species that are shared by all resources : caenorhabditis elegans , drosophila melanogaster , ciona intestinalis , danio rerio , tetraodon nigroviridis , gallus gallus , monodelphis domestica , mus musculus , rattus norvegicus , canis familiaris , pan troglodytes , homo sapiens .
all 12 species belong to the bilaterians , a metazoan subgroup simplifies the objective of this study since ( i ) the phylogeny of bilaterians is reasonably defined , and ( ii ) a few fully sequenced basal metazoan genomes ( like cnidarians ) can be used as outgroups of bilaterians 29 , 50 - 52 .
the phylogenetic analysis : briefly , we selected 70 aforementioned cog / kogs , as they exist in eggnog v2 6 , which we refer to as " homology seeds. " to exclude errors due to old genome annotation ( eggnog v2 is based on ensembl v46 ) , we mapped the " homology seed " identifiers to ensembl v60 .
the following steps were performed uniformly to all families certifying that refogs are not biased toward their initial " homology seeds. " blast 53 searches were performed in the 16 animals using query sequences from well - annotated genomes ( e.g. human , zebrafish , and fly ) .
the homologous sequences were aligned with muscle 54 and the alignments were used to build initial nj trees with clustal x 55 ( indicated as round 1 in the illustration below ) .
large groups were thereafter divided based on the positions of orthologs in the outgroups , as exemplified by the family of mucins ( fig. 1 ) .
in several cases where no clear outgroup was found , refogs were defined based on ( i ) the domain content , ( ii ) manual inspection of the alignments , and ( iii ) previous published descriptions of the families .
after the initial curation of the families , all sequences determined to be members of the bilaterian refogs were aligned using muscle 54 .
alignments were refined 56 and hidden markov models ( hmm ) were built using the hmmer3 package 57 .
in a second refinement step ( indicated as round 2 ) , the hmm models were used to identify related sequences that were left out from the 16 aforementioned genomes .
as a last step , all qualified members of each refog were realigned , using the same procedure as before , final hmm models were generated and phylogenetic trees were calculated using phyml version 3.0 58 .
the detailed analysis is described in the supplementary file .
black arrows indicate the flow of the analysis .
* steps that are repeated after hmm profile searches resulting in refogs after round 2 ( red arrow ) .
the manually curated benchmarking set was used for two different analyses : ( i ) comparison of refogs to the automatically predicted ogs of five publicly available databases , and ( ii ) comparison of refogs to different customized versions of the eggnog database .
the first comparison aimed at demonstrating the power of this dataset to guide the improvement of current methods .
we selected five databases , namely treefam 5 , eggnog 6 , orthodb 7 , orthomcl 8 , and oma 9 , since each is designed for multiple - species comparison , but with unique database features ( box 1 ) .
although the comparisons are against the same benchmarking set , we are aware of several other confounding variables , such as algorithmic differences , species representation / distribution or genome annotation , that can all affect the results .
yet , it quantifies the status of the compared databases in an objective way .
to quantify the impact of some specific biological and technical factors , we additionally generated different versions of the eggnog database to monitor several influencing factors one by one .
we assessed the quality of the ogs at two different levels of resolution : ( i ) gene count , measuring mispredicted genes , and ( ii ) group count , reflecting errors at the level of og ( fig. 2 ) .
additionally , for each of the two resolution levels , we used three counting schemes allowing us to distinguish database - specific trends .
at a strict requirement of all genes being correctly assigned ( gene count level ) only as little as 3 - 22 % of the refogs were recovered , while a more relaxed requirement that curated orthologs are not clustered in multiple ogs or with other homologous proteins that are not part of the refog ( group count level ) results in 10 - 48 % correctly predicted refogs .
limiting our analysis to the 35 most challenging families decreases this percentage even more ( fig. s1 of supporting information ) , reflecting our initial aim to select families that hamper accurate orthology prediction ; we aimed at a benchmark set that points out shortcomings of each method and leads to its improvement .
all above indicated that there is room for improvement for all methods , but most importantly , we have to understand which factors contributed to this result .
figure 2 the 70 manually curated refogs as a quality assessment tool .
five databases were used to illustrate the validating power of the benchmark set .
the performance of each database was evaluated at two levels : gene ( focus on mispredicted genes ; upper panel ) and group ( focus on fusions / fissions ; lower panel ) level .
a : gene count - for each database we identified the og with the largest overlap with each refog and calculated how many genes were not predicted in the og ( missing genes ) and how many genes were over - predicted in the og ( erroneously assigned genes ) and e : group count - for each method we counted the number of ogs that members of the same refog have been separated ( refog fission ) and how many of those ogs include more than three erroneously assigned genes ( refog fusion ) .
to increase the resolution of our comparison , three different measurements for each level were provided , resulting in six different scoring schemes .
b : percentage of accurately predicted refogs in gene level ( refogs with no mispredicted genes ) ; c : number of erroneously assigned and missing genes ; d : percentage of affected refogs by erroneously assigned and missing genes ; f : percentage of accurately predicted refogs in grouplevel ( all refog members belong to one og and are not fused with any proteins ) ; g : number of fusions and fissions ; and j : percentage of affected refogs by fusion and fission events .
databases are aligned from the more to the less accurate , taking into account the total number of errors ( length of the bar in total ) .
black bars indicate identical scores .
the phylogenetic range of the compared species affects the accuracy of prediction the phylogenetic distribution of the compared species influences the orthology / paralogy assignment , as we exemplified with the mucin family ( vertebrate - vs. bilaterian - specific groups ) .
the broader the phylogenetic range of the compared species the larger the ogs , as the single ancestral sequence from which all the orthologs and paralogs are derived is placed deeper in the tree .
this is reflected in the ranking of the five databases that varies considerably in the six different scoring schemes used ( fig. 2 ) .
for instance , although orthomcl contains the highest number of erroneously assigned genes ( fig. 2c ) , the number of refogs that are affected by erroneously assigned genes is higher for eggnog than orthomcl ( fig. 2d ) .
on closer examination , orthomcl overpredicts many orthologs in only a few families , while eggnog overpredicts a few proteins in many families ( table s2 of supporting information ) , partially due to mispredicted genes ( later characterized as pseudogenes or wrong gene models ) inherited from an old genome annotation ( see below ) .
we assume this observation is partly due to the diverse species ranges of the studied repositories ( box 1 ) .
eggnog , although it provides a broad species coverage ( 630 prokaryotes and 55 eukaryotes ) , supplies ogs for several taxonomic levels , such as metazoans ( menogs ) that are used in this study and are build from 34 bilaterians in the eggnog version studied here .
on the other hand , orthomcl builds its ogs from all 138 eukaryotic and prokaryotic species in the database .
in other words , ancient families , e.g. abc transporters , which expanded before the bilaterian radiation , form huge ogs in orthomcl , but not in the menog subset of eggnog .
as different scientific questions require a different species range , hierarchical groups as provided by eggnog 27 , orthodb 28 , and oma 9 appear to be a balanced solution to serve many different questions , compared to databases that are only dedicated to a particular phylogenetic range [ be they narrow ( treefam ) or broad ( orthmcl )] .
despite being specifically designed for metazoans , treefam has the second largest number of erroneously assigned genes after orthomcl ( fig. 2c ) , which is accompanied by the largest number of fusion events ( fig. 2g ) .
this can be attributed to the choice of outgroups used by treefam .
treefam families are phylogenetically separated by a non - animal outgroup ( yeast or plant ) , while , for example , monosiga brevicollis 29 or other proposed species 30 would be much better suited .
the choice of a phylogenetically closer species would presumably split artificially large families .
furthermore , delineating orthology through tree reconciliation benefits treefam in the category of missing genes ( fig. 2c ) , since the lack of a closer outgroup prevents the bilaterian ogs from splitting , as illustrated in fig. 1. in contrast , the database with the largest number of missing genes and fission events is oma ( figs. 2c and g ) due to an alternative operational definition of an og 31 ; only proteins with one - to - one orthologous relationships are included in an og , so that large families with multiple paralogs are split artificially into multiple smaller ogs .
the latest release of the oma database , publicly available after the completion of our analysis , has been redesigned and now provides ogs based on both oma and cog formulations 9 .
in summary , the initial design of an orthology resource , e.g. phylogenetic range of species , " hierarchical groups " , or formulation of og , is crucial for its performance .
in any case , all methods only predict a fraction of refogs accurately and mispredict a large number of genes ( fig. 2 ) .
it is noteworthy that there are refogs that none of the methods infer accurately , indicating that there are biological and technical factors that affect the performance of orthology assignment more generally .
we have thus tried to relate a few of them with the outcome of this comparison .
the impact of family complexity on orthology prediction due to the central role of orthology in comparative and functional genomics , there is an extensive literature on accuracy - restricting factors of its assignment 13 , 16 , 17 .
we have already mentioned several caveats of orthology prediction using the mucin family , the majority of which are exemplified by the 70 refogs .
the families were selected under certain criteria ( box 2 ) , mostly with a view to understanding the impact of a few biological and technical factors , namely duplications ( paralogy )/ losses , rate of evolution , domain architecture , and alignment quality .
all these factors have been reported to affect the quality of orthology prediction 17 .
paralogy as manifested in multi - gene families hamper the accurate orthology prediction 4 , 13 .
multiple lineage - specific gene losses and duplications result in complex evolutionary scenarios , which are hard to interpret .
classifying the refogs based on their size , we observed that the larger the refog , the more mispredictions are introduced by the methods ( fig. 3a ) .
for all methods , the numbers of missing genes ( fig. 3a ) and og fissions ( fig. s2 in supporting information ) increases significantly with the refog size ( table s5 of supporting information ) .
additionally , families with more than 40 members accumulate both fusion and fission events .
for instance , gh18 - chitinases , a refog that consists of 45 members , is characterized by multiple vertebrate - specific duplication events .
all graph - based methods split the vertebrate subfamilies of the gh18 - chitinases into distinct groups ( table s2 of supporting information ) , and treefam lumps the refog with insect - specific homologs due to the presence of the glyco - hydro - 18 domain , although phylogenetic analysis of the family indicates a general lack of orthology among those groups 32 .
figure 3 the impact of biological complexity in orthology assignment .
to evaluate the impact of important caveats in orthology prediction , the refogs were classified based on their family size , rate of evolution , alignment quality and domain complexity .
a : family size ( reveals the impact of paralogy ) : the refogs were separated into ( i ) small ( less than 14 members ) , ( ii ) medium ( more than 14 members , but less than 40 ) , and ( iii ) large ( more than 40 genes ) .
b : rate of evolution : the refogs were classified based on the meanid score ( described as the " famid " in 33 ) , an evolutionary rate score derived from the msa of each family .
there are : ( i ) slow - evolving ( meanid > 0.7 ) , ( ii ) medium - evolving ( meanid < 0.7 , but > 0.5 ) , and ( iii ) fast - evolving ( meanid < 0.5 ) refogs .
c : quality of alignment : we classified the families based on their normd score 34 into : ( i ) high - quality alignment ( normd > 0.6 ) , and ( ii ) low - quality alignment 44 , 45 .
we can observe that high amino acid divergence correlates with an increasing number of mispredicted genes .
d : domain architecture complexity ; each refog is associated with the average number of domains , which is equal to the sum of predicted domains of the members of one refog divided by the family size .
there are three levels of complexity , starting from ( i ) none or one domain on average , to ( ii ) two to four , to ( iii ) more than four .
we observe that the performance of the five databases correlates with the biological complexity of refogs ; as families increasing their complexity ( more members , fast - evolving or multiple domains ) , the accuracy of predictions drops .
(+) and ( - ) symbolize erroneously assigned and missing genes , respectively .
significant correlations ( table s5 of supporting information ) between the distribution of missing / erroneously assigned genes and the tested factor are indicated in bold [(+) , ( - )] .
figures s2 and s4 of supporting information show similar observations at the group level ( fusions / fissions of refogs ) .
some large - size refogs , like ribosomal proteins or sam - synthetases are , however , predicted accurately by several methods .
since these two well - predicted large families are well conserved , we decided to investigate the impact of the rate of evolution on orthology prediction .
we categorized our benchmarking families into fast - , medium - , and slow - evolving based on their meanid score ( described as the " famid " in 33 ) , which indicates the rate of evolution ( supporting information ) .
fast - evolving families tend to accumulate a larger number of errors ( fig. 3b ) .
all graph - based methods miss a larger number of genes and introduce more fission events ( fig. s2 in supporting information ) in fast - evolving refogs compared to the more slowly evolving groups .
since the meanid score is calculated based on the multiple sequence alignment ( msa ) , we investigated the impact of msa quality by calculating the normd score 34 , an alignment score that depends on the number and the length of aligned sequences as well as their estimated similarity ( supporting information ) .
we expected treefam to be more sensitive to low - quality msas compared to graph - based methods , since it uses msa for tree - building and reconciliation steps to infer orthology .
indeed , it presents the highest deviation for all sources of errors ( table s5 of supporting information ) .
we also found that the number of missing genes is also affected by the alignment quality in graph - based methods ( fig. 3c ) .
because meanid and normd scores are correlated , many of the fast - evolving families are also poorly aligned .
still , we can see that treefam is significantly more affected by msa quality rather than rate of evolution .
the vast majority of proteins contain only one domain , and the most common multi - domain proteins tend to have few ( two or three ) domains 35 , 36 .
due to a variety of genetic processes ( duplication , inversion , recombination , retrotransposition , etc. ) proteins consisting of multiple domains with independent evolutionary origin can arise 37 - 40 .
this leads to conceptual but also practical challenges ( e.g. alignment ) in orthology prediction , as the domains have followed distinct evolutionary trajectories 16 .
we identified the domains of each protein in each refog through the smart database 41 .
out of the 70 refogs , 75 % contain multi - domain ( more than two domains ) proteins , compared to 62 % in the random subset and a report of 40 % multi - domain occurrence in metazoans 36 , which illustrates the tendency of the benchmark set toward more challenging families .
as expected , the proportion of accurately predicted refogs decreases as the number of average domains per family increases ( fig. 3d ) .
interestingly , the rate of erroneously assigned genes presents the most significant correlation with domain complexity , suggesting that protein families with multiple protein domains " attract " non - orthologous proteins due to domain sharing .
repeated domains within proteins , as the von willebrand factor ( vw ) d - c8 - vwc repeat in mucins ( fig. 1 ) or the epidermal growth factor ( egf ) domains in collagen , also lead to lower quality of ogs .
all of the 27 refogs containing repeated domains are more error prone than refogs without repeated domains ( fig. s3 of supporting information ) .
taken together , classification of the families from slow - evolving single copy to fast - evolving large families revealed method - specific limitations , but also that all pipelines fail to predict complex families accurately .
the rates of missing genes and fissions significantly correlate with the family size and rate of evolution , as expected , whereas the domain complexity seems to affect the recruitment of non - orthologous genes ( fig. 3 , figs. s2 and s4 of supporting information ) .
species coverage affects orthology prediction biological complexity is unlikely to be the primary source of errors in automated predicted ogs , as there are single - copy , slow - evolving , or single - domain protein families , which are not assigned correctly by several prediction methods. by investigating these families , we identified two additional technical factors that influence orthology assignment : genome annotation and species coverage .
to quantify the impact of these , we used the method in our own hands , eggnog , as we could apply it to different species sets ( fig. 4 , table s3 of supporting information ) and genome annotation versions ( fig. 4 , table s4 of supporting information ) .
figure 4 the impact of species coverage and genome annotation .
a : comparison of the performance of 34 - species and 12 - species ogs using refogs .
we measure the percentage of orthologs recovered ( coverage ) , missing genes and erroneously assigned genes for each reference species for those datasets [ yellow bar : publicly available ogs in eggnog ( same measurements as fig. 2 ) and green bar : customized ogs of the 12 selected species using same genome annotations as the public eggnog ] .
the reference species are highlighted by black letters , while the unconsidered species that complete the set of 34 eggnog species are written in gray letters .
numbers in parentheses show the total number of orthologs per species in the benchmarking set .
the gray boxes enclosing the colored bars correspond to 100 % coverage .
notice that the coverage is always higher for the 34 - species ogs compared to the 12 - species ogs except in the cases of c. elegans and ciona ( marked by asterisk ) , which are separated by long branches in both datasets .
b : comparison of the public eggnog ( yellow bar ) , 12 - species - old - annotation ogs ( green bar ) and 12 - species - new - annotation ogs ( purple bar ) at the gene level .
hatched boxes label the fraction of mispredicted genes of 34 - species - and 12 - species - old - annotation datasets that do not exist in ensembl v60 genome annotations , indicating the high number of errors due to old genome annotations .
c : comparison of public eggnog ( yellow bar ) , 12 - species - old - annotation ogs ( green bar ) and 12 - species - new - annotation ogs ( purple bar ) at the group level .
notice that the 12 - species datasets ( either with old or new annotation ) always introduce a larger number of fission events than the 34 - species ogs , highlighting again the importance of species coverage .
to measure the impact of species coverage , we prepared new ogs from only the 12 reference species , but kept the same genome annotation version ( ensembl v46 ) that the public eggnog v2 uses .
the 12 - species - ensembl46 ogs were compared to the refogs as well as the 34 - species - ensembl46 ogs ( referred to as eggnog in fig. 2 ) .
in the 12 - species - ensembl46 ogs , a larger number of genes are missing compared to the 34 - species ogs ( eggnog _ v2 ) ( fig. 4b ) , implying that 30 % of the missing genes in this dataset are due to the change in species coverage .
it seems that sequences of the 34 species facilitate correct clustering , presumably , by breaking long branches so that faster evolving genes can be connected ( fig. 4a ) .
for mammals , fish and insects , which contain more representatives in 34 - species ogs , we identified fewer missing genes in the 34 - species ogs than the 12 - species ogs .
on the other hand , c. elegans and c. intestinalis , which are separated by long branches from their nearest phylogenetic neighbors in both datasets , are not influenced as the sequence similarity for ortholog detection remains limited ( fig. 4a ) .
while 34 - species perform better than 12 - species in terms of missing genes , they contain more erroneously assigned genes .
a large fraction of erroneously assigned genes is due to inclusion of low - quality genomes , i.e. tetraodon in ensembl v60 contains almost 5,000 gene predictions less than the same genome in ensembl v46 .
in summary , the total number of mispredicted genes is higher for the 12 - species og ( figs. 4a and c ) , indicating that the more genomes and in particular those at the right evolutionary distance , increase the quality of the ogs .
number of errors inflates because of inaccuracies in genome annotation the quality of the genome annotation of a species included in a genomic or phylogenetic study has been reported to affect the results of the study 42 .
all resources in this study rely on ensembl 43 genome annotations for all 12 species , but the annotation status is considerably different from version to version .
while eggnog uses ensembl v46 ( the oldest among the compared resources ) orthodb uses ensembl v59 , thus it is the most updated and closest to the refog annotation , for which ensembl v60 was used. by tracing the identifiers of the mispredicted genes through ensembl history , we discovered that 7 % of the missing genes of eggnog only exist in the latest versions of ensembl ( v54 to v60 ) ( fig. 4b ) .
genomes like human , zebrafish and puffer fish , which were updated after ensembl v46 , contribute significantly to the pool of missing genes .
likewise , only 58 % of the erroneously assigned genes of eggnog map to ensembl v60 , while 40 % of them have been retracted and 2 % have been characterized as pseudogenes .
taken together , almost half of all errors result from genome annotation artifacts , which is thus a major factor to consider .
to directly test the effect of the genome annotation and separate the impact of species coverage from this analysis , we clustered the proteins of the 12 reference species based on the ensembl v60 gene annotations .
the impact of genome annotation is elucidated by comparing the number of errors between the 12 - species - ensembl60 ogs with the 12 - species - ensembl46 ogs .
comparing the overall number of mispredicted genes , at the gene level , the 12 - species - ensembl60 ogs perform better than the 12 - species - ensembl46 ogs ( fig. 4b ) .
we found 45 % fewer erroneously assigned genes ( 149 vs. 271 ) in the 12 - species - new - annotation ogs compared to the 12 - species - old - annotation ogs .
again , a large fraction or erroneously assigned genes of the latter dataset ( 33 %) do not exist in ensembl v60 ( table s4 of supporting information ) .
however , the number of missing genes is similar between the two datasets and higher compared to the 34 - species ogs , indicating , once again , the impact of species coverage .
the fact that ~ 40 % of the mispredicted genes in eggnog ogs would have been avoided by using an updated version of genome annotations , highlights the importance of frequent updates and points to the sensitivity of genome annotations .
a transparent benchmark set made publicly available to facilitate the access to the curated benchmark families , we have created a web interface through which details on the 70 refogs can be retrieved .
in addition , alignments , protein sequences , phylogenetic trees and hmm of each refog can be downloaded and used for future analyses of the 70 bilaterian ogs .
the data are available under the creative commons attribution 3.0 license at : http :// eggnog.embl.de / orthobench .
conclusions the quality assessment introduced here is independent of functional associations and , instead , directly approaches the phylogenetic foundations of ogs .
the benchmark set was applied to five commonly used databases and revealed the impact of several biological and technical factors that challenge orthology prediction .
all studied repositories predict only a fraction of refogs accurately and thus indicate that there is considerable room for improvement for all orthology assignment methods .
although it is impossible to completely quantify the individual factors that contribute to the errors of each method due to the diversity of the methodologies , hidden correlations , and confounding variables , the 70 refogs reveal biological and technical limitations that affect each method significantly .
for example , domain complexity is significantly correlated with an increased accumulation of erroneously assigned genes in all databases .
our results also illustrate that all the tested algorithms need to be improved to be able to handle the " complex " families ( duplication / losses , complex domain architectures ). of the refogs , 36 % are not accurately predicted by any tested databases , revealing " global " limitations of orthology predictions that are associated with the factors we outlined here .
there are also refogs that only some of the databases mispredict , and , thus , hint at database - specific improvements , i.e. several operational differences , such as the delineation of hierarchical groups , and the usage of ( as close as possible ) outgroups affect the accuracy of predicted ogs .
however , the most striking outcome of this study is that technical factors , such as genome quality followed by the phylogenetic coverage of the compared species seem to be the most limiting factors , causing up to 40 % of the errors observed .
the last observation suggests that frequent updates of the databases are necessary .
although we only tested bilaterian ogs in this study , we realize the importance of the expansion to other taxonomic groups , and have therefore provided sequences , alignments , hmm profiles , and trees of the refogs publicly at http :// eggnog.embl.de / orthobench for further curation in other species .
as this benchmark set proved valuable for assessing the quality of predicted ogs in metazoans , we believe that an analogous dataset covering the entire tree of life and capturing additional challenges more prominent in prokaryotes , such as horizontal gene transfer , should be the next step in guiding orthology prediction .
we would like to thank the orthodb team for providing us with a customized dataset .
we are grateful to lars juhl jensen , martijn huynen , evgeny zdobnov , and michael kuhn for their insightful comments , venkata satagopam for his help with ensembl history , and all members of the bork group for the fruitful discussions , and in particular ivica letunic for his help with the multidomain analysis .
we would like also to thank the three anonymous reviewers for their constructive comments .
references 1 koonin ev galperin my sequence - evolution - function .
computational approaches in comparative genomics 2003 boston kluwer academic 2 fitch wm distinguishing homologous from analogous proteins syst zool 1970 19 99 113 5449325 3 sonnhammer el koonin ev orthology , paralogy and proposed classification for paralog subtypes trends genet 2002 18 619 20 12446146 4 tatusov rl koonin ev lipman dj a genomic perspective on protein families science 1997 278 631 7 9381173 5 ruan j li h chen z coghlan a treefam .
2008. update nucleic acids res 2008 36 d735 40 18056084 6 muller j szklarczyk d julien p letunic i eggnog v2.0 .
extending the evolutionary genealogy of genes with enhanced non - supervised orthologous groups , species and functional annotations nucleic acids res 2010 38 d190 195 19900971 7 waterhouse rm zdobnov em tegenfeldt f li j orthodb , the hierarchical catalog of eukaryotic orthologs in 2011 nucleic acids res 2011 39 d283 288 20972218 8 chen f mackey aj stoeckert cj jr. roos ds orthomcl - db. querying a comprehensive multi - species collection of ortholog groups nucleic acids res 2006 34 d363 368 16381887 9 altenhoff am schneider a gonnet gh dessimoz c oma 2011 .
orthology inference among 1000 complete genomes nucleic acids res 2011 39 d289 294 21113020 10 vilella aj severin j ureta - vidal a heng l ensemblcompara genetrees .
complete , duplication - aware phylogenetic trees in vertebrates genome res 2009 19 327 35 19029536 11 huerta - cepas j capella - gutierrez s pryszcz lp denisov i phylomedb v3.0 .
an expanding repository of genome - wide collections of trees , alignments and phylogeny - based orthology and paralogy predictions nucleic acids res 2011 39 d556 560 21075798 12 kristensen dm wolf yi mushegian ar koonin ev computational methods for gene orthology inference brief bioinform 2011 in press , doi : 10.1093 / bib / bbr030 13 koonin ev orthologs , paralogs , and evolutionary genomics annu rev genet 2005 39 309 38 16285863 14 lang t alexandersson m hansson gc samuelsson t gel - forming mucins appeared early in metazoan evolution proc natl acad sci usa 2007 104 16209 14 17911254 15 lang t alexandersson m hansson gc samuelsson t bioinformatic identification of polymerizing and transmembrane mucins in the puffer fish fugu rubripes glycobiology 2004 14 521 7 15044386 16 gabaldon t large - scale assignment of orthology .
back to phylogenetics ?
genome biol 2008 9 235 18983710 17 kuzniar a van ham rc pongor s leunissen ja the quest for orthologs : finding the corresponding gene across genomes trends genet 2008 24 539 51 18819722 18 pryszcz lp huerta - cepas j gabaldon t metaphors .
orthology and paralogy predictions from multiple phylogenetic evidence using a consistency - based confidence score nucleic acids res 2010 39 e32 21149260 19 hulsen t huynen ma de vlieg j groenen pm benchmarking ortholog identification methods using functional genomics data genome biol 2006 7 r31 16613613 20 chen f mackey aj vermunt jk roos ds assessing performance of orthology detection strategies applied to eukaryotic genomes plos one 2007 2 e383 17440619 21 altenhoff am dessimoz c phylogenetic and functional assessment of orthologs inference projects and methods plos comput biol 2009 5 e1000262 19148271 22 goodstadt l ponting cp phylogenetic reconstruction of orthology , paralogy , and conserved synteny for dog and human plos comput biol 2006 2 e133 17009864 23 byrne kp wolfe kh the yeast gene order browser : combining curated homology and syntenic context reveals gene fate in polyploid species genome res 2005 15 1456 61 16169922 24 wapinski i pfeffer a friedman n regev a automatic genome - wide reconstruction of phylogenetic gene trees bioinformatics 2007 23 i549 58 17646342 25 akerborg o sennblad b arvestad l lagergren j simultaneous bayesian gene tree reconstruction and reconciliation analysis proc natl acad sci usa 2009 106 5714 9 19299507 26 salichos l rokas a evaluating ortholog prediction algorithms in a yeast model clade plos one 2011 6 e18755 21533202 27 jensen lj julien p kuhn m von mering c eggnog .
automated construction and annotation of orthologous groups of genes nucleic acids res 2008 36 d250 254 17942413 28 kriventseva ev rahman n espinosa o zdobnov em orthodb : the hierarchical catalog of eukaryotic orthologs nucleic acids res 2008 36 d271 5 17947323 29 king n westbrook mj young sl kuo a the genome of the choanoflagellate monosiga brevicollis and the origin of metazoans nature 2008 451 783 8 18273011 30 rokas a the origins of multicellularity and the early history of the genetic toolkit for animal development annu rev genet 2008 42 235 51 18983257 31 schneider a dessimoz c gonnet gh oma browser - exploring orthologous relations across 352 complete genomes bioinformatics 2007 23 2180 2 17545180 32 funkhouser jd aronson nn jr. chitinase family gh18 .
evolutionary insights from the genomic history of a diverse protein family bmc evol biol 2007 7 96 17594485 33 muller j oma y vallar l friederich e sequence and comparative genomic analysis of actin - related proteins mol biol cell 2005 16 5736 48 16195354 34 thompson jd plewniak f ripp r thierry jc towards a reliable objective function for multiple sequence alignments j mol biol 2001 314 937 51 11734009 35 doolittle rf the origins and evolution of eukaryotic proteins philos trans r soc lond b biol sci 1995 349 235 40 8577833 36 tordai h nagy a farkas k banyai l modules , multidomain proteins and organismic complexity febs j 2005 272 5064 78 16176277 37 copley rr letunic i bork p genome and protein evolution in eukaryotes curr opin chem biol 2002 6 39 45 11827821 38 ciccarelli fd von mering c suyama m harrington ed complex genomic rearrangements lead to novel primate gene function genome res 2005 15 343 51 15710750 39 forslund k henricson a hollich v sonnhammer el domain tree - based analysis of protein architecture evolution mol biol evol 2008 25 254 64 18025066 40 singh ah doerks t letunic i raes j discovering functional novelty in metagenomes : examples from light - mediated processes j bacteriol 2009 191 32 41 18849420 41 letunic i doerks t bork p 2009 d229 232 smart 6 .
recent updates and new developments .
nucleic acids res 37 42 milinkovitch mc helaers r depiereux e tzika ac 2x genomes - depth does matter genome biol 2010 11 r16 20144222 43 flicek p amode mr barrell d beal k ensembl 2011 nucleic acids res 2011 39 d800 806 21045057 44 thompson jd thierry jc poch o rascal .
rapid scanning and correction of multiple sequence alignments bioinformatics 2003 19 1155 61 12801878 45 muller j creevey cj thompson jd arendt d aqua .
automated quality improvement for multiple sequence alignments bioinformatics 2009 26 263 5 19926669 46 huynen ma bork p measuring genome evolution proc natl acad sci usa 1998 95 5849 56 9600883 47 ostlund g schmitt t forslund k kostler t inparanoid 7 : new algorithms and tools for eukaryotic orthology analysis nucleic acids res 2010 38 d196 203 19892828 48 deluca tf wu ih pu j monaghan t roundup : a multi - genome repository of orthologs and evolutionary distances bioinformatics 2006 22 2044 6 16777906 49 van der heijden rt snel b van noort v huynen ma orthology prediction at scalable resolution by phylogenetic tree analysis bmc bioinformatics 2007 8 83 17346331 50 putnam nh srivastava m hellsten u dirks b sea anemone genome reveals ancestral eumetazoan gene repertoire and genomic organization science 2007 317 86 94 17615350 51 chapman ja kirkness ef simakov o hampson se the dynamic genome of hydra nature 2010 464 592 6 20228792 52 srivastava m begovic e chapman j putnam nh the trichoplax genome and the nature of placozoans nature 2008 454 955 60 18719581 53 altschul sf gish w miller w myers ew basic local alignment search tool j mol biol 1990 215 403 10 2231712 54 edgar rc muscle : multiple sequence alignment with high accuracy and high throughput nucleic acids res 2004 32 1792 7 15034147 55 larkin ma blackshields g brown np chenna r clustal w and clustal x version 2.0 bioinformatics 2007 23 2947 8 17846036 56 castresana j selection of conserved blocks from multiple alignments for their use in phylogenetic analysis mol biol evol 2000 17 540 52 10742046 57 eddy sr a new generation of homology search tools based on probabilistic inference genome inform 2009 23 205 11 20180275 58 guindon s dufayard jf lefort v new algorithms and methods to estimate maximum - likelihood phylogenies assessing the performance of phyml 3.0 syst biol .
2010 59 307 21 20525638 authors' contributions t. a. l. , k. t. , t. d. , w. h. c. , and s. p. did the phylogenetic analysis of the families. k. t. , t. a. l. , and w. h. c. performed the analysis. s. p. created the website. t. d. , j. m. , and p. b. designed the analysis .
all the authors contributed to write the paper .
abbreviations : cog clusters of orthologous group egf epidermal growth factor hmm hidden markov models lca last common ancestor msa multiple sequence alignment og orthologous group refog reference orthologous groups vwc von willebrand factor type c vwd von willebrand factor type d supplementary material