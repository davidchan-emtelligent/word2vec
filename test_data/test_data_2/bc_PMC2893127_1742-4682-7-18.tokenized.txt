theor biol med model theoretical biology & medical modelling 1742 - 4682 biomed central 20525272 2893127 1742 - 4682 - 7 - 18 10.1186 / 1742 - 4682 - 7 - 18 research chip - pam : an algorithm to identify protein - dna interaction using chip - seq data wu song 1 song.wu @ stjude.org wang jianmin 2 jianmin.wang @ stjude.org zhao wei 1 wei.zhao @ stjude.org pounds stanley 1 stanley.pounds @ stjude.org cheng cheng 1 cheng.cheng @ stjude.org 1 department of biostatistics , st. jude children 's research hospital , 262 danny thomas place , memphis , tn 38105 , usa 2 bioinformatics center , st. jude children 's research hospital , 262 danny thomas place , memphis , tn 38105 , usa 2010 3 6 2010 7 18 18 19 3 2010 3 6 2010 copyright ( c ) 2010 wu et al ; licensee biomed central ltd .
2010 wu et al ; licensee biomed central ltd.this is an open access article distributed under the terms of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 2.0 ) , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
background chip - seq is a powerful tool for identifying the interaction between genomic regulators and their bound dnas , especially for locating transcription factor binding sites .
however , high cost and high rate of false discovery of transcription factor binding sites identified from chip - seq data significantly limit its application .
results here we report a new algorithm , chip - pam , for identifying transcription factor target regions in chip - seq datasets .
this algorithm makes full use of a protein - dna binding pattern by capitalizing on three lines of evidence : 1 ) the tag count modelling at the peak position , 2 ) pattern matching of a specific tag count distribution , and 3 ) motif searching along the genome .
a novel data - based two - step efdr procedure is proposed to integrate the three lines of evidence to determine significantly enriched regions .
our algorithm requires no technical controls and efficiently discriminates falsely enriched regions from regions enriched by true transcription factor ( tf ) binding on the basis of chip - seq data only .
an analysis of real genomic data is presented to demonstrate our method .
conclusions in a comparison with other existing methods , we found that our algorithm provides more accurate binding site discovery while maintaining comparable statistical power .
background understanding of transcriptional regulation mechanisms is of fundamental importance to the study of biological processes such as development , drug response and disease pathogenesis [ 1 ]. through modulation of gene expression patterns , the differentiation and function of cells are tightly controlled .
the on / off switch of specific gene expression is one of the main modulating mechanisms and is mainly through the association and disassociation of transcription factors ( tfs ) with their target gene promoters .
therefore , revealing the mechanism by which transcription factors regulate their target genes is essential to understanding many important biological processes .
several methods have been developed to identify the tf - target gene interactions and to investigate how and why cells respond to different signals .
one such method , chromatin immunoprecipitation ( chip ) on a chip ( chip - chip ) , is based on a tiling - array platform in which genomic dna oligomers from gene promoters are pre - fixed .
the dna fragments immuno - precipitated from cell lysate by a tf antibody hybridize with the chip - chip array and tf - binding regions are identified by their high - intensity signals .
like all other array - based methods , however , this method can detect only targets included on the array .
more recently , with the advance of next - generation sequencing ( ngs ) technologies , chip - seq has come into a wide use for transcription factor binding sites analysis. by directly sequencing the dna fragments immunoprecipitated in a chip experiments , chip - seq offers whole - genome coverage and greater sensitivity than the traditional chip - chip assay [ 2 ] .
several analytic algorithms have been proposed for chip - seq data , including erange [ 3 ] , findpeaks [ 4 ] , macs [ 5 ] , sissrs [ 6 ] , cisgenome [ 7 ] , quest [ 8 ] , useq [ 9 ] , spp [ 10 ] , peakseq [ 11 ] , bayespeak [ 12 ] , and glitr [ 13 ] .
most of these algorithms aim to identify genomic regions enriched with chip - dna fragments by using some negative control samples to remove / normalize some of the background noise from experimental procedures .
for example , robertson et al [ 2 ] identified the enriched regions by detecting peaks on a tag density map , generated by extending each mapped tag in the 3 ' direction to the average length of the dna fragments in the sequenced dna library .
the signal map is the integer count of the number of overlapping dna fragments at each nucleotide position .
the control sample was generated by another chip - seq experiment using the same antibodies against the un - stimulated cells , in which the transcription factor of interest is inactive and located in cytoplasm .
rozowsky et al [ 11 ] used the same idea of signal map , but used the raw input dna as the control sample .
chen et al [ 14 ] , studied a group of 13 transcription factors in e14 mouse es cells by using a control sample obtained from another chip - seq experiment with an irrelevant antibody , anti - gfp .
although these negative controls are useful , they cannot account for an important source of noise signal - nonspecific dna binding by tfs .
this noise signal is difficult to control , as tfs must nonspecifically bind to dna in order to efficiently access their unique binding sites among billions of nucleotides .
studies directly probing transcription factor dynamics at the single - molecule level in a living cell showed that tfs spend as much as 90 % of their time non - specifically bound to and diffusing along dnas [ 15 ] .
like the ability to bind to specific targets , non - specific binding to dna is a bona fide tf ability and therefore , this type of noise signal cannot be eliminated by using a negative control .
a few algorithms , such as sissrs , macs and findpeaks , can identify transcription factor binding targets solely on the basis of chip - seq data , without the use of control samples .
however , with the exception of sissrs , these algorithms identify binding sites merely by the number of tag counts within a genomic region , ignoring the forward - and reverse - strand information .
sissrs utilizes a logic rule in which the sequenced forward and reverse strands should lie separately on the two sides of the binding site ; therefore , the difference between the forward and reverse tag counts would change sign on the binding site .
the sissrs algorithm usually generates significantly more binding sites than other algorithms [ 6 ] , but these may include many false discoveries , as will be shown in later section .
here we describe a new algorithm that incorporates the forward - and reverse - strand information but employs it differently .
our algorithm , chip - pam , is based on peak counts modeling and pattern matching of a specific tag count distribution of forward and reverse strands generated by protein - dna binding , followed by de novo motif finding and searching within the potential binding regions .
we show that our algorithm can greatly reduce false positive findings while maintaining or improving accuracy and statistical power for binding site discovery .
results chip - pam : scoring the enriched genomic regions in chip - seq data tf binding sites ( tfbss ) usually contains a short consensus binding site ( cbs ) sequence , ~ 10 - 20 base pairs , that provides target specificity .
suppose that there is one tfbs in a small genomic neighbourhood ( e.g. , < 500 bp ) .
in a chip - seq experiment , ideally all forward - strand tags related to this tfbs should lie on the 5 ' side of the tfbs , and all reverse - strand tags should lie on the 3 ' side ( figure 1a ) , because only fragments containing the tfbs are pulled down for sequencing .
hence , given that the maximum fragment size selected for sequencing is d , a quantity known from chip - seq experimental procedures , it is expected that the region beginning d bp upstream of the tfbs and ending at the tfbs will contain the greatest number of forward - strand tags , and the region beginning at the tfbs and ending d bp downstream of the tfbs will contain the greatest number of reverse - strand tags .
if a potential tf binding region is scanned base pair by base pair with a sliding window of width d and the unique forward and reverse tags within the window are counted separately , the tag densities formed from forward and reverse strands will show a pattern of peak shift along the scanned genomic region , with the peak of one strand corresponding to the background signal of the other strand ( figure 1a , c ) .
the tag counts at the peak position and the pattern of peak shift can be used as physiological evidence for a tf binding .
therefore , several sequences that show good evidence of containing the potential cbs can be aligned for de novo motif finding [ 16 - 19 ] .
figure 1 tag count distributions from the simulated and real genomic data. a. simulated forward - and reverse - strand count distribution for a region containing one tf binding site ; b. difference between forward - and reverse - strand tag counts shown in panel a. c. forward - and reverse - strand tag count distribution in an example genomic region ( from the real data application ) ; d. difference between forward - and reverse - strand tag counts shown in panel c. based on the above , we propose a new algorithm , chip - pam , for chip - seq data analysis .
the method combines the tag counts at the peak position , the pattern recognition of the forward and reverse tag shift , and de novo cbs finding .
it consists of six steps that are summarized in figure 2 and described in detail below : figure 2 sequence the chip - pam algorithm .
1. identify potential binding regions ( pbrs ) by using a pre - specified empirical false discovery rate ( efdr ) : the whole genome is divided into non - overlapping regions d bp in size and the unique tags in each region are counted .
the frequencies of the tag counts are then tabulated and fitted to a gamma - poisson ( g - p ) mixture model that can accommodate the over - dispersion of the data .
the g - p model showed better fitting to the real data than the frequently used poisson model and has been used in other software ( e.g. , cis - genome [ 7 ]) .
the efdrs for different tag count thresholds , defined as the ratio of the theoretical number of regions exceeding the thresholds by chance from the g - p model to the number of observed regions exceeding the same thresholds [ 6 ] , can be calculated as the following where k is a count threshold , pr ( count > k ) is the probability of a tag count exceeding k in the g - p background model , ntotal is the total number of regions in the whole genome and nobserved ( count > k ) is the number of observed regions with count exceeding k. a tag count cut - off corresponding to the pre - specified fdr rate ( alpha , e.g. 0.5 ) is then determined , and the genomic regions with tag counts greater than the cutoff are selected , and merged if adjacent , to form pbrs .
the majority of the background tag signals are eliminated in this step , which can save immense amount of computing time in the following steps .
2. evaluate the peak tag counts for each pbr : a sliding window of width d is used to scan the pbrs base pair by base pair and the forward and reverse tags within each window are counted to yield the forward and reverse tag distributions similar to figure 1a and 1c .
on the basis of the fitted g - p model , a p - value is calculated for the tag counts at the peak position within each pbr .
3. identify the peak shift pattern from forward - to reverse - strand tag distributions : if a pbr contains a true tfbs , the difference between the forward - and reverse - strand tag counts will show a sinusoidal shape ( figure 1b , d ) .
this shape is used for the pattern match and is identified by pattern recognition that employs a wavelet - based smoothing technique ( see methods for details ) .
dissimilarity scores comparing each pbr to a simulated reference pattern ( sr ) are computed and ranked .
4. de novo motif finding : pbrs with high peak counts and good sinusoidal pattern of forward to reverse tag count shift are considered as high - quality pbrs , i.e. , those most likely contain a tf binding site .
the peak positions of the forward - and reverse - strand count distribution within the high - quality pbrs are obtained , and the genomic sequence a few bp ( e.g. , 20 bp ) upstream and downstream of the peak sites are retrieved to search for the de novo motif to which the tf might bind .
existing efficient algorithms such as meme [ 18 ] are used for motif finding .
a motif search algorithm typically generates several motifs , but only those contained by at least 25 % of the input sequences are candidate motifs .
notice that each input sequence is only about 40 bp long ; therefore it is reasonable to assume that each sequence contains either one motif or no motif .
5. scan potential pbrs by using the de novo motif identified : a scoring matrix formed on the aligned consensus sequences identified in step4 is used to screen and score all pbrs identified in step 1 .
the smallest p - values corresponding to the best match to the scoring matrix in each pbr are retained as the pbr motif p - values .
6. determine the significant regions : the pbr peak tag count p - values , pattern dissimilarity scores , and motif p values are integrated to re - rank the pbrs .
because the minimal p - value for the peak tag count may be as low as 10 - 30 , whereas the minimal motif p values may be only 10 - 5 , the scale difference for different score distributions is normalized .
the p - values are log - transformed , rescaled to the same level and averaged to re - rank the pbrs .
finally , the top ( 1 - alpha ) re - ordered pbrs are selected as the significant tf target regions .
characteristics of the chip - seq data to illustrate our method , we used a public chip - seq dataset ( gse12782 ) deposited at the geo by rozowsky et al [ 11 ] .
this dataset was originally analyzed by using peakseq .
several characteristics of the dataset are worth noting : 1 ) the raw input dna is used as control ; 2 ) the experiments were done in female hela s3 cells ; 3 ) the mitochondrial chromosomes ( chr m ) were retained for sequencing ; and 4 ) the transcription factor studied was stat1 , a tf with many well - known downstream target genes .
these characteristics , while are not necessarily useful for the data analysis , provide a good opportunity to assess our proposed method , including an estimate of its false negative and false positive findings , as described below .
in the chip - seq sample , ~ 26.7 million unique reads were mapped to the reference genome ( hg18 / ncbiv36 , ucsc genome browser ) , and in the input sample ~ 23.4 million unique reads were mapped .
the summary statistics are shown in table 1 .
the genome - wide coverage for the chip sample is 0.015 read / nt. this low sequencing coverage is typical of chip - seq data because the high - affinity of tf - dna binding averts the need for deep sequencing on the whole genome .
however , the sequenced fragments in chip sample and the input fragments in the control sample have very little overlap ( 0.75 % of all sequenced tags , table 1 ) .
this factor could be problematic if the input sample is used as local control , because the majority of fragments sequenced are present only in the chip sample or the input sample and therefore , the input fragments cannot serve as a representative control for chip data .
table 1 summary statistics of the chip - seq dataset .
unique reads copy percentage chr chip only input only in both chip only input only in both total length chip read / nt 1 - 22 , x 24.3 m 20.9 m 0.34 m 53.3 % 45.9 % 0.75 % 3b 0.015 y 11 k 11.6 k 1.7 k 45.5 % 47.6 % 6.9 % 54.7 m 0.0004 m 33 3144 16.5 k 0.17 % 15.9 % 83.9 % 16.5 k 1.191 shown are selected basic characteristics used in the application , comparing chromosomes 1 - 22 plus x ( combined because they are in the 2 - copy state ) , chr y , and mitochondrial chromosomes ( m ) .
chr y is absent from hela - s3 cells and indicates sequencing / mapping errors ; mitochondrial chromosomes are located in cytoplasm and serve as an internal control for the nuclear chromosomes .
the mitochondrial chromosomes have been deeply sequenced due to their high copy numbers .
most cells contain many mitochondria , and each mitochondrion contains several copies of chr m. thus , chr m copies are much more abundant than nuclear chromosomes [ 20 ] .
this phenomenon is observed in the example dataset ; the coverage on chr m is ~ 3000 times more than that on the nuclear chromosomes from the input sample .
because mitochondrial dna are physically separated from the nuclear stat1 proteins , they can be used as a reference to estimate the background noise from the experimental procedure , such as the residual input dna left in the chip sample .
the expected number of noise reads is estimated to be 5 million for genomic dnas ( table 2 ) .
however , the chip experiment generated about 24 million total noise reads , suggesting that most of the background fragments in the chip sample come from other sources , such as the nonspecific binding of a tf to the genome .
as discussed in the introduction , this type of noise signals cannot be adequately resolved by using controls .
this is one challenge that promoted us to develop an algorithm independent of control samples .
table 2 comparison of nuclear and cytoplasmic chromosomes .
total reads chr in chip in input chip / input ratio specific reads 2356286 441471 5.3373 1 - 22 , x noise reads 24285371 22585024 1.0753 e ( background 4959671 noise ) in chip * ( 0.2042 ) m 89835 409136 0.2196 * assuming that reads mapped to mitochondrial chromosomes ( m ) are due to the experimental procedure and not to the non - specific binding of stat1 , the chip / input ratio for this background noise is 21.96 % .
among chromosome 1 - 22 and x , the expected background noise in chip would be 22585024 * 0.2196 = 4959671 , which accounts for 20.42 % of total noise reads .
in contrast to chr m , chromosome y ( chr y ) is another extreme with very low coverage , because the male y chromosome is absent in the female hela s3 cells .
therefore , any enriched regions identified on the chr y should be considered as false positives .
the fact that some reads were mapped to chr y in the dataset suggests there were mapping / sequencing errors .
the reads mapped to chr y cannot be explained by sequence homology to chromosome x , because only unique reads were mapped to the reference genome .
for these reasons , chr y serves as a perfect internal negative control .
as shown in table 1 , 12.7 thousand of the 24.3 million chip reads were mapped to chr y. given that the length of chr y is 54.7 m and the whole genome is about 3 billion bps , at least 0.9 m ( 3.64 %) reads in the chip sample are predicted to be wrongly mapped or sequenced .
stat1 targets identified by chip - pam in the chip - seq dataset we applied chip - pam to the stat1 chip - seq dataset to examine the performance of our algorithm. from the experiment procedure , the maximum fragment size was known to be 250 bp. the whole genome was then divided into non - overlapping regions of 250 bp and the unique tags in each region were counted and tabulated into a tag count histogram .
this histogram resembles an empirical distribution of the background noise count within a 250 - bp region and was fitted by the g - p and poison models ( figure 3a , b ) .
the comparison between the two models showed that the g - p model fits the data much better than the poisson model , suggesting significant dispersion of the data .
although almost 98 % of the 250 - bp windows contained six or fewer unique tag reads , a close look at the tail of the histogram and the fitted g - p density ( figure 3c ) revealed significant tag enrichment in some regions ; the efdrs for different tag count cut - offs were calculated from these data .
figure 3 model fitting of the genome - wide tag count histogram. a. data fitted by the gamma - poisson model ; b. data fitted by the poisson model. c. the detailed right - tail fitting by the gamma - poisson model. with a pre - specified efdr level of 0.5 for the count data , regions containing six or fewer unique tag reads were eliminated , leaving 69,809 pbrs .
for each pbr , a p - value based on the count at the regional peak was calculated from the fitted g - p model , and a dissimilarity score based on shape pattern matching was computed .
these two values were used to select 190 regions with low count p - values and the best - matched shapes , which showed strong evidence of tf bindings .
short genomic sequences around the peak sites (+/ - 20 bp ) in the 190 region were retrieved for de novo motif finding by using meme .
because each input sequence was very short ( 40 bp ) , we specified that each sequence contained either one motif or none .
a motif was identified in 112 out of 190 regions ( 58.9 %) , and all of the pbrs were then scanned for this motif by using the mast program [ 18 ] .
the de novo motif found strongly matched the stat1 gas motif previously identified and validated in biological experiments [ 2 ]. from the mast scan , a p - value for the best motif match was obtained for each pbr .
therefore , three values were associated with every pbr : a p - value based on count distribution ( pc ) , a dissimilarity score based on shape pattern matching ( dp ) , and a p - value based on motif matching ( pm ) .
the three scores were log - transformed and the log - dp and log - pm were scaled to the level of log - pc by regression .
the pbrs were then re - ranked by averaging the three scores .
because the original efdr was specified to be 0.5 , this suggests the true positive rate is also 0.5 in all pbrs .
therefore , the top 34905 regions are considered significant target regions .
the pre - specified efdr level is somewhat arbitrary .
a general rule in choosing the efdr is that it should be large enough to incorporate sufficient number of pbrs for re - ranking , yet not too large to include too many noisy regions .
when we used another alpha of 0.7 to analyze the data , 117,479 pbrs were identified and 35243 ( 117479 *( 1 - 0.7 )) were selected as significant regions .
the number of significant regions resulting from the two efdrs is almost identical , as although a higher efdr ( alpha ) yields a larger pool of pbrs , a smaller rate of true discovery rate ( 1 - alpha ) offsets the initial large number in the final result .
we found that an efdr of 0.5 is a good choice because it can generate sufficient pbrs for further improvement while being computationally more efficient than higher efdrs .
comparison with other algorithms we compared chip - pam with sissrs , peakseq and chip - pam using tag counts information only .
in the stat1 chip - seq dataset described above , peakseq identified 36,998 significant regions [ 11 ] and sissrs identified 85,892 significant regions .
to make the further comparison fair , we used the same number of top 36,998 regions for all algorithms .
the false discovery rate and power are the two most important criteria in assessing a model or algorithm .
although we do not know all of the true stat1 binding sites in this dataset , we do have partial knowledge to make the assessment .
as mentioned before , because hela - s3 cells are female cells , any significant regions found on chr y should be spurious .
therefore , we used the number of findings on chr y as a surrogate for false discoveries .
figure 4a shows the " cumulative incidence " of findings on chr y as a function of the total number of significant regions .
chip - pam identified markedly fewer false positives than sissrs and peakseq .
compared with chip - pam using the counts data only , the incorporation of additional information about the tag distribution shape and motif score in chip - pam significantly reduced the false - positive findings .
figure 4 comparison of chip - pam with sissrs and peakseq and chip - pam using count data only. a. the number of findings on chr y is used to compare false positive findings. b. fourteen known stat1 gas target genes are used to compare the true positive findings ( i.e. , power ) .
twenty - two genomic promoters have been experimentally validated to be regulated and bound by stat1 protein upon ifn - gamma stimulation [ 2 ] .
we used this information to compare the power of the algorithms .
as shown in figure 4b , peakseq , chip - pam and chip - pam using count only have almost identical " cumulative power " ; they all detected a maximum of 14 of 24 positive promoters .
however , the sissrs had the least power to detect the known sites .
in the rest 8 targets that were not identified by either method , a detailed look at their genomic regions found that essentially no reads were mapped in this chip - seq sample , and therefore no algorithm can detect them .
this suggests that chip - pam is efficient in identifying the true stat1 targets .
we used the refseq to annotate the significant regions found by the three algorithms .
if an identified stat1 binding region is located within - 250 bp to 5 kp from a gene 's transcription initiation site , the gene is considered a stat1 target .
the target genes found by the three algorithms share close similarity ( figure 5 ) , and 2,651 of them were identified by all three methods ( additional file 1 ) .
for the 2,651 common genes , the rank correlation was 0.71 between chip - pam and peakseq , 0.55 between chip - pam and sissrs , and 0.52 between peakseq and sissrs .
these data suggest that ranking by chip - pam is more similar to ranking by sissrs , since both used a pattern of forward and reverse tags .
however , the pattern utilized by sissrs is somewhat too local as it captures , within a small region , the sign change of the difference between the forward and reverse tag counts .
this fact may explain why sissrs yields a much higher false positive rate .
two genomic examples on chromosome 1 , chr1 : 91,625,233 - 91,625,750 ( figure 6a ) and chr1 : 121,185,480 - 121,186,959 ( figure 6b ) , are shown to illustrate the point .
these two regions were identified as significant by sisisrs , but not by either chip - pam or peakseq .
the overall regional pattern clearly indicates that the tag enrichments in these two regions are not caused by tf binding ; however , the rapid local sign change of the difference between the forward and reverse tag counts causes sissrs to consider them as significant .
figure 5 venn diagraph of genes found by the three algorithms .
figure 6 examples of two real genomic regions that are identified as significant by sissrs but not by chip - pam and peakseq. a. chr1 : 91625233 - 91625750 ; b .
chr1 : 121185480 - 121186959 .
the red line represents forward - strand counts and the green line represents reverse - strand counts .
the positive blue bars represent forward tag reads and the negative blue bars represent reverse tag reads .
the broad pink line delineates regions identified as significant by sissrs .
discussion with the advance of the next - generation techniques , chip - seq experiments are expected to be in great demand for the important biological studies of transcription regulatory network .
therefore , more efficient models and algorithms to analyze such data are urgently needed .
here we have proposed a new method of analysis of chip - seq data that is based on chip - seq sample only and that retains and even improves the accuracy and statistical power of binding site discovery .
there are four potential major mechanisms by which a region with enriched tags might be observed in chip - seq data : ( 1 ) " true positive " tf target regions ; ( 2 ) focal amplification of certain genomic regions ; ( 3 ) nonspecific binding of tfs to the genome ; and ( 4 ) random noise from experimental procedures .
the difficulty arises in effectively separating tag enrichment resulting from ( 1 ) from those resulting from the others .
our algorithm is designed to improve the accuracy of finding in each instance .
the gamma - poisson modeling takes account of the non - uniform noise background across the genome and helps to model both nonspecific tf binding and random noises .
the use of pattern recognition to match a tf binding pattern will improve the detection of the true enrichment pattern .
for example , enrichment induced by focal amplification shows a shape pattern ( similar to figure 6a ) very different from that of enrichment by tf binding , and the pattern matching step of our algorithm can efficiently remove it from the final results .
furthermore , the de novo motif finding and searching step will help eliminate non - specific binding regions that do not contain the conserved motif sequences .
because our proposed method incorporates three lines of evidence to determine the significant tf target regions , it is more robust than other current methods and detects fewer false positive bindings .
however , it is often difficult to determine the statistical accuracy of the findings when multiple lines of evidence are integrated .
in chip - pam , we propose a novel data - based two - step fdr procedure to solve this problem .
in this procedure , an efdr ( alpha ) derived from the genome - wide tag count distribution is pre - specified to select the potential tf binding regions , and then the shape and motif information is incorporated to re - rank the selected pbrs .
as the alpha level controls the overall fdr and re - ranking of the pbrs will not change it , the top ( 1 - alpha ) re - ordered candidate regions are considered to be significant .
this data incorporation procedure can be potentially applied to other integrated analyses as well .
another advantage of our algorithm is that unlike other methods , in which the average length of the chip fragments must be estimated , chip - pam makes use of the maximum length of the fragments , which is known from the experimental procedures .
this should reduce the variation of the findings .
the entire analysis of the stat1 example dataset took about 1.5 hours on a regular desktop computer .
therefore , our algorithm is computationally efficient .
the majority of time is spent on the shape matching and motif identification steps .
only 5 minutes is needed to scan the pbrs and compute preliminary result from them .
if the inference is to be made on the basis of the count data and only the genome scanning part is required , our algorithm would be extremely fast and might be algorithmically attractive for other applications , such as epigenetic analysis of modified histone proteins [ 21 ] .
further investigation is needed in this direction .
finally , one point worth noting is that although our algorithm requires no control sample , control samples may have an important role , depending on the scientific questions asked .
for example , if a study were to compare the binding site difference of a tf in its " active " v.s .
" inactive " form , a chip - seq sample for the " inactive " tf would be a perfect control .
in this case , two chip - pam analyses would be performed independently on the two chip - seq samples .
conclusions we propose a new algorithm , chip - pam , for genome - wide identification of the transcription factor target genes by using the chip - seq data .
unlike other methods of analyzing chip - seq data , chip - pam incorporates three lines of evidences , including tag count modeling at the peak position , pattern matching of a specific tag count distribution , and de novo motif finding and searching along the genome .
a comparison with existing methods showed that our method can greatly improve the accuracy of binding site discovery while maintaining comparable statistical power .
methods sequencing procedures because information from sequencing procedures is used as parameter inputs of our algorithm , we will briefly describe the sequencing process .
in chip - seq sample preparation , genomic dnas are either sonicated or digested into random fragments and size - selected ( 100 - 800 bp ) for better sequencing accuracy .
the chip - dna fragments submitted for sequencing are therefore within a certain range of length , e.g. 150 - 250 bp. owing to cost and technical reasons , typical tag reads acquired from sequencing apparatus for chip - seq experiments are small (~ 30 - 60 bp ) , and consequently reflect only the two ends of the fragments , not the whole fragments .
the end positions of fragments can be revealed by mapping the short - read tags back to a reference genome .
for single - end sequencing , because the sequencing adaptors are ligated onto two ends of a fragment randomly , approximately equal numbers of tags are expected to be obtained in forward and reverse directions within a region .
gamma - poisson model if the tag reads from chip - seq experiments are uniformly distributed on the genome that is divided into equal windows of d bp , basic probabilistic considerations imply that the distribution of unique tag counts in a certain window should obey the poisson distribution .
however , since the binding affinity of a tf to the whole genome is not uniform ( i.e. , specific and non - specific bindings ) , the ideal poisson model will not be followed .
it is expected that the whole count data will be a mixture of poisson distributions .
assuming that the majority of dna fragments are background signals , and that the significantly enriched regions reside largely in the right tail of the distribution , a zero - truncated gamma - poisson density can be employed as the background model for the count data .
the gamma - poisson model is shown as below : poisson probability mass : gamma density function : gamma - poisson ( g - p ) mixture density function : zeros are not included in the model , as zero counts can occur simply because of non - mappability of certain regions and therefore does not truly reflect the zero counts in the model .
the g - p model is employed to infer whether a specific region has a significantly high count .
the mean count r ( 1 - p )/ p is positively correlated with the size of the window , i.e. , the maximum fragment size d , and the sequencing depth of total number of reads obtained , and r ( 1 - p )/ p2 measures the dispersion of the data .
there are several ways to estimate the model parameters [ 22 ] .
here we employ the maximum likelihood method .
the maximum - likelihood estimate of the parameters ( r , p ) was done by using the nonlinear optimization algorithms implemented in r [ 23 ] .
pattern matching with wavelet smoothing the pattern of peak shift in figure 1a represents the difference in the tag count distributions between the forward and reverse strands .
theoretically , this difference has a sinusoidal shape , as illustrated in figures 1b .
the observation patterns spbr are calculated for all the pbrs that pass the initial genome scan .
a reference pattern ( sr ) can also be generated from the simulation of a chip - seq experiment .
the spbr and sr can then be compared to calculate the dissimilarity score .
to remove noise signal from the data , we perform wavelet smoothing on sr and spbr by using maximal overlap discrete wavelet transform with la8 wavelet filter and hard thresholding [ 24 ] .
the locations of the peaks and troughs of sr and spbr are then matched by translation and scaling .
the maximum amplitudes of both spbr and sr are scaled to 1 .
assuming the total length of the reference strand is n , the dissimilarity score is defined as the sum of the absolute differences between spbr and sr. simulation of a reference pattern a tf chip - seq experiment is simulated to generate the reference pattern used for the pattern matching .
suppose there are 3 x 106 dna fragments with random length between 150 and 250 bp that are uniformly distributed on a 1 kb genomic region .
assume there is one tfbs located in the center of the region .
assume that the probability of being pulled down for sequencing is 0.1 % for dna fragments containing the tfbs , and 0.005 % for fragments not containing the tfbs and that the two ends of one fragment have an equal probability of being sequenced .
the tag count distributions for the forward and reverse strands along the genomic region are generated and used to build the reference pattern .
motif finding and searching meme is one of the most widely used tools for de novo consensus motif finding [ 18 ] http :// meme.sdsc.edu / meme4 _ 1 / .
because meme searches for motifs by performing expectation - maximization ( em ) on a motif model , it is very time - consuming for large input datasets .
we chose an input size of fewer than 500 sequences for motif finding , to minimize the drawbacks of too few sequences ( not representative ) or of a number too large to be computationally feasible .
only motifs contained in at least 25 % of sequences submitted were considered to be canonical motifs and were used for subsequent motif searching .
also , as each submitted sequence for motif finding is approximately 40 bps , we expect that such short sequences will not contain more than one motif .
therefore , the maximum number of motifs in each sequence was set at 1 for meme .
position - specific scoring matrices ( pssms ) generated by meme were used as input for mast , a sister program of meme developed for motif alignment and searching .
mast compares the sequence from pesrs with the motifs identified from meme and calculates match scores for each sequence .
a p - value is generated to score the probability of each sequence that may contain the motif found .
competing interests the authors declare that they have no competing interests .
authors' contributions sw conceived the idea , wrote the r code , analyzed the real genomic data , and wrote the manuscript .
jw wrote the perl code to integrate the software .
wz conceived the idea of pattern matching with wavelet smoothing , wrote the code , and helped to write manuscript .
sp and cc was involved in data analysis and helped to write manuscript .
all authors have read and approved the final manuscript .
supplementary material additional file 1 the common genes identified by three algorithms .
the file contains the 2,651 common genes that are identified by all three algorithms : chip - pam , peakseq and sissrs , and also their relative rankings by each method .
click here for file acknowledgements we thank ms. sharon naron in scientific editing at st jude children 's research hospital for her professional editing support .
this work was supported in part by the american lebanese syrian associated charities ( alsac ) .
latchman ds eukaryotic transcription factors 2008 fifth elsevier ltd robertson g hirst m bainbridge m bilenky m zhao y zeng t euskirchen g bernier b varhol r delaney a thiessen n griffith ol he a marra m snyder m jones s gnome - wide profiles of stat1 dna association using chromatin immunoprecipitation and massively parallel sequencing nat methods 2007 4 651 7 10.1038 / nmeth1068 17558387 mortazavi a williams ba mccue k schaeffer l wold b mapping and quantifying mammalian transcriptomes by rna - seq nat methods 2008 5 621 8 10.1038 / nmeth.1226 18516045 fejes ap robertson g bilenky m varhol r bainbridge m jones sj findpeaks 3.1 : a tool for identifying areas of enrichment from massively parallel short - read sequencing technology bioinformatics 2008 24 1729 30 10.1093 / bioinformatics / btn305 18599518 zhang y liu t meyer ca eeckhoute j johnson ds bernstein be nussbaum c myers rm brown m li w liu xs model - based analysis of chip - seq ( macs ) genome biol 2008 9 r137 10.1186 / gb - 2008 - 9 - 9 - r137 18798982 jothi r cuddapah s barski a cui k zhao k genome - wide identification of in vivo protein - dna binding sites from chip - seq data nucleic acids res 2008 36 5221 31 10.1093 / nar / gkn488 18684996 ji h jiang h ma w johnson ds myers rm wong wh an integrated software system for analyzing chip - chip and chip - seq data nat biotechnol 2008 26 1293 300 10.1038 / nbt.1505 18978777 valouev a johnson ds sundquist a medina c anton e batzoglou s myers rm sidow a genome - wide analysis of transcription factor binding sites based on chip - seq data nat methods 2008 5 829 34 10.1038 / nmeth.1246 19160518 nix da courdy sj boucher km empirical methods for controlling false positives and estimating confidence in chip - seq peaks bmc bioinformatics 2008 9 523 10.1186 / 1471 - 2105 - 9 - 523 19061503 kharchenko pv tolstorukov my park pj design and analysis of chip - seq experiments for dna - binding proteins nat biotechnol 2008 6 1351 9 10.1038 / nbt.1508 rozowsky j euskirchen g auerbach rk zhang zd gibson t bjornson r carriero n snyder m gerstein mb peakseq enables systematic scoring of chip - seq experiments relative to controls nature biotechnol 2009 27 66 75 10.1038 / nbt.1518 spyrou c stark r lynch ag tavare s bayespeak : bayesian analysis of chip - seq data bmc bioinformatics 2009 10 299 10.1186 / 1471 - 2105 - 10 - 299 19772557 tuteja g white p schug j kaestner kh extracting transcription factor targets from chip - seq data nucleic acids res 2009 37 e113 10.1093 / nar / gkp536 19553195 chen x xu h yuan p fang f huss m vega vb wong e orlov yl zhang w jiang j loh yh yeo hc yeo zx narang v govindarajan kr leong b shahab a ruan y bourque g sung wk clarke nd wei cl ng hh integration of external signaling pathways with the core transcriptional network in embryonic stem cells cell 2008 133 1106 17 10.1016 / j.cell.2008.04.043 18555785 elf j li gw xie xs probing transcription factor dynamics at the single - molecule level in a living cell science 2007 316 1191 4 10.1126 / science.1141967 17525339 bailey tl elkan c fitting a mixture model by expectation maximization to discover motifs in biopolymers proceedings of the second international conference on intelligent systems for molecular biology 1994 aaai press 28 36 bailey tl gribskov m combining evidence using p - values : application to sequence homology searches bioinformatics 1998 14 48 54 10.1093 / bioinformatics / 14.1.48 9520501 bailey tl williams n misleh c li ww meme : discovering and analyzing dna and protein sequence motifs nucleic acids research 2006 34 w369 w373 10.1093 / nar / gkl198 16845028 tompa m li n bailey tl church gm de moor b eskin e favorov av frith mc fu y kent wj makeev vj mironov aa noble ws pavesi g pesole g regnier m simonis n sinha s thijs g van helden j vandenbogaert m weng z workman c ye c zhu z assessing computational tools for the discovery of transcription factor binding sites nature biotechnol 2005 23 137 144 10.1038 / nbt1053 miller fj rosenfeldt fl zhang c linnane aw nagley p precise determination of mitochondrial dna copy number in human skeletal and cardiac muscle by a pcr - based assay : lack of change of copy number with age nucleic acids research 2003 31 e61 10.1093 / nar / gng060 12771225 baker m epigenome : mapping in motion nature methods 2010 7 181 186 10.1038 / nmeth0310 - 181 mccullagh p nelder ja generalized linear models , second ed 1989 chapman & hall , london r development core team r : a language and environment for statistical computing r foundation for statistical computing , vienna , austria 2009 http :// www.r - project.org percival db walden at wavelet methods for time series analysis 2000 cambridge university press