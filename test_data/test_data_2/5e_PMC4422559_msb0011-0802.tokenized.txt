mol syst biol mol. syst .
biol msb molecular systems biology 1744 - 4292 1744 - 4292 blackwell publishing ltd oxford , uk 25888284 4422559 10.15252 / msb.20145475 articles inferring causal metabolic signals that regulate the dynamic torc1 - dependent transcriptome oliveira ana paula 1 + dimopoulos sotiris 2 + busetto alberto giovanni 3 ++ christen stefan 1 dechant reinhard 4 falter laura 1 haghir chehreghani morteza 3 jozefczuk szymon 1 ludwig christina 1 rudroff florian 1 schulz juliane caroline 1 gonzalez asier 5 soulard alexandre 56 stracka daniele 5 aebersold ruedi 17 buhmann joachim m 3 hall michael n 5 peter matthias 4 sauer uwe 1 * stelling jorg 2 ** 1 department of biology , institute of molecular systems biology , eth zurichzurich , switzerland 2 department of biosystems science and engineering and sib swiss institute of bioinformatics , eth zurichbasel , switzerland 3 department of computer science , eth zurichzurich , switzerland 4 department of biology , institute of biochemistry , eth zurichzurich , switzerland 5 biozentrum , university of baselbasel , switzerland 6 umr5240 map , universite lyon 1villeurbanne , france 7 faculty of science , university of zurichzurich , switzerland * corresponding author .
tel : + 41 44 633 3672 ; e - mail : sauer @ ethz.ch ** corresponding author .
tel : + 41 61 387 3194 ; e - mail : joerg.stelling @ bsse.ethz.ch subject categories genome - scale & integrative biology ; metabolism + these authors contributed equally to this work ++ present address : department of electrical and computer engineering , university of california santa barbara , ca , usa 4 2015 17 4 2015 11 4 802 03 6 2014 19 3 2015 23 3 2015 ( c ) 2015 the authors .
published under the terms of the cc by 4.0 license 2015 this is an open access article under the terms of the creative commons attribution 4.0 license , which permits use , distribution and reproduction in any medium , provided the original work is properly cited .
cells react to nutritional cues in changing environments via the integrated action of signaling , transcriptional , and metabolic networks .
mechanistic insight into signaling processes is often complicated because ubiquitous feedback loops obscure causal relationships .
consequently , the endogenous inputs of many nutrient signaling pathways remain unknown .
recent advances for system - wide experimental data generation have facilitated the quantification of signaling systems , but the integration of multi - level dynamic data remains challenging .
here , we co - designed dynamic experiments and a probabilistic , model - based method to infer causal relationships between metabolism , signaling , and gene regulation .
we analyzed the dynamic regulation of nitrogen metabolism by the target of rapamycin complex 1 ( torc1 ) pathway in budding yeast .
dynamic transcriptomic , proteomic , and metabolomic measurements along shifts in nitrogen quality yielded a consistent dataset that demonstrated extensive re - wiring of cellular networks during adaptation .
our inference method identified putative downstream targets of torc1 and putative metabolic inputs of torc1 , including the hypothesized glutamine signal .
the work provides a basis for further mechanistic studies of nitrogen metabolism and a general computational framework to study cellular processes .
causal inference network motifs nutrient signaling target of rapamycin pathway introduction the comprehensive elucidation of the multi - level , dynamic molecular networks that underlie the processes of living cells requires the generation of dynamic data at different levels of biological organization , the integration of complementary data types , and the incorporation of prior knowledge ( ideker et al , 2011 ; bar - joseph et al , 2012 ) .
currently large - scale , dynamic experimental datasets are still scarce , but it can be anticipated , based on rapidly advancing technology , that such data will become abundantly available in the near future .
consequently , the primary challenges for the comprehensive analysis of dynamic molecular networks will shift from data generation toward data and knowledge integration .
at present , most molecular network analyses consider a single data type such as transcript , protein , or metabolite abundances .
this precludes the multi - level , integrated analysis of processes , for example , the interplay between signaling and transcriptional networks .
further , the few studies that have integrated different data types , for example , interacting metabolic and transcriptional networks ( zhu et al , 2012 ) , almost always inferred static networks even though the ubiquitous presence of feedback loops suggests that dynamic resolution is required to infer causal relationships between network components ( bar - joseph et al , 2012 ) .
finally , even with prior knowledge integration by static maps ( e.g. of transcriptome data onto known transcription factor networks ) or by large - scale mathematical models ( e.g. representations of metabolic constraints ) , the inference of causal networks is a largely unsolved problem ( orth & palsson , 2010 ; ideker et al , 2011 ; bar - joseph et al , 2012 ) .
these limitations particularly affect studies of metabolism ( fernie & stitt , 2012 ) , because metabolism both integrates external stimuli and generates internal signals that orchestrate cellular adaptation , for example by regulating the activity of kinases ( wilson & roach , 2002 ; dechant & peter , 2008 ) , transcription factors ( sellick & reece , 2005 ) , and metabolic enzymes ( link et al , 2013 ) in response to metabolite abundances .
for example , the activity of several transcription factors is feedback - regulated via the direct binding of intermediates of metabolic pathways that are under their control ( sellick & reece , 2005 ; pinson et al , 2009 ) .
statistical descriptions in most existing dynamic multi - omics studies associate metabolite changes only qualitatively to the consequences of transcriptional and translational regulation of metabolism ( kresnowati et al , 2006 ; dikicioglu et al , 2012 ) .
functional relations between genes and metabolites were recently inferred with bayesian networks from metabolome , transcriptome , and other datasets ( bradley et al , 2009 ; zhu et al , 2012 ) .
however , simple bayesian networks cannot consider feedback and are therefore unable to describe the exact nature of most metabolic signaling systems .
consequently , despite the frequent observations that nutritional stimuli modulate signaling and transcriptional networks , the exact nature of most metabolic signals is elusive and their identification remains a challenge ( wilson & roach , 2002 ; dechant & peter , 2008 ; watson et al , 2013 ) .
to infer causal relationships between potential metabolic signals and the kinases and / or transcription factors they regulate , we co - designed a perturbation matrix for the generation of dynamic multi - omics datasets and a probabilistic , model - based analysis method that systematically incorporates prior knowledge .
we focused on nitrogen ( n ) metabolism of saccharomyces cerevisiae where general and specific mechanisms sense and react to the quality of the available n - source ( magasanik & kaiser , 2002 ; ljungdahl & daignan - fornier , 2012 ) .
cellular responses to n - source quality are tightly regulated via the tor kinase complexes ( crespo et al , 2002 ; loewith & hall , 2011 ) , and their downstream effects are relatively well studied ( rohde et al , 2008 ; loewith & hall , 2011 ) .
for example , yeast uses glutamine preferentially over the alternative n - source proline , partly by nitrogen catabolite repression ( ncr ) of proline utilization ( hofman - bang , 1999 ; magasanik & kaiser , 2002 ) .
the response to rapamycin - induced inhibition of the tor complex 1 ( torc1 ) resembles the response to less - preferred n - sources ( smets et al , 2010 ; loewith & hall , 2011 ) , namely inhibition of ribosomal biogenesis and induction of autophagy , pseudohyphal growth , and ncr - controlled pathways .
at the molecular level , torc1 is known to directly target the kinase sch9 and the protein phosphatase 2a complex ( pp2ac ) and to modulate the phosphorylation state of several other kinases and transcription factors ( smets et al , 2010 ; loewith & hall , 2011 ) .
conversely , while intracellular glutamine and leucine concentrations have been suggested as upstream endogenous signal ( s ) to torc1 , the exact mechanisms are unclear ( crespo et al , 2002 ; gaubitz & loewith , 2012 ) .
here , we performed dynamic multi - level omics measurements of yeast cells perturbed by the modulation of the quality of the n - source and by chemical inhibition of torc1 .
our metabolome , transcriptome , and tor - related sub - proteome data captured the dynamics of the underlying regulation mechanisms , and our probabilistic , model - based inference method identified putative metabolic signals up - and downstream of torc1 , including the suggested glutamine signal , and novel , enzymatic targets of torc1 signaling .
results a comprehensive and consistent dataset for dynamic shifts between nitrogen sources to elucidate the dynamic interplay between the signaling , transcriptional , and metabolic networks controlling the cellular response to the quality of the external n - source , we subjected s. cerevisiae ysbn6 wild - type cells ( canelas et al , 2010 ) to nutritional upshift and downshifts that were each done as fully independent biological triplicate experiments .
dynamic shifts in well - controlled bioreactor batch cultures with glucose minimal medium were induced by adding glutamine to yeast growing exponentially on the poor n - source proline ( upshift ) or by glutamine depletion in yeast growing on glutamine plus proline ( downshift ) ( fig1a , supplementary tables s1 and s2 ) .
in the upshift , proline was nearly depleted at the time of the shift , but it still sustained exponential growth , and added glutamine was almost immediately taken up. in the downshift , exponentially growing cells exclusively consumed glutamine until its complete depletion , as expected from ncr ( hofman - bang , 1999 ; magasanik & kaiser , 2002 ) .
additionally , we induced a downshift chemically by adding rapamycin to a culture growing exponentially on glutamine as the sole n - source , thereby bypassing the natural nitrogen quality signal by inhibiting torc1 directly ( loewith & hall , 2011 ) ( fig1a ) .
expectedly , torc1 activity increased rapidly during the upshift and decreased during both downshifts , as measured by the phosphorylation status of sch9 ( urban et al , 2007 ; loewith & hall , 2011 ) ( supplementary fig s1 , supplementary table s3 ) .
likewise , cell volume and percentage of cells in the g1 phase of the cell cycle matched the expectations ( loewith et al , 2002 ) ( supplementary fig s2 , supplementary table s4 ) .
figure 1 experimental design and data consistency biomass evolution ( filled circles ) and extracellular concentrations of glutamine ( open circles ) and proline ( triangles ) for the three dynamic shifts .
fermentation time is scaled relative to the time of shift .
grey areas mark the exponential growth phase prior to the shift .
yellow areas mark the 2 h following the shifts during which samples were taken .
the maximum specific rates of steady - state growth on proline and glutamine plus proline were 0.20 +/ - 0.03 / h ( n = 3 , sd ) and 0.36 +/ - 0.01 / h ( n = 6 , sd ) , respectively .
see also supplementary tables s1 and s2 .
sampling times for the different measurements relative to the time of shift , taken in independent biological triplicates .
the sample - 10 min represents the steady - state cellular status preceding the shifts and is henceforth referred to as time 0 .
see also supplementary tables s4 , s5 , s6 and s7 .
scores plot of the first two principal components ( pc1 , 2 ; variance captured by each component in parentheses ; pc3 explains 10 % of the variance ) for the transcripts of the 909 metabolic genes from all time point samples across the three shift experiments ( red : n - upshift ; blue : n - downshift ; green : rapamycin - induced downshift ; numbers near arrows : minutes after shift ) .
for transcript data , see supplementary table s5 .
to capture the regulatory events triggering or reflecting cellular adaptation to the shifts , we quantified the intracellular abundances of 5,716 transcripts by expression array analysis , 20 tor - related signaling proteins and six enzymes of glutamine - glutamate metabolism by targeted proteomics ( picotti et al , 2013 ) , and 42 metabolites by targeted lc - ms / ms ( buescher et al , 2010 ) ( supplementary tables s5 , s6 and s7 ) .
a further 256 metabolites were analyzed by untargeted semi - quantitative flow injection time - of - flight ms ( fuhrer et al , 2011 ) ( supplementary table s7 ) .
to minimize biological variability , all samples for the different omics analyses were withdrawn from one bioreactor culture in three independent biological replicates , at a temporal coverage adapted to the expected dynamics of metabolite , transcript , and protein responses ( buescher et al , 2012 ) ( fig1b ) .
since all 20 tor - related signaling proteins showed constant abundances during the shifts ( supplementary fig s3 ) , we assessed the consequences of signaling at the metabolic and transcription level .
altogether , 3,203 , 1,585 , and 2,104 transcript abundances changed by more than two - fold ( maximum observed fold - change across the time course ) in the upshift , the nutritional , and the rapamycin - induced downshift , respectively .
we tested the consistency of our dataset across experiments by principal component analysis of transcript dynamics for the 909 metabolic enzymes ( herrgard et al , 2008 ) .
the first two principal components , which capture ~ 60 % of the variance , indicated that the cellular states at the start and end points of up - and downshifts were in close vicinity ( fig1c ; see supplementary fig s4 for all genes ) .
also , transcript responses of the nutritional and rapamycin - induced downshifts followed each other closely , confirming that rapamycin addition mimics a nitrogen downshift to proline .
we conclude that our dynamic shift experiments were complementary and consistent and therefore suitable to address two specific questions : ( i ) what is the extent of global rewiring of yeast metabolism , and ( ii ) how are metabolic signals related to torc1 signaling as inputs or outputs .
extensive dynamic rewiring of metabolism via multiple mechanisms the extent of transcriptional responses during the shift experiments indicated a large - scale reorganization of metabolism during adaptation , reminiscent of the global re - wiring during bacterial nutrient source transitions ( buescher et al , 2012 ) .
despite the consistency across the three shifts , the broad distributions of transcript correlations ( fig2a ) and response timings ( fig2b ) indicated rather heterogeneous responses of individual transcripts .
average onset times [ times for reaching half of the maximum changes in transcript abundance according to an impulse model ( chechik et al , 2008 ; chechik & koller , 2009 ; supplementary table s5 )] were around 7 min in the upshift and wider , bimodally distributed in the two downshifts with peaks at around 10 and 25 min .
these data , furthermore , indicate that transcriptional responses were highly similar between nutrient downshift and rapamycin perturbation also at the level of individual transcripts , which is a prerequisite for inferring causal relations between metabolites and transcripts based on all pairwise correlations ( see below for the corresponding computational method ) .
figure 2 comparison of transcriptome profiles across the three shifts distribution of pearson 's correlation coefficients for every pair of transcripts across all possible pairs of shifts .
dashed lines correspond to the median value for each distribution .
see also supplementary table s5 .
distribution of onset times ( time to reach half of the maximum gene expression change ) per shift .
average transcriptional responses ( normalized to the steady - state sample of the n - downshift ) for all 13 clusters .
visualization based on the linear interpolated response of the cluster averages .
dashed lines represent +/ - sd. the transcript responses across the three shifts distributed over 13 clusters ( fig2c ) according to a robust method for the validation of cluster assignments based on maximization of information content ( chehreghani et al , 2012 ) .
to focus on torc1 - regulated genes , we analyzed clusters 2 , 5 , 7 , 9 , 10 , and 13 , which showed similar responses in the two downshifts , and the opposite behavior in the upshift ( fig2c ) .
clusters 2 , 5 , 7 , and 10 included most of the known ncr - sensitive genes ( hofman - bang , 1999 ) and targets of the retrograde response pathway ( magasanik & kaiser , 2002 ) ( supplementary table s8 ) .
they were also over - represented in the gene ontology process terms endocytosis , pseudohyphal growth , mitochondrion organization , and cellular respiration , all of which are induced upon torc1 inactivation ( loewith & hall , 2011 ) .
the opposite response - - induced upshift and repressed downshift expression - - was found in clusters 9 and 13 that included nearly all ribosomal protein and ribosome biogenesis genes , known targets of torc1 - regulated transcription factors such as sfp1 and fhl1 - ifh1 ( smets et al , 2010 ; loewith & hall , 2011 ) .
the overall processes captured in the six clusters agreed with previous transcriptional studies in rapamycin - treated yeast ( smets et al , 2010 ; loewith & hall , 2011 ) .
documented targets of gcn4 ( teixeira et al , 2006 ) , the general amino acid transcriptional regulator , were over - represented in clusters 1 , 8 , 9 , and 10 .
similar responses of cluster 8 transcripts to nutrient upshift and rapamycin treatment indicate additional , torc1 - independent transcriptional regulation .
the long - term metabolite response approached a new pseudo steady state within 1 h of perturbation onset ( fig3a and supplementary table s7 ) .
specifically , aspartate and citrate / isocitrate levels showed similar long - term trends in the two downshifts and the opposite response in the upshift .
the long - term responses of arginine and aromatic amino acids levels were similar between upshift and rapamycin addition , consistent with the starvation - like transcriptional response of their biosynthesis genes in cluster 8 ( fig2c ) .
the immediate metabolite changes within the first 10 min precede transcriptional regulation and reflect readjustments of reaction equilibrium , post - translational , or allosteric enzyme regulation .
within the first minutes , several metabolite abundances changed in the upshift but only very few in the two downshifts ( fig3b ) .
the most pronounced responses in the upshift were the instantaneous increase in intracellular glutamine and the decrease in trehalose 6 - phosphate ( t6p ) concentration , accompanied by transient decreases of metabolite concentrations in upper glycolysis and pentose phosphate pathway , and transient increases of amp , adp , gmp , and gdp ( fig3b ) .
in contrast to the glutamine upshift response in escherichia coli ( doucette et al , 2011 ) , we observed no changes in glutamate , alpha - ketoglutarate , and other tca cycle intermediates ( supplementary fig s5 ) .
the similar but not identical early metabolite changes in the two downshifts ( fig3c ) were few , subtle , and less dynamic ( fig3b ) .
since extracellular glutamine is in excess during the rapamycin downshift , early metabolite changes in common with the nutritional downshift may reflect post - translational modifications induced by torc1 inactivation , while changes specific to the nutritional downshift may be independent or upstream of torc1 .
overall , multiple level adjustments were observed that are non - trivial to explain , that is , they are not just consequences of transcriptional regulation .
figure 3 metabolite profiles across the three shifts profiles of the metabolites referred to in the text over the 120 min after the shift , for one representative experiment per shift .
fold - changes refer to absolute concentrations normalized to the steady state of the respective shift .
solid lines are the linear interpolated responses , used here for purpose of visualization .
see also supplementary table s7 .
example of metabolite responses within the first 15 min after the shift for metabolites within central carbon , amino acids , nucleotide mono - and di - phosphates ( nxp ) , and other nucleotide metabolism intermediates .
data for one representative experiment per shift are shown as in ( a ) .
semi - quantitative metabolite concentrations from untargeted fia - qtof - ms are marked with * .
aicar : 5 - amino - 1 - ( 5 - phospho - d - ribosyl ) imidazole - 4 - carboxamide ; imidazole glycerol - p : d - erythro - 1 - ( imidazole - 4 - yl ) glycerol 3 - phosphate .
principal component analysis of metabolite responses during the first 10 min after the shifts .
pc3 explains 9 % of the variance .
a computational method for assigning metabolic signals to network motifs to identify the metabolic signals that modulate transcriptional responses , and to find how such regulation relates to torc1 activity , existing computational methods are not sufficient because they do not systematically integrate dynamic metabolomics and transcriptomic data with prior knowledge .
for example , current bayesian integration of transcriptomic and metabolomics data elucidates functional , but not causal relations between the two data types ( bradley et al , 2009 ). by exploiting metabolic network structures as prior knowledge , chechik et al ( 2008 ) defined " activity motifs " , patterns such as ordered transcriptional activation along a metabolic pathway , but they only integrated gene expression data .
here , we developed a probabilistic , integrative framework that infers causal relations from heterogeneous data types and exploits prior knowledge on networks and biological mechanisms .
to apply the framework to the specific metabolic system of this study , we formalized prior knowledge as prototypic interactions between signaling , metabolism , and gene expression and as generic interaction mechanisms .
this is exemplified by a situation where , if a metabolite controls transcription factor activity , a changing metabolite concentration should change the rate of gene expression at a later time , which makes the approach inherently causal .
specifically , our framework classifies the metabolic signals into four network motifs that reflect different modalities of metabolite - torc1 - transcriptional regulation interactions ( fig4a ; see materials and methods and supplementary text s1 for a detailed rationale of the approach ) .
the " unrelated " network motif accounts for metabolite changes unrelated to the transcriptional responses , the " downstream " motif for metabolite responses that are consequences of post - translational enzyme regulations downstream of torc1 , the " upstream " network for metabolites that are potential signals upstream of torc1 , and the " parallel " motif for metabolite responses that modulate transcriptional responses independent of torc1 .
the framework uses the early metabolic dynamics and the genome - wide transcript dynamics across the three shift experiments for classification ( fig4b ) .
we assume that an unknown dynamic network connects each metabolic response and the transcript changes over time .
at this point , no further assumptions or prior knowledge on the dynamic network and its characteristics are used ( see also supplementary text s1 ). from the experimental data , we extract features that approximate : ( i ) how consistent the observed dynamics are with a causal relation between metabolites and gene expression (" dynamic dependence " ; dd ) , and ( ii ) how strongly each metabolite is associated with genes that are direct targets of transcription factors regulated by torc1 (" representation of tor genes " ; rg ; see materials and methods for details ) .
we use the feature values for each experimental condition to estimate probabilities of metabolite assignments to the network motifs via bayesian inference ( kass & raftery , 1995 ) as explained in detail in materials and methods .
figure 4 computational framework for motif assignment schematic diagrams of the four network motifs (" met " : metabolite ; " tor " : torc1 complex ; " genes " : whole genome of saccharomyces cerevisiae ) .
arrows denote direct causal interactions .
method overview .
for each metabolite monitored under the three experimental conditions ( small boxes , upper left ) , we extract features ( grey box , upper right ; feature values range between 0 and 1 ) assuming that the measured quantities are connected by an unknown dynamic network in which metabolite concentrations ([ m ]) control transcript ([ tr ]) dynamics .
the middle grey box illustrates such a causal relation in the form of an ordinary differential equation with an unknown functional relation f (.) that depends on time t and unknown parameters p. bayesian inference ( bottom grey box ) is then used to compute the probability of each metabolite being assigned to each network motif characterized by a set of " prototypic " feature values across the three experimental conditions (" r " : representative of artificial , random metabolic time - course data ) .
example time - course data from rapamycin downshift .
filled circles represent experimental data points , and open circles denote interpolated data points used for the computation of dynamic dependence .
left : time evolution of t6p ( black : linear interpolation from the experimental data ; colors : experimental repeats ) .
right : time evolution of the normalized mrna level of yml018c ( blue line , spline interpolation from the experimental data ) , and of its derivative values ( green line ) .
the thick part of the curves correspond to a 10 - min interval with a 4 - min time delay used in conjunction with the metabolic data ( left ) to compute the dynamic dependence for this particular delay .
dynamic dependence values between t6p and the derivative of yml018c for all delayed versions of the transcript ( from 0 to 10 min ) .
distribution of dynamic dependence values of t6p with all genes .
the top 10 % of the distribution ( in red ) define the significant gene set associated with t6p .
computation of likelihood values for bayesian inference of t6p for the " dynamic dependence " feature ( left ) and " representation of tor genes " feature ( right ) computed in the rapamycin downshift .
the distribution of the features' values from artificial , random metabolic time - course data is shown in blue ( scaled values ) , and the corresponding empirical cumulative density function ( ecdf ) is shown in cyan .
the green line denotes the " r " value of ( b ) and corresponds to the median of the random distributions .
red lines denote the feature values of t6p as shown in ( e ) , used to compute the likelihood value for each network .
formally , we defined prototypic values for each motif by combining the expected biological events in the three experimental conditions ( fig4b , bottom ; see also supplementary text s1 ) .
a metabolic signal that acts upstream of torc1 in the two nutritional shifts should elicit a torc1 - dependent transcriptional response .
consequently , the " upstream " network 's prototypic feature values for dd and rg are maximal in the two nutrient shifts .
however , the metabolic signal is bypassed during rapamycin - induced torc1 inactivation such that the feature values should not be statistically distinguishable from those of a random response ( fig4b ) .
similarly , all the " downstream " network 's prototypic feature values are maximal for all three experiments because torc1 should control the same gene sets transcriptionally , and induce metabolite changes post - translationally in all three conditions .
for a metabolite to regulate transcription in a torc1 - independent manner (" parallel network ") , dd should be high in the two nutrient shifts , but essentially random upon rapamycin treatment ( because rapamycin affects only torc1 activity , not the metabolite concentration ) , and rg needs to be random in all experiments .
finally , when all feature values of a metabolite are random for all three experiments , we postulate that metabolic and transcriptional changes are not related .
to assign the measured metabolites to the four motifs , we considered every pair of metabolite and transcript in our dataset ( fig4c ) .
specifically , we computed the dynamic dependence ( see materials and methods ) between every metabolic trajectory and the rate of change of every transcript ( fig4c , right , for yml018c ) .
signaling metabolite changes should precede their effects on transcriptional regulation , and we allowed for variable delays between 0 and 10 min in 1 - min increments for all transcript responses ( fig4c , right ) .
hence , for every metabolite - transcript pair in every experimental condition , we computed 11 dd values ( fig4d ) .
the maximum values of every pair defined a dd distribution for each metabolite in each experimental condition .
for every metabolite , we selected the gene set consisting of 10 % of the transcripts with the best dd to calculate the final ( average ) dynamic dependence ( fig4e ) and then determined the fraction of genes known to be targeted by torc1 - dependent transcription factors .
in the bayesian inference framework , these feature values were compared to the distribution of random metabolic data ( fig4f , see materials and methods ) to estimate network assignment probabilities .
to ensure robust assignments , we varied the assumed level of data noise ( four variants ) , the type of interpolation of the metabolite data ( 2 ) , the method to compute the dynamic dependence of metabolite - transcript pairs ( 3 ) , and the calculation of network assignments ( 2 ) , leading to 48 assignment probabilities .
finally , we assigned each metabolite to a network motif by majority vote ( exceeding 50 % assignment probability in more than half of the methods ; materials and methods ) .
computational assignment of metabolites to network motifs while most metabolites were assigned to the " unrelated " network , our method revealed seven " downstream " , seven " parallel " , and six " upstream " metabolites to torc1 ( fig5a and supplementary table s9 ) .
to analyze the robustness of the assignments and how motif assignments depend on the prior biological knowledge on torc1 - controlled tfs and their controlled genes , we considered two scenarios : ( i ) prior knowledge is correct but limited - - we know fewer than the 11 reported tfs directly controlled by torc1 - - and ( ii ) knowledge on torc1 - controlled tfs is incomplete , meaning that additional tfs could be directly controlled by torc1 .
we investigated both scenarios for different numbers of tfs affected , and we refer to them as " - 3 ...
- 1 tfs " and "+ 1 ...
+ 3 tfs " scenarios , respectively ( see materials and methods for details ) .
computing motif assignments for all metabolites and all perturbation scenarios revealed that the total error rate , defined as the average rate of assignments that differ from the unperturbed analysis , generally is below 30 % ( fig5b and supplementary table s9 ) .
sufficient prior knowledge on real torc1 - tfs is important ( red curves in fig5b ) , whereas additional unknown tfs have less effect ( blue curves ) .
if we expect errors in assigning motifs by exceeding the 50 % motif frequency threshold , these errors will be false negatives ( no motif is assigned although it should be , fig5c ) , rather than false positives ( assignment of spurious motifs , fig5d ) .
in particular , all assignment frequencies that exceed approximately 70 % have practically zero false - positive and false - negative rates on average .
for our original motif assignments shown in fig5a , we find generally high motif robustness as quantified by the motif recovery stability for the + 3 tfs case .
this scenario gives a lower bound in our application - relevant + tf scenarios ; previous experimental analyses provide us with high confidence for the validity of the 11 known torc1 - tfs .
figure 5 classification of metabolite functions in nitrogen regulation heat - map of the percentage (%) of the normalized assignment frequency of the metabolites over 48 different methods of probabilistic computation .
a metabolite is associated with a network if the probability of assignment to this network exceeds 50 % for a particular computation method .
metabolites semi - quantified with untargeted fia - qtof - ms are marked with * .
assignment robustness scores are the recovery frequencies of the network associations assuming that three additional , random tfs are directly controlled by torc1 ( n = 100 samples ) .
pyrroline - 3h - 5c : l - 1 - pyrroline - 3 - hydroxy - 5 - carboxylate ; tetracosanoate : tetracosanoate ( n - c24:0 ) ; dguanosine : deoxyguanosine ; gaba : 4 - aminobutanoate ; nad : nicotinamide adenine dinucleotide ; alphakg : alpha - ketoglutarate ; prpp : 5 - phosphoribosyl 1 - pyrophosphate .
see also supplementary table s9 .
robustness of motif assignments in terms of average total error rate for all metabolites binned by their maximal motif assignment frequencies .
red colors show the scenarios of reduced sets of known torc1 - controlled tfs ( - 3 ...
- 1 tfs , with decreasing color intensity ) , and blue colors , the scenarios of additional , random tfs assumed to be controlled directly by torc1 (+ 3 ... + 1 tfs , with decreasing color intensity ) .
average false - negative motif assignment rates in analogy to ( b ) .
average false - positive motif assignment rates in analogy to ( b ) .
mapping of metabolites with normalized assignment frequency over 50 % ( bold face : > 65 %) to central carbon , amino acid , and nucleotide metabolism .
violet , orange , and blue colors correspond to the " downstream " , " upstream " , and " parallel " networks , respectively .
biologically , many of the metabolites assigned to the " downstream " , " parallel " , and " upstream " motifs are intermediates of amino acid or nucleotide metabolism , processes known to be regulated via torc1 ( loewith , 2011 ) ( fig5a and e ) .
the seven " downstream " metabolites include aspartate , t6p , and the purine - related metabolites imp and adenosine / deoxyguanosine ( fig5a ) , whose response within the first 10 min suggests post - translational control of an associated enzyme .
in the pathway that converts aspartate to threonine , hom3 and hom2 catalyze the first two reactions and thr4 the final conversion to threonine ; all three are phospho - enzymes and their deletion causes growth defects with rapamycin ( chan et al , 2000 ) .
continuous accumulation of aspartate over at least 20 min ( fig3a ) , but not of threonine or any of the four pathway intermediates upon torc1 inactivation , therefore suggests regulation of hom3 and / or hom2 activity by torc1 - dependent ( de ) phosphorylation .
t6p is a precursor for the reserve carbohydrate and stress protectant trehalose .
two enzymes of the t6p - synthetase / phosphatase complex that catalyzes t6p production / degradation , tsl1 and tps3 , were previously found to be hyperphosphorylated in rapamycin - treated yeast ( soulard et al , 2010 ) .
t6p association with the downstream motif may therefore be a consequence of torc1 phospho - regulation of the t6p - synthetase / phosphatase complex .
the purine - related metabolites are intermediates of dna and rna degradation and nucleotide salvage pathways ( fig5e ) .
deamination of amp to imp , catalyzed by the tetrameric amd1 that becomes dephosphorylated upon rapamycin treatment ( soulard et al , 2010 ; loewith , 2011 ) , is important for rapid and energy - cost - efficient adaptation of nucleotide pools during changing conditions ( walther et al , 2010 ) .
increasing imp concentration with torc1 activation during the upshift and the opposite response upon rapamycin treatment ( fig3b ) suggest that torc1 activates amd1 activity , possibly to avoid accumulation of the allosteric effector amp , in addition to the well - known torc1 - dependent transcriptional regulation of purine metabolism ( loewith , 2011 ) .
" parallel " motif metabolites are predicted to affect transcription in a torc1 - independent manner ( fig5a ) , and transcriptional induction of aromatic amino acid catabolism genes by tryptophan has already been described ( iraqui et al , 1999 ) .
the six " upstream " metabolites represent candidate endogenous signals to modulate torc1 activity .
our analysis quantitatively supports the previously raised hypothesis of glutamine being a torc1 signal in yeast ( crespo et al , 2002 ; gaubitz & loewith , 2012 ) .
leucine , in contrast , is assigned to the " parallel " network , which renders its hypothetical role of a natural torc1 input ( gaubitz & loewith , 2012 ) unlikely .
strikingly , the " upstream " network associated glutamine , aicar , and imidazole glycerol - p , all of which participate in a single reaction at the branch point between histidine and purine nucleotide metabolism ( fig5e ) .
in particular , aicar is a promising candidate to coordinate amino acid and nucleotide metabolism in response to nitrogen availability because : ( i ) it stimulates in vivo interactions between the phosphate metabolism transcription factor pho2 with either pho4 or the regulator of purine nucleotide and histidine metabolism bas1 ( pinson et al , 2009 ; ljungdahl & daignan - fornier , 2012 ) , and ( ii ) torc1 responds ( weakly ) to histidine deprivation ( binda et al , 2009 ) .
discussion metabolites are top signal candidates to drive rapid cellular adaptations to environmental change because they are amongst the first responding cellular constituents .
however , their transient and weak interactions with proteins , potentially leading to immediate allosteric regulation , are notoriously difficult to assess ( gerosa & sauer , 2011 ; link et al , 2013 ) .
hence , the field is replete with speculation on the actual signals that govern kinase activity , and torc1 is no exception ( loewith & hall , 2011 ) .
here , we developed a generic experimental / computational framework to infer causal relationships within intertwined regulatory networks that combines a probabilistic , model - based method with dynamic metabolite and transcript data .
the key novelty of the approach is to correlate the experimentally observed dynamics via prototype models that integrate prior network information systematically .
this enables predictions of metabolites that best explain the dynamics of the global transcriptional responses by acting ( directly or indirectly ) upstream , downstream , or in parallel to a signaling pathway of interest .
beyond confirming the hypothesized torc1 signal glutamine ( crespo et al , 2002 ; gaubitz & loewith , 2012 ; stracka et al , 2014 ) , we identified other , putative endogenous inputs into the upstream network of torc1 signaling .
given our prediction that aicar acts upstream and imp , the next intermediate in purine synthesis , acts downstream of torc1 , it is tempting to speculate that torc1 ( or an upstream effector ) senses aicar to regulate the activity of the reaction from aicar to imp that is catalyzed by the phosphoproteins ade17 ( holt et al , 2009 ) or its paralog ade16 ( soufi et al , 2009 ). by predicting tryptophan to regulate its own synthesis in a torc1 - independent manner , we capture also one of the few known direct interactions of metabolites with yeast transcription factors ( iraqui et al , 1999 ) .
downstream of torc1 , we found metabolic imprints of several torc1 - dependent post - translational modifications , including the previously hypothesized t6p - synthase / phosphatase ( soulard et al , 2010 ) , whose increased activity accumulates the stress protectant trehalose , the tetrameric amd1 in purine metabolism ( soulard et al , 2010 ; loewith , 2011 ) , whose activation is important for efficient adaptation of nucleotide pools during changing conditions ( walther et al , 2010 ) , and the novel torc1 - dependent regulation of threonine biosynthesis at hom3 and / or hom2. through a combination of the here reported metabolomics data with phosphoproteomics data , torc1 - dependent activation of t6p - synthase and amd1 as well as inhibition of hom3 were independently confirmed ( oliveira et al , 2015 ) .
in contrast to earlier approaches , our co - design of perturbation experiments and a probabilistic analysis framework integrates heterogeneous dynamic data and exploits existing network knowledge ( e.g. torc1 controlled genes ) , prototypic interaction classes ( network motifs ) , and approximations of biological control mechanisms ( dynamic dependence ) .
we expect that our approach for model - based data integration will extend to other ( nutrient ) signaling networks because , while the formalization of the prior knowledge is application specific , the approach itself is generic : target sets , network motifs , and temporal relations of events and variables could be formulated analogously for other applications .
note , however , that the approach may not be applicable to existing datasets in retrospect : a co - design of experiments is critical , for example , because equivalent perturbations of signaling via natural inputs and drugs ( here : amino acids and rapamycin , respectively ) are needed for the inference approach .
another possible limitation concerns the availability of prior knowledge on , for example , transcriptional regulation .
here , we employed only experimentally documented interactions between torc1 - controlled transcription factors and target genes , but already general sampling biases in the well - characterized yeast transcriptional network could lead to biased inference results .
however , our robustness analysis indicates that such confounding factors have less severe effects on prediction accuracy than limited biological knowledge .
in addition , the approach requires a careful definition of the " prototypic " motifs ( see also supplementary text s1 ) , but this cannot guarantee that all possible causal interactions will be identified ( e.g. " hybrid " motifs in which a metabolite has multiple roles in the network may be missed ) .
future extensions of the computational method to counteract these limitations could incorporate mechanistic details , prior information such as transcriptional or metabolic network structures , and quantitative features of transcriptional control ( using , correspondingly , more detailed models ) to improve resolution and confidence of inferred causal relationships .
for example , the structure of a metabolic network could provide constraints because any change in a metabolite concentration should be preceded by changes in educt concentration ( s ) in the corresponding reaction ( s ) .
in terms of experimental data , constant protein abundances allowed us to focus on metabolite and transcript dynamics. with more detailed dynamic measurements , such as ( phospho - ) proteomics data , it should become possible to unravel regulatory interactions across multiple network types and timescales , addressing one of the most prominent current challenges for data integration in complex cellular networks .
provided that the topology of transcriptional or phosphorylation regulation networks , or substantial parts thereof , is known , the presented approach is also applicable to regulation in healthy and diseased higher cells .
materials and methods strain and growth conditions throughout we used the prototrophic s. cerevisiae strain ysbn6 ( canelas et al , 2010 ) .
precultures were prepared in 500 - ml shake flasks with 50 ml yeast minimal medium , grown for 24 h at 30degreesc and 300 rpm .
bioreactor batch cultures of 2.5 l medium in a 3.1 - l klf glass vessel ( bioengineering ag , wald , switzerland ) were inoculated to a starting optical density at 600 nm ( od600 ) of 0.03 - 0.08 , and grown at 30degreesc , ph 5 , impeller speed of 1,000 rpm , and sparging with 3 l air per min .
growth was monitored by od600 measurements and the concentration of co2 in the reactor exhaust gas stream .
the yeast minimal medium ( ymm ) contained ( per liter ) : 20 g d - glucose , 5 g k2so4 , 3 g kh2po4 , 0.5 g mgso4.7h2o , 15 mg edta , 4.5 mg znso4.7h2o , 0.3 mg cocl2.6h2o , 1.0 mg mncl2.4h2o , 0.3 mg cuso4.5h2o , 4.5 mg cacl2.2h2o , 3.0 mg feso4.7h2o , 0.4 mg namoo4.2h2o , 1.0 mg h3bo3 , 0.1 mg ki , 0.05 mg biotin , 1.0 mg ca - pantothenate , 1.0 mg nicotinic acid , 25 mg inositol , 1.0 mg pyridoxine , 0.2 mg p - aminobenzoic acid , 1.0 mg thiamin , and 10 mm potassium hydrogen phthalate buffer ( ph 5 ) .
nitrogen source supplementation was as followed ( final concentrations ) : " preculture - ymm " with 1 g / l of either l - glutamine or l - proline ( for cultures initially growing in glutamine or proline , respectively ) ; " downshift - ymm " with 500 mg / l of l - glutamine and 250 mg / l of l - proline ; " rapamycin - ymm " with 1 g / l of l - glutamine ; and " proline - ymm " with 200 mg / l of l - proline .
all experiments were performed in three independent biological replicates .
dynamic perturbations and sampling times proline to glutamine upshift the initial culture was inoculated in " proline - ymm " .
at od600 = 1.07 +/ - 0.24 ( n = 3 , sd ) , still in exponential growth , glutamine was instantaneously added into the bioreactor to a final concentration of 400 mg / l. the time of glutamine addition is referred to as the " time of shift " .
glutamine to proline downshift the initial culture was inoculated in " downshift - ymm " , containing both glutamine and proline as nitrogen sources .
at appropriate intervals , the concentration of glutamine in the broth was monitored by using at - line direct flow injection ms analysis on an agilent lc - qtof system , allowing readouts within < 2 min after sampling .
the time at which glutamine was not detected anymore by direct flow injection ms is referred to as the " time of shift " , at an od600 of 0.84 +/ - 0.02 ( n = 3 , sd ) .
rapamycin pulse the initial culture was inoculated in " rapamycin - ymm " .
at od600 = 0.85 +/ - 0.08 ( n = 3 , sd ) , still in exponential growth , rapamycin was instantaneously added into the bioreactor to a final concentration of 400 mug / l. the time of rapamycin addition is referred to as the " time of shift " .
sampling times and sampling setup throughout the cultivation , we monitored od600 and extracellular concentrations of glucose , glutamine , proline , ethanol , glycerol , acetate , and pyruvate ( supplementary table s2 ) .
immediately before and for 120 min after the shift , samples for determination of mrna levels , protein abundances , intracellular metabolites , cell physiology , cell size and dna content were taken as shown in fig1b .
steady - state samples taken a few minutes before the shift are also referred to as sample time 0 min ( t0 ) , since concentrations at this time scale can be assumed as constant .
the high sampling frequency following the shift was enabled by independent sampling ports , installed at the bottom of the reactor , specific for each measurement type .
sampling for intracellular metabolomics was performed by an automated sampling device with a vacuum pump to maintain a rapid and reliable sampling frequency .
determination of biomass and extracellular metabolite concentrations biomass concentration was determined as od600 in a spectrophotometer .
the correspondence to dry cell weight ( dcw ) for the ysbn6 strain growing in minimal media was initially determined to be 0.463 gdcw / l / od600 .
extracellular concentrations of glucose , ethanol , acetate , glycerol , succinate , and pyruvate were determined with an hplc system ( agilent hp1100 ) , equipped with a polymer column ( aminex hpx - 87h from bio - rad ) ( buescher et al , 2012 ) .
extracellular concentrations of glutamine and proline were determined by gc - ms. sample derivatization and gc - ms operation were adapted from zamboni et al ( 2009 ) with norvaline and glutarate as internal standards .
in all cases , quantification was achieved with pure chemicals obtained from sigma as external standards .
determination of intracellular metabolite levels quenching and extraction culture broth was quickly quenched into a tube containing ( 1:4 v / v ) 60 % ( v / v ) methanol buffered with 10 mm ammonium acetate ( ph 7.5 ) , precooled at - 40degreesc , and pelleted by centrifugation .
intracellular metabolites were extracted from the pellet with 1 ml 75 % ( v / v ) ethanol buffered with 10 mm ammonium acetate ph 7.5 , at 80degreesc for 3 min .
samples for lc - ms / ms were supplemented with 50 mul 13c - labeled internal standard before extraction .
after centrifugation for 5 min at 3,500 g at - 9degreesc , the extracts ( supernatant ) were dried completely in a vacuum centrifuge ( christ - rvc 2 - 33 cd plus , kuehner ag , birsfelden , switzerland ) .
the extracts were resuspended in water before analysis .
lc - ms / ms ( targeted metabolomics ) liquid chromatography coupled with mass spectrometry was adopted from buescher et al ( 2010 ) , including the selected reaction monitoring ( srm ) transitions used ( supplementary table s7 ) .
specifically , liquid chromatography separation was achieved by an ion pairing - reverse phase method implemented on a waters acquity uplc ( waters corporation , milford , ma , usa ) using a waters acquity t3 end - capped reverse phase column with dimensions 150 x 2.1 mm x 1.8 mum ( waters corporation ) .
the metabolites were ionized with a heated electrospray ionization source and detected with a thermo tsq quantum ultra qqq mass spectrometer ( thermo fisher scientific , waltham , ma , usa ) using a heated electrospray ionization source .
the ms was operated in negative mode with srm .
data acquisition and peak integration were performed with the xcalibur software version 2.07 sp1 ( thermo fisher scientific ) and in - house integration software .
peak areas were normalized to fully 13c - labeled internal standards and absolute quantification of metabolites was achieved with linear calibration curves of standards .
finally , concentrations were normalized to the amount of biomass .
fia - qtof - ms ( untargeted metabolomics ) sample extracts were analyzed by flow injection into a time - of - flight ms ( 6,550 series qtof , agilent technologies ) operated in the negative ionization mode .
high - precision mass spectra were recorded from 50 to 1,000 m / z and analyzed as described previously ( fuhrer et al , 2011 ) .
each sample was injected and measured twice .
ions were annotated to yeast metabolites based on accurate mass with tolerance of 0.001 da. only high confidence annotations were used , for a total of 186 unique m / z ions annotated to 256 yeast metabolites ( supplementary table s7 ) .
relative intensities were normalized to the amount of biomass .
the overall performance of the untargeted method was compared against the lc - ms / ms measurements for the common metabolites measured in both platforms ( supplementary fig s6 ) , and generally the spearman correlation coefficient was high for those metabolites changing by two - fold or more .
determination of mrna levels to cover the entire dynamics for transcriptome analysis , 14 or 15 samples were processed per nutritional shift from one representative bioreactor experiment ( supplementary table s5 ) , and samples from time points - 10 , 7 , and 24 min in the triplicate experiments allowed to statistically assess biological variability , yielding a total of 43 array images .
culture broth was quickly quenched into a tube containing ( 1:1 v / v ) methanol precooled at - 40degreesc , and pelleted by centrifugation .
pellets were washed once with 10 ml ice - cold water .
total rna extraction was done using the rneasy kit ( quiagen ) , including on column dnase treatment for 20 min .
the manufacturer 's instructions were followed except that we used lysing matrix c for yeast rna extraction from mp biomedicals ( santa ana , ca , usa ) .
quality of the isolated rna was determined with a nanodrop nd 1000 ( nanodrop technologies , delaware , usa ) and a bioanalyzer 2100 ( agilent , waldbronn , germany ) .
only samples with a 260 / 280 nm value between 1.8 - 2.1 and a 28s / 18s value within 1.5 - 2 were further processed .
total rna samples ( 50 ng ) were reverse - transcribed into double - stranded cdna and then in vitro transcribed in the presence of biotin - labeled nucleotides using genechip ( r ) 3 ' ivt express kit ( affymetrix inc. , p / n 901229 ) .
the quality and quantity of the biotinylated crna were determined using nanodrop nd 1000 and bioanalyzer 2100 .
biotin - labeled crna samples ( 15 mug ) were fragmented randomly to 35 - 200 bp at 94degreesc in fragmentation buffer ( affymetrix inc. , p / n 900371 ) and were mixed in 300 mul of hybridization mix ( affymetrix inc. , p / n 900720 ) containing hybridization controls and control oligonucleotide b2 ( affymetrix inc. , p / n 900454 ) .
samples were hybridized to genechip ( r ) yeast 2.0 arrays for 16 h at 45degreesc .
arrays were then washed using an affymetrix fluidics station 450 fs450 _ 0001 protocol .
an affymetrix genechip scanner 3000 was used to measure the fluorescent intensity emitted by the labeled target .
the raw cel files were normalized using r / bioconductor , affy package ( background correction : rma ; only perfect - match probes ; probe intensity normalization : qspline ; expression index calculation : li and wong method ) .
the resulting dataset with one intensity per orf per time point per experiment was the final working dataset .
for clustering and pca analysis , all 25 cel files comprising the three complete time series ( eight in n - upshift , eight in rapamycin and nine in n - downshift ) were normalized together , allowing the relative comparison of transcripts across all experiments .
for statistical dependency analysis , all cel files from each specific shift , including the replicates , were normalized together ( 14 in n - upshift , 14 in rapamycin and 15 in n - downshift ) , allowing adequate statistical treatment for each shift .
raw data are deposited in ncbi geo under the accession number gse54852 .
determination of protein levels protein samples were taken by addition of trichloroacetic acid directly to the yeast culture , followed by cell lysis using glass beads beating in condition of 8 m urea .
as internal standard , a 15n stable - isotope labeled protein reference yeast extract was spiked into all samples .
after reduction , alkylation and trypsin digestion peptide mixtures were purified using c18 cartridges , and all protein samples were assayed in biological triplicates .
srm measurements were performed on a tsq vantage qqq mass spectrometer ( thermo fischer scientific ) equipped with a nano - electrospray ion source and a nano - lc system ( eksigent ) .
for all targeted proteins , proteotypic peptides and optimal transitions for identification and quantification were selected based on two high - quality srm assay repositories of s. cerevisiae : ( i ) a proteome - wide mass - spectrometric map generated from synthetic reference peptides ( picotti et al , 2013 ) ( accessible at www.srmatlas.org / yeast /) and ( ii ) a yeast ion - trap consensus spectral library from the national institute of standards and technology ( nist ) ( built 2009 , accessible at http :// peptide.nist.gov ) .
relative protein quantification was carried out based on the ratio between summed transition areas for light ( endogenous ) and heavy ( 15n reference ) peptide form .
for proteins quantified with several peptides the average peptide ratio was used to compute the protein ratio .
the quantitative srm dataset has been deposited to the public repository " panorama " and is accessible via the link https :// daily.panoramaweb.org / labkey / project / aebersold / ludwig / bigy _ srmdata / begin.view .
analysis of transcriptome and metabolome data principal component analysis ( pca ) pca was performed with the r - package pcamethods ( method ppca ) on the entire transcript set ( 5,716 transcripts ) , metabolic gene set [ 909 transcripts encoding for metabolic enzymes described previously ( herrgard et al , 2008 )] and lc - ms / ms metabolome set ( 42 metabolites ) .
transcript and metabolite intensities were mean - centered by subtracting the average intensity of each transcript / metabolite over the entire samples and scaled to unit variance by dividing by the standard deviation .
onset times onset times , defined as the time for a transcript to reach half of its maximum intensity change , were determined by fitting a six - parameter impulse model ( chechik & koller , 2009 ) to the dynamic transcript profiles .
the impulse model fit was implemented in matlab , and the parameters h0 , h1 , h2 , t1 , t2 , and beta that best fit the data were identified based on an optimization problem formulated as minimization of unconstrained variables. by interpolation of the dynamic transcript response given by the impulse response , we calculated the onset time t1 / 2 .
clustering clustering was applied to the dataset containing all measured transcripts over the complete time - course datasets for the three shifts ( matrix size : 5,716 transcripts x 25 samples ) .
model selection and statistical validation was performed with the principle of approximation set coding to determine the most predictive clustering and the number of clusters ( chehreghani et al , 2012 ) , which determines the best tradeoff between informativeness and stability of the clustering solutions .
here , it has been employed to compare two relational cost models : pairwise clustering ( hofmann & buhmann , 1997 ) and correlation clustering ( bansal et al , 2004 ) with pearson correlation similarity .
pairwise clustering yielded a higher approximation capacity than correlation clustering , that is a larger number of bits - per - sample which are reliably extracted from the data .
for each cluster , a representative time trajectory was estimated by the average value of the members of the cluster at each time point .
probabilistic assignment to network motifs interpolation of metabolite and transcript data depending on how we computed the " dynamic dependence " ( see below ) , we either used interpolated trajectories of the average ( across three biological replicates ) response of each metabolite in every shift , or we interpolated each biological replicate independently for every shift .
in both cases , we used two interpolation techniques : ( i ) linear interpolation , and ( ii ) cubic smoothing spline interpolation .
we interpolated the experimental time points between 0 and 10 min of the metabolic response .
to estimate the rate of change of each transcript in time ( that is , its time derivative ) , we interpolated each transcriptional time course ( experimental time points between 0 and 24 min of the transcriptional response , evaluated in equally spaced intervals of 1 min ) with cubic smoothing splines and differentiated the resulting polynomials .
all the interpolated curves were sampled every minute to establish sampled datasets .
computation of " dynamic dependence " to compute the dynamic dependence between every metabolite - transcript pair for each experiment , we employed the sampled version of distance correlation ( szekely et al , 2007 ) .
the computation of a distance correlation between a set of pairwise samples ( within a 10 - min interval ) of a metabolite - transcript pair resulted in a dynamic correlation value of that pair for that particular time interval .
since the experimental measurements are noisy , we also added gaussian noise to the pairwise samples ( with coefficient of variation equal to 0.1. 0.2 , 0.3 , and 0.4 ) .
causality was introduced by computing the dynamic correlation between each metabolic trajectory and the derivative of each transcriptional response , and by making use of ten " delayed " versions of the transcriptional response for the computation of the distance correlation ( a 10 - min window of the initial transcript - trajectory was used in every case , which was moved by 1 min until the 20th min of the transcriptional response ) .
hence , for each pair of metabolite - transcript , we computed 11 values ( each assigned to one transcriptional " delay " value ) of dynamic dependence for each experimental case .
to achieve robust results , we used three definitions of pairwise correlations : ( i ) average trajectories : average metabolite samples ( over biological replicates ) and transcript samples in time define two one - dimensional feature vectors ; ( ii ) individual trajectories , variant 1 : the one - dimensional vector of metabolite responses is constructed from all biological replicates ; and ( iii ) individual trajectories , variant 2 : the metabolite and transcript vectors are both three - dimensional ( for the replicates ). with these three variants , two versions of the interpolated metabolite data , and four different levels of variance for the gaussian noise , we computed the dynamic dependence for each metabolite - transcript pair by 24 different methods .
finally , we selected the 10 % of the transcripts with the highest maximum distance correlation value ( across all the transcriptional delays ) to define a set of genes associated with a metabolite ( significant set of genes of a metabolite ; ssg of a metabolite ) .
the " dynamic dependence " feature value of a metabolite used for network assignment was defined as the mean value of the distance correlation values of the ssg of this metabolite .
computation of " representation of tor genes " for each metabolite , the feature of " representation of tor genes " is defined as the normalized fraction of genes in ssg that are known to be directly associated with at least one of the transcription factors gcn4 , rtg1 , rtg3 , gln3 , sfp1 , fhl1 , ifh1 , msn2 , msn4 , gis1 , and sko1 that are known direct targets of torc1 .
the direct association was inferred from the yeastract database ( teixeira et al , 2006 ) using the direct and documented interactions ( downloaded on 10 nov 2011 ) .
bayesian inference framework given the computed values for the features of " dynamic dependence " and of " representation of tor genes " for each experimental condition , we employed bayes factors ( kass & raftery , 1995 ) to perform the probabilistic assignment of each metabolite to the four network motifs .
the bayes factor bij is defined as the fraction of the posterior probability of the motif mi given the data d with the posterior probability of the motif mj given the data : the posterior probability of each motif m given the data can be computed via bayes' rule as : where p ( d | m ) is a likelihood that represents the probability that the data are produced under the assumption of the motif m , p ( m ) is the prior value of the motif m ( representing the initial degree of belief in the motif ) , and p ( d ) is the evidence of the data .
we assumed uniform priors for each metabolite - network assignment such that the bayes factor bij is given by : namely the fraction of the likelihoods of the two motifs .
the likelihood of assigning a metabolite to a network motif was computed based on the corresponding " motif prototype " values ( see fig4b ) and the values of the metabolite - related features compared to the feature distribution of a random set of metabolites ( of an initial constant value plus gaussian noise of same coefficient of variation as in the experimental dataset ) .
specifically , the likelihood value was defined as the product of the distances of the features' values on the empirical cumulative density function ( ecdf ) of the random metabolite set from the " motif prototype " values .
when a " motif prototype " value is " r " , then the ecdf distance ( of a feature with value x ) from the median of the random set distribution is computed only when ecdf ( x ) > 0.5 .
if ecdf ( x ) < 0.5 , then the ecdf distance equals zero .
note that we employed two ways to compute the likelihood of assigning a metabolite to a network motif m : ( i ) by accounting for the likelihood in all three conditions , and ( ii ) by accounting for the likelihood values of the rapamycin downshift and of the nutrient shift with the highest likelihood value .
finally , by computing the values of : and accounting for the fact that the sum of all four posterior probabilities has to equal one , we can easily compute posterior probabilities of the assignments of each metabolite to the four network motifs .
frequency of assignment to network motifs altogether , we performed 48 different probabilistic assignments of each metabolite to the four network motifs ( 24 variants for computing the dynamic dependence and two variants of determining probabilities of network assignments ) .
for a metabolite , the frequency of assignment to a network motif is defined as the fraction of the methods that support the metabolite - network assignment with more than 50 % probability .
note here that although the probabilities of the network assignments always sum up to one , this does not apply to the frequencies of assignments .
when , for a metabolite , the assignment probabilities ( computed with a particular method ) are identical for the four network motifs ( i.e. 25 %) , then this method will increase the frequency of " no network motif " .
robustness of assignments to network motifs the only prior knowledge we use for the analysis is the set of transcription factors ( tfs ) that , according to the literature , are direct targets of torc1 ( 11 torc1 - tfs ) .
this set of tfs influences directly the values of the feature " representation of tor genes " , which in turn affects the motif frequency value ( fraction of computational methods assigning a metabolite to a specific motif ) , and hence the final assignment of a metabolite to a network motif via the dominant motif frequency .
we performed two types of perturbations to the torc1 - tfs set : ( i ) we removed all possible combinations of one ( - 1 ) , two ( - 2 ) , or three ( - 3 ) tfs and recomputed the assignments of the metabolites to network motifs for all possible tf subsets ( 11 , 55 , and 155 sets , respectively ) .
( ii ) we added one (+ 1 ) , two (+ 2 ) , or three (+ 3 ) tfs to the torc1 - tfs set by random selection from the yeast tfs not known to be targets of torc1 , with n = 100 samples each .
we call " assignment robustness " the fraction of perturbation sets in which a metabolite is assigned to the same network motif as in the unperturbed case .
supplementary table s9 contains the " assignment robustness " and the standard deviation of the dominant frequency for every metabolite and for all perturbations cases .
data availability the raw gene expression data comprising all three shift experiments are deposited in the ncbi gene expression omnibus ( geo ) under the accession number gse54852 ( http :// www.ncbi.nlm.nih.gov / geo / query / acc.cgi ? acc = gse54852 ) .
each individual shift experiment can alternatively be retrieved under accession numbers gse54844 ( n - upshift ) , gse54850 ( n - downshift ) , and gse54851 ( rapamycin - induced downshift ) .
the protein quantitative srm dataset is deposited in the public repository panorama and accessible via the link https :// daily.panoramaweb.org / labkey / project / aebersold / ludwig / bigy _ srmdata / begin.view .
all data were processed as described in materials and methods .
the matlab code for the network inference method is provided as supplementary file s1 .
this work was funded through the systemsx.ch project yeastx , evaluated by the swiss national science foundation , and the ec framework 7 project unicellsys .
we thank the functional genomic center zurich for performing the microarray experiments , from reverse transcription to chip image .
author contributions us and js conceived and designed the study .
us , js , mnh , ra , jb and mp supervised the study .
fr and us planned the experiments .
fr coordinated the shift experiments .
fr , cl , apo , ds , as , lf , sc , jcs and rd collected and preprocessed samples .
fr and sc processed the samples for biomass and extracellular concentrations .
as processed the samples for transcriptome analysis .
fr and sj processed the samples for metabolome analysis .
cl processed the samples for proteome analysis .
rd processed the samples for facs analysis .
ds and ag performed the sch9 - p experiments .
apo coordinated the data analysis .
apo and sj analyzed the omics data .
agb and mhc performed the clustering .
sd , agb and js developed the probabilistic model - based analysis method for network motifs .
sd performed the model - based analysis .
apo , us , sd and js interpreted the results of the model - based analysis .
apo , sd , ra , us and js wrote and edited the manuscript .
conflict of interest the authors declare that they have no conflict of interest .
references bansal n blum a chawla s correlation clustering mach learn 2004 56 89 113 bar - joseph z gitter a simon i studying and modelling dynamic biological processes using time - series gene expression data nat rev genet 2012 13 552 564 22805708 binda m peli - gulli mp bonfils g panchaud n urban j sturgill tw loewith r de virgilio c the vam6 gef controls torc1 by activating the ego complex mol cell 2009 35 563 573 19748353 bradley ph brauer mj rabinowitz jd troyanskaya og coordinated concentration changes of transcripts and metabolites in saccharomyces cerevisiae plos comput biol 2009 5 e1000270 19180179 buescher jm moco s sauer u zamboni n ultrahigh performance liquid chromatography - tandem mass spectrometry method for fast and robust quantification of anionic and aromatic metabolites anal chem 2010 82 4403 4412 20433152 buescher jm liebermeister w jules m uhr m muntel j botella e hessling b kleijn rj le chat l lecointe f mader u nicolas p piersma s rugheimer f becher d bessieres p bidnenko e denham el dervyn e devine km global network reorganization during dynamic adaptations of bacillus subtilis metabolism science 2012 335 1099 1103 22383848 canelas ab harrison n fazio a zhang j pitkanen jp van den brink j bakker bm bogner l bouwman j castrillo ji cankorur a chumnanpuen p daran - lapujade p dikicioglu d van eunen k ewald jc heijnen jj kirdar b mattila i mensonides fi integrated multilaboratory systems biology reveals differences in protein metabolism between two reference yeast strains nat commun 2010 1 145 21266995 chan tf carvalho j riles l zheng xf a chemical genomics approach toward understanding the global functions of the target of rapamycin protein ( tor ) proc natl acad sci usa 2000 97 13227 13232 11078525 chechik g oh e rando o weissman j regev a koller d activity motifs reveal principles of timing in transcriptional control of the yeast metabolic network nat biotechnol 2008 26 1251 1259 18953355 chechik g koller d timing of gene expression responses to environmental changes j comput biol 2009 16 279 290 19193146 chehreghani mh busetto ag buhmann jm information theoretic model validation for spectral clustering j mach learn res 2012 22 495 503 crespo jl powers t fowler b hall mn the tor - controlled transcription activators gln3 , rtg1 , and rtg3 are regulated in response to intracellular levels of glutamine proc natl acad sci usa 2002 99 6784 6789 11997479 dechant r peter m nutrient signals driving cell growth curr opin cell biol 2008 20 678 687 18930818 dikicioglu d dunn wb kell db kirdar b oliver sg short - and long - term dynamic responses of the metabolic network and gene expression in yeast to a transient change in the nutrient environment mol biosyst 2012 8 1760 1774 22491778 doucette cd schwab dj wingreen ns rabinowitz jd alpha - ketoglutarate coordinates carbon and nitrogen utilization via enzyme i inhibition nat chem biol 2011 7 894 901 22002719 fernie ar stitt m on the discordance of metabolomics with proteomics and transcriptomics : coping with increasing complexity in logic , chemistry , and network interactions scientific correspondence plant physiol 2012 158 1139 1145 22253257 fuhrer t heer d begemann b zamboni n high - throughput , accurate mass metabolome profiling of cellular extracts by flow injection - time - of - flight mass spectrometry anal chem 2011 83 7074 7080 21830798 gaubitz c loewith r amino acid signaling in high definition structure 2012 20 1993 1994 23217680 gerosa l sauer u regulation and control of metabolic fluxes in microbes curr opin biotechnol 2011 22 566 575 21600757 herrgard mj swainston n dobson p dunn wb arga ky arvas m bluthgen n borger s costenoble r heinemann m hucka m le novere n li p liebermeister w mo ml oliveira ap petranovic d pettifer s simeonidis e smallbone k a consensus yeast metabolic network reconstruction obtained from a community approach to systems biology nat biotechnol 2008 26 1155 1160 18846089 hofman - bang j nitrogen catabolite repression in saccharomyces cerevisiae mol biotechnol 1999 12 35 73 10554772 hofmann t buhmann jm pairwise data clustering by deterministic annealing patt anal mach intell ieee trans 1997 19 1 14 holt lj tuch bb villen j johnson ad gygi sp morgan do global analysis of cdk1 substrate phosphorylation sites provides insights into evolution science 2009 325 1682 1686 19779198 ideker t dutkowski j hood l boosting signal - to - noise in complex biology : prior knowledge is power cell 2011 144 860 863 21414478 iraqui i vissers s andre b urrestarazu a transcriptional induction by aromatic amino acids in saccharomyces cerevisiae mol cell biol 1999 19 3360 3371 10207060 kass re raftery ae bayes factors j am stat assoc 1995 90 773 795 kresnowati mt van winden wa almering mj ten pierick a ras c knijnenburg ta daran - lapujade p pronk jt heijnen jj daran jm when transcriptome meets metabolome : fast cellular responses of yeast to sudden relief of glucose limitation mol syst biol 2006 2 49 16969341 link h kochanowski k sauer u systematic identification of allosteric protein - metabolite interactions that control enzyme activity in vivo nat biotechnol 2013 31 357 361 23455438 ljungdahl po daignan - fornier b regulation of amino acid , nucleotide , and phosphate metabolism in saccharomyces cerevisiae genetics 2012 190 885 929 22419079 loewith r jacinto e wullschleger s lorberg a crespo jl bonenfant d oppliger w jenoe p hall mn two tor complexes , only one of which is rapamycin sensitive , have distinct roles in cell growth control mol cell 2002 10 457 468 12408816 loewith r a brief history of tor biochem soc trans 2011 39 437 442 21428915 loewith r hall mn target of rapamycin ( tor ) in nutrient signaling and growth control genetics 2011 189 1177 1201 22174183 magasanik b kaiser ca nitrogen regulation in saccharomyces cerevisiae gene 2002 290 1 18 12062797 oliveira ap ludwig c zampieri m weisser h aebersold r sauer u dynamic phosphoproteomics reveals torc1 - dependent regulation of yeast nucleotide and amino acid biosynthesis sci signal 2015 doi 10.1126 / scisignal.2005768 orth jd palsson bo systematizing the generation of missing metabolic knowledge biotechnol bioeng 2010 107 403 412 20589842 picotti p clement - ziza m lam h campbell ds schmidt a deutsch ew rost h sun z rinner o reiter l shen q michaelson jj frei a alberti s kusebauch u wollscheid b moritz rl beyer a aebersold r a complete mass - spectrometric map of the yeast proteome applied to quantitative trait analysis nature 2013 494 266 270 23334424 pinson b vaur s sagot i coulpier f lemoine s daignan - fornier b metabolic intermediates selectively stimulate transcription factor interaction and modulate phosphate and purine pathways genes dev 2009 23 1399 1407 19528318 rohde jr bastidas r puria r cardenas me nutritional control via tor signaling in saccharomyces cerevisiae curr opin microbiol 2008 11 153 160 18396450 sellick ca reece rj eukaryotic transcription factors as direct nutrient sensors trends biochem sci 2005 30 405 412 15950477 smets b ghillebert r de snijder p binda m swinnen e de virgilio c winderickx j life in the midst of scarcity : adaptations to nutrient availability in saccharomyces cerevisiae curr genet 2010 56 1 32 20054690 soufi b kelstrup cd stoehr g frohlich f walther tc olsen jv global analysis of the yeast osmotic stress response by quantitative proteomics mol biosyst 2009 5 1337 1346 19823750 soulard a cremonesi a moes s schutz f jeno p hall mn the rapamycin - sensitive phosphoproteome reveals that tor controls protein kinase a toward some but not all substrates mol biol cell 2010 21 3475 3486 20702584 stracka d jozefczuk s rudroff f sauer u hall mn nitrogen source activates tor ( target of rapamycin ) complex 1 via glutamine and independently of gtr / rag proteins j biol chem 2014 289 25010 25020 25063813 szekely gj rizzo ml bakirov nk measuring and testing dependence by correlation of distances anna stat 2007 35 2769 2794 teixeira mc monteiro p jain p tenreiro s fernandes ar mira np alenquer m freitas at oliveira al sa - correia i the yeastract database : a tool for the analysis of transcription regulatory associations in saccharomyces cerevisiae nucleic acids res 2006 34 d446 d451 16381908 urban j soulard a huber a lippman s mukhopadhyay d deloche o wanke v anrather d ammerer g riezman h broach jr de virgilio c hall mn loewith r sch9 is a major target of torc1 in saccharomyces cerevisiae mol cell 2007 26 663 674 17560372 walther t novo m rossger k letisse f loret mo portais jc francois jm control of atp homeostasis during the respiro - fermentative transition in yeast mol syst biol 2010 6 344 20087341 watson e macneil lt arda he zhu lj walhout aj integration of metabolic and gene regulatory networks modulates the c. elegans dietary response cell 2013 153 253 266 23540702 wilson wa roach pj nutrient - regulated protein kinases in budding yeast cell 2002 111 155 158 12408859 zamboni n fendt sm ruhl m sauer u ( 13 ) c - based metabolic flux analysis nat protoc 2009 4 878 892 19478804 zhu j sova p xu q dombek km xu ey vu h tu z brem rb bumgarner re schadt ee stitching together multiple data dimensions reveals interacting metabolomic and transcriptomic networks that modulate cell regulation plos biol 2012 10 e1001301 22509135 supporting information supplementary figure s1 supplementary figure s2 supplementary figure s3 supplementary figure s4 supplementary figure s5 supplementary figure s6 supplementary table s1 supplementary table s2 supplementary table s3 supplementary table s4 supplementary table s5 supplementary table s6 supplementary table s7 supplementary table s8 supplementary table s9 supplementary text s1 supplementary file s1 .
code and documentation for the network inference algorithm ( matlab ) review process file