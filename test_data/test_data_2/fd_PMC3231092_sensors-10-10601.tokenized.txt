sensors ( basel ) sensors ( basel , switzerland ) 1424 - 8220 molecular diversity preservation international ( mdpi ) 22163488 3231092 10.3390 / s101210601 sensors - 10 - 10601 article automated detection of the arterial inner walls of the common carotid artery based on dynamic b - mode signals cheng da - chuan 1 * schmidt - trucksass arno 2 liu chung - hsiang 3 liu shing - hong 4 1 department of biomedical imaging and radiological science , china medical university , taichung , taiwan 2 institute of exercise and health sciences , university of basel , basel , switzerland ; e - mail : arno.schmidt - trucksaess @ unibas.ch 3 department of neurology , china medical university hospital , taichung , taiwan ; e - mail : greengen @ gmail.com 4 department of computer science and information engineering , chaoyang university of technology , taichung , taiwan ; e - mail : shliu @ cyut.edu.tw * author to whom correspondence should be addressed ; e - mail : dccheng @ mail.cmu.edu.tw ; tel. : + 886 - 4 - 2205 - 2121 ext .
7625 ; fax : + 886 - 4 - 2233 - 4175 .
2010 29 11 2010 10 12 10601 10619 7 10 2010 12 11 2010 18 11 2010 ( c ) 2010 by the authors ; licensee mdpi , basel , switzerland .
2010 this article is an open access article distributed under the terms and conditions of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 3.0 /) .
in this paper we propose a novel scheme able to automatically detect the intima and adventitia of both near and far walls of the common carotid artery in dynamic b - mode rf ( radiofrequency ) image sequences , with and without plaques. via this automated system the lumen diameter changes along the heart cycle can be detected .
three image sequences have been tested and all results are compared to manual tracings made by two professional experts .
the average errors for near and far wall detection are 0.058 mm and 0.067 mm , respectively .
this system is able to analyze arterial plaques dynamically which is impossible to do manually due to the tremendous human workload involved .
intima media adventitia cca plaque 1 .
introduction carotid atherosclerosis may appear as intima - media thickening or plaque formation .
common carotid artery intima - media thickness ( cca - imt ) measurements have been confirmed to be an early marker of atherosclerosis [ 1 ] and have been associated with a higher risk of stroke [ 2 ] and myocardial infarction [ 3 ] .
the non - invasive sonographic examination has demonstrated its potential in early prediction of cardiovascular diseases [ 4 ] .
carotid plaque formation is a different form of atherosclerotic damage of the carotid artery .
an increasing grade of stenosis caused by plaques is associated with higher incidence of stroke and major cardiovascular events .
further , total plaque area is a major determinant of cardiovascular events and mortality .
b - mode sonography is widely used to scan the carotid artery in the diagnosis of atherosclerosis .
it is noninvasive and low cost .
the carotid imt can be measured either manually [ 5 ] , semi - automatically or automatically [ 6 - 14 ] .
carotid plaques are usually measured manually by measurement of the largest diameter in length and height , respectively .
this can only be seen as a rough estimation of the plaque area .
measurement of stenosis degree is mostly performed via few points placed manually at the nearest point of the stenosis .
the automatic methods of outlining the outer boundaries of imt and plaques have the potential to make results reproducible and eliminate the strong variations observed in manual tracings by different observers .
particularly , it is almost impractical to trace the boundaries of the inner wall on image sequences manually since this requires a tremendous amount of time. by using an automatic system the processing time can be considerably reduced .
the motivation of this study was to develop a fiable system which is able to automatically detect the intima and adventitia of both near and far artery walls along a section , with or without plaques , using dynamic b - mode sonographic image sequences even under strong speckle noise conditions .
this system can identify not only the imt but also the lumen diameter ( ld ) during systolic and diastolic cycles , from which the artery 's volume change with respect to time can be outlined .
a precise measurement of the imt over the heart cycle in areas without plaque formation is the basis for the measurement of the local arterial stiffness .
the same measurement in the area of a plaque offers the possibility of measuring the deformation of a plaque over the heart cycle , giving the perspective to analyze the deformability of a plaque .
this may be a step forward of the detection of vulnerable plaques. via this system , the dynamic processes of the carotid artery ( ca ) can be represented by some parameters such as imt variation , ld variation , and the frequency analysis on the ld changes .
the carotid artery stiffness ( or elasticity , cs ) is one of the important factors for predicting cardio - vascular events [ 15,16 ] .
in order to measure cs one has to calculate the cross - sectional area changes of the cca during the systolic and diastolic cycle , i.e. , cdist = deltaa /( a.deltap ) , where a is diastolic lumen area and deltaa is the maximum area change during a systolic - diastolic cycle , and deltap is the local blood pressure change measured by a sphygmometer on branchial artery .
the cdist can be converted to cs by giving cs = ( cdist ) - ( 1 / 2 ) [ 15 ] .
our method is an automated scheme which is able to calculate the diameter changes of cca during the heart beat cycle .
it provides direct information for calculating deltaa and a. in previous studies cs was calculated by measuring the lds in systolic and diastolic states , i.e. , only two points .
the contribution of this study is to propose a fiable technique for detecting the sectional imt and ld changes along a section of cca with respect to time , with and without plaques and even having speckle noises .
this method is in general different from previously published works and it provides good results .
technically , we use a novel dual dynamic programming combined with some anatomic knowledge incorporated into the scheme which makes the detection more robust towards the presence of speckle noises .
2. materials after at least 15 minutes of rest in the supine position , ultrasonic examinations of the right and left cca were performed .
an esaote mylab 25 ( florence , italy ) ultrasound scanner with a transducer ( la523 ) having variable - band linear array ( 13 - 14 mhz ) .
the neck of the study subjects was turned slightly to the left or right side for scanning the right or left carotid artery , respectively .
the transducer was positioned at the anterior - lateral side of the neck .
the lumen was maximized in the longitudinal plane with an optimal image of the near and the far vessel wall of the cca or carotid bifurcation .
thus , typical double lines could be seen as the intima - media layer of the artery .
plaques were scanned in a longitudinal and cross - sectional plane showing the highest diameter .
at least three heart cycles of every subject were acquired for measurement of the imt or plaque , respectively .
all sequences were stored digitally in the ultrasound device and transferred to a personal computer for further image analysis .
this study complies with the declaration of helsinki and was approved by the ethics committee of the technical university munich , germany .
all patients signed an informed consent before being examined .
3. methods 3.1 .
problems statement the problems encountered in this study can be itemized as follows : speckle noises ; calcification deposition on intima ; moving target ; parameter determination in different sonographic modalities .
the first problem is very common in the near arterial wall .
due to the jump of echo intensity between intimal surface and lumen , echoes ( speckle noises ) are transferred to the lumen which cause blurring of the intima - lumen interface .
the second problem is that calcification deposition generally causes a shadow area under it. this results in a problem in detecting the far wall adventitia or the near wall intima depending on the location of the plaque .
the third problem states that the artery changes in lumen diameter , imt and position with systolic and diastolic phases .
since sequential images are processed , the tracking problem appears .
the last problem is very common in many algorithms .
due to different properties of different ultrasonic machines , one has to determine the optimal parameter set for each specific machine .
3.2 .
image feature a typical b - mode image is shown in figure 1 .
there are plaques on both near and far walls .
on the contrary , a typical cca image without plaque having thin and thick imt is shown in figures 2 and 3 , respectively .
outlining the boundaries of intima and adventitia is not easy , especially on the near wall .
some features have been studied in previous studies [ 7,11 ] , in which the most frequently used feature is the gradient of gray - values. from our previous studies [ 7,14,17 ] , it is found that macleod operator combined with some specific enhancement filters are very suitable for feature extraction in intima and adventitia detections .
the dynamic b - mode sonographic sequences are recorded and converted to a series of static images and saved in bmp format .
a graphic user interface ( gui ) is designed for the user to select a region of interest ( roi ) for the following automatic analysis .
the selected roi is a rectangular area which is large enough to cover the possible area during a complete systolic and diastolic cycle .
similarly , when the imt is analyzed , the rectangular area covers only the intima , adventitia , and part of artery lumen area .
however , since the imt does not change too much during the heart cycle , the rectangular area for imt measurement is much smaller than the one for lumen diameter measurement .
after the roi is selected , the following analysis and measurement processes are fully automatic .
the feature image ( f ) is obtained from the roi sub - image by means of the following filtration : ( 1 ) f =| i * fm |+ i * fxwhere i denotes the roi sub - image ; fm is the macleod operator ; and fx is the enhancement filter .
the design of fx for the imt and ld detection is different .
the macleod filter is defined as follows [ 18 ] : ( 2 ) fm ( x , y )= exp ( - x2 + y2dc2 )[ exp ( - ( dxy + dpkdpk ) 2 ) - exp ( - ( dxy - dpkdpk ) 2 )] where : dc constant ; determining the rate of radial decay , dpk distance from axis to peaks in positive and negative weights , dxy = x sin theta - y cos theta , perpendicular , distance of point ( x,y ) from axis of edge ( at orientation theta to horizontal ) .
the macleod filter is used to detect the gradient in different orientations .
in total we used four angles , i.e. , theta = 0 , pi / 4 , pi / 2 , and 3pi / 4 .
however , due to the noise interference in the sub - intima area , a single macleod filter cannot finish this work .
therefore , we add another enhancement filter to reduce the effect of noises .
this is because the gradient direction is considered in the enhancement filter to degenerate the noises effect in the sub - intima computed by macleod filter .
there are two kinds of fx , one for imt detection and another one for ld detection .
each one has its own duality , one for near wall and another one for far wall .
the enhancement filter for far wall ld detection has been published in [ 17 ] .
for simplicity we do not repeat it again because it is a large matrix .
the enhancement filter for far and near wall imt detection is as follows : ( 3 ) fimt ( far )=[ 000 - 1000000 - 1000000 - 10000000000000100000010000001000 ] , fimt ( near )=[ 0001000000100000010000000000000 - 1000000 - 1000000 - 1000 ] figure 4 demonstrates the noise reduction effect of the enhancement filter .
in cases without plaques , the thickness of sub - intima does not change on a large scale .
if it has plaques , the noise layer existing in the sub - intima is not so strong and therefore , it can be ignored .
the size of the filter is based on the consideration of the sensor 's frequency and the anatomic structure .
since the normal imt is around 0.5 mm for young persons and the sensor is 10 mhz , therefore , the pixel size is about 0.1 mm and the imt is around 5 pixels. that is the reason why the filter size is 7 x 7. via this design , the imt can be detected with less interference from the noise layer .
on the task of lumen diameter detection , detecting the intima of both near and far walls precisely is very important .
to achieve this goal , we separate the detection into two phases , i.e. , the near wall ia ( intima - adventitia ) and far wall ia detection. from the two detections the intima layers of both walls can be obtained .
the reason for using ddp ( dual dynamic programming ) two - times instead of using the 4 - dynamic programming is because it requires less computation time .
most previous studies use the adventitia of the near wall instead of the initima to calculate ld. this is an approximation when there is no plaque .
since some patients have plaques , this approximation might cause significant faults in ld calculation .
according to our experience the enhancement filter in ( 2 ) combined with macleod filter produces good results for the far wall imt detection .
however , it is not the case for the near wall .
figure 5 demonstrates one typical problem .
this image is a sub - image extracted from a raw image in a sequence .
some noises existed under the intima when the artery is in the systolic cycle because its larger moving speed .
this will cause ambiguity in ia detection because most of the rest images have no such kind of noises .
we therefore propose a method to alleviate this problem .
the ambiguity results from the fact that the directional gradient of gray values cannot differentiate the interface between the lumen - intima interface and lumen - noise interface .
if the gradient of the interface between the noise and artery lumen is larger than that between media and adventitia ( figure 5 shows the case ) , then the following ddp will have a faulty result .
the problem then becomes how to enhance the interface between media and adventitia .
we observed that there are large gray values under both lumen - intima and media - adventitia interfaces in the near wall .
we can make good use of this information .
nevertheless , we do not hope to enhance the outer wall simultaneously , since it will result in ambiguity in searching the dual lines , i.e. , the intima and the adventitia .
to solve this problem we apply dynamic programming to find out the outer wall first .
then an additional feature image ( h ) is calculated as follows : ( 4 ) h ( y , x )= 1 - 1rsumi = y + 1y + ri ( i , x ) , for m - r > y > youter , n >= x >= 1where i is the sub - image of the size m x n and r is determined by the knowledge and the image resolution ; youter is the coordinate of the outer wall .
notably , i is normalized so that 0 <= i ( y,x ) <= 1 .
3.3 .
dual dynamic programming ( ddp ) in our previous study we have developed dual dynamic programming ( ddp ) for imt detection .
here we briefly describe this scheme as follows .
let h ( x , y ) denote the feature image grid of size m x n , where m and n are the number of rows and columns , respectively .
assume the ddp running from left to right in order to find dual curves such as intima and adventitia ( or intimal layers of both near and far walls in case of detecting the lumen diameter ) .
the ddp intends to find the global maximum , which is the summation of the feature values on the grid where the dual curves go through .
the dual curves can be denoted as a point set {( x , y1 ) , ( x , y2 )} , 1 <= x <= n , and its corresponding feature values are { h ( x , y1 ) , h ( x , y2 )} .
the anatomic knowledge is then embedded into the ddp structure : quasi - parallel property : the intima and adventitia do not cross each other .
only in very limited cases such as when the intima is damaged so that adventitia might be exposed to the artery lumen .
based on this fact , the relationship is defined to be 1 <= y1 <= y2 <= m. minimum - and maximum - thickness property : the imt has normally 0.5 mm. however , it varies and depends on age and diseases .
elderly people or cvd ( cardiovascular disease ) patients have larger imt than younger or normal persons .
plaques are often a symptom seen in artery walls .
based on this finding , the minimal and maximal thickness can be given as dmin and dmax , respectively .
they have to satisfy a constraint : dmin <= y2 - y1 <= dmax .
these two parameters are determined by the image pixel size and related to the selected roi size .
in which dmin is normally set to 0.4 mm and dmax can be set smaller if there is no plaque in order to speed - up the imt detection process .
in the ld detection , dmax has to be set larger since the ld is larger than imt .
smoothness property : the last consideration is smoothness .
it is assumed that intima or adventitia does not change abruptly .
there are two terms defined in the energy function , i.e. , the single line smoothness ( dr =| yx - yx - 1 |) and dual - line change smoothness ( deltaomegax =| omegax - omegax - 1 |) , where omegax =| y2,x - y1,x | .
finally , the cost function can be defined to be : ( 5 ) j ( x , y1 , y2 )= minj1,j2in { - k ,... , k }{ j ( x - 1 , y1 + j1 , y2 + j2 )+ alphadeltaomegax + beta (| j1 |+| j2 |)}+ h ( x , y1 )+ h ( x , y2 ) subject to dmin <= y2 + j2 - y1 - j1 <= dmax , k = dr , and 2 <= x <= n ; where alpha and beta are weighing factors of the line smoothness .
all tuples ( y1 , y2 ) are tested if they fit the constraints .
actually , both deltaomegax and (| j1 | + | j2 |) can form a ( 2k + 1 ) x ( 2k + 1 ) matrix .
take k = 1 as an example as follows : deltaomegax =[ 012101210 ] , and (| j1 |+| j2 |)=[ 212101212 ] therefore , alphadeltaomegax + beta (| j1 |+| j2 |)=[ 2betaalpha + beta2 ( alpha + beta ) alpha + beta0alpha + beta2 ( alpha + beta ) alpha + beta2beta ] , where the row and column index pair is ( j1 , j2 ) .
since the minimization problem depends on ( j1 , j2 ) only , the process can be accelerated via finding the minimum in the following matrix : j ( x - 1 , y1 + j1 , y2 + j2 )+ alphadeltaomegax + beta (| j1 |+| j2 |)=[ j ( x - 1 , y1 - 1 , y2 - 1 ) j ( x - 1 , y1 - 1 , y2 ) j ( x - 1 , y1 - 1 , y2 + 1 ) j ( x - 1 , y1 , y2 - 1 ) j ( x - 1 , y1 , y2 ) j ( x - 1 , y1 , y2 + 1 ) j ( x - 1 , y1 + 1 , y2 - 1 ) j ( x - 1 , y1 + 1 , y2 ) j ( x - 1 , y1 + 1 , y2 + 1 )]+[ 2betaalpha + beta2 ( alpha + beta ) alpha + beta0alpha + beta2 ( alpha + beta ) alpha + beta2beta ] this can be expanded to a ( 2k + 1 ) x ( 2k + 1 ) matrix if k > 1 .
the initial values of j ( 1 , y1 , y2 ) is defined by j ( 1 , y1 , y2 ) = h ( 1 , y1 ) + h ( 1 , y2 ) and the optimal tuple ( j1 * , j2 *) can be determined by searching the minimum in the ( 2k + 1 ) x ( 2k + 1 ) matrix : ( j1 * , j2 *) = arg min ( j1 , j2 ) j ( x , y1 + j1 , y2 + j2 ) .
the indices pointing backwards are stored in coordinate matrices c1 and c2 as follows : ( 6 ) c1 ( x , y1 , y2 )= y1 + j1 * c2 ( x,y1,y2 )= y2 + j2 * after the ddp is processed , the cost values are computed and saved in the cost map j ( x , y1 , y2 ) in r3 .
the minimum value in the last matrix , i.e. , j ( n , y1 , y2 ) is searched , which indicates the last points of the dual lines .
having a backwards tracking from n to 1 in the coordinate matrices c1 and c2 , the complete coordinates of the dual lines can be obtained .
3.4 .
artery movement tracking ( amt ) the artery has extension and possible movement during the heart cycle .
the movement is mostly in the y - direction , i.e. , orthogonal to the artery flow .
this is because the pressure from the upper skin is less than the pressure from the tissues below .
therefore , the roi is changing in each image of a sequence .
a simple automatic tracking scheme is embedded in order to track a correct roi for the following ddp process .
let t0 ( x + x0 , y + y0 ) in r2 be the rectangular roi selected by the user in the first image of a given sequence , where 1 <= x <= deltax , 1 <= y <= deltay , deltay x deltax is the size of the roi , and ( x0 , y0 ) is a reference point ( i.e. , the upper - left corner of the roi ) on the first image .
the normalized correlation coefficient ( ncc ) is applied to find out the shift in y - direction on each subsequent image : ( 7 ) yi,s *= max - deltas <= s <= deltas1sigmat0sigmati,ssumy = 1deltaysumx = 1deltax ( t0 ( x + x0 , y + y0 ) - t ^ 0 )( ti ( x + x0 , y + yi - 1 + s ) - t ^ i,s ) where i denotes image number ; ( xi - 1 , yi - 1 ) is the reference point in image ( i - 1 ) ; t0 and ti,s are the mean gray values of the regions t0 and ti ( s ) , respectively ; sigmat0 and sigmati,s are the standard deviations of the regions t0 and ti ( s ) , respectively ; deltas is a small integer covering a possible range of artery movement in the y - direction .
the optimal value is the maximal ncc .
thus , yi = yi - 1 + yi,s * .
3.5 .
procedure we summarized the whole process in section 3 to be a procedure as follows : step 1 : the user selects a directory in the hard disk where images of an image sequence are unpacked and stored .
step 2 : the image number ( l ) in the directory is counted .
the first image is automatically loaded and shown on the monitor .
step 3 : the user selects a rectangular area where the artery should be analyzed including the near and the far wall of the ca. step 4 : the selected rectangular area is equally divided into two parts : the upper and lower parts .
record the coordinates .
to analyze near wall , go to step 5 .
to analyze far wall , go to step 6 .
step 5 : ( a ) let i denote the upper part of the rectangular area , i in rmxn .
normalize i so that 0 <= i <= 1 .
f = i * f1 , where f1 = [ - 1 , - 1 , - 1 , - 1,0,1,1,1,1 ] is a column vector .
normalize f so that 0 <= f <= 1 .
( b ) set dmin = 0 , dmax = 1 , k = 1 , apply ddp to find out the outer wall coordinate youter .
( c ) re - calculate f using ( 1 ) , where fx = - fimt ( far ) .
normalize f so that 0 <= f <= 1 .
set h to 1 , h in rmxn .
calculate h using ( 3 ) .
( d ) combine f and h together : h = 1 - f + ch , where c is a weighting factor .
( e ) set dmin = 4 , dmax = 0.9m , k = 1 , apply ddp to find out the intima and adventitia coordinates of the near wall .
record the coordinates .
( f ) set i = i + 1 .
if i > l , end the procedure , else input next image and use amt in section iii to track the correct position of the near wall .
output i and go to step 5 ( a ) .
step 6 : ( a ) let i denote the lower part of the rectangular area , i in rmxn .
normalize i so that 0 <= i <= 1 .
calculate f using ( 1 ) .
normalize f so that 0 <= f <= 1 .
set h to 1 , h in rmxn .
( b ) set dmin = 4 , dmax = 0.9 m , k = 1 , apply ddp to find out the intima and adventitia coordinates of the near wall .
record the coordinates .
( c ) set i = i + 1 .
if i > l , go to step 7 , else input next image and use amt in section iii to track the correct position of the near wall .
output i and go to step 6 ( a ) .
step 7 : smooth the output intima and adventitia lines using averaging technique and show it on the images .
3.6 .
accuracy an accuracy study is an assessment of the reliability of a system .
in order to compare results made by the proposed automated system , we developed software for manual drawings .
the manual drawings were performed by well - trained radiology technicians and then confirmed and modified by a medical physician .
four layers were drawn , i.e. , intima and adventitia of both near and far walls .
the linear interpolation is applied to fill out points between two points in manual drawings .
assume a layer goes from left to right ( x1 to xn ) and the i - th corresponding y - coordinate of the manual drawing and automated result are yi and yi , respectively .
the averaged error of one layer is computed by e = 1nsumi = 1n | yi - y ^ i | .
since each image sequence has many static images , the total averaged error of a sequence is e = 1msum1mei , where there are m static images in the sequence .
4. results the b - mode sonographic image videos were captured by an experienced physician of the institute of exercise and health sciences vascular lab at basel university .
each video has more than 78 static images after decoding .
the image resolution is 652 x 800 and the pixel size is about 0.106 mm. we took three test videos and show some of them in the paper .
the imt detection has duality , i.e. , near and far wall imt detections .
traditionally , the far wall is taken for imt measurement because the near wall intima is insufficiently visible due to the noise impact in many cases .
our method has better robustness against noise impact on the near wall and it is able to detect imt on both near and far walls with and without plaques .
moreover , the measurement of ld is the distance between both intima of near and far walls .
we have tested three image sequences : s1 , s2 , and s3 , they include plaques , thin , and thick imt , respectively .
all sequences have at least three heart cycles .
figures 6 to 8 show the test results of imt detection on the far wall , whereas figures 9 to 11 show the test results of imt detection on the near wall of the three sequences .
in figure 6 there is a plaque on the right - hand side which is successfully detected .
a total of 78 images are in sequence s1 .
another example shows the ability to detect a thin imt as shown in figure 7 .
a total of 111 images are in sequence s2 .
figure 8 shows the thick imt test result .
a total of 86 images are in sequence s3 .
figure 9 shows that our method has the ability to detect the plaque on the near wall .
figure 10 ( b ) shows the problem using the method in [ 7 ] to detect the dual lines when the near wall is not clear .
however , the proposed method can have a good result , as shown in figure 10 ( c ) .
as well , it produces good results in thicker imt detection ( figure 11 ) .
figures 12 and 13 show the error distributions of intima and adventitia along image frame number of near and far wall ( sequence s2 ) , respectively .
the error distributions of the other two sequences are similar and are not shown here .
figure 12 shows an increase of error during the systolic phase of the heart cycle in the near wall .
during this phase the wall movements usually is strongest and results in a blurring of the arterial wall .
in the sequence s2 the systolic cycle begins at image 4 , 41 , 77 , and 111 .
in the middle two heart cycles ( begins at image 41 and 77 ) the artery movement is significant .
it can be noted that there are two " hills " during this period .
it reveals that intima has a lower intensity than the adventitia , which results in a longer blurring ( image 40 - 80 ) than in the adventitia ( image 40 - 60 ) .
however , this error can be treated as low because its averaged error during these two " hills " is around 0.8 pixels .
compare this to the total average error ( 0.6 pixel for near wall and 0.55 pixel for far wall in table 1 ) the difference ( between 0.8 pixel and 0.55 pixel ) is only 0.25 pixel ( 0.0265 mm ) .
absolutely it is in the range of 0.048 mm , thus within 5 % of the imt .
we summarize all errors of the automated results comparing to the expert 's manual tracing in table 1 .
the average error on near wall detection ( 0.63 pixel or 0.067 mm ) is larger than the far wall detection ( 0.55 pixel or 0.058 mm ) .
this is because the near wall is in general vaguer than the far wall , especially in the systolic cycle .
the intima detection is in general easier than the adventitia detection if there is a plaque .
in thin or thick imt cases the difference is not significant .
in order to test our system , we analyzed more patients' image sequences ( s4 - s7 ) and calculated the unsigned ( absolute error ) and signed error .
in this experiment we detect intima on both near and far walls .
this is because we want to analyze the artery 's lumen diameter change with respect to time during the heart cycle .
the unsigned ( equation 8a ) and signed ( equation 8b ) error in j - th frame , similar to the equation in section 3.6 , are calculated using the equations : ( 8a ) ej = 1nsumi = 1n | yautomatic ( i ) - ymanual ( i )| ( 8b ) e ^ j = 1nsumi = 1n ( yautomatic ( i ) - ymanual ( i )) where yautomatic ( i ) and ymanual ( i ) denote the i - th y - coordinate of automatic result and manual drawing .
however , n is limited to 10 points in each image because the manual drawing is a tremendous human work .
the averaged error in a sequence is calculated by : eunsigned = 1msumj = 1mej and esigned = 1msumj = 1me ^ j .
( m = 21 ) the results are shown in table 2. from table 2 it is noted that the signed error at the near wall is larger than that for the far wall .
the far wall has almost no bias between the automated results and the manual drawings .
this confirms that the detection on near walls is in general more difficult than the detection on far walls .
figure 14 depicts our manual drawing gui .
the solid lines denote the boundary of the automated analysis .
the dashed lines denote where the expert should give their judgment on the lumen - intima interface .
manual drawing involves a tremendous amount of human work .
although we are not able to provide many manual drawings for comparison , however , the automated results were controlled visually by experts and all results are similar to those shown in tables 1 and 2 .
the system is built on the matlab platform .
some kernel functions are written in c language in order to reduce the computation time .
5. discussion according to our experience , the most difficult part is to detect the intima as well as the adventitia of the near wall .
this is due to the fact that the near wall has a greater moving speed than that on the far wall during the systolic and diastolic cycle .
the dynamic analysis of the imt and lumen of the artery faces problems which do not occur with static images .
the static image is a single shot providing a clear view of the intima - lumen and adventitia - media interfaces .
during the heart cycle the near wall usually moves more than 1 mm and might thus be associated with the blurring of the im layers .
this usually affects the intima - lumen interface more than the adventitia - medial interface due to the lower echogeneity of the intima .
in cca near walls with a thinner imt this problem might also happen in the adventitia , as shown in figure 10 .
however , the tracing error is relatively low compared with the overall movement of the artery .
notably , the accuracy of the detection on intimal layer does not show significant difference between the cases which have or have not plaque .
therefore , the existence of plaque does not affect the accuracy in calculation of the lumen diameter .
the artery adventitia is difficult to recognize if a plaque exists .
for instance , the formation of a vulnerable plaque might be due to a severe microbial invasion .
the microbial products and autoantibodies stick to the lipoproteins , which aggregate and obstruct the capillary lumen , leading to local ischemia and inflammation [ 19 ] .
this may result in a blurred boundary between media and adventitia .
this might be one of the reasons that the accuracy of automated identification on adventitia in the sequence s1 is worse than the other two sequences ( table 1 ) .
precise plaque detection is a prerequisite for the calculation of total plaque area .
for automatic detection , noises within a plaque do seriously disturb the tracing process .
the main contributions of this study are : ( 1 ) we propose a scheme which is able to detect the near and far wall intima and adventitia with and without plaque ; ( 2 ) we solve the ambiguity problem caused by artery movement .
these are the two major problems in the artery wall dynamic analysis in the b - mode rf sensors .
dynamic analysis of the artery lumen area might be a direct way to measure the local compliance and distensibility of the common carotid artery .
due to the heterogeneity of the arterial wall , the measurement at a single line - - as it is in traditional m - mode imaging - - may not be representative for the elastic properties of the arterial across a segment .
the measurement of imt as well as the ld in b - mode image series might 1 .
be more representative and 2 .
offer the opportunity to show differences within a certain segment which stand for different atherosclerotic processes .
this may not be true for the plaque .
however , to show changes of plaque thickness over time might be an indicator for vulnerability of the plaque , which is of significant clinical importance with respect to future cardio - vascular events .
6. conclusions a new method of analyzing imt on both near and far wall of cca in dynamic b - mode sonographic image sequences is proposed .
this method is able to detect thin or thick imt , with or without plaques .
we have tested three image sequences and all results are compared to the manual tracing made by two experts .
we have compared this method with the previous study and the results show that this method has better performance .
the average error is of a sub - pixel level , i.e. , 0.55 pixel ( 0.0583 mm ) for the far wall and 0.63 pixel ( 0.0668 mm ) for the near wall detection .
this work was supported by the national science council ( nsc ) , taiwan , under grant nsc 99 - 2221 - e - 039 - 012 .
references 1 .
bonithon - kopp c scarabin py taquet a touboul pj malmejac a guize l risk factors for early carotid atherosclerosis in middle - aged french women arterioscler thromb 1991 11 966 972 2065047 2 .
o'leary d polak j kronmal r manolio t burke g wolfson sj carotid - artery intima and media thickness as a risk factor for myocardial infarction and stroke in older adults n engl j med 1999 340 14 22 9878640 3 .
bots ml grobbee de hofman a witteman jc common carotid intima - media thickness and risk of acute myocardial infarction : the role of lumen diameter stroke 2005 36 762 767 15746451 4 .
teravest e stalenhoef afh graaf jd what is the role of non - invasive measurements of atherosclerosis in individual cardiovascular risk prediction clin sci 2007 112 507 516 17419684 5 .
vemmos kn tsivgoulisb g spengosb k papamichaela cm zakopoulosa n daffertshoferc m lekakisa jp mavrikakis m common carotid artery intima - media thickness in patients with brain infarction and intracerebral haemorrhage cerebrovasc dis 2004 17 280 286 15026610 6 .
kanai h hasegawa h ichiki m tezuka f koiwa y elasticity imaging of atheroma with transcutaneous ultrasound : preliminary study circulation 2003 107 3018 3021 12810617 7 .
cheng dc jiang x detections of arterial wall in sonographic artery images using dual dynamic programming ieee trans inf technol biomed 2008 12 792 799 19000960 8 .
gustavsson t liang q wendelhag i wikstrand j a dynamic programming procedure for automated ultrasonicmeasurement of the carotid artery proceedings of the ieee , computers in cardiologybethesda , md , usa 1994 297 300 9 .
gariepy j massonneau m levenson j heudes d simon a evidence for in vivo carotid and femoral wall thickening in human hypertension .
groupe de prevention cardio - vasculaire en medecine du travail hypertension 1993 22 111 118 8319987 10 .
cardinal m - hr meunier j soulez g maurice rl therasse e cloutier g intravascular ultrasound image segmentation : a three - dimensional fast - marching method based on gray level distributions ieee trans med imaging 2006 25 590 601 16689263 11 .
liang q wendelhag i wikstrand j gustavsson t a multiscale dynamic programming procedure for boundary detection in ultrasonic artery images ieee trans med imaging 2000 19 127 142 10784284 12 .
selzer rh hodis hn kwong - fu h mack wj lee pl liu cr liu ch evaluation of computerized edge tracking for quantifying intima - media thickness of the common carotid artery from b - mode ultrasound images atherosclerosis 1994 111 1 11 7840805 13 .
touboul pj prati p scarabin py adrai v thibout e ducimetiere p use of monitoring software to improve the measurement of carotid wall thickness by b - mode imaging j hypertens suppl 1992 10 s37 41 1403232 14 .
cheng dc schmidt - trucksaess a cheng ks burkhardt h using snakes to detect the intimal and adventitial layers of the common carotid artery wall in sonographic images comput meth programs biomed 2002 67 27 37 15 .
paini a boutouyrie p calvet d tropeano a - i laloux b laurent s carotid and aortic stiffness : determinants of discrepancies hypertension 2006 47 371 376 16446398 16 .
wada t kodaira k fujishiro k maie k tsukiyama e fukumoto t uchida t yamazaki s correlation of ultrasound - measured common carotid artery stiffness with pathological findings arterioscler thromb 1994 14 479 482 8123655 17 .
cheng dc schmidt - trucksaess a pu q liu sh motion analysis for artery lumen diameter and intima - media thickness of carotid artery on dynamic b - mode sonography trans mass - data anal images signals 2009 1 89 100 18 .
macleod idg comments on techniques for edge detection proc ieee 1972 60 344 19 .
mccully ks the chemical pathology of homocysteine. iv. excitotoxicity , oxidative stress , endothelial dysfunction , and inflammation ann clin lab sci 2009 39 307 320 19667417 figure 1 .
a sub - image from a b - mode sonographic image sequence .
there are plaques on both near and far walls .
( sequence s1 : male , 36 yr old ) .
figure 2 .
a sub - image from a b - mode sonographic image sequence .
this patient has thin imt .
( sequence s2 : male , 56 yr old ) .
figure 3 .
a sub - image from a b - mode sonographic image sequence .
this patient has thick imt .
( sequence s3 : male , 59 yr old ) .
figure 4 .
( a ) original sub - image .
( b ) result made by macleod filter .
there is a noise layer in the sub - intima indicated by arrows .
( c ) result made by the combination of macleod and enhancement filters .
figure 5 .
a sub - image in the near wall .
there are some noises under the intima resulting difficulties in detection .
the oblique arrow indicates the intima and the vertical arrow indicates the outer wall of the ca .
( sequence s2 ) .
figure 6 .
far wall imt detection .
( a ) raw sub - image .
( b ) solid line : automatic detection result .
dash line : manual drawing .
( sequence s1 ) .
figure 7 .
far wall imt detection .
( a ) raw sub - image .
( b ) solid line : automatic detection result .
dash line : manual drawing .
( sequence s2 ) .
figure 8 .
far wall imt detection .
( a ) raw sub - image .
( b ) solid line : automatic detection result .
dash line : manual drawing .
( sequence s3 ) .
figure 9 .
there is a plaque on the right - hand side .
the left - hand side has a normal thickness .
solid line : automatic detection result .
dash line : manual drawing .
( sequence s1 ) .
figure 10 .
( a ) sub - image .
( b ) result made by [ 7 ] .
( c ) result of the proposed method .
( sequence s2 ) .
figure 11 .
result superimposed on the raw sub - image .
solid line : automatic detection result .
dash line : manual drawing .
( sequence s3 ) .
figure 12 .
"*" and " o " denote the near wall error distribution of intima and adventitia along image number , respectively .
the total averaged error of the near wall is 0.6 - pixel in sequence s2 .
figure 13 .
"*" and " o " denote the far wall error distribution of intima and adventitia along image number , respectively .
the total averaged error of the far wall is 0.54 - pixel in sequence s2 .
figure 14 .
the gui for manual drawing .
the dash lines denote where the expert should give points .
table 1 .
averaged errors of proposed method comparing to manual drawings .
sequence name near wall ( unit : pixel ) far wall ( unit : pixel ) quantity of images intima adventitia average intima adventitia average s1s2s3average 0.580.600.500.56 0.970.600.540.69 0.780.600.520.63 0.530.600.470.53 0.720.490.470.56 0.630.550.470.55 7811186 1 pixel = 0.106 mm table 2 .
averaged unsigned and signed error .
the comparison between automated result and expert 's manual drawing .
( 1 pixel = 0.106 mm ) .
sequence name averaged unsigned error in pixel : eunsigned averaged signed error in pixel : esigned near wall far wall near wall far wall s4s5s6s7 0.670.830.890.54 0.460.420.400.39 0.230.210.60 - 0.22 0.020.040.05 - 0.02