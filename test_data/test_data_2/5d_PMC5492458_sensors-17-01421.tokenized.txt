sensors ( basel ) sensors ( basel ) sensors sensors ( basel , switzerland ) 1424 - 8220 mdpi 28629142 5492458 10.3390 / s17061421 sensors - 17 - 01421 article a source anonymity - based lightweight secure aodv protocol for fog - based manet fang weidong 12 zhang wuxiong 12 * xiao jinchao 3 yang yang 12 chen wei 4 1 key laboratory of wireless sensor network & communication , shanghai institute of micro - system and information technology , chinese academy of sciences , shanghai 201800 , china ; weidong.fang @ mail.sim.ac.cn ( w.f. ) ; yang.yang @ mail.sim.ac.cn ( y.y . )
2 shanghai research center for wireless communication , shanghai 201210 , china 3 guangzhou shenyang institute of automation , chinese academy of sciences , guangzhou 511458 , china ; xiaojinchao @ sia.cn 4 school of computer science and technology , china university of mining and technology , xuzhou 221116 , china ; chenw @ cumt.edu.cn * correspondence : wuxiong.zhang @ mail.sim.ac.cn ; tel. : + 86 - 21 - 6021 - 3056 ; fax : + 86 - 21 - 6021 - 3000 17 6 2017 6 2017 17 6 1421 30 4 2017 12 6 2017 ( c ) 2017 by the authors .
2017 licensee mdpi , basel , switzerland .
this article is an open access article distributed under the terms and conditions of the creative commons attribution ( cc by ) license ( http :// creativecommons.org / licenses / by / 4.0 /) .
fog - based manet ( mobile ad hoc networks ) is a novel paradigm of a mobile ad hoc network with the advantages of both mobility and fog computing .
meanwhile , as traditional routing protocol , ad hoc on - demand distance vector ( aodv ) routing protocol has been applied widely in fog - based manet .
currently , how to improve the transmission performance and enhance security are the two major aspects in aodv 's research field .
however , the researches on joint energy efficiency and security seem to be seldom considered .
in this paper , we propose a source anonymity - based lightweight secure aodv ( sal - saodv ) routing protocol to meet the above requirements .
in sal - saodv protocol , source anonymous and secure transmitting schemes are proposed and applied .
the scheme involves the following three parts : the source anonymity algorithm is employed to achieve the source node , without being tracked and located ; the improved secure scheme based on the polynomial of crc - 4 is applied to substitute the rsa digital signature of saodv and guarantee the data integrity , in addition to reducing the computation and energy consumption ; the random delayed transmitting scheme ( rdtm ) is implemented to separate the check code and transmitted data , and achieve tamper - proof results .
the simulation results show that the comprehensive performance of the proposed sal - saodv is a trade - off of the transmission performance , energy efficiency , and security , and better than aodv and saodv .
mobile ad hoc network fog computing security aodv energy efficiency 1 .
introduction every application and system that is managed in a cloud and mobile cloud service is promising for big data processing .
however , centralized cloud computing is unnecessary and inefficient for the management and application in a large - scale mobile ad hoc network .
to relieve the computation and communication burden on mobility management in cloud computing , fog computing can be adopted .
fog computing was firstly proposed by cisco in 2012 [ 1 ] .
it is an extension of the cloud - based internet .
moreover , it is introduced as an intermediate layer between mobile devices and the cloud in order to provide smooth , low - latency service delivery from the cloud to the mobile .
in this paper , we combine a mobile ad hoc network with fog computing , and consider a new paradigm called a fog - based manet , as shown in figure 1 .
generally , manet is called a mobile ad hoc network , which is composed of many organizing mobile nodes or terminals via routing protocol .
what 's more , the ad hoc on - demand distance vector ( aodv ) protocol is just a typical routing protocol .
different from the clustered network , the mobile or fixed node can autonomously connect with the fog node , or construct a self - organizing , wireless , multi - hop , peer - to - peer , and dynamic mobile network , in which each node can act as a source node , a forwarding node , or a sink node .
each node is mobile , and can communicate with the single - hop node directly with wireless transmission technology .
then , its neighbor nodes decide how to transfer the data to the next hop , repeating this until reaching the fog node .
in the openfog architecture overview white paper for fog - computing , " security implementations have many different descriptions and attributes such as privacy , anonymity , integrity , trust ..." .
to meet and achieve these requirements , the routing protocol in fog - based manet aims at establishing high efficiency routing and transmitting information between nodes quickly .
if any incorrect routing information is inserted into the network , or any routing information is tampered maliciously , the route will be misled , causing the whole network to become paralyzed .
hence , the security of the routing protocol is very important for the whole network .
however , due to the characteristics of channel openness , dynamic topology , the lack of central authorization , distributed cooperation , and limited network capability , the traditional information security technologies that involve encryption [ 2 ] , trust management [ 3 ] , authentication [ 4 ] , and secure network coding [ 5 ] are difficult to employ for solving the security issues of routing protocol directly and effectively .
as a traditional on - demand routing protocol in manet , aodv ( ad hoc on - demand distance vector ) routing protocol also faces the same security issue .
this is because aodv builds on the fact that all nodes trust each other , and does not take any security into consideration [ 6 ] .
although some secure algorithms have been proposed to improve the aodv security , they pay little attention to the impact on transmission performance and energy efficiency .
furthermore , the anonymity is not considered for the source node in aodv .
an attacker can explore and locate the source node by using traffic analysis .
in this paper , a source anonymity - based lightweight secure aodv routing protocol ( sal - saodv ) is proposed to meet the above requirements , which involves defending against attacks and achieving energy efficiency in manet .
the rest of this paper is organized as follows : in section 2 , the related works are highlighted in aodv and its evolution .
some preliminary knowledge and a security analysis are represented in section 3 .
the sal - saodv protocol is proposed , simulated , and analyzed in section 4 .
finally , some concluding remarks are given in section 5 .
2. related works in this section , some of the research conducted so far related to aodv is introduced , which helps to build and support this paper .
currently , these researches are divided into two categories : one is focused on enhancing its security ; the other is improving its performances ( e.g. , reliability , transmission performance under a dynamic topology ) .
2.1 .
enhancing security since the secure transmission does not take account of the design of the aodv protocol , the way in which we can solve the increasing number of security issues becomes very important .
at present , many secure schemes and algorithms have been researched for aodv protocol .
these schemes and algorithms mainly focus on detecting , defending , or mitigating against specific attacks , including the sinkhole attack , the blackhole attack , and the sybil attack .
ranjan summarized the security issues of manet , especially under the blackhole attack [ 7 ] .
the non - secure boundaries of the manet made it vulnerable to various threats like information leakage by eavesdropping or the denial of services ( dos ) attack .
on the other hand , the lack of infrastructure and a central management system in manet made it difficult to detect , defend , and mitigate the different security attacks .
choudhurya et al. put forward a scheme to modify the aodv protocol in order to mitigate the blackhole attack in manet [ 8 ] .
the proposed scheme mainly created a wait time and request reply tab table .
choudhary and tharani demonstrated a timer - based detection approach for identifying a blackhole node [ 9 ] , modified the code of the aodv protocol according to the blackhole attack procedure , and proposed a timer - based method to overhear the next node action in the network layer .
the proposed approach could effectively remove a blackhole node from manet .
bhandare et al. proposed a detection and defense scheme to eliminate the attacker , which carried out a blackhole attack [ 10 ] .
the scheme could check the route reply against a fake reply based on " normal v / s abnormal ( anomaly ) activity " .
siddiqua et al. put forward a secure knowledge algorithm [ 11 ] , which aimed to detect and prevent the blackhole attack in the promiscuous mode .
jain and tokekar proposed a solution to defend against a blackhole attack based on the first rrep caching scheme in aodv protocol [ 12 ] .
this solution could improve the performance in the routing protocol .
throug enhancing the protocol along with the context aware tor ( trusted on - demand routing ) model , hazra and setua proposed a trust computation - based sybil attack avoidance scheme in aodv [ 13 ] .
the tor model involved three major modules : the node manager , the trust module , and the decision manager .
the decision manager secured the routing path on the basis of the trust value , which was computed in the trust module .
the node manager reacted accordingly to aodv in response .
kasiran and mohamad evaluated the throughput performance in aodv under a wormhole attack and sybil attack [ 14 ] , and gave the conclusion that the impact on throughput generated by the sybil attack was greater than the impact of the wormhole attack .
patel et al. proposed an approach to detect the wormhole based on the hash - based compression function ( hcf ) [ 15 ] .
actually , the approach used the secure hash function to compute a value of a hash field for the rreq packet .
in addition , ehsan and khan implemented and analyzed attacks against manet in ns - 2 using aodv routing protocol .
these attacks involved the blackhole attack , the sinkhole attack , the selfish node behavior , the rreq flooding attack , the hello flood attack , and the selective forwarding attack [ 16 ] .
they drew the conclusion that : if the malicious node was on the path from the source node to the destination node , the selective forwarding attack and the selfish node attack could cause a decline in the network performance .
furthermore , if the malicious node was connected to the source and destination , the sinkhole attack and the blackhole attack could severely affect the performance by transmitting false routing information and attracting all the traffic to themselves .
harwahyu et al. presented an analytical model [ 17 ] and estimated the performance of an aodv variant with a trust scheme .
chaubey et al. proposed a trust - based secure on demand routing protocol ( tsdrp ) [ 18 ] , considered the packet delivery fraction ( pdf ) , the average end - to - end delay ( aed ) , the average throughput ( at ) , and the normalized routing load ( nrl ) , and analyzed the impact of the pause time of tsdrp and aodv under the blackhole attack and the dos attack in manet. from the above analysis , almost all of the secure algorithms and secure protocols in aodv have been proposed for efficiently detecting and defending / mitigating against the attacks in many different scenarios .
however , it is regretful that these secure schemes could not defend against tramper attacks .
furthermore , these security technologies seemed to seldom consider the node 's energy consumption .
2.2 .
improving transmission performance as a distance vector routing protocol for manet , aodv protocol permits intermediate nodes to reply , allowing the source node to quickly obtain routing in order to effectively reduce the number of broadcasts .
since nodes only store on - demand routing , this scheme can reduce the memory requirements and unnecessary duplications .
however , because of periodically broadcast packets , a certain energy consumption and network bandwidth have to be considered .
due to the existence of stale routing , aodv protocol requires a relatively long latency to establish routes .
currently , the improvements of transmission performance in aodv mainly involve the following aspects : the energy efficiency , reducing the network congestion , improving the throughput , load balancing , and so on. su and yang proposed resilient aodv ( raodv ) protocol [ 19 ] .
in the route discovery phase , raodv differed from aodv .
raodv protocol established as many routes as possible , whereas aodv only established one routing path from a source node to the destination node .
thus , when the primary route broke , the node could immediately adopt an alternative route without further route search .
if there was no possible alternative route , the node would transmit the route break information backward to instruct the previous node on the reverse route to select an alternative one until an alternative route was found .
the raodv protocol could effectively reduce the number of route rediscovery procedures , the packet loss rate ( plr ) , and the transmission latency , especially in sparse manet .
liu et al. presented an optimized protocol , b - aodv [ 20 ] , to solve the shortage of routing finding and routing repair in aodv protocol .
there were two steps in b - aodv .
firstly , brreq ( b - aodv rreq ) was used to replace of rreq in order to reduce the time of route finding .
secondly , optimizing the two hops record in control messages and route table could improve the rate of routing repair and reduce the time required to find a route .
additionally , it improves the function of the ad hoc network .
hanji and shettar introduced an improved aodv ( i - aodv ) protocol [ 21 ] .
in the i - aodv protocol , the location and energy level of the nodes were considered , and the route discovery area was restricted based on the source and destination location .
the nodes lying in this region were taken into account as route nodes .
one hop communication took place when the two nodes were located in the communicating range of each other .
if the communicating nodes were far away each other , then according to the distance between the selected intermediate node and destination node , the energy for the intermediate nodes was greater than the threshold energy , and the intermediate nodes were re - selected .
this scheme could increase the lifetime of the path .
in addition , apidet et al. evaluated the energy consumption and control response of the aodv protocol in wsans for building - temperature control [ 22 ] .
carolina et al. evaluated and contracted the mac / network / energy performance of mph , aodv , dsr , and ztr routing protocols in wsn [ 23 ] .
for addressing the congestion issue in manet , bala and krishna analyzed the performance of aodv and gpsr ( greedy perimeter stateless routing ) protocols in a vanet in multi - scenarios under different traffic conditions with respect to the packet delivery ratio ( pdr ) and average end - to - end delay ( e2ed ) [ 24 ] .
they found that aodv performed better with respect to pdr and gpsr outperformed aodv with respect to e2ed .
moreover , the performance of both the routing protocols varied from one scenario to another and between traffic types .
the performance of both aodv and gpsr was improved by using ieee 802.11p instead of ieee 802.11 .
in improving the throughput , hamidian proposed an extended aodv ( aodv +) protocol [ 25 ] , which allowed mobile nodes to communicate using the internet .
the aodv + protocol had the ability to establish gateways , which support vehicle - to - infrastructure ( v2i ) communication .
the proposed routing protocol can effectively improve the throughput .
because aodv + protocol only considered how to connect the destination node in the internet or infrastructure network , wantoro and mustika proposed a modified aodv + ( m - aodv +) [ 26 ] to achieve reliable transmission from the mobile source to the destination in vanets .
this protocol involved three parts : communication channel selection , gateway discovery , and infrastructure to infrastructure communication routing .
for load balancing , arya and gandhi presented a node - disjoint aodv ( ndj - aodv ) [ 27 ] routing protocol that identified multiple node - disjoint routes to the destination .
the proposed scheme could be used for load balancing , qos - ( quality of service ) based routing , and more specifically , for performing energy aware routing .
regarding qos , sharma and dimri proposed a routing protocol : aodv with qos ( qaodv ) [ 28 ] .
in qaodv , two additional fields were added to the message of aodv routing protocol in order to improve the performance in terms of pdr , plr , and average e2ed .
many valuable schemes in aodv are proposed to improve the transmission performance , including the energy efficiency , reducing the network congestion , improving the throughput , and load balancing .
just as mentioned above , there are many researches on enhancing the security and improving the performance in aodv .
unfortunately , joint works of the above two aspects are seldom researched .
moreover , we argue that the practical secure - routing - protocol is a tradeoff between security , energy consumption , and transmission performance .
therefore , we will propose a source anonymity - based lightweight secure aodv protocol ( sal - saodv ) in the following sections in order to meet the security requirements of a fog - base manet .
3. preliminary knowledge and analysis 3.1 .
aodv aodv ( ad hoc on demand distance vector ) was published as the experimental rfc of ad hoc network routing protocol by ietf 's manet working group in 2003 .
aodv is an on - demand algorithm .
it draws on the broadcast routing discovery algorithm and routing maintenance scheme with dsr ( dynamic source routing ) .
however , it 's not exactly a source routing protocol .
it 's a large cost protocol because each data packet takes the source routing , so the aodv dynamically establishes a routing table entry by the intermediate nodes .
it also employs dsdv ( destination sequenced distance vector )' s hop - by - hop routing scheme and sequential numbering , and periodically keeps the routing information up - to - date in the route maintenance period .
aodv efficiently avoids generating a loop by effectively using the sequence number of the destination node .
form the on - demand property , we can realise that : ( 1 ) nodes that are not on the route towards the destination node are neither involved in maintaining any routing information nor responsible for any periodical routing information exchange ; ( 2 ) nodes do not need to discover and maintain routes to other nodes unless a communication needs to take place ; ( 3 ) if the mobile nodes need a local connection , they obtain the routing information from the route discovery process .
generally , aodv protocol includes the following five aspects : 3.1.1 .
route discovery in the mobile ad hoc networks ( manet ) , when the source node must send a packet to the destination node , but there is no valid routing message about the destination node in its routing table , the source node starts a route discovery process to establish a route towards the destination node .
therefore , the source node sends its neighbors a route request message ( rreq ) .
the neighbor nodes receive the request and forward it to their neighbors , so that the rreqs are broadcasted using the flooding approach .
each node in manet maintains two counters independently : the broadcast id counter and the node sequence number counter .
the rreq message contains the broadcast id and the source node address , and a rreq message is thus uniquely identified .
a neighbor node receiving a rreq message has three potential roles : ( 1 ) the neighbor node is the destination node .
in this case , the rreq message reaches the destination node and the neighbor node reacts with a route reply ( rrep ) message .
then , the rrep message is sent as a unicast towards the source node , using the path established by the rreq .
this process is similar to what happens with rreq ; ( 2 ) the neighbor node is not the destination node , but the neighbor node knows a route towards the destination .
in this case , the neighbor node generates a rrep message and sends it to the source node , but the source node will deliver the rreq message to the destination node if needed ; ( 3 ) the source node is not the destination node and has no valid route to the destination node .
the source node increases the hop count and forwards the message to its neighbors .
it should be noted that a node may receive multiple rreq messages with the same ip address and broadcast id. thus , when a node receives the rreq message , it first checks whether the rreq message has previously been received , and discards the rreq message if it has .
if a node is not the destination node , it has to take part of the rreq message to set the reverse routing information , so that the other nodes can identify a route ( the " reverse route ") toward the source node .
if a node is not the destination node , it has to track part of the rreq message to set the reverse routing information , so that the other nodes can identify a route ( the " reverse route ") toward the source node .
3.1.2 .
route maintenance each node maintains its own broadcast id counter and sequence number counter .
the sequence number counter is a 32 - bit loop counter , and the nodes need to increment the sequence number count before an operation .
the sequence number represents the new level of a node .
aodv always favors newer information , and the nodes update their routing information , called an update function , if they receive a message with a sequence number higher than the last recorded one for that destination .
after the rreq message is broadcasted from the source node , each intermediate node on the route towards the destination node automatically saves the reverse path back to the source node .
the reverse path will be maintained for a certain time in the routing table , so that the rrep message can return to the source node along it .
3.1.3 .
setting the immediate nodes when an immediate node m receives an rreq message , it inserts the message into the route to the last node or updates the reverse route to the last node .
before m completes either of these actions , it checks whether it has ever received the message .
if it has , m refuses to deal with the rreq message and discards it directly .
in this subroutine routing forward setting , we do not focus on this disorder case .
3.1.4 .
management of the routing table all items in the routing table not only maintain the routing information about the source node , the destination node , the source node sequence number , and the destination node sequence number , but also hold some other routing information that has little relationship to the communication .
this information is called the soft state of the routing .
each routing message maintains a timer , and all routing information expires or becomes invalid after a timeout and is removed from the routing table .
the length of valid time determines the size of the network structure .
3.1.5 .
local connectivity management once a node receives a broadcast form a neighbor node , it calls upon the insert function or the update function to update the local routing table information , so that all of the latest information of the neighbor nodes will be included in the local routing table .
if one node does n't broadcast any information to its neighbor nodes for a long time , it needs to broadcast a hello message to them .
a hello message is a special rrep message , sent by the node initiatively , and contains the broadcast id and sequence number of the node owners .
the hello message only has a ttl ( time to live ) of 1 , which ensures that it is not forwarded by its neighbor node .
in other words , the hello message wo n't be broadcast outside its neighbor range .
nodes that receive the hello message update the connection information with the node that sends it. receiving the hello message from a new node or no longer receiving any message from the original node implies a change in the local network .
the main advantage of aodv is the ability to reduce the routing overhead .
the others are the possibility to use an extension ring search to control the flooding of rreq packets .
in addition , the deployment of the destination sequence number allows nodes to pursue more updated routing .
however , there are several issues worthy of attention in aodv protocol .
firstly , the two - way link and periodic link confirmation are required to detect link damage .
then , it needs to maintain the routing table .
in particular , this flooding scheme might cause some security issues .
furthermore , the flooding attacks generated excessive traffic to the lead to dos in manet .
3.2 .
secure aodv the latest release of the saodv ( secure aodv ) rfc protocol was proposed by manel guerrero zapata in september 2006 [ 29 ] .
saodv is a security extension of the aodv protocol , based on the public key cryptography of rsa .
saodv adds security fields to the extended aodv routing packets , and all of the end nodes and intermediate nodes need to authenticate the grouping , so that the saodv can guarantee the security in the routing discovery process and the route maintaining process .
saodv uses a digital signature and hash chain scheme to protect the routing messages : the digital signature is used to ensure the integrity of non - mutable fields in the routing message , and the hash chain is used to keep the mutable field ( such as the hop count ) from being misrepresented .
3.2.1 .
saodv hash chain the saodv protocol specifies that the intermediate nodes need to complete hash operations in the hash fields in the message and increase the hop count before forwarding the routing message .
in order to send an rreq or rreq message , each node needs to do the following two steps : ( 1 ) randomly generate a hash seed , let the hash fields of the rreq or rrep be the seed , and set the max _ hop of the route so that it is equal to ttl ; ( 2 ) select a hash function h (*) for the hash fields , and complete hash operations on the seed max _ hop times .
after this , we get hmax _ hop , which is then written into the top of the hash fields ( called top _ hash ) .
each node receiving the rreq or the rrep also completes the hash operations max _ hop times on the hash fields by the h (*) in the message , to check if the result is equal to top _ hash ; if equal , it means that the number of hops is not maliciously reduced .
the type of hash , top _ hash , hop , and max _ hop are all defined as natural numbers .
3.2.2 .
saodv digital signature saodv routing messages ( rreq , rrep , rerr ) are digitally signed , in order to guarantee their integrity and authenticity .
except for the hop count and the hash fields , other fields in the message should not be changed in the transfer process .
the node generates a routing message and signs the changeless part with its private key .
the node receives this message and verifies the signature with the sender 's public key .
the type of key and sign are defined as natural numbers .
the signature function and the validation function are expressed as a crypt and decrypt , respectively .
gerri and ghion proposed and implemented an saodv scheme , called a - saodv ( adaptive saodv ) , based on an adaptive scheme , and optimized the performance .
this protocol is intended for multi - threads , including two execution threads .
one is dedicated to cryptographic operations , avoiding the blocking of other message processing .
the other is used to complete all of the other functions , such as routing message processing , saovd routing table management , timeout management , saovd packet generation , and packet forwarding .
a - saodv adopts the adaptive reply decision scheme to optimize the saodv double signature feature .
the intermediate node can determine whether to respond to the rreq message according to its own load state , and it wo n't reply to rrep when it is overburdened with dealing with the routing packet signature or authentication .
a - saodv adopts the adaptive reply decision scheme to optimize the saodv double signature feature .
the intermediate node can determine whether to respond to the rreq message according to its own load state , and it wo n't reply to rrep when it is overburdened with dealing with the routing packet signature or authentication .
a - saodv also optimizes some other processes , except when adopting the adaptive reply decision scheme .
for example , it uses a cache to store the new routing packets that have been signed and authenticated , adapts key ring management , and so on. all these optimizations have played a positive role in improving saodv performance .
however , there are some shortcomings in avoiding the routing group flooding , and reducing the node calculation and signature time .
3.3 .
security analysis as there is no security scheme , aodv may be attacked by malicious nodes , compromised nodes , and selfish nodes .
malicious nodes refer to the nodes for which the attacker could not verify the legality of its own identity because of the lack of effective encryption information ; compromised nodes refer to the nodes for which internal attackers could verify their identity as legal nodes and be trusted by other nodes , and this would launch an offensive within the network ; selfish nodes refer to the nodes that tend to deny their own resources so that the other nodes cannot benefit from them , so as to save their own resources .
aodv does not specify any security measure , effectively assuming that there are no malicious nodes participating in the routing process , but many kinds of attacks are possible .
aodv could be attacked by malicious nodes , compromised nodes , and selfish nodes .
for our analysis , the aodv is vulnerable to the following categories of attacks : tampering attack : malicious nodes tamper with the routing information , causing the destination node to receive the wrong messages .
for example , when a malicious node forwards rreq messages , it falsifies the hop fields in the routing message , so that it has a larger opportunity to be chosen as the active route .
once the attack is successful , the malicious node can make any change on the packets it forwards to achieve a spiteful purpose .
forgery attack : malicious nodes forge routing messages , causing the other nodes to receive the wrong messages .
for example , a malicious node creates fake rrep messages to impersonate a destination node , obtaining the packets that should be sent to the real destination .
routing replay attack : the malicious node sends an obsolete routing message , so that the nodes that receive the message update the related entries in their routing tables .
black hole attack : a malicious node exploits the rreq broadcast scheme and sends a fake rrep message , in which the hop count and destination node sequence number are forged , to claim that it is the destination node or has the best route towards the destination node .
after receiving the rrep message , the source node establishes a route towards the malicious node .
rushing attack : as one type of dos attack , the malicious node exploits the rreq duplicate suppression scheme , sending the rreq message to the destination node before the legitimate node through some special means ( e.g. , using the pre - established tunnels , increasing the transmit power , etc. ) .
then , the legitimate rreq messages later received will be discarded .
in this way , the source node will establish the route , including the malicious nodes , when the data passes through the malicious node , and it can be discarded or changed arbitrarily by the malicious node .
tunneling attack : two malicious nodes collaborate to transmit the routing messages from another node through the tunnel between them , resulting in the illusion of communication links between the two nodes .
thus , the malicious nodes can easily insert the fork routing information into the other node 's routing message , and prevent the other nodes from forming the correct routing information .
the advantage of the saodv protocol is that it can resist the external attacks well .
the source authentication and integrity of the messages are provided by the public key algorithm , and each time the routing message arrives at a hop , it has to be carried through a public key calculation .
as for the public key algorithm , the computational complexity is high and the energy consumption is also large , so the forwarding performance of the routing protocol is badly influenced .
the double signature increases the packet length and the computational complexity of the nodes , and the effect is less important .
in saodv , the rreq message generated by the source node is broadcasted using a flooding approach , and it will always propagate over a certain hop range unless it reaches a node that responds to it. in a complex or bad condition , the rreq will spread in a larger scale , that is , there will be more rreq messages spreading in the network .
as the range of the rreq message propagation increases , the energy consumption of the nodes increases accordingly .
what 's more , the protocol is not perfect in detecting a tunneling attack and defending against a dos attack .
4. source anonymity - based lightweight secure aodv protocol in this section , we propose a source anonymity - based lightweight secure aodv protocol , which involves three parts : a source anonymity algorithm , lightweight tamper - proof scheme , and random delayed transmitting scheme .
then , we simulate and analyze sal - soadv by using ns - 2 .
4.1 .
source anonymity - based lightweight secure aodv protocol 4.1.1 .
source anonymity algorithm in sal - saodv , the pseudonym scheme is that in which the virtual prime ids corresponding to the false ids are generated to hide the nodes' true id with the nodes id. in general , the node 's id of manet is 4 bytes , which ranges from 1 to 4,294,967,296 ( 0 is generally not used ) .
the number of prime numbers within 1 billion is 50,847,534 , which is able to meet the requirement of the pseudonym .
the pseudo - code of the prime queue ( false id queue ) generation algorithm is described in algorithm 1 .
although the number of loops is executed more frequently during the generation of primes , the work only needs to be performed once in this algorithm .
algorithm 1 .
prime queue generation algorithm .
1 : set nodes' maximum number ( nmax ) in manet , initialize the prime queue pi = 0 , set p1 = 2 2 : for ( set counter a = 1 ; a <= nmax ; a = a + 1 ) 3 : for ( set counter b = 2 ; b <= [ a square root ] + 1 ; a = a + 1 ) 4 : if a / b = 0 then 5 : exit this loop 6 : else 7 : pa = b 8 : end if 9 : end for 10 : end for according to the false id queue generated by algorithm 1 , the node can generate a false id for itself .
the false id corresponds to the true id in the false id queue from the prime number sequence in the sequence of prime numbers , which is a single mapping in figure 2 .
the pseudonym is generated by formula ( 1 ) .
( 1 ) pseudonmy = rand ( falseid,falseid + r ) where , rand ( n , n + m ) is a function , which can generate a random number between n and n + m. r is a random number that is updated regularly .
at this point , the false id can be replaced with the generated pseudonym .
the process of index generation can be distributed in the initial stage of the network , by the signaling interaction between the sink node and each node , or by the operation of the node itself .
in addition to the single mapping , the group mapping and block mapping and other tactics can be used to index and generate themselves false ids , or a false id set , and even the encryption can be implemented further .
the specific mapping can be determined according to the actual requirements .
in addition , the false id can also be changed in the network operation process via the signaling interaction .
4.1.2 .
lightweight tamper - proof scheme the rsa digital signature in the saodv protocol guarantees that the data is not tampered with , and the shortest key of the rsa digital signature is 1024 - bit .
its computation and storage for the resource - constraint node are not a small overhead .
in comparison , the deployment of cyclic redundancy check ( crc ) could also achieve a similar functionality - - tamper - proof .
what 's more , the polynomial of crc - 4 is only 5 bits .
meanwhile , the computational complexity of crc is much lower than that of the rsa digital signature .
so , we propose an energy - efficient secure aodv protocol , which could effectively reduce the storage space and energy consumption of saodv protocol , increasing the energy efficiency by using crc instead of a rsa digital signature to test whether the data has been changed. by attaching the gotten crc check code at the back of the next original data and then making a transmission together , the receiver divides the data , and it represents data that has not been tampered with when there is no remainder .
crc is an error detection code , which is usually used for detecting the unexpected data change in storage devices or the internet .
the data uses a crc algorithm to obtain a check code , and this code is attached at the back of the transferred original data .
then , the receiver reuses the same crc algorithm to check whether the data is being changed .
generally , the errors caused by environmental factors such as interference or harasses could use the crc algorithm to effectively detect them in transmission .
however , if the transmitting data and its crc code is artificially manipulated at the same time by malicious nodes , it cannot not be detected whether the data has been tampered with the crc algorithm .
in order to defend against the tamper attack , the polynomials are generated by a pseudorandom .
usually , the polynomial that is generated by the crc algorithm is a fixed pattern , and the malicious nodes could be easy to tamper with the data and its crc simultaneously , while if the pseudorandom polynomials are implemented , it could reduce the possibility of tampering with the data and its crc .
the transmitter and the receiver only need to negotiate and make the using sequence of the polynomial generated by pseudorandom in advance .
in addition , we could introduce the checksum ( chk ) for verifying the crc 's integration .
meanwhile , the checksum ( 1 byte ) is encrypted by sharing the key , and thus the ability to defend against the tamper attack can be enhanced .
4.1.3 .
random delayed transmitting scheme in a sense , the point of using the rsa digital signature and crc is to guarantee the data cannot be tampered with .
although the crc is simple , and its security strength is not as high as ras , when compared with the ras digital signature ( 1024 bytes ) , crc ( 4 bytes ) has certain advantages in the computation and transmitted energy consumption , especially for resource - constrained nodes .
then , how to guarantee the integrity of crc becomes a critical issue .
in this sub - section , we give the random delayed transmitting scheme to solve the above problem , and use a checksum for the crc code to guarantee its integrity to a certain extent .
in order to illustrate the proposed algorithm , the notations we have introduced and will introduce later are summarized in table 1 .
briefly , the proposed scheme mainly involves two parts : generating the crc and random delayed transmitting based on given random out - of - order space ( rr ) .
the random out - of - order space ( rr ) is generated by a knuth - durstenfeld shuffle algorithm in fog node , and is described in algorithm 2 .
although the number of loops is executed more frequently during the generation of primes , the work only needs to be performed once in this algorithm .
algorithm 2 .
to shuffle an array a of n elements ( indices 0 ... n - 1 ) .
1 : for i from n - 1 down to 1 do 2 : j < - random integer with 0 <= j <= i 3 : exchange a [ j ] and a [ i ] in the sal - saodv , the structure of a typical data packet is shown in figure 3 .
meanwhile , we claim that intermediate nodes only constitute forward packets .
where , we define rr as a set , which includes the overall sequence randomly aligned 0 to 15 .
in theory , there are 16 possibilities for this permutation .
each aligned sequence has a strong randomness to randomize the order in which each packet matches the check information. by the following formula , a specific out - of - order sequence 's index is obtained .
index = ps mod pd ( 2 ) where , ps is the source node 's false id and pd is the destination node 's false id. these false ids are generated by using algorithm 1 .
a typical example is shown in figure 4 .
4.2 .
simulation and analysis simulation analysis is performed using a network simulator ( ns - 2 ) , which is the most common tool for the simulation of network scenarios and topologies .
we simulated aodv , saodv , and sal - saodv protocol , and made a comparison in terms of energy consumption , throughput , and bpue ( bits - per unit of energy ) .
bpue is a multi - parameter joint evaluation metric based on the transmission distance and modulation level [ 30 ] .
the simulation parameters are shown in table 2 : the energy consumption of the three kinds of protocol is compared in figure 5a .
it can be seen from the diagram that the aodv protocol has the largest energy consumption , and the network energy consumption tends to be constant at about 700 s , which means that most of the nodes witness energy depletion and the network stops working ; the saodv protocol has the minimum energy consumption , and the saodv and sal - saodv deal is still in a rising status in the 800 s , which means that the nodes have residual energy and the network can continue working .
the three protocols' throughputs are compared in figure 5b .
it shows that the aodv 's throughput is bigger than saodv and sal - saodv .
it reaches its maximum at about 700 s , and its throughput is no longer high due to the fact that the network stops working , whereas saodv 's throughput is the minimum .
since aodv has no security schemes , its operating speed is the fastest .
meanwhile , its energy consumption and throughput exhibit the largest values .
instead , the saodv protocol joins the security scheme and is more complicated than the sal - saodv protocol .
therefore , it exhibits the minimum energy consumption and throughput .
the energy consumption and throughput values of the sal - saodv protocol are between the aodv and saodv protocol .
it can be concluded from the figure 5a,b that the sal - saodv protocol can be used to reduce energy consumption by an average of 30 % in terms of saodv when they have the same throughput .
the bpue of the three kinds of protocol is compared in figure 5c .
it can be seen from the diagram that the aodv protocol has the biggest bpue , while saodv displays the minimum ; the bpue of sal - saodv is between that of the aodv and saodv protocol .
it can be seen from figure 5c that the bpue metric is about 55 % higher than that of the saodv protocol when it remains steady .
figure 5a confirmed our viewpoint that the sal - saodv protocol improves the energy efficiency of saodv .
5. conclusions fog - base manet is a special field of an ad hoc network , with the internal architecture continuously extending in different directions based on instrumentation and a private network as basic components .
therefore , its own routing technology may be different from that of the general ad hoc network .
the fog - based manet also produces higher security requirements , in addition to the technical features of highly heterogeneous , mobile characteristics .
therefore , fog - based manet has a higher standard than a traditional ad hoc network in terms of the security architecture , network security technology , secure routing protocol , privacy protection , security management , and guarantee measures .
in this paper , it is proposed that the sal - saodv protocol is combined with fog - based manet application scenarios based on saodv protocol. by using a cyclic redundancy check instead of a digital signature to reduce the saodv 's complexity and improve the energy efficiency of the protocol , the tamper - proof of packets is guaranteed by a random delayed transmitting mechanism .
the simulation results show that the energy consumption is about 35 % lower and bpue is about 60 % higher in the sal - saodv protocol than the saodv protocol .
at the same time , the schemes of increasing the energy efficiency and information tamper - proof could be used in the improvement of other aodv protocols .
it is worth noting that the end - to - end latency will increase due to the random delayed transmitting mechanism .
hence , the sal - saodv protocol is suitable for the scenarios , which are delay - insensitive , but have a high security requirement .
acknowledgments this work is partially supported by the national natural science foundation of china ( 61471346 , u1510115 ) , the national natural science foundation of china ( 61461136003 ) , the shanghai natural science foundation ( 17zr1429100 ) , the science and technology innovation program of shanghai ( 17511105903 ) , the qing lan project , the china postdoctoral science foundation ( 2013t60574 ) , the natural science foundation of qinghai province ( 2016 - zj - 922q ) and the cemee project ( cemee2017k0303b ) .
author contributions the five authors of the paper have extensively participated in all of the paper writing .
weidong fang mainly worked on the researched and proposed sal - aodv .
wuxiong zhang and yang yang revised this paper .
jinchao xiao mainly added to and revised the related works .
wei chen was responsible for simulating the sal - aodv .
furthermore , all of the authors equally contributed to reviewing the manuscript .
conflicts of interest the authors declare no conflict of interest .
references 1 .
ahmed a. bakar k.a. channa m.i. khan a.w. complex iot control system modeling from perspectives of environment perception and information security mob. netw. appl .
2016 21 272 285 10.1007 / s11036 - 016 - 0683 - y 2 .
zhang p. lin c. jiang y. fan y. a lightweight encryption scheme for network - coded mobile ad hoc networks ieee trans .
parallel distrib .
2014 25 2211 2221 10.1109 / tpds.2013.161 3 .
fang w.d. zhang w.x. yang y. yang l. chen w. a resilient trust management scheme for defending against reputation time - varying attacks based on beta distribution sci. china inf. sci. 2017 60 040305 10.1007 / s11432 - 016 - 9028 - 0 4 .
raja g. baskaran s.b.m. ghosal d. padmanabhan j. reduced overhead frequent user authentication in eap - dependent broadband wireless networks mob. netw. appl .
2016 21 523 538 10.1007 / s11036 - 015 - 0642 - z 5 .
fang w. shan l. jia g. ji x. chen s. a low complexity secure network coding in wireless sensor network j. internet technol .
2016 17 905 913 6 .
perkins c.e. royer e.m. ad - hoc on - demand distance vector routing proceedings of the 2nd workshop on mobile computing systems and applications ( wmcsa ) washington , dc , usa25 - 26 february 1999 7 .
ranjan r. singh n.k. singh a. security issues of black hole attacks in manet proceedings of the 2015 international conference on computing , communication & automation ( iccca ) greater noida , india15 - 16 may 2015 8 .
choudhurya d.r. raghab l. marathe n. implementing and improving the performance of aodv by receive reply method and securing it from black hole attack procedia comput. sci. 2015 45 564 570 10.1016 / j.procs.2015.03.109 9 .
choudhary n. tharani l. preventing black hole attack in aodv using timer - based detection scheme proceedings of the 2015 international conference on signal processing and communication engineering systems ( spaces ) guntur , india2 - 3 january 2015 10 .
bhandare a.s. patil s.b. securing manet against co - operative black hole attack and its performance analysis - - a case study proceedings of the 2015 international conference on computing communication control and automation ( iccubea ) pune , india26 - 27 february 2015 11 .
siddiqua a. sridevi k. mohammed a.a.k. preventing black hole attacks in manet using secure knowledge algorithm proceedings of the 2015 international conference on signal processing and communication engineering systems ( spaces ) guntur , india2 - 3 january 2015 12 .
jain a.k. tokekar v. mitigating the effects of black hole attacks on aodv routing protocol in mobile ad - hoc networks proceedings of the 2015 international conference on pervasive computing ( icpc ) pune , india8 - 10 january 2015 13 .
hazra s. setua s.k. sybil attack defending trusted aodv in ad - hoc network proceedings of the 2012 2nd international conference on computer science and network technology ( iccsnt ) changchun , china29 - 31 december 2012 14 .
kasiran z. mohamad j. throughput performance analysis of the wormhole and sybil attack in aodv proceedings of the 2014 fourth international conference on digital information and communication technology and it 's applications ( dictap ) bangkok , thailand6 - 8 may 2014 15 .
patel a. patel n. patel r. defending against wormhole attack in manet proceedings of the ieee 2015 fifth international conference on communication systems and network technologies ( csnt ) gwalior , india4 - 6 april 2015 16 .
ehsan h. khan f.a. malicious aodv : implementation and analysis of routing attacks in manet proceedings of the 2012 ieee 11th international conference on trust , security and privacy in computing and communications ( trustcom ) liverpool , uk25 - 27 june 2012 17 .
harwahyu r. simaremare h. sari r.f. lorenz p. performance estimation of aodv variant with trust scheme proceedings of the 2014 international conference on communications ( icc ) melmaruvathur , india3 - 5 april 2014 18 .
chaubey n. aggarwal a. gandhi s. jani k.a. effect of pause time on aodv and tsdrp routing protocols under black hole attack and dos attacks in manet proceedings of the 2015 2nd international conference on computing for sustainable global development ( indiacom ) new delhi , india11 - 13 march 2015 19 .
su m.y. yang c.w. a resilient routing approach for mobile ad hoc networks proceedings of the 2015 international conference on high performance computing & simulation ( hpcs ) amsterdam , the netherlands20 - 24 july 2015 20 .
liu s. yang y. wang w. research of aodv routing protocol for ad hoc networks1 aasri procedia 2013 5 21 31 10.1016 / j.aasri.2013.10.054 21 .
hanji b.r. shettar r. improved aodv with restricted route discovery area proceedings of the 2015 international conference on computer communication and informatics ( iccci ) coimbatore , india8 - 10 january 2015 22 .
apidet b. wiklom t. chusak l. energy consumption and control response evaluations of aodv routing in wsans for building - temperature control sensors 2013 13 8303 8330 10.3390 / s130708303 23807689 23 .
carolina d .
- v .
- s. carlos m .
- p. aldo o .
- l. mauricio l. giselle m.g .
- t. oscar o. on the mac / network / energy performance evaluation of wireless sensor networks : contrasting mph , aodv , dsr and ztr routing protocols sensors 2014 14 22811 22847 10.3390 / s141222811 25474377 24 .
bala r. krishna c.r. scenario based performance analysis of aodv and gpsr routing protocols in a vanet proceedings of the 2015 ieee international conference on computational intelligence & communication technology ( cict ) ghaziabad , india13 - 14 february 2015 25 .
hamidian a. a study of internet connectivity for mobile ad hoc networks in ns2 master 's thesis lund institute of technology lund , sweden 1 2003 26 .
wantoro j. mustika i.w. m - aodv + : an extension of aodv + routing protocol for supporting vehicle - to - vehicle communication in vehicular ad hoc networks proceedings of the 2014 ieee international conference on communication , networks and satellite ( comnetsat ) dki jakarta , indonesia4 - 5 november 2014 27 .
arya v. gandhi c. ndj - - aodv : node disjoint multipath routing in mobile ad hoc networks based on aodv protocol proceedings of the 2014 seventh international conference on contemporary computing ( ic3 ) noida , india7 - 9 august 2014 28 .
sharma l. dimri p. an improved aodv with qos support in mobile ad - hoc network proceedings of the 2015 2nd international conference on computing for sustainable global development ( indiacom ) new delhi , india11 - 13 march 2015 29 .
zapata m.g. secure ad hoc on - demand distance vector ( saodv ) routing available online : http :// ietfreport.isoc.org / idref / draft - guerrero - manet - saodv /( accessed 7 september 2006 ) 30 .
fang w. shi z. shan l. li f. xiong y. a multi - parameter joint evaluation scheme in energy consumption for wireless sensor networks chin .
high technol. lett .
2015 34 753 759 figure 1 architecture of the fog - based manet .
figure 2 non - consecutive pseudonym single mapping .
figure 3 structure of a typical data packet in sal - saodv protocols .
figure 4 random delayed transmitting scheme .
figure 5 ( a ) energy consumption comparisons , ( b ) throughput comparisons , ( c ) bpue comparisons .
sensors - 17 - 01421 - t001 _ table 1 table 1 summary of notations .
notation definition s _ id source node id d _ id destination node id bsn block sequence number len length of original packet payload payload of packet chk [ bsn ] checknum for crc crc [ bsn ] cyclic redundancy check for original packet p _ buffer transmitting / receiving packets buffer c _ buffer transmitting / receiving crcs buffer tx _ packet transmitted packet ( involved : packet , chk and crc ) rx _ packet received packet ( involved : packet , chk and crc ) sensors - 17 - 01421 - t002 _ table 2 table 2 simulation parameters .
parameter value number of nodes 50 initial energy of nodes ( j ) 2 simulation area ( m2 ) 1000 x 1000 node movement speed ( m / s ) 0 simulation time ( s ) 800 transmission range ( m ) 200 antenna type omni antenna mobility model random way point