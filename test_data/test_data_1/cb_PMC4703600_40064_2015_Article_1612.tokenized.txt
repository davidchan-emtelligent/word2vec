springerplus springerplus springerplus 2193 - 1801 springer international publishing cham 26759756 4703600 1612 10.1186 / s40064 - 015 - 1612 - 4 research color reproduction and processing algorithm based on real - time mapping for endoscopic images khan tareq h .
1 - 306 - 966 - 5474 tareq.khan @ usask.ca mohammed shahed k. shahed.mohammed @ usask.ca imtiaz mohammad s. mohammad.imtiazz @ usask.ca wahid khan a. khan.wahid @ usask.ca department of electrical and computer engineering , university of saskatchewan , saskatoon , sk s7n5a9 canada 6 1 2016 6 1 2016 2016 5 17 27 8 2015 13 12 2015 ( c ) khan et al .
2016 open accessthis article is distributed under the terms of the creative commons attribution 4.0 international license ( http :// creativecommons.org / licenses / by / 4.0 /) , which permits unrestricted use , distribution , and reproduction in any medium , provided you give appropriate credit to the original author ( s ) and the source , provide a link to the creative commons license , and indicate if changes were made .
in this paper , we present a real - time preprocessing algorithm for image enhancement for endoscopic images .
a novel dictionary based color mapping algorithm is used for reproducing the color information from a theme image .
the theme image is selected from a nearby anatomical location .
a database of color endoscopy image for different location is prepared for this purpose .
the color map is dynamic as its contents change with the change of the theme image .
this method is used on low contrast grayscale white light images and raw narrow band images to highlight the vascular and mucosa structures and to colorize the images .
it can also be applied to enhance the tone of color images .
the statistic visual representation and universal image quality measures show that the proposed method can highlight the mucosa structure compared to other methods .
the color similarity has been verified using delta e color difference , structure similarity index , mean structure similarity index and structure and hue similarity .
the color enhancement was measured using color enhancement factor that shows considerable improvements .
the proposed algorithm has low and linear time complexity , which results in higher execution speed than other related works .
keywords color map color reproduction wireless capsule endoscopy endoscopic images enhancement sharpening nsercwedcfiissue - copyright - statement ( c ) the author ( s ) 2016 background cancer is currently the second - leading cause of death in the united states ( siegel et al. 2015 ) .
furthermore , in 2015 cancer in the digestive system may cause the second highest number of fatalities among all sites ( siegel et al. 2015 ) .
endoscopy plays an important role in diagnostic of colon rectum cancer at an early development stage ( hosokawa et al. 2008 ) .
as a result , mortality role for diseases like the stomach cancer , colon cancer , and ulcerative colitis has been drastically decreased in the recent years ( stock et al. 2011 ) .
in addition , the ability to capture digital pictures has paved the way for the new field of computer - aided decision support system ( cadss ) in medical endoscopy ( liedlgruber and andreas 2011 ) .
these systems focus on aiding in different decision making from endoscopic images such as assessment of different diseases ( kumar et al. 2012 ; cong et al. 2014 ) , bleeding detection ( sainju et al. 2014 ) and frame of interest extraction ( li et al. 2014 ) .
in both cases for diagnosis by physician or cadss , image quality plays a critical role .
wireless capsule endoscopy ( wce ) , as an alternative to the wired endoscopy , offers physicians the capability of examining the interior of the small intestine with a noninvasive procedure ( brownsey and michalek 2010 ) .
in wce , a battery powered camera is placed in a capsule .
when the patient swallows this capsule , it send picture continuously from the gastrointestinal tract ( gi ) .
due to its limited power consumption , the wce suffers from low image quality ( nakayoshi et al. 2004 ) .
even a high - definition white light endoscopy cannot always detect all mucosal or vascular abnormalities of different positions of gi tract .
in both cases for wireless and wired endoscopy , improved image quality can greatly increase early detection and reduce the miss rates of the detection of the mucosal or vascular abnormalities ( liedlgruber and andreas 2011 ) .
there are both pre - processing and post - processing methods that can significantly enhance mucosal or vascular characteristics in endoscopic images .
pre - processing systems like narrow band imaging ( nbi ) and auto - fluorescence imaging ( afi ) use rotating filters in front of the light source sequentially generating red , blue and green light for tissue illumination ( schmitz - valckenberg et al. 2008 ; pohl et al. 2007 ) .
special light sources and filters are utilized to enhance the mucosal structure in the resultant images in nbi and afi at a cost of higher hardware complexity and power consumption .
as an alternative , post - processing system such as virtual chromoendoscopy ( ce ) decomposes the image into various wavelengths and produces pseudo color added image with enhanced mucosal surface contrast ( chiu et al. 2007 ) .
several researchers concluded that nbi appeared to be a less time - consuming and efficient alternative to ce for the detection of neoplasia .
however , nbi has a higher miss rate than ce ( khan and wahid 2011 ; nass and connolly 2010 ) .
additionally , neither nbi nor ce can improve the adenoma detection or reduce miss rates during screening colonoscopy .
as found in works in ( nass and connolly 2010 ) and ( khan and wahid 2011 ) , nbi and ce showed no difference in terms of diagnostic efficacy .
based on the success of ce , several researchers proposed post processing enhancement method for endoscopic image .
for example , okuhata et al. has proposed a real - time enhancement procedure based on retinex theory ( okuhata et al. 2013 ) and vogt et al. has proposed real time endoscopic image enhancement scheme based on color normalization ( vogt et al. 2003 ) .
in image processing in general , a well - known procedure for image enhancement is to enhance the luminance channel only while keeping the chrominance channel unchanged ( gonzalez and woods 2002 ) .
due to psycho - visual redundancy , human eyes are more sensitive to the enhancement of brightness than color .
there are a several well - known methods available for enhancing the grayscale image , which can be broadly divided into two categories .
techniques such as contrast stretching ( cs ) ( wang and bovik 2002 ) , high boost filtering ( hbf ) ( srivastava et al. 2009 ) and unsharp masking ( um ) ( polesel et al. 2000 ) work on the local gradient of the image .
on the other hand , techniques such as histogram equalization ( he ) , contrast limited adaptive histogram equalization ( clahe ) ( zuiderveld 1994 ) and brightness preserving dynamic fuzzy histogram ( bpdfhe ) ( sheet et al. 2010 ) work on the global gradient of the image .
the global gradient methods are effective for the low contrast images that contain a single object or no apparent contrast change between object and background ( cheng and shi 2004 ) .
on the other hand , the psycho - visual redundancy can be utilized to reduce the power consumption in endoscopy .
this phenomenon is often utilized in image compression by sending only the grayscale image or the brightness channel .
the grayscale image is later colorized using a similar tone theme images , which results in a significant save of power , memory , and bandwidth ( khan et al. 2015 ) .
there are several color reproduction algorithms available in the literature .
in ( welsh et al. 2002 ) , color information is retrieved from a target swatch .
each pixel in the grayscale image is matched with the pixel in the target swatch based on euclidean distance metrics .
the color is then copied from the matched pixel in the target swatch .
this algorithm suffers from high computational complexities and processing time .
in another work ( horiuchi and hirano 2003 ) , the authors have used a set of seed points and their respective color vectors in the rgb format with a yuv - based classification .
in ( levin et al. 2004 ) , a quadratic objective function based optimization method is used to interpolate the u and v components of the yuv color space over the entire image using a set of color scribble lines .
in ( korostyshevskiy 2006 ) , pseudo colors are employed to colorize the grayscale image using different 64 x 3 color matrices .
it does not reproduce a visually appealing color on the entire image and introduces blurriness on the high contrast edges .
none of those mentioned above methods has ever been applied to endoscopic imaging .
in a recent work by our group , a color enhancement scheme is presented that is dedicated to enhance endoscopic images ( imtiaz et al. 2013 and imtiaz and khan 2014 ) .
although this color enhancement scheme is very promising in terms of the color enhancement factor ( cef ) , it suffers from high algorithm complexities .
in this paper , we propose a dictionary based color reproduction method with low complexities , high color similarity and high cef .
this method enhances the visual quality of gi images .
we have also shown three possible scenarios in endoscopy where the proposed method is applicable .
the performance of the proposed method is assessed on a relatively diverse dataset based on the reduction of image degradation , structural similarity , and cef .
proposed method the proposed method has two steps as shown in fig. 1. at first , the grayscale images are enhanced by histogram shifting and image sharpening .
this results in a high contrast image with better visibility of the mucosa layer .
in the second step , the grayscale image is colorized using a theme image , taken from nearby anatomical location , by utilizing a dictionary based color reproduction method. fig. 1 flowchart of the proposed color image reproduction technique enhancement stage endoscopic images have the intrinsic characteristics of low contrast and inhomogeneous brightness , which stems from the random steering motion of the camera and bending and waving nature of the gastric organs ( vogt et al. 2003 ) .
the goal in enhancement stage is to increase the contrast and reduce the inhomogeneous brightness .
the enhancement stage works on the grayscale channel of the image .
at first , the input color image p is converted to a grayscale image , y , using eq .
( 1 ) : 1 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ y = \ frac { r }{ 4 } + \ frac { g }{ 2 } + \ frac { b }{ 4 } $$\ end { document } y = r4 + g2 + b4 here r , g , and b represent the intensity of red , green and blue channel of the rgb color image respectively using eq .
( 1 ) , which uses division by a power of two , so it can be very easily implemented using a shift register .
this type of implementation results in a simpler hardware implementation than other conversion methods .
on the other hand , for a gray scale image : 2 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ y = p $$\ end { document } y = p to reduce the over exposure effect , we have analyzed several images of nbi , afi , and virtual ce systems and found that the histogram of these images has more content in low regions .
the results are shown in fig. 2. as a result , at this stage of our method , we adjust the histogram by shifting it to the left using eq ( 3 ) .
here ymin is the minimum intensity level in y. fig. 2 ( a , b ) gray - scale endoscopic image and its histogram ; ( c , d ) nbi image and its histogram ; ( e , f ) afi image and its histogram ; ( g , h ) virtual ce image and its histogram ; ( i , j ) histogram shifted image of a and its new histogram 3 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ y ^{ h } = y - y _{ min } $$\ end { document } yh = y - ymin this shifting produces a darkening effect that improves the visibility of mucosa layer .
all processed images have a dominance of low - intensity pixel compare to the white lighting image ( wli ) .
the second step in the enhancement stage consist of a modified um. first the vein or the mucosa layer are extracted from the image using eq .
( 4 ) .
here g ( yh ) indicates the blurred image created by convoluting the image with gaussian filter .
4 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ \ delta y = y ^{ h } - g ( y ^{ h } ) $$\ end { document } deltay = yh - g ( yh ) then the sharpened image is produced by eq .
( 5 ) .
5 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ y ^{ eh } = y ^{ h } + \ lambda \ delta y $$\ end { document } yeh = yh + lambdadeltay here lambda is the sharpening factor .
sharpening factor controls the amount of sharpening in the resulting image .
higher the value of sharpening factor , more enhancements can be achieved .
but with very high value of lambda , the noise presented in the edge image , produced by eq .
( 4 ) , gets magnified .
as a result , image artifacts and ringing effect would be introduced in the resultant image .
in fig. 3 , images sharpened using different sharpening factor , lambda , are shown .
here , we can observe that the increment of sharpening factor is eventually increasing the visibility of mucosa structure in the gray endoscopic image .
the specific sharpening factor for each figure is given with the figure. fig. 3 sharpened image having different value of lambda from the experiment it has been found the values of sharpening factor in the range 2 - 8 provide the best result .
proposed color reproduction algorithm at this stage , color is added to the generated enhanced grayscale image to produce a colorized image .
the color information is retrieved using the available color image of the nearby anatomical location .
then using the color similarity between the theme image and the grayscale image , the algorithm reproduces the color of the enhanced grayscale image .
we have prepared a database of color wce pictures taken from ( gastrolab - - the gastrointestinal site 1996 ; atlas of gastrointestinal endoscopy 1996 ) for different locations of the gi tract from where a theme image is chosen manually .
this part of the algorithm consists of two steps .
color map generation and color reproduction .
color map generation the color map , z , is a lookup table that maps luminance components to corresponding color components , providing the r , g , b value for a pixel with a particular value of luminance y. the generated color map is dynamic in nature as they change when a new theme image is chosen .
color map is expressed as below : 6 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ z : y \ to \{ r,g,b \} $$\ end { document } z : y - - >{ r,g,b } first a color map is generated from a theme image t. each color pixel is converted to luminance , y using eq .
( 1 ) .
then the corresponding r , g and b values are listed in a color map lookup table .
since there is no one to one correspondence between y and r , g , b , there may be multiple combinations of r , g , b with a same value of y. in these cases , the mean values of r , g , b are taken .
for an example , rgb triplet ( 32 , 16 , 8 ) and ( 0 , 28 , 0 ) both will produce the same y value 14 .
in this case , in the lookup table the average of these combinations , that is ( 16 , 22 , 4 ) , will be saved for y = 14 .
these may produce color artifacts in the colorized image .
however , since , for an anatomically nearby location image , the correlation between the color and luminance would be very high , the trend between the luminance and color of the theme image would provide sufficient information about the color for the enhanced grayscale image .
after completing the table , there might be some empty slots in the color map table if all y values from 0 to 255 are not generated from the image pixels .
the empty slots are filled by linear interpolation between two nearest neighboring entries .
for instance , if there are some consecutive empty slots from row m to row m + d in the lookup table , the empty slots entries are calculated using eq .
( 7 ) , where x represents r , g , b and i range from 0 to d .
7 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ x _{ m +\ , i } = x _{ m - 1 } + \ frac {{ x _{ m - 1 } - x _{ m +\ , d + 1 } }}{ d + 2 } \ times \ left ( { i + 1 } \ right ) $$\ end { document } xm + i = xm - 1 + xm - 1 - xm + d + 1d + 2xi + 1 the first and last entry of the table is kept fixed presenting full black ( 0 , 0 , 0 ) and full white ( 255 , 255 , 255 ) namely .
a pseudo code for color map generation is shown in fig. 4. figure 5 shows a theme image and the corresponding plot of the color map generated using the proposed scheme .
after interpolation , the generated color map shows a lot of ripple which can introduce color artifacts later in the colorized image .
to remove this ripple , a smoothing function is applied to the generated color map. fig. 4 pseudo code for color map generation fig. 5 color map generation procedure , a a theme endoscopy image ( t ) at gastric corpus location ; b plot of the color map without interpolation ; c plot of the color map with interpolation ; d plot of the color map with interpolation and smoothing the optimum smoothing function was determined by calculating the difference between the original grayscale image and grayscale image regenerated from the colorized image using the generated color map .
table 1 shows the result. from the result , we conclude that linear local regression with span 19 provides the best outcome in this case .
in the future in this paper , wherever it is not specified , linear local regression with span 19 was used .
table 1 psnr measures ( in db ) with different smoothing function applied to the color table span 5 9 15 19 smoothing function moving average 51.07 51.42 51.50 51.16 linear local regression 51.27 51.18 51.14 52.06 quadratic local regression 51.11 51.94 51.50 51.22 savitzky - golay 50.46 51.16 51.22 50.91 robust linear local regression 51.26 49.29 49.43 49.53 robust quadratic local regression 48.82 49.85 49.40 49.16 applying the color map after the new color map has been generated , the enhanced grayscale image is colorized using the lookup table .
for each pixel , the r , g and b values are looked up from z , using the luminance value of that pixel .
for example , if a pixel has a luminance value of 100 , the corresponding r , g and b value in the lookup table would be the color value for that pixel .
in this way , the output colored image , o , is produced .
8 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ z :\ forall y \ in eh \ to \ left \{ { r,g,b \} } \ right .
= o $$\ end { document } z : for - allyineh - - > r,g,b }= o experimental results this section illustrates possible applications where the proposed method is applied .
they are divided into three categories and discussed below .
for these experiments , several images and videos were collected from the gastrolab ( gastrolab - - the gastrointestinal site 1996 ; atlas of gastrointestinal endoscopy 1996 ) database .
in addition , we have prepared and used a database of 100 theme images taken from 20 different anatomical locations of human gi tract ( see fig. 6 ) .
the theme images were taken manually from nearby anatomical location for the experiments. fig. 6 position of gi track category 1 : low contrast wli images firstly , we have used several wli grayscale image whose color information was absent .
wli images generally suffer from low contrast as evident from the input original images in fig. 7. the proposed algorithm can improve the visual quality of the system by enhancing the mucosa layer and retrieving color information from a theme image taken from a nearby anatomical location .
the results are shown in fig. 7. it can be seen that , although the input original images and the corresponding theme images have a different structure , the reproduced color images have a very similar color tone to the theme image .
on the other hand , the sharpening introduced in the preprocessing stage increases the contrast and make the subtle features more visible ( compare the input original image with preprocessed grayscale image ) .
two conclusion can be drawn from this experiment .
firstly , the proposed method can be used for colorizing and enhancing grayscale wli image for which color information is unavailable .
secondly , since color information is not required , it can be omitted from transmission of wli image , resulting in a more simple capture device , lower transmission power and lower bandwidth requirement .
the grayscale image can be later colorized using the proposed method and the database of theme image for different gi location. fig. 7 category 1 : preprocessing and color reproduction of grayscale wli images category 2 : raw nbi images in nbi images , special lighting is utilized to enhance the mucosa layer .
lights of 415 and 540 nm wavelengths are used to illuminate the mucosa surface ; the reflected light from the mucosa is captured in a monochromic ccd image sensor ( dung and wu 2010 ) .
the grayscale images from the ccd image sensor are then passed to an image processor where pseudo color is added to the images ( evis lucera spectrum family brochure ( online ) 2014 ) .
the proposed method can be utilized in two ways .
it can directly colorize the raw nbi image and also provide greater enhancement .
on the other hand , it may replace the color transformation system by colorizing the nbi image using the wli image as the theme image .
we used the method to colorize several raw nbi images , and the results are shown in fig. 8. it can be seen from the figure that the output images have better visibility of the mucosa layer than the input raw nbi images .
if we compare the corresponding original nbi image , the structures are better defined in our method due to image preprocessing provided by the proposed method. fig. 8 category2 : preprocessing and color reproduction of grayscale nbi images category 3 : tone enhancement in ce systems , such as i - scan technology , it has been shown that mapping tone of a wli image into a different color map can improve the visibility of the lesion and mucosal layer ( kodashima and fujishiro 2010 ) .
in this experiment , we want to demonstrate the flexibility of the proposed method in providing similar type of tone enhancement .
firstly , tone mapping model can be applied directly to the color map produced from the theme image .
for example , te - g ( kodashima and fujishiro 2010 ) tone mapping is applied to the color map of the theme image shown in fig. 9. the resultant color map is then used for colorizing the wli image , and a tone enhanced image similar to image produced by i - scan te - g is produced. by comparison to the wli image , tone enhanced image has more crisp mucosa structure due to image sharpening in the preprocessing step .
the tone enhancement further improve the visibility of the mucosa structure. fig. 9 category 3 : tone enhanced color reproduction in the second case , a tone enhanced endoscopic image can be used as a theme image to transfer its characteristics to the wli images .
for example , in the second image in fig. 9 , a tone enhanced theme image from a nearby anatomical location is used to reproduce the color of the original wli image .
the output image showed more enhanced mucosal structure than the original image .
in both cases , we have applied the te - g tone enhancement proposed by i - scan ( kodashima and fujishiro 2010 ) .
performance analysis in this section , experiments are conducted to prove the validity of the proposed method in the enhancement of the mucosal structure and color reproduction .
altogether 178 images with different physiological characteristics , taken from gastrolab ( gastrolab - - the gastrointestinal site 1996 ) and atlas ( atlas of gastrointestinal endoscopy 1996 ) databases , were used for the purpose of comparison .
for theme images , we have used the database of 100 wli images taken from 20 different location in gi tract .
there was no overlapping between these two database meaning that the images used for experimentation were different than the images used for color theme image .
the sharpening factor used for different pictures are specified in the figure .
both objective and the subjective evaluation were considered as performance metrics .
the objective method evaluated the enhancement , quality of the images and similarity between the original and colorized images .
on the other hand , the quality of the proposed method in mucosal structure enhancement has been verified visually by conducting a survey among gastroenterologists .
reducing the effect of over lighting and low contrast image in capsule endoscopy suffers from inhomogeneous lighting and low contrast .
in a recent study , sdiri et al. has shown that the contrast enhancement improved the stereo matching performance and classification results ( sdiri et al. 2015 ) .
to measure the performance of the proposed method in contrast enhancement , statistics of visual representation ( svr ) ( balas et al. 2009 ; jawahar and ray 1996 ) was used .
svr compares the contrast and intensity of the original image and enhanced image .
high contrast measurement means that the resultant image has higher contrast than the original image .
similarly , high intensity measurement indicates that the processed image has a higher average intensity than the original image .
in addition , to evaluate the image quality , universal image quality ( uiq ) ( wang and bovik 2002 ) was used .
uiq is a mathematically defined parameter that evaluates the image quality on three factors : loss of correlation , luminance distortion and contrast distortion .
uiq value closer to + 1 indicates good quality while value closer to - 1 indicates bad quality .
the proposed method was compared with other enhancement methods in terms of svr and uiq in table 2 .
here the average value was shown for a database of 178 images .
table 2 shows that the proposed method can increase the overall contrast level in an image compared to other methods , but at the same time can decrease the overall intensity level .
thus , statistically it can be stated that this method will provide an image with higher contrast and darker tone .
the result also showed that the proposed method provides the highest quality image in terms of uiq value .
table 2 svr measures with other related works contrast measurement intensity measurement universal image quality index proposed method ( 178 images ) 1.3711 - 0.22901 0.9241 adaptive histogram equalization ( ahe ) 0.2393 0.08304 0.5722 contrast stretching ( cs ) 0.7022 0.14686 0.9244 high boost filtering ( hbf ) - 0.0033 0.00049 0.2633 unsharp masking ( um ) 0.03975 0.00002 0.9528 in fig. 10 , a visual comparison of the algorithms is shown for a sample image taken from the database .
as evident from the figure , the proposed method increases the contrast level as well as sharpens the subtle details. fig. 10 visual representation of color enhancement of different algorithms color similarity test and color enhancement factor ( cef ) in this section , the proposed color reproduction is evaluated in terms of color similarity and color enhancement .
color similarity takes into account the structural similarity between the original image and colorized image .
in this paper , we have used cie94 delta - e color difference ( robertson 1990 ) , structure similarity index ( ssim ) , mean structure similarity index ( mssim ) ( wang et al .
2004 ) and structure and hue similarity ( shsim ) ( shi et al. 2009 ) for evaluating color similarity .
all these parameters provide the difference in color between the original and processed image .
cie94 measures the color differences between processed and original image in lab color space .
in cie94 , value close to 2.3 indicates that the color difference between two images is the lowest .
ssim , mssim and shsim measure the color similarity in the chrominance planes in ycbcr color space .
the indices of these parameters close to 1 indicate higher similarities between two structures and chrominance planes .
the results are compared with other color reproduction methods and presented in table 3 .
we can see that the average ssim , mssim and shsim indices are higher than others , with a color difference close to 2.3 .
all these values indicate that the colorized frames are very close to the original images in terms of structural similarities .
table 3 color similarity and enhancement assessment cie94 ssim mssim shsim cef proposed ( 178 images ) 2.36 0.9996 0.9792 0.9987 1.3322 welsh et al .
4.1 0.9001 0.8605 0.8578 0.7615 korostyshevskiy 0.6 0.8907 0.8714 0.8001 0.8853 imtiaz et al .
3.01 0.9945 0.9967 0.9942 1.1520 okuhata et al .
1.18 0.9922 0.7479 0.9603 0.6840 vogt et al .
4.79 0.9847 0.4078 0.2826 1.0429 the proposed method was also evaluated in terms of the cef .
a no - reference performance metrics called colorfulness metric ( cm ) was used for this purpose ( susstrunk and winkler 2003 ) .
in this paper , we have used the ratios of cms between the processed and original image for observing the cef .
the higher the cef value , the higher the high - frequency components and lesser the color artifacts .
table 3 shows that our method provides the highest cef while keeping a strong structural similarity .
the color enhancement is further evident in the visual comparison of a sample image in fig. 11. fig. 11 visual representation of color enhancement of different color reproduction algorithms algorithm complexity the proposed method has an extremely low complexity that results in very fast execution time .
the time required to generate an enhanced color image from the original image for different image sizes using various methods are shown in table 4 .
all the algorithms were implemented in matlab 2013 platform and the experiments were conducted on a pc having intel ( r ) core ( tm ) i3 - 2310m cpu @ 2.10 ghz and 6 gb of ram .
here , it is noticeable that the proposed method is faster than all other methods except korostyshevskiv 's algorithm .
although the execution time of korostyshevskiv 's algorithm ( korostyshevskiy 2006 ) is lower than ours , the quality of the color reproduction is worse as shown in fig. 11 and table 3 .
table 4 algorithm complexity assessment methodology image size image enhance.time ( sec ) color reprod .
time ( sec ) total time ( sec ) proposed ( 178 images ) 256 x 256 0.06 1.50 1.56 512 x 512 0.21 6.31 6.52 imtiaz et al .
256 x 256 0.39 28.25 28.64 512 x 512 1.52 113.31 114.83 welsh et al .
256 x 256 - 64.46 64.46 512 x 512 - 235.14 235.14 korostyshevskiy 256 x 256 - 0.19 0.19 512 x 512 - 0.47 0.47 okuhata et al .
256 x 256 0.21 - 0.21 512 x 512 1.37 - 1.37 vogt et al .
256 x 256 0.11 - 0.11 512 x 512 0.56 - 0.56 subjective evaluation by gastroenterologists to perform a preliminary subjective evaluation , we have conducted a primitive survey among several professional gastroenterologists .
in the survey , three original and processed image pairs were shown to several gastroenterologists and their opinion was requested on whether they agree with the following statement : " the enhanced image can provide better visibility of the mucosa surface than the original image " .
here , the original image indicates the raw color endoscopic image and enhanced image indicates the processed image using the proposed method .
the results of the survey are summarized in table 5 .
the average mean opinion score ( mos ) ( viera and garrett 2005 ) for all images is 1.17 , which is interpreted as " agree " .
the result indicates that the proposed method can highlight the mucosa structures .
table 5 survey results image # doctor 1s1 doctor 2s2 doctor 3s3 doctor 4s4 mos 1 1 - 1 1 1 0.50 2 1 2 1 2 1.50 3 1 2 1 2 1.50 average mean opinion score ( mos ) 1.17 strongly agree = 2 , agree = 1 , neutral = 0 , disagree = - 1 , strongly disagree = - 2 ; mos = sum ( s1 : s4 )/ 4 conclusions this paper presents a novel dictionary based algorithm for colorizing and enhancing a grayscale endoscopic image .
the color information and the enhancing improve the visual quality of the endoscopic image .
the proposed algorithm generates a dynamic color map from a color theme image .
then the color map is applied to the enhanced grayscale image to produce a color image having a similar color tone of the theme image .
the quality of the generated enhanced color image is evaluated using several standard performance metrics , which showed better performance compared to many existing methods .
this method can be used in enhancing and colorizing low contrast grayscale wli images and as an alternative to the color transformation system for nbi system .
authors' contributions thk , skm , msi and kaw : the work was done by thk , skm and msi and supervised by kaw .
all authors conceived the idea .
the experiments were designed and conducted by thk , skm and msi .
all authors read and approved the final manuscript .
acknowledgements the authors would like to acknowledge grand challenges canada star in global health , natural science and engineering research council of canada ( nserc ) , canada foundation for innovation ( cfi ) and western economic diversification canada for its support to this research work .
the authors also acknowledge the gastroenterologists who took part in the survey .
they are ( in no particular order ) : dr. marco puglia and dr. smita halder from division of gastroenterology , mcmaster university and dr. pierre ellul and dr. mario vassallo from gastroenterology department , mater dei hospital .
competing interests the authors declare that they have no competing interests .
references atlas of gastrointestinal endoscopy 1996 ( online ) .
available : http :// www.endoatlas.com / index.html balas benjamin nakano lisa rosenholtz ruth a summary - statistic representation in peripheral vision explains visual crowding j vis 2009 9 12 1 18 10.1167 / 9.12.13 brownsey a , michalek j ( 2010 ) high definition scopes , narrow band imaging , chromoendoscopy .
in : american society for gastrointestinal endoscopy cheng h shi x a simple and effective histogram equalization approach to image enhancement digit signal process 2004 14 158 170 10.1016 / j.dsp.2003.07.002 chiu h chang c chen c lee y wu m lin j wang h a prospective comparative study of narrow - band imaging , chromoendoscopy , and conventional colonoscopy in the diagnosis of colorectal neoplasia gut 2007 56 3 373 379 10.1136 / gut.2006.099614 17005766 cong y wang s liu j cao j luo j deep sparse feature selection for computer aided endoscopy diagnosis pattern recognit 2014 48 3 907 917 10.1016 / j.patcog.2014.09.010 dung l wu y a wireless narrowband imaging chip for capsule endoscope ieee trans biomed circuits syst 2010 4 6 462 468 10.1109 / tbcas.2010.2079932 23853384 evis lucera spectrum family brochure ( online ) 2014 , available : http :// www.olympus.co.uk / medical / en / medical _ systems / mediacentre / media _ detail _ 7450.jspgastrolab - - the gastrointestinal site 1996 ( online ) .
available : http :// www.gastrolab.net / index.htm gonzalez rc woods re digital image processing 2002 nj prentice hall upper saddle river horiuchi t , hirano s ( 2003 ) colorization algorithm for grayscale image by propagating seed pixels , in proceedings of icip pp 457 - 460 hosokawa o miyanaga t kaizaki y hattori m dohden k ohta k aoyagi h decreased death from gastric cancer by endoscopic screening : association with a population - based cancer registry scand j gastroenterol 2008 43 9 1112 1115 10.1080 / 00365520802085395 18609154 imtiaz ms , khan aw ( 2014 ) a color reproduction method with image enhancement for endoscopic images , in proc .
ieee 2nd middle east conf bio - med engimtiaz ms , khan th , khan aw ( 2013 ) new color image enhancement method for endoscopic images , in proc .
ieee int conf adv elect eng : 263 - 266 jawahar cv ray ak incorporation of gray - level imprecision in representation and processing of digital images pattern recogn lett 1996 17 5 541 546 10.1016 / 0167 - 8655 ( 96 ) 00002 - 5 khan t shrestha r imtiaz ms wahid ka colour - reproduction algorithm for transmitting variable video frames and its application to capsule endoscopy healthc technol lett 2015 2 52 57 10.1049 / htl.2014.0086 26609405 khan th wahid k low complexity color - space for capsule endoscopy image compression iet electron lett 2011 47 22 1217 1218 10.1049 / el.2011.2211 kodashima s fujishiro m novel image - enhanced endoscopy with i - scan technology world j gastroenterol 2010 16 9 1043 10.3748 / wjg.v16.i9.1043 20205272 korostyshevskiy v ( 2006 ) grayscale to rgb converter , ( online ) , 2006 , available : http :// www.mathworks.com / matlabcentral / fileexchange / 13312 - grayscale - to - rgb - converter kumar r zhao q seshamani s mullin g hager g dassopoulos t assessment of crohn 's disease lesions in wireless capsule endoscopy images biomed eng ieee trans 2012 59 2 355 362 10.1109 / tbme.2011.2172438 levin a colorization using optimization acm trans gr ( tog ) 2004 23 689 694 10.1145 / 1015706.1015780 li c hamza ab bouguila n wang x ming f xiao g online redundant image elimination and its application to wireless capsule endoscopy signal image video process 2014 8 8 1497 1506 10.1007 / s11760 - 012 - 0384 - 3 liedlgruber m andreas u computer - aided decision support systems for endoscopy in the gastrointestinal tract : a review ieee rev biomed eng 2011 4 2011 73 88 10.1109 / rbme.2011.2175445 22273792 nakayoshi t tajiri h magnifying endoscopy combined with narrow band imaging system for early gastric cancer : correlation of vascular pattern with histopathology endoscopy 2004 36 12 1080 1084 10.1055 / s - 2004 - 825961 15578298 nass jp connolly se current status of chromoendoscopy and narrow band imaging in colonoscopy clin colon rectal surg 2010 23 1 21 30 10.1055 / s - 0030 - 1247853 21286287 okuhata h , nakamura h , hara s , tsutsui h , onoye t ( 2013 ) application of the real - time retinex image enhancement for endoscopic images , proc eng med biol soc ( embc ) , 35th annu int conf ieee : 3407 - 3410 pohl j may a computed virtual chromoendoscopy : a new tool for enhancing tissue surface structures endoscopy 2007 39 1 80 83 10.1055 / s - 2006 - 945045 17252465 polesel a ramponi g mathews vj image enhancement via adaptive unsharp masking ieee trans image process 2000 9 505 510 10.1109 / 83.826787 18255421 robertson ar incorporation of gray - level imprecision in representation and processing of digital images color res appl 1990 15 3 167 170 10.1002 / col.5080150308 sainju s bui fm wahid ka automated bleeding detection in capsule endoscopy videos using statistical features and region growing j med syst 2014 38 4 1 11 10.1007 / s10916 - 014 - 0025 - 1 24395031 schmitz - valckenberg s holz fg bird ac spaide rf fundus autofluorescence imaging : review and perspectives retina 2008 28 3 385 409 10.1097 / iae.0b013e318164a907 18327131 sdiri b cheikh fa dragusha k beghdadi a comparative study of endoscopic image enhancement techniques colour and visual computing symposium ( cvcs ) 2015 new york ieee 1 5 sheet deboot garud hrushikesh brightness preserving dynamic fuzzy histogram equalization ieee trans consum electron 2010 56 4 2475 2480 10.1109 / tce.2010.5681130 siegel rl miller kd jemal a cancer statistics , 2015 ca cancer j clin 2015 65 1 5 29 10.3322 / caac.21254 25559415 srivastava r , gupta jrp , parthasarthy h , srivastava s ( 2009 ) pdf based unsharp masking , crispening and high boost filtering of digital images , commun comput inf sci , vol. 40 , pp 8 - 13 stock c knudsen ab lansdorp - vogelaar i haug u brenner h colorectal cancer mortality prevented by use and attributable to nonuse of colonoscopy gastrointest endosc 2011 73 3 435 443 10.1016 / j.gie.2010.12.005 21353840 susstrunk se , winkler s ( 2003 ) color image quality on the internet .
in : proceedings of the spie .
electronic imaging 2004 , international society for optics and photonics , vol 5304 , san jose , ca , p 118 - 131 viera aj garrett jm understanding interobserver agreement : the kappa statistic fam med 2005 37 5 360 363 15883903 vogt f , kruger s , niemann h , schick c ( 2003 ) a system for real - time endoscopic image enhancement .
in : ellis re , peters tm ( eds ) proceedings of the international conference on medical image computing and computer assisted intervention ( miccai ) , ser lecture notes comput sci , springer - verlag , new york , pp 356 - 363 wang z bovik a sheikh h simoncelli e image quality assessment : from error visibility to structural similarity ieee trans image process 2004 13 600 612 10.1109 / tip.2003.819861 15376593 wang z bovik ac a universal image quality index signal process lett ieee 2002 9 81 84 10.1109 / 97.995823 welsh t ashikhmin m mueller k transferring color to greyscale images acm trans gr 2002 21 3 277 280 10.1145 / 566654.566576 shi y , ding y , zhang r , li j ( 2009 ) structure and hue similarity for color image quality assessment , in icect , pp 329 - 333 zuiderveld k contrast limited adaptive histogram equalization graphics gems iv 1994 san diego academic press professional inc 474 485