genet mol biol gmb genetics and molecular biology 1415 - 4757 1678 - 4685 sociedade brasileira de genetica ribeirao preto , sp , brazil 21637669 3036944 10.1590 / s1415 - 47572009000200001 review article a review of techniques for spatial modeling in geographical , conservation and landscape genetics spatial regression modeling in genetics diniz - filho jose alexandre felizola 1 nabout joao carlos 2 de campos telles mariana pires 1 soares thannya nascimento 1 rangel thiago fernando l. v. b. 3 1 departamento de biologia geral , instituto de ciencias biologicas , universidade federal de goias , goiania , gobrazil 2 programa de doutorado em ciencias ambientais , universidade federal de goias , goiania , gobrazil 3 department of ecology and evolutionary biology , university of connecticut , storrs , ctusa send correspondence to jose alexandre f. diniz - filho .
departamento de biologia geral , instituto de ciencias biologicas , universidade federal de goias , campus samambaia , caixa postal 131 , 74001 - 970 goiania , go , brazil .
e - mail : diniz @ icb.ufg.br . apr - jun 2009 1 6 2009 32 2 203 211 26 8 2008 20 1 2009 copyright ( c ) 2009 , sociedade brasileira de genetica .
2009 this is an open - access article distributed under the terms of the creative commons attribution license , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly cited .
most evolutionary processes occur in a spatial context and several spatial analysis techniques have been employed in an exploratory context .
however , the existence of autocorrelation can also perturb significance tests when data is analyzed using standard correlation and regression techniques on modeling genetic data as a function of explanatory variables .
in this case , more complex models incorporating the effects of autocorrelation must be used .
here we review those models and compared their relative performances in a simple simulation , in which spatial patterns in allele frequencies were generated by a balance between random variation within populations and spatially - structured gene flow .
notwithstanding the somewhat idiosyncratic behavior of the techniques evaluated , it is clear that spatial autocorrelation affects type i errors and that standard linear regression does not provide minimum variance estimators .
due to its flexibility , we stress that principal coordinate of neighbor matrices ( pcnm ) and related eigenvector mapping techniques seem to be the best approaches to spatial regression .
in general , we hope that our review of commonly used spatial regression techniques in biology and ecology may aid population geneticists towards providing better explanations for population structures dealing with more complex regression problems throughout geographic space .
autocorrelation geographical genetics isolation - by - distance landscape genetics spatial regression introduction most evolutionary processes occur in a spatial context .
the genetic variation originated by random mutations and drifting within local populations will disperse through geographically - mediated gene flow , whereas selection gradients will appear , since environmental factors will also be geographically arranged .
consequently , since the late 1970 's , several techniques in spatial analysis started to be used to investigate these processes by analyzing spatial patterns of genetic variation among populations ( see epperson , 2003 and diniz - filho et al. , 2008a for recent general reviews ) .
in turn , this allowed for the emergence of many slightly different ( but highly overlapping ) research programs , integrating ecology , evolutionary biology and genetics ( diniz - filho et al. , 2008a ) .
these techniques usually involve the estimation of parameters from spatial structure , such as the geographic distance at which genetic data can be considered independent , which in turn can be linked to ecological or evolutionary processes , such as dispersal .
more complex micro - evolutionary inferences can be performed by comparing mapping patterns and their spatial signature , for different alleles and loci ( see sokal and oden , 1978a,b ; sokal and wartenberg , 1983 ; sokal et al. , 1989 ) .
understanding such patterns within species can also be important in optimizing strategies for biodiversity conservation ( diniz - filho and telles , 2002 , 2006 ; diniz - filho et al. , 2006 ) .
most of these techniques rely on the spatial autocorrelation patterns of genetic variation ( sokal and oden , 1978a , b ) .
spatial autocorrelation occurs when closer samples in geographical space tend to be more similar or dissimilar to each other than expected by chance alone , for a given variable such as allele frequencies ( legendre and legendre , 1998 ) .
spatial autocorrelation in a biological variable can be caused by endogenous processes , in which an intrinsic property of the organisms in spatially distributed populations ( such as higher levels of dispersal ) causes higher genetic similarity among neighboring locations .
another possibility is that an exogenous factor , in which the genetic variable is responding to variation in an environmental variation , causes the observed pattern ( fortin and dale , 2005 ; kissling and carl , 2008 ) .
in most cases , a combination of these two " types " of factors will influence spatial patterns in biological variables .
in population genetics , autocorrelation has been usually considered as caused by endogenous processes , especially when analyzing neutral markers ( although natural selection cannot be ruled out in many instances ) .
inferences on micro - evolutionary processes have been reached based on parameters extracted from autocorrelation analysis , through a descriptive and exploratory analysis of the spatial structure underlying genetic variation .
however , recognition that isolation among populations caused by exogenous effects ( including anthropic disturbances ) ( see manel et al. , 2003 ; telles et al. , 2007 ; storfer et al. , 2007 ; holderegger and wagner , 2008 ; soares et al. , 2008 ;) can affect neutral loci and create spatial patterns in genetic variation , has led to other widely discussed approaches in spatial analyses in diverse research areas in biology ( i.e. , ecology and biogeography - see diniz - filho et al. , 2003 , 2007b ) .
the existence of autocorrelation can perturb significance tests and parameter estimates on analyzing data using standard statistical techniques , when a given response variable ( genetic data ) is modeled as a function of explanatory variables , as for instance , patterns of human occupation or historical effects creating isolation among local populations .
in this case , more complex models incorporating the effects of autocorrelation must be used instead of standard and well - known regression and correlation models .
the main problem is that spatial autocorrelation in data also causes inferential statistical problems , since type i errors in regression and correlation analyses are always inflated ( see legendre , 1993 ) .
thus , when dealing with exogenous processes affecting genetic variation , it is important to apply statistical techniques that take into account intrinsic demographic factors and population dynamics creating intrinsic autocorrelation .
here , we review those modeling techniques which have already been well studied and used in many fields of biology and science in general ( see cressie , 1993 ; haining , 1990 , 2002 ; schabenberg and gotway , 2005 ) , but only recently have they been mentioned in the contexts population , conservation and landscape genetics ( storfer et al. , 2007 ) .
we describe these techniques and show their application in a simple simulation of genetic data , in which spatial patterns in allele frequencies were generated by a balance between random variation within populations and spatially - structured gene flow .
we show that the avoidance of their use tends to increase type i errors when relating genetic variation with exogenous factors structured on geographical space .
spatial regression techniques spatial autocorrelation in residuals of standard regression models suppose that an allele frequency is estimated in local populations and that the purpose / proposal is to model the dependence of this allele frequency on an explanatory variable , such as temperature ( when looking for selection gradients ) or intensity of anthropogenic effects that , for example , could create patterns through increasing isolation .
the standard approach to analyze this kind of data is to perform a linear regression of allele frequencies ( y ) against the explanatory variable ( x ) , so that the observed frequency in each ith population can be expressed by : ( 1 ) where a and b are the linear ( intercept ) and angular ( slope ) coefficients and epsiloni is the residual term , given by the difference between observed and expected frequency of the population i. in a matrix form , the equation above can be written ( and generalized ) by : ( 2 ) where beta is the vector with coefficients associated with k explanatory variables ( plus the intercept term beta0 or a ) .
thus , the r2 of this regression model , given by the ratio between predicted and observed sum of squares , will provide the amount of variation in allele frequency that is " explained " by the explanatory variables .
it is assumed that the epsilon term is normally distributed with constant variance , and is independently distributed among observations , so that covariance matrix c among residuals is equal to : ( 3 ) where sigma2 is the variance of the residuals , which is constant throughout the diagonal of c , and i is an identity matrix .
under these assumptions , the coefficients in the vector beta can be obtained by : ( 4 ) these coefficients are usually estimated by using least - square techniques , and this simple non - spatial regression model will be called here ordinary , or non - spatial , least - squares ( ols ) ( which is actually the general method of estimating beta ) .
however , a higher dispersal or migration will link populations closer in geographical space , so that any single stochastic variation will be shared among adjacent populations , and their similarity will be explained by these stochastic processes and not by their common response to x. thus , close populations in geographic space ( i.e. , which are linked by higher levels of gene flow ) show similar deviations from expected allele frequency by effects of x. this problem can be formally evaluated by checking whether the residuals e of the model for local populations closer in geographic space are more similar than expected by chance alone .
in other words , this can be evaluated by estimating spatial autocorrelation in model residuals epsilon .
although autocorrelation at short distances will not generate broad scale gradients , except if coupled with some form of historical effects , autocorrelation among residuals will actually generate an overestimation of residual degrees of freedom , thus completely disturbing any significance tests associated with the model .
even under alternative frameworks for model evaluation , such as the information theory ( see burnham and anderson , 2002 ) , model choice will be perturbed by residual autocorrelation ( diniz - filho et al. , 2008b ) .
the residual autocorrelation can be evaluated using several techniques ( see sokal and oden , 1978a,b , legendre and legendre , 1998 ) , but the most commonly applied approach in population genetics is to estimate moran 's i autocorrelation coefficients , given as : ( 5 ) where n is the number of samples ( local populations ) , yi and yj are the values of the allele frequencies ( or any quantitative trait ) measured in the populations i and j , y is the average of y and wij is an element of the w matrix .
in this w matrix , the elements are equal to 1 if the pair i , j of local populations is within a given distance class interval ( indicating populations that are " connected " in this class ) , and otherwise wij = 0 .
s indicates the number of entries ( connections ) in the w matrix .
the value expected under the null hypothesis of the absence of spatial autocorrelation is - 1 /( n - 1 ) .
in practice , moran i is usually calculated by using different distance classes , connecting , in the w matrix , pairs of local populations situated at increasing geographic distances .
thereby , a sequence of coefficients is obtained and a spatial correlogram appears when they are plotted against geographic distance classes .
this correlogram better describes the complexity of spatial patterns , both in original variable and model residuals .
most evolutionary inferences using autocorrelation in population genetics and phylogenetic comparative analyses have been performed based on correlograms , although these were not obtained from model residuals , but instead from original allele frequencies or phenotypes ( sokal and oden , 1978a , b ; sokal and wartenberg , 1983 ; sokal et al. , 1989 ; diniz - filho and malaspina , 1995 ; diniz - filho , 2001 , 2004 ) .
the statistical significance of moran 's i can be obtained by estimating its variance , under different assumptions and obtaining a standard normal deviation statistics z. for model residuals , these formulae do not apply exactly ( see schabenberg and gotway , 2005 ) , and so significance levels can be established by randomization techniques ( manly , 1997 ) .
another recent development is to apply local versions of moran 's i , in which a spatial autocorrelation coefficient is calculated for each spatial unit , thereby revealing how similar neighbouring values are regarding each of these " focal " spatial units ( sokal et al. , 1998a , 1998b ; fotheringham et al. , 2002 ) .
this is a more forceful way of evaluating more localized spatial patterns in model residuals , thus allowing for a better understanding of genetic variation and greater ability in detecting problems in regression models .
mantel tests ( mantel , 1967 ; manly , 1985 , 1997 ) have also been widely used in population genetics for comparing geographic and genetic distances .
in this context of spatial regression , multiple mantel tests ( smouse et al. , 1986 ; manly , 1985 ) could be used to evaluate the effects of different sets of explanatory matrices x in pairwise genetic distances .
however , this is basically a partial regression model ( see below ) in a matrix design , and has mainly been used for exploring relationships and not correcting statistical inference .
once autocorrelation in model residuals is detected , a number of modifications in eq .
( 1 ) can be performed taking this into account , both in order to improve understanding of genetic variation , as well as to better estimate and test model parameters .
in general , we will refer to these subsequent models , as reviewed below , as " spatial regression models " .
these can be grouped into two classes , based on the idea of incorporating autocorrelation either into a model structure or into model residuals .
since the problem of modeling spatially - structured genetic data appears when autocorrelation exists in model residuals , as described above , the solution to the problem is exactly to eliminate this autocorrelation .
this can be statistically achieved by two different approaches ( see martins and hansen , 1996 ) : 1 ) it is possible to introduce into the model structure certain spatial " terms " , such as additional vectors in x which are other variables that capture spatial variation , so that e becomes independently distributed ; or 2 ) assume that epsilon is autocorrelated , and explicitly incorporate this when estimating coefficients in beta .
both classes of models will be discussed in more detail below .
incorporating geographic space in model structure there are many ways of incorporating spatial variables into the model structure to eliminate residual autocorrelation .
this can be expressed by a general model of the form : ( 6 ) where x , beta and epsilon are as defined for eq .
( 2 ) and g is a vector or matrix ( i.e. , spatial terms and associated spatial coefficients ) expressing geographic space or , more appropriately , the geographically - structured genetic variation among local populations .
thus , this class of spatial regression tries to " filter " or eliminate autocorrelation in model residuals by capturing it in the g term of eq .
( 6 ) .
therefore , the problem is how to define " space " in eq .
( 6 ) and express it in g terms .
the first and simplest way of defining space is by directly using the spatial coordinates of populations ( i.e. , latitude and longitude ) that can be added as spatial predictors , so that : ( 7 ) where l is a vector with spatial coordinates of local populations and bl are the slopes of these coordinates .
what eq .
( 7 ) is actually doing is to express part of genetic variation , such as a north - south cline , as a plane in geographic space .
the spatial component in eq .
( 7 ) can be changed by adding polynomial expansions , thereby adjusting to quadratic or cubic functions of spatial coordinates .
this technique is known as " trend surface analysis " ( see legendre and legendre , 1998 ) , and is better designed to model broad scale trends and not local autocorrelation in model residuals .
anyhow , these can be useful if genetic variation is in part caused by broad - scale effects , such as directional selection gradients caused by environmental factors ( such as temperature ) and is structured at these scales , or by colonization historical events with strong directional components ( see bocquet - appel and sokal , 1989 ) .
another way to express more localized spatial patterns is by an autoregressive term .
there are several forms to express autoregressive models , but the main idea is that the response variable y can be modeled as : ( 8 ) where rho is an autoregressive coefficient and w is a matrix expressing spatial weightings , or rather , how one local population affects the other .
the elements of w can be defined in many ways , including connectivity ( as in w matrices of a spatial correlogram using moran 's i ) or by the inverse of geographic distances dij among local populations ( wij = 1 / dij ) .
it is also possible to use another term to increase the complexity of the relationship between weights and distances , so that wij = 1 / dij , where alpha is a coefficient that controls curvilinearity in the relationship between geographic distances and weights .
thus , the above term rhowy is the estimated value of y in a given local population if its genetic variation is a function of nearby local populations weighted by their geographic distances ( expressed as weights ) .
thus , the term g in the above equation can be expressed as the vector rhowy , so that : ( 9 ) this model is usually called the " lagged - response autoregressive model " .
alternatively , it is possible to incorporate autoregressive terms , as defined above , for both y and x variables , so that the overall eq .
( 6 ) becomes : ( 10 ) where gamma are the spatial autoregressive coefficients rho for each explanatory variable .
this model is usually called the " lagged - predictor or mixed autoregressive model " .
a different approach to incorporating space into models is to extract eigenvectors from a matrix expressing the spatial relationship among local populations , and to use part to establish the term g of eq .
( 6 ) .
this approach have been called eigenvector - based spatial filtering , the principal coordinate of neighbor matrices ( pcnm ) , or , and in general , spatial eigenvector mapping ( sevm ) ( see borcard and legendre , 2002 ; borcard et al .
2004 ; griffith , 2003 ; diniz - filho and bini , 2005 ; griffith and peres - neto , 2006 ) .
the basic difference among these slightly different applications is from which matrix expressing geographic space , the eigenvectors are to be extracted .
diniz - filho et al .
( 1998 ) also proposed to extract eigenvectors from phylogenetic distance matrices , calling this process phylogenetic eigenvector regression ( pvr ) , and using this to express phylogenetic components in a trait y measured across species ( or populations , as seen in diniz - filho et al. , 1999 ; see also diniz - filho et al. , 2007a for a more complex combination of spatial and phylogenetic mapping ) .
eigenvectors of a spatial matrix express the relationships among local populations at decreasing spatial scales , so that first eigenvectors ( i.e. , those associated with large eigenvalues ) tend to express broad - scale structures , whereas eigenvectors with small eigenvalues tend to express local patterns .
thus , the advantage of eigenvector mapping is the flexibility in dealing with patterns at multiple scales , and the possibility of iteractively improving modeling process by adding or removing these eigenvectors .
however , this may also pose a problem , since a very large number of eigenvectors ( i.e. , n - 1 ) exists , so there must be a certain criterion for establishing which are to be used in the model .
this is the same as the " stopping - rule problem " in multivariate analysis for deciding which eigenvectors are meaningful ( see legendre and legendre , 1998 ) .
several criteria can be used , but in this modeling context the most important is to parsimoniously select the smallest number of eigenvectors that ensure a minimum desirable level of spatial autocorrelation in residuals .
incorporating autocorrelation in model residuals the second class of spatial regression does not attempt to minimize residual autocorrelation by " filtering " it from variable y , as described above .
instead , the idea is to solve the problem by incorporating spatial autocorrelation as part of residual variation , and correcting ( or generalizing ) the way coefficients in beta and their variances are to be estimated .
the basic idea is actually based on eq .
( 4 ) above .
actually , eq .
( 4 ) is a simplification of a more general equation of the form : ( 11 ) where c is a covariance matrix expressing the relationships between local populations , quite similar ( or analogous ) to w. notice that , if there is no autocorrelation in residuals , and variances are homocedastic , the c matrix becomes a single number ( sigma2 ) , so that eq .
( 10 ) is reduced to eq .
( 4 ) .
once again , the different techniques that can be found in the literature are named after different ways of defining c. wagner et al .
( 2005 ) also used a similar approach to generalize the amova , a widely used technique in population genetics .
the most widely used techniques are simultaneous ( sar ) and conditional ( car ) spatial autoregressive models , based on p autoregressive coefficients and the w matrix ( see wall 2004 ) , and similar to those defined above , in which the c matrix is given by : ( 12 ) and ( 13 ) another related model , called the moving average ( ma ) , can be obtained by defining c as : ( 14 ) equations ( 8 ) to ( 10 ) are also forms of simultaneous autoregressive models , but since they are based on the " filter " approach , they are called lagged - models , whereas the simultaneous form presented in eq .
( 11 ) is sometimes referred to the sar error model ( kuhn , 2007 , dormann et al. , 2007 , kissling and carl , 2008 ) .
finally , it is very important to note that success in the application of these techniques is not always guaranteed , because of model - fit problems .
for example , if the spatial structure way , as expressed in the w matrix , does not capture those spatial processes underlying genetic variation , then the residual can still possess spatial autocorrelation .
thus , it is important to use moran 's i or some other autocorrelation coefficient to test whether the assumption of spatial independence of residuals is being violated or not .
a simple simulation we showed the relative performance of the models described above , by using a simple simulation of an isolation - by - distance process in geographic space , generated with easypop 2.0 ( balloux , 2001 ) .
the simulation consisted of a total of 30 local populations , each with 20 diploid individuals ( 10 males and 10 females ) , with a known spatial distribution ( see below ) .
dispersal distance was equal to 2 units , and a maximum of 10 alleles per locus was generated under an infinite allele model , with maximum variability .
gene dynamics occurred throughout 500 generations .
thus , spatial patterns that appear in genetic data ( allele frequencies ) were generated by a purely spatially - structured stochastic process combining mutation , drift and gene flow , without exogenous effects .
as a reference for geographical dimension , the 30 populations were randomly assigned to a grid with 181 cells covering the cerrado biome ( figure 1 ) .
the cerrado is the second largest biome in brazil ( the first is the amazon rain forest ) , occupying more than 1,500,000 km2 , comprising a mosaic of different vegetation types dominated by a tropical savanna matrix , but also ranging from open grasslands and rocky fields to dense woodlands and dry forests ( oliveira - filho and marquis , 2002 ) .
the allele frequencies were then modeled by using spatial regression techniques as a function of the main directions of spatial variation in human occupation throughout the biome , these being derived from a factor analysis of 23 socio - economic variables , surrogates of modernization in farming , cattle breeding and human demography ( see rangel et al. , 2007 for details ) .
take note that we are not simulating any effect of these factors on allele frequencies , and spatial patterns in genetic data are only generated by endogenous processes .
thus , statistically significant regression coefficients express the pure coincidence of spatial patterns in data ( a north - south directed cline in human demography ) or an inflated type i error of the different models under spatial autocorrelation in the data .
all spatial analyses were performed using the sam 3.0 ( spatial analysis in macroecology ; rangel et al. 2006 ) program .
figure 1 allele frequency of each of the 30 populations in the cerrado biome , and a spatial correlogram , placing in evidence the high positive autocorrelation in the first distance classes .
as foreseen , allele frequencies showed a significant spatial pattern , with an expected spatial correlogram under isolation - by - distance , with high positive autocorrelation coupled with negative or stabilizing autocorrelation in the last - distance classes ( figure 1 ) .
when modeling the allele frequencies as a function of the three factors of human occupation ( explanatory variables x ) , one would expect no significant relationships to arise .
however , on using the standard ols regression , out of the 20 models obtained , 14 contained at least one significant coefficient , and out of 60 regression slopes , a total of 29 were significant at the 5 % probability level ( table 1 ). by chance alone , one would expect to find 1 out of 20 models with some significant coefficients , or rather 3 coefficients out of the 60 tested .
thus , despite the absence of causal relationships between y and x , the ols tend to disclose many significant relationships between genetic variation and exogenous processes .
repeating these analyses , using the 7 different spatial regression models , gave mixed results , when counting the number of significant models and coefficients .
for autoregressive models , elements in the w matrix were defined as wij = 1 / dij3 ( where dij are the distances between cells ) , and for pcnm the eigenvectors used in the model were those with significant spatial patterns ( moran i in the first distance class > 0.1 ) , with truncation distance equal to 250 km. in general , spatial regression models performed better than ols , both in terms of frequency of models and frequency of coefficients , the two best models being lagres and pcnm , with a frequency of significant coefficients equal to 13 % and 18 % , respectively .
however , some spatial regression methods , such as car , performed even worse than ols .
a " distance " from null expectation can also be obtained for each method , by the sum of squares of standardized slopes or each explanatory variable , assuming that expected slopes are zero .
according to this metric , sar , ma , lagres and pcnm gave lower distances than ols , thus being less affected by autocorrelation and furnishing results closer to the expected under the null hypothesis ( a null vector of slopes ) .
finally , an ordination using a non - metric multidimensional scaling of distances among methods , and based on their standardized slopes , supports the above patterns .
lagres , pcnm and tsa are the most diverse methods , at extreme positions in ordination space ( figure 2 ) , whereas tsa is somewhat closer to ols .
the other methods are at intermediate positions .
figure 2 distribution of spatial regression methods in the 2d solution of non - metric multidimensional scaling ( nmds ) based on their standardized slopes .
the methods were : ordinary least - squares ( ols ) ; principal coordinate of neighbor matrices ( pcnm ) ; lagged response ( lagres ) ; lagged predictor ( lagpred ) ; simultaneous autoregression ( sar ) ; conditional autoregression ( car ) ; moving average ( ma ) ; trend surface analysis ( tsa ) .
discussion our analyses agree with the recent comparative evaluation by bini et al .
( 2009 ) , in the sense that the performance of spatial regression models is quite idiosyncratic and data - dependent , at least in terms of parameter estimates. from our analyses , it is evident that spatial filtering approaches ( especially lagres and pcnm ) seem to work better for our simulated data than those incorporating autocorrelation in model residuals , a result opposed to a slight trend found by bini et al .
( 2009 ) on analyzing 99 macro - ecological datasets ( although they also found a better performance by sevm , analogous to pcnm ) .
this may be due to the strong endogeneous component in our simulated data , whereas in bini et al .
( 2009 ) , macro - ecological data exogenous components are usually dominant ( see also hawkins et al. , 2007 ) .
the same is valid for simulations performed by dormann et al .
( 2007 ) and kissling and carl ( 2008 ) .
in all these ecological analyses , lagres was the worst model , whereas here it was the model with the lowest type i errors .
at the same time , our performed simulations are constrained by the shape of the cerrado domain , so that common clinal patterns may appear alone and by chance , even without a causal basis , and it is difficult to tease these effects apart .
because of the relatively great number of significantly large coefficients and models found in our analyses ( a minimum of 13 % for lagres ) , one could argue that spatial regression models , although tending to perform better than ols , are not entirely effective in decoupling the endogenous and exogenous processes driving allele frequencies .
this is true , although it is not necessarily due to statistical problems with methods , but instead to conceptual problems underlying correlation and causation ( shipley , 2000 ) .
it is important to note that , in our simulations , statistically significant coefficients or models purely express the coincidence of spatial patterns in data , or an inflated type i error of the different models , because of residual spatial autocorrelation .
we simulated stochastic patterns in allele frequencies and used real patterns of human occupation in the cerrado as explanatory variables , thereby following recent approaches in ecological data ( dormann et al. , 2007 ; dormann , 2007 ; kissling and carl , 2008 ) .
although this approach is more realistic , it also opens the possibility of common trends appearing by chance alone , since independent spatial patterns are not simulated in both y and x variables .
for example , if allele frequencies under isolation - by - distance tend to form a cline , the spatial configuration of the cerrado alone , itself more oriented across a north - south axis , would be enough to generate a correlation with the north - south cline in human demography , even if these two patterns are not intrinsically related .
spatial regressions are mainly designed to deal with inflated type i errors due to / because of short - distance autocorrelation , and would not solve broad - scale associations , so it would be conceptually impossible to distinguish between causal effects when similar trends appear in data , even if they are originated by different mechanisms .
this is a general problem of all observation ( not experimental ) data ( see shipley , 2000 ) , and is not a problem of particular modeling approaches .
thus , part of the much higher type i errors that appeared in our analyses were due to a north - south cline that arose in both allele frequencies ( because of the spatial configuration of local populations in the simulations ) and human demography .
indeed , if this last explanatory variable is not included in the analyses and the frequency of significant models and coefficients are recalculated ( table 2 ) , it is possible to see that models are closer to null expectation ( i.e. , zero slopes for the predictors ) .
also , type i error of ols increases to 40 % , whereas type i errors of spatial regression models are reduced to much more acceptable levels , equal to 7.5 % for lagres ( see diniz - filho and torres , 2002 and martins et al. , 2002 for analogous type i errors estimated in comparative analyses ) ( table 2 ) .
notice that when an improved performance appears , it mainly occurs with " filtering " methods that remove the common trends , and not with methods that deal with short - distance autocorrelation in model residuals .
despite the somewhat idiosyncratic results of comparing spatial regression models in the literature ( bini et al. , 2009 ) , there is a consensus that spatial autocorrelation affects and perturbs type i errors and that , in this situation , ols does not provide minimum variance estimators ( as shown here in our simple simulations ) .
in the recent developments in landscape and conservation genetics , genetic data is usually regressed against sets of explanatory variables to detect factors associated with population structure .
so a warning against these undesirable effects in spatial autocorrelation is necessary .
among the techniques tested , pcnm and lagres performed better with our simulated data , although recently , lagres has been the subject of criticism in several papers ( dormann et al. , 2007 ; kissling and carl , 2008 ) .
due to its flexibility and capacity to deal simultaneously with problems in type i error and parameter estimation , we reinforce the notion that pcnm and related eigenvector filtering techniques seem to constitute the best approach for spatial regression .
in general , we hope that our review of certain spatial regression techniques that have been more commonly applied in biology and ecology to solve autocorrelation " problems " , may help population geneticists to provide better explanations for population structure dealing with more complex regression problems throughout geographic space .
acknowledgments we thank l.m. bini and b.a. hawkins for a long - term discussion regarding spatial autocorrelation and spatial autoregression .
we also wish to thank an anonymous reviewer who helped in improving the text .
work by j.a.f. diniz - filho , m.p.c. telles was continuously supported by several grants and fellowships from cnpq ( 301259 / 2005 - 4 to 470918 / 2006 - 3 jafdf , 309404 / 2007 - 0 and 471492 / 2007 - 8 to mpct ) .
tns and jcn received a cnpq and capes doctoral fellowship , and tfvb rangel received a fulbright / capes doctoral fellowship and financial support from nsf and the university of connecticut .
our research on conservation biogeography was supported by a pronex program of the cnpq / sectec - go ( proc .
23234156 ) for establishing conservation priorities in the brazilian cerrado .
associate editor : louis bernard klaczko references balloux f .
2001 easypop , v .
1.7 .
a computer program for the simulation of population genetics j hered 92 301 302 11447253 bini l.m. diniz - filho j.a.f. rangel t.f.l.v.b. akre t.s.b. albaladejo r.g. albuquerque f.s. aparicio a. araujo m.b. baselga a. beck j .
2009 coefficients ships in geographical ecology : an empirical evaluation of spatial and non - spatial regression ecographyd.o.i .
10.1111 / j.1600 - 0587.2009 .
05717.x. bocquet - appel j.p. sokal r.r .
1989 spatial autocorrelation analysis of trend residuals in biological data syst zool 38 331 341 borcard d. legendre p .
2002 all - scale spatial analysis of ecological data by means of principal coordinates of neighbour matrices ecol modell 153 51 68 borcard d. legendre p. avois - jacquet c. tuomisto h .
2004 dissecting the spatial structure of ecological data at multiple scales ecology 85 1826 1832 burnham k.p. anderson d.r .
2002 model selection and multimodel inference .
a practical information - theoretical approachnew york springer cressie n.a.c .
1993 statistics for spatial datanew york wiley - interscience diniz - filho j.a.f .
2001 phylogenetic autocorrelation under distinct evolutionary processes evolution 55 1104 1109 11475046 diniz - filho j.a.f .
2004 phylogenetic diversity and conservation priorities under distinct models of phenotypic evolution conserv biol 18 698 704 diniz - filho j.a.f. bini l.m .
2005 modelling geographical patterns in species richness using eigenvector - based spatial filters global ecol biogeogr 14 177 185 diniz - filho j.a.f. malaspina o .
1995 evolution and population structure of africanized honey bees in brazil : evidence from spatial analysis of morphometric data evolution 49 1172 1179 diniz - filho j.a.f. telles m.p.c .
2002 spatial autocorrelation analysis and the identification of operational units for conservation in continuous populations conserv biol 16 924 935 diniz - filho j.a.f. telles m.p.c .
2006 optimization procedures for establishing reserve networks for biodiversity conservation taking into account population genetic structure genet mol biol 29 207 214 diniz - filho j.a.f. torres n.m .
2002 phylogenetic comparative methods and the geographic range size - body size relationship in new world terrestrial carnivora evol ecol 16 351 367 diniz - filho j.a.f. bini l.m. hawkins b.a .
2003 spatial autocorrelation and red herrings in geographical ecology global ecol biogeogr 12 53 64 diniz - filho j.a.f. fuchs s. arias m.c .
1999 phylogeographic autocorrelation of phenotypic evolution in honey bees ( apis mellifera ) heredity 83 671 680 10651911 diniz - filho j.a.f. sant'ana c.e.r. bini l.m .
1998 an eigenvector method for estimating phylogenetic inertia evolution 5 1247 1262 diniz - filho j.a.f. bini l.m. pinto m.p. rangel t.f.l.v.b. carvalho p. bastos r.p .
2006 anuran species richness , complementarity and conservation conflicts in the brazilian cerrado acta oecol 29 9 15 diniz - filho j.a.f. bini l.m. rodriguez m.a. rangel t.f.l.v.b. hawkins b.a .
2007a seeing the forest for the trees : partitioning ecological and phylogenetic components of bergmanns rule in european carnivora ecography 30 598 608 diniz - filho j.a.f. hawkins ba bini l.m. marco j.r.p. blackburn t .
2007b are spatial regression methods a panacea or a pandora 's box ?
a reply to beale et al .
( 2007 ) ecography 30 848 851 diniz - filho j.a.f. telles m.p.c. bonatto s. eizirik e. freitas t.r.o. de marco p. santos f.r. sole - cava a. soares t.n .
2008a mapping the evolutionary twilight zone : molecular markers , populations and geography j biogeogr 35 753 763 diniz - filho j.a.f. rangel t.f.l.v.b. bini l.m .
2008b model selection and information theory in geographical ecology global ecol biogeogr 17 479 488 dormann c.f .
2007 effects of incorporating spatial autocorrelation into the analysis of species distribution data global ecol biogeogr 16 129 138 dormann c.f. mcpherson j. araujo m.b. bivand r. bolliger j. carl g. davies r.g. hirzel a. jetz w. kissling w.d .
2007 methods to account for spatial autocorrelation in the analysis of distributional species data : a review ecography 30 609 628 epperson b.k .
2003 geographical geneticsprinceton princeton university press fortin m .
- . j. dale m.r.t .
2005 spatial analysis : a guide for ecologistscambridge cambridge university press fotheringham a.s. brunsdon c. charlton m .
2002 geographically weighted regression : the analysis of spatially varying relationshipschichester john wiley & sons ltd .
griffith d.a. peres - neto p .
2006 spatial modeling in ecology : the flexibility of eigenfunction spatial analyses ecology 87 2603 2613 17089668 griffith d.a .
2003 spatial autocorrelation and spatial filtering : gaining understanding through theory and visualizationnew york springer - verlag haining r .
1990 spatial data analysis in the social and environmental sciencescambridge cambridge university press haining r .
2002 spatial data analysiscambridge cambridge university press hawkins b.a. diniz - filho j.a.f. bini l.m. de marco p. blackburn t.m .
2007 red herrings revisited : spatial autocorrelation and parameter estimation in geographical ecology ecography 30 375 384 holderegger r. wagner h.h .
2008 landscape genetics bioscience 58 199 208 kissling w.d. carl g .
2008 spatial autocorrelation and the selection of simultaneous autoregressive models global ecol biogeogr 17 59 71 kuhn i .
2007 incorporating spatial autocorrelation may invert observed patterns div distrib 13 66 69 legendre p. legendre l .
1998 numerical ecology3rd edamsterdan elsevier legendre p .
1993 spatial autocorrelation : trouble or new paradigm ?
ecology 74 1659 1673 manel s. schwartz m.k. luikart g. taberlet p .
2003 landscape genetics : combining landscape ecology and population genetics trends ecol evol 15 189 197 mantel n .
1967 the detection of disease clustering and a generalized regression approach cancer res 27 209 220 6018555 manly b.f.j .
1985 the statistics of natural selectionnew york chapman and hall manly b.f.j .
1997 randomization , bootstrap , and monte carlo methods in biologylondon chapman and hall martins e.p. diniz - filho j.a.f. housworth e .
2002 adaptive constraints and the phylogenetic comparative method : a computer simulation test evolution 56 1 13 11913655 martins e.p. hansen t.f .
1996 the statistical analysis of interspecific data : a review and evaluation of phylogenetic comparative methods phylogenies and the comparative method in animal behavior martins e.p. oxford oxford university press 22 75 oliveira p.s. marquis r.j .
2002 the cerrado of brazil : ecology and natural history of a neotropical savannanew york columbia univ. press rangel t.f.l.v.b. diniz - filho j.a.f. bini l.m .
2006 towards an integrated computational tool for spatial analysis in macroecology and biogeography global ecol biogeogr 15 321 327 rangel t.f.l.v.b. bini l.m. diniz - filho j.a.f. pinto m.p. carvalho p. bastos r.p .
2007 human development and biodiversity conservation in brazilian cerrado appl geogr 27 14 27 schabenberg o. gotway c.a .
2005 statistical methods for spatial data analysislondon chapman and hall shipley b .
2000 cause and correlation in biology : a user 's manual to path analysis , structural equations and causal inferencecambridge cambridge university press smouse p.e. long j.c. sokal r.r .
1986 multiple regression and correlation extensions of the mantel test of matrix correspondence syst zool 35 627 632 soares t.n. chaves l.j. telles m.p.c. diniz - filho j.a.f. resende l.v .
2008 landscape conservation genetics of dipteryx alata genetica 132 9 19 17333479 sokal r.r. oden n.l .
1978a spatial autocorrelation in biology .
1. methodology biol j linn soc 10 199 228 sokal r.r. oden n.l .
1978b spatial autocorrelation in biology .
2. some biological implications and four applications of evolutionary and ecological interest biol j linn soc 10 229 249 sokal r.r. wartenberg d.e .
1983 a test of spatial autocorrelation analysis using an isolation - by - distance model genetics 105 219 237 17246154 sokal r.r. oden n.l. thomson b.a .
1998a local spatial autocorrelation in biological variables biol j linn soc 65 41 62 sokal r.r. oden n.l. thomson b.a .
1998b local spatial autocorrelation in a biological model geogr anal 30 331 354 sokal r.r. harding r.m. oden n.l .
1989 spatial patterns of human gene frequencies in europe am j phys anthropol 80 267 294 2589472 storfer a. murphy m.a. evans j.s. goldberg c.s. robinson s. spear s.f. dezzani r. delmelle e. vierling l. waits l.p .
2007 putting the ' landscape ' in landscape genetics heredity 98 128 142 17080024 telles m.p.c. diniz - filho j.a.f. bastos r.p. soares t.n. guimaraes l.d. lima l.p .
2007 landscape genetics of physalaemus cuvieri in brazilian cerrado : correspondence between population structure and patterns of human occupation and habitat loss biol conserv 139 37 46 wagner h.h. holderegger r. werth s. gugerli f. hoebbe s.e. scheidegger c .
2005 variogram analysis of the spatial genetic structure of continuous populations using multilocus microsatellite data genetics 169 1739 1752 15654102 wall m.m .
2004 a close look at the spatial structure implied by the car and sar models j stat plan infer 121 311 324 table 1 a comparison of spatial regression methods based on the analysis of null expectation , by regressing allele frequencies evolving under a pure isolation - by - distance process against three explanatory variables ( factors ). n. models refers to the frequency ( out of 20 simulations ) with at least one significant ( p < 0.05 ) regression slope , whereas n. coeff .
shows the frequency ( out of 60 coefficients ) of significant coefficients .
the dist ( h0 ) refers to the average euclidian distances between the regression coefficient vector beta and the null expectation ( all slopes are zero ). n. models n. coeffs dist ( h0 ) ols 0.65 0.38 0.140 tsa 0.75 0.33 0.170 pcnm 0.50 0.18 0.154 lagres 0.40 0.13 0.076 lagpred 0.40 0.20 0.113 sar 0.70 0.35 0.118 car 0.70 0.38 0.138 ma 0.70 0.35 0.116 table 2 the same analyses shown in table 1 , but regressing allele frequencies evolving under a pure isolation - by - distance process against two out of three explanatory variables ( removing human occupation ). n. models n. coeffs dist ( h0 ) ols 0.55 0.40 0.069 tsa 0.35 0.25 0.073 pcnm 0.10 0.07 0.103 lagres 0.15 0.07 0.033 lagpred 0.20 0.12 0.055 sar 0.40 0.30 0.060 car 0.50 0.45 0.070 ma 0.40 0.30 0.058