genome biol genome biology 1465 - 6906 1465 - 6914 biomed central london 25633159 4290828 523 10.1186 / s13059 - 014 - 0523 - y research an investigation of biomarkers derived from legacy microarray data for their utility in the rna - seq era su zhenqiang zhenqiangsu @ gmail.com fang hong hong.fang @ fda.hhs.gov hong huixiao huixiao.hong @ fda.hhs.gov shi leming leming.shi @ gmail.com zhang wenqian wenqian.zhang @ fda.hhs.gov zhang wenwei zhangww @ genomics.org.cn zhang yanyan zhangyanyan @ genomics.cn dong zirui dongzirui @ genomics.org.cn lancashire lee j lee.lancashire @ thomsonreuters.com bessarabova marina marina.bessarabova @ thomsonreuters.com yang xi xi.yang @ fda.hhs.gov ning baitang baitang.ning @ fda.hhs.gov gong binsheng binsheng.gong @ fda.hhs.gov meehan joe joe.meehan @ fda.hhs.gov xu joshua zhihua.xu @ fda.hhs.gov ge weigong weigong.ge @ fda.hhs.gov perkins roger roger.perkins @ fda.hhs.gov fischer matthias matthias.fischer @ uk - koeln.de tong weida weida.tong @ fda.hhs.gov national center for toxicological research , us food and drug administration , 3900 nctr road , jefferson , ar 72079 usa thomson reuters , ip & science , 22 thomson place , boston , ma 02210 usa state key laboratory of genetic engineering and moe key laboratory of contemporary anthropology , schools of life sciences and pharmacy , fudan university , shanghai , 201203 china fudan - zhangjiang center for clinical genomics , shanghai , 201203 china zhanjiang center for translational medicine , shanghai , 201203 china bgi - shenzhen , main building , bei shan industrial zone , yantian district , shenzhen , guangdong 518083 china bgi - guangzhou , guangzhou , china department of pediatric oncology and hematology and center for molecular medicine ( cmmc ) , university children 's hospital of cologne , kerpener strasse 62 , d - 50924 cologne , germany 3 12 2014 3 12 2014 2014 15 12 3273 16 8 2013 31 10 2014 ( c ) su et al. ; licensee biomed central .
2014 this is an open access article distributed under the terms of the creative commons attribution license ( http :// creativecommons.org / licenses / by / 4.0 ) , which permits unrestricted use , distribution , and reproduction in any medium , provided the original work is properly credited .
the creative commons public domain dedication waiver ( http :// creativecommons.org / publicdomain / zero / 1.0 /) applies to the data made available in this article , unless otherwise stated .
background gene expression microarray has been the primary biomarker platform ubiquitously applied in biomedical research , resulting in enormous data , predictive models , and biomarkers accrued .
recently , rna - seq has looked likely to replace microarrays , but there will be a period where both technologies co - exist .
this raises two important questions : can microarray - based models and biomarkers be directly applied to rna - seq data ?
can future rna - seq - based predictive models and biomarkers be applied to microarray data to leverage past investment ?
results we systematically evaluated the transferability of predictive models and signature genes between microarray and rna - seq using two large clinical data sets .
the complexity of cross - platform sequence correspondence was considered in the analysis and examined using three human and two rat data sets , and three levels of mapping complexity were revealed .
three algorithms representing different modeling complexity were applied to the three levels of mappings for each of the eight binary endpoints and cox regression was used to model survival times with expression data .
in total , 240,096 predictive models were examined .
conclusions signature genes of predictive models are reciprocally transferable between microarray and rna - seq data for model development , and microarray - based models can accurately predict rna - seq - profiled samples ; while rna - seq - based models are less accurate in predicting microarray - profiled samples and are affected both by the choice of modeling algorithm and the gene mapping complexity .
the results suggest continued usefulness of legacy microarray data and established microarray biomarkers and predictive models in the forthcoming rna - seq era .
electronic supplementary material the online version of this article ( doi : 10.1186 / s13059 - 014 - 0523 - y ) contains supplementary material , which is available to authorized users .
issue - copyright - statement ( c ) the author ( s ) 2014 background microarray - based gene expression profiling represents a mature , high - throughput , transcriptomic analysis approach that has been extensively applied in biomedical and clinical research as the major biomarker tool for almost two decades .
an important outcome is a number of large - scale microarray data sets for public reference , for example , the connectivity map ( also known as cmap ) database [ 1,2 ] , chemical effects in biological systems ( cebs ) [ 3 ] , drugmatrix [ 4 ] , and the japanese toxicogenomics database ( tg - gates ) [ 5 ] .
meanwhile , a large number of microarray - based gene signatures and biomarkers [ 6 - 9 ] and gene expression profile - based predictive models [ 10 - 12 ] have also been established for human disease subtype classification , disease diagnosis and prognosis , and therapeutic treatment selection .
during more recent years , next - generation sequencing technologies ( ngs ) have emerged as a powerful alternative to microarrays , particularly for whole transcriptome analysis with rna - seq [ 13 - 15 ] .
besides providing accurate measurement of gene expression levels , rna - seq is additionally promising because of its capability to discover splicing junctions , novel transcripts , alternative splicing variants , and un - annotated genes .
the unprecedented discovery features as well as a sustained cost decrease are causing an inevitable transition from microarray to rna - seq for clinical biomarker development .
the advent of evermore economical ngs has led many companies and institutions that have heavily invested in microarrays to ask whether they need to repeat their sample profiling with ngs .
such a costly undertaking could be averted depending on the extent to which predictive models and associated signature genes developed from microarrays can be directly transferred to rna - seq data .
given the fact that the cost for rna - seq is rapidly decreasing , the same transferability question could be raised again in the future on how predictive models and associated signature genes based on rna - seq can be applied back to the legacy microarray data to leverage the existing data and knowledge .
moreover , the analysis of the current gene expression omnibus ( geo ) database revealed several important observations ( additional file 1 : figure s1 ) .
first , by only examining the number of data added to geo from both technologies in 2014 , much larger number of array data ( 54,206 ) was deposited compared to rna - seq ( 9,082 ) .
second , justifying the year as a starting point for which both array data ( 2001 ) and rna - seq data ( 2006 ) were ' seen ' by geo , the growth rate for rna - seq was slower compared to microarrays in the following 5 to 7 years .
third , projecting the data growth by fitting the existing data with the polynomial and power equations for microarray and rna - seq , respectively , it seems that rna - seq will reach 1 million mark in 2021 ( the current number of arrays in geo ) and surpass microarrays in 2028 .
the analysis indicated a long period of co - existence of both technologies ( the transition from microarray to rna - seq could last many years ) , rendering these aforementioned questions even more important .
as a part of the fda - led community wide sequencing quality control ( seqc ) project [ 16 ] , we broadly assessed the transferability of predictive models and signature genes between microarray and rna - seq data using two large clinical data sets : the neuroblastoma ( nb ) data ( zhang w , shi l , hertwig f , thierry - mieg j , zhang w , thierry - mieg d , wang j , furlanello c , devanarayan v , cheng j , deng y , hero b , hong h , jia m , li l , lin s , nikolsky y , oberthuer a , qing t , su z , volland r , wang w , wang m , yu y , ai j , albanese d , amur s , asgharzadeh s , avigad s , bao w , et al. comparison of rna - seq and microarray - based models for clinical endpoint prediction ; submitted ) having 498 nb samples with six binary clinical endpoints and four continuous survival times and the acute myeloid leukemia ( aml ) data [ 17 ] containing 175 aml samples with two binary clinical endpoints and two continuous survival times ( table 1 ) .
' signature genes' of a predictive model are defined as the set of rna - seq genes or microarray probes / probe sets used by the predictive model .
the samples in both clinical data sets were independently profiled with microarray and illumina rna - seq technologies .
to ensure a rigorous comparison , we first investigated the cross - platform sequence correspondence between microarray probes / probe sets and rna - seq genes for three human and two rat data sets having both microarray and rna - seq data available for the same samples .
consequently , microarray probes / probe sets and rna - seq genes were cross mapped and stratified into four mapping groups a , b , c , and d in accordance with sequence correspondence complexity as defined in table 2 .
three predictive modeling algorithms representing different modeling complexity , k - nearest neighbors ( k - nn ) , nearest shrunken centroids ( nsc ) [ 18 ] , and support vector machine ( svm ) were applied to each of the three mapping groups a , b , and c , and for each of the eight binary clinical endpoints and cox proportional hazards survival analysis [ 19 ] was applied to the six continuous endpoints to model survival times with gene expression data ( table 1 ) .
our analyses indicate that the signature genes of models between microarray and rna - seq data are reciprocally transferable for model development , regardless of the degree of clinical endpoint prediction difficulty and the cross - platform gene mapping complexity .
more importantly , the models developed from microarray data could be directly used to accurately predict rna - seq - profiled samples , as long as microarray and rna - seq data were properly transformed .
conversely , the models derived from rna - seq data could be directly used to predict microarray - profiled samples , but with more difficulty and lower accuracy .
table 1 definition of the clinical endpoints for the 498 seqc nb samples and the 175 aml samples endpoint category data set total samples ( n ) endpoint training set validation set samples ( n ) 1 0 samples ( n ) 1 0 binary ( 1 / 0 ) seqc nb 498 a _ efs _ all ( event , yes / no ) 249 89 160 249 94 155 b _ os _ all ( death , yes / no ) 249 51 198 249 54 195 c _ sex _ all ( female / male ) 249 103 146 249 108 141 272 d _ fav _ all ( unfavorable / favorable ) 136 45 91 136 46 90 176 e _ efs _ hr ( event , yes / no ) 86 55 31 90 65 25 f _ os _ hr ( death , yes / no ) 86 43 43 90 49 41 aml 175 sex ( female / male ) 89 43 46 86 39 47 cytogenetic risk ( poor / good ) 89 72 17 86 70 16 continuous ( time ) seqc nb 498 a _ efs _ all ( event , days ) 249 249 b _ os _ all ( death , days ) 249 249 176 e _ efs _ hr ( event , days ) 86 90 f _ os _ hr ( death , days ) 86 90 aml 175 efs ( event , months ) 89 86 os ( death , months ) 89 86 efs : event - free survival ; fav : unfavorable / favorable ( class label for extreme disease course ) ; hr : high - risk patients ; os : overall survival .
table 2 gene mapping groups with different sequence correspondence complexity group microarray probes / probe sets rna - seq genes concordance a each probe set can be exclusive mapped to one rna - seq gene .
it is identical to rna - seq a set each gene can be exclusively mapped to one array probe set .
it is identical to array a set high b each probe set can be mapped to one rna - seq gene , but the gene can be mapped to multiple array probe sets .
it is a subset rna - seq c set each gene can be mapped to one array probe set , but the probe set can mapped to multiple genes .
it is a subset of array c set low c each probe set can be mapped to multiple rna - seq genes each gene can be mapped to multiple array probe sets lowest d probe sets cannot be mapped ( unique probe set ) genes cannot be mapped ( unique genes ) unique features results examining the reciprocal transferability of predictive models and signature genes between microarray and rna - seq data requires understanding the sequence correspondence in gene mappings between the two platforms .
consequently , we first performed cross - platform mappings of microarray probes or probe sets to rna - seq genes and explored the consistency of gene expression measurements between microarray and rna - seq data using two rat and three human data sets having both microarray and rna - seq data .
the two rat data sets were from the nctr rat toxicogenomics study [ 20,21 ] and the fda sequencing quality control ( seqc ) rat toxicogenomics study [ 22 ] ; and the three human data sets were from the fda seqc main study [ 16 ] , microarray quality control ( maqc ) phase i main study [ 23 ] , the seqc neuroblastoma ( nb ) study , and the cancer genome atlas ( tcga ) acute myeloid leukemia ( aml ) study [ 17 ] .
subsequently , only the fda seqc nb and tcga aml data sets were used for a quantitative assessment of the cross - platform transferability conducted ( 1 ) at the signature gene level ( figure 1a ) and ( 2 ) at the model level [ 24 ] ( figure 1b ) for both binary endpoint prediction and cox survival regression analysis .
we first applied the whole transferability assessment processes to the fda seqc nb data set and then validated the findings using the tcga aml data set .
since gene mappings between microarray and rna - seq are not in one - to - one correspondence , we independently performed the signature level assessment process ( figure 1a ) on the three groups of gene mappings ( a , b , and c in table 2 ) for each of the eight binary predefined clinical endpoints using three modeling algorithms and for each of the six continuous survival times using cox survival analysis .
in total , we carried out 180 signature level assessment processes ( three gene mapping groups by eight endpoints by three algorithms by two transfer directions for binary endpoint prediction and three gene mappings by six continuous survival times by two transfer directions for cox modeling ) and thereby generated 144,072 predictive models ( 500 trained models plus 500 corresponding transferred models per process for binary endpoint prediction and two models per process for cox modeling ) .
for model level assessment , the process ( figure 1b ) was conducted on both original log2 intensity / counts data and per sample z - scored data ; and group c mappings were excluded from modeling since their ambiguous mapping relationships were not suitable for cross - platform prediction .
thus , we conducted 216 model level assessment processes ( two gene mapping groups by eight endpoints by three algorithms by two transfer directions by two forms of data for binary endpoint prediction and two gene mappings by six continuous survival times by two transfer directions for cox modeling ) and thereby generated 96,024 predictive models ( 500 trained models per process for binary endpoint prediction and one model per process for cox modeling ) .
figure 2a,b , and c show the summary of the assessment results for each scenario .
figure 1 flowcharts for evaluating the cross - platform transferability of signature genes and predictive models .
two analysis procedures were applied to evaluate the transferability of signature genes ( a ) and predictive models ( b ) .
in ( a ) , microarray training data are used to develop 500 trained models through ( c ) to predict the microarray validation samples .
the signature genes of each model are then used with the rna - seq training data to build an untrained rna - seq model using through ( d ) to predict the rna - seq validation samples .
the performance of microarray models is finally compared to that of rna - seq models .
the transferability of signature genes from rna - seq back to microarray data can conversely be calculated .
while in ( b ) , both microarray and rna - seq data were z - scored prior to model development .
then microarray training data are used to develop 500 trained models to predict both microarray and rna - seq validation samples .
the performance of models in predicting microarray data is compared to that in predicting rna - seq data. from rna - seq back to microarray is conversely examined .
a trained model is developed through ( c ) .
briefly , training samples are randomly split in a 70 / 30 ratio .
for each split , a series of models are developed using the 70 % of training samples to predict the remaining 30 % .
the models are developed as follows : ( 1 ) all genes are first filtered with t - test p < 0.05 and then ranked by fold change ( fc ) ; ( 2 ) a sequential forward feature selection by a step of two and parameter selection strategy is then used to build a number of models to predict the remaining samples .
finally , the signature genes and parameters of the best model are used with all training samples to build a trained model .
an untrained model is built using all training samples from one platform but with the signature genes and parameters of a model trained from the other platform ( d ) .
figure 2 summary of the transferability of signature genes and predictive models between microarray and rna - seq data .
the test results whether the parameters and signature genes of a model developed from one platform ( microarray or rna - seq ) can be used to build a model using data generated with the other platform ( rna - seq or microarray ) are shown in ( a ) for the three gene mappings a , b , and c separately ; while the results whether a predictive model developed from one platform can be directly used to accurately predict the samples profiled with the other platform for gene mappings a and b are summarized for per sample z - scored data and without per sample z - scored data in ( b ) and ( c ) , respectively .
green and red arrows indicate the good and bad transferability from one platform to the other , respectively .
cross - platform gene mapping complexity and consistency of gene expression measurements between microarray and rna - seq gene mapping is an essential step to assess the transferability of gene expression - based predictive models between microarray and rna - seq .
cross - platform gene mapping is complicated by disparity between array annotations and rna - seq gene models .
moreover , given the complexity of human transcriptomes and the lack of complete genome functional annotation [ 25 ] , gene annotations from different sources may be inconsistent .
even within a given source , gene annotations undergo constant change .
the inconsistency complicates array annotation and causes variation in rna - seq analysis as well .
we used diverse data sets from microarray and rna - seq platforms including affymetrix rat and human arrays , agilent human arrays , and illumina hiseq 2000 , hiscansq , and ga - ii to characterize and categorize the complexity of cross - platform gene mappings and the consistency of gene expression measurements .
we first mapped affymetrix rat _ 230 _ 2 arrays to illumina ga ii rna - seq using the method depicted in figure 3a ( see also methods and materials ) .
data were from an nctr rat toxicogenomics study [ 20 ] in which eight rat kidney samples were separately profiled with rat _ 230 _ 2 arrays and ga - ii rna - seq .
after mapping array probe sets to rna - seq genes , the 31,099 array probe sets were split into four groups a , b , c , and d ( defined in table 2 ) having 8,350 , 7,736 , 2,121 , and 12,892 probe sets , respectively .
group a contains probe sets that can be exclusively mapped to one rna - seq gene ; group b includes probe sets that can be uniquely mapped to one rna - seq gene , but the rna - seq gene can be mapped to multiple array probe sets ; group c consists of probe sets that can be mapped to multiple rna - seq genes ; and group d are microarray unique probe sets that cannot be mapped to any rna - seq genes .
the gene expression levels in groups a , b , and c detected with microarrays were compared to those detected with rna - seq for one of the eight rna samples ( figure 3b,c , and d ) .
as can be seen from the scatter plots , gene expression measurements for genes in group a are much more consistent than those in groups b and c. the average spearman 's correlation coefficients between microarray and rna - seq measurements for groups a , b , and c are 0.87 , 0.60 , and 0.54 , respectively .
the same trend was observed in the mapping results from affymetrix hg - u133 _ plus _ 2 arrays to illumina hiseq 2000 ( table 3 and additional file 2 : figure s2 and additional file 3 : figure s3 ) and from agilent human arrays to illumina hiseq 2000 ( table 3 and additional file 4 : figure s4 ) .
figure 3 the strategy for cross - platform gene mapping and the consistency of cross - platform gene expression measurements .
the microarray probes / probe sets are mapped to rna - seq genes in one of two ways : public gene id mapping or genome location mapping ( a ) .
using the gene id mapping approach requires that one of the following public gene ids be available : gene symbol , refseq transcript id , ensembl gene id , or entrez gene id. using the genome location mapping requires an rna - seq gene annotation file in either the gene transfer format ( gtf ) or the general feature format ( gff ) .
the process produces separate mapping lists for microarrays and rna - seq .
each of them consists of a , b , c , and d groups .
group a for microarrays corresponds to the group a in rna - seq .
the microarray group b is a subset of rna - seq group c , and vice versa .
the d group for microarrays and for rna - seq contain genes and probes / probe sets that cannot be mapped between the two platforms .
the intensities of affymetrix microarray probe sets in mapping groups a , b , and c are separately compared to those of rna - seq gene counts in panels ( b ) , ( c ) , and ( d ) for one of the eight rna samples in the nctr toxicogenomics data set .
the microarray data are from rat _ 230 _ 2 arrays normalized with the mas5 algorithm , and the rna - seq reads are from the illumina ga ii platform with the single - end 36 base pairs rna - seq protocol and gene counts from the p2 pipeline ( novoalign with refseq rat gene models ) .
the mappings from microarray probe sets to rna - seq genes are based on the genome location mapping approach .
table 3 spearman 's correlation coefficients of gene expression levels detected with microarray and rna - seq data set microarray rna - seq platform and pipeline gene group probes / probe sets ( n ) spearman 's correlation coefficient nctr rat tgx affymetrix p2 a 8,350 0.87 +/ - 0.02 rat _ 230 _ 2 b 7,736 0.60 +/ - 0.04 c 2,121 0.54 +/ - 0.04 seqc main affymetrix p2 a 6,355 0.84 +/ - 0.01 hg _ u133 _ plus 2 b 27,166 0.53 +/ - 0.02 c 7,636 0.33 +/ - 0.02 seqc nb agilent p2 a 10,042 0.73 +/ - 0.03 customized 4 x 44 k b 13,401 056 +/ - 0.04 c 2,543 0.49 +/ - 0.04 seqc rat tgx affymetrix p1 a 7,829 0.88 +/ - 0.01 rat _ 230 _ 2 b 8,376 0.63 +/ - 0.01 c 95 0.64 +/ - 0.03 p2 a 8,386 0.87 +/ - 0.01 b 8,035 0.68 +/ - 0.01 c 3,149 0.58 +/ - 0.01 p3 a 8,201 0.89 +/ - 0.01 b 8,142 0.69 +/ - 0.01 c 702 0.73 +/ - 0.01 p4 a 8,080 0.88 +/ - 0.01 b 8,160 0.67 +/ - 0.01 c 91 0.64 +/ - 0.04 p5 a 8,197 0.85 +/ - 0.01 b 7,543 0.66 +/ - 0.01 c 1,750 0.32 +/ - 0.01 p6 a 5,663 0.90 +/ - 0.01 b 12,228 0.59 +/ - 0.01 c 3,189 0.38 +/ - 0.02 tccga alm affymetrix bwa + in a 7,448 0.82 +/ - 0.04 hg _ u133 _ plus 2 house b 31,313 0.66 +/ - 0.04 program c 551 0.57 +/ - 0.04 we then mapped affymetrix rat _ 230 _ 2 arrays to six rna - seq gene sets generated from the same raw data of 62 rat liver samples using different bioinformatics pipelines and references , representing a diversity of approaches popularly used in rna - seq data analysis [ 22 ] .
array probe sets were mapped to each of the six gene sets using either the gene id or genome location mapping approaches ( table 4 ) .
the percentage of array probe sets in groups a , b , c , and d for the six gene sets varied with the choice of analysis pipelines and references ( figure 4 ) .
a high percentage of array probe sets ( group d ) in the range of 32 % to 48 % could not be mapped to any rna - seq genes , though this group of array probe sets provides additional information to rna - seq analysis .
the correlation pattern exhibited by groups a , b , and c ( table 3 and additional file 5 : figure s5 ) is similar to that observed from the previous four analyses .
the average spearman 's correlation coefficients between microarray and rna - seq measurements from the 62 rat liver samples for groups a , b , and c are 0.88 , 0.65 , and 0.55 , respectively ( table 3 ) .
the results indicate that , although the numbers of genes in the four groups from the six mapping results are quite different ( in the range of 5,653 to 8,356 , 7,543 to 12,228 , 91 to 3,189 , and 10,029 to 14,799 for groups a , b , c , and d , respectively ) , the genes in group a consistently show the highest cross - platform concordance followed by groups b and c. the inconsistency and ambiguity between microarray and rna - seq gene models are apparent .
in the subsequent analysis , we investigated the cross - platform transferability of signature genes and models separately and explored the potential impact of such gene mapping inconsistency and ambiguity .
table 4 bioinformatics pipelines and gene models used for rna - seq data analysis data set pipeline aligner counting and normalization reference genome gene annotation mapping approach seqc nb p2 novo align v2.08.01 global scaling to rpm ucsc hg19 human refseq rna v51 id mapping nctr rat toxicogenomics [ 20 ] p2 novo align v2.08.01 global scaling to rpm ucsc rn4 rat refseq rna v52 location mapping seqc main [ 16 ] p2 novo align v1.7.01 global scaling to rpm ucsc hg19 human refseq rna v51 location mapping seqc rat toxicogenomics [ 22 ] p1 magic magic index rgsc v3.4 ace view 2008 gene models id mapping p2 novo align v2.08.01 global scaling to rpm ucsc rn4 rat refseq rna v52 id mapping p3 bwa 0.5.9 - r16 samtools 0.1.13 rat refseq rna v50 id mapping p4 to phat htseq - count 0.53p3 ucsc rn4 rat refseq rna v50 id mapping p5 bowtie v0.12.7 rsem v1.1.18 ensemble rat genome 66 ensemble genes build 66 location mapping p6 to phat 2.0 cufflinks + cuffdiff ucsc rn4 cufflinks de novo assembly location mapping tcga aml [ 17 ] bwa 0.5.7 in - house program hg18 + exon junction ensembl v59 id mapping figure 4 the percentages of probe sets in mapping groups a , b , c , and d. the percentages of affymetrix probe sets in four mapping groups a , b , c , and d for the six rna - seq gene sets are shown in stacked bar charts .
the data set comprises 62 affymetrix rat _ 230 _ 2 arrays and 62 rna - seq assays from the same set of 62 rat liver rna samples .
the microarray data were normalized with mas5 , and the same rna - seq raw data were analyzed by six independent data analysis teams with a variety of analysis pipelines , that is , p1 ( ncbi magic ) , p2 ( novoalign with refseq gene models ) , p3 ( bwa + refseq rnas ) , p4 ( tophat + htseq with refseq gene models ) , p5 ( bowtie + rsem with ensembl gene models ) , and p6 ( tophat + cufflinks de novo assembly ) .
the affymetrix probe sets ( 31,099 in total ) were separately mapped to the six rna - seq gene sets .
the mappings to p1 , p2 , p3 , and p4 gene sets are based on the gene id mapping approach , while mappings to p5 and p6 gene sets are based on the genome location mapping .
signature genes of a microarray model can be transferred to rna - seq data for model development to assess the transferability of signature genes from microarray to rna - seq data , we first applied the signature level assessment process ( figure 1a , red line ) to the fda seqc nb data set .
the data set was derived from the 498 nb samples that were independently profiled with agilent microarrays and illumina hiseq 2000 .
six binary clinically relevant endpoints of varying degrees of clinical complexity and prediction difficulty were included in the seqc nb study .
as shown in table 1 , a _ efs _ all represents event - free or not at a certain time point , where event means the occurrence of progression , relapse or death ; b _ os _ all denotes whether patients died from disease or not at a specific time point ; c _ sex _ all is the patients' sex ; d _ fav _ all represents event - free without chemotherapy for at least 1,000 days post diagnosis or died from disease despite chemotherapy ; e _ efs _ hr and f _ os _ hr are similar to a _ efs _ all and b _ os _ all , respectively , but only for the patients with stage four disease or with mycn - amplified tumors .
for each of the six binary endpoints , a set of training samples and a set of validation samples were predefined in the seqc nb study .
we first mapped agilent array probes to rna - seq genes and then sorted them into groups a , b , c , and d in accordance with gene mapping complexity .
as indicated above , the probes in groups a , b , and c exhibited different degrees of consistency in gene expression measurements between microarray and rna - seq ( table 3 and additional file 4 : figure s4 ) .
we thus separately used the probes in groups a , b , and c as features to develop 500 trained k - nearest neighbors ( k - nn ) models using microarray training samples for each individual binary clinical endpoint to predict the microarray validation samples .
the 500 microarray models were trained using the stratified random sample splitting approach ( figure 1c ) .
for each of the 500 models , the parameter k and signature genes were then used with all rna - seq training data for those genes to build an untrained rna - seq k - nn model ( figure 1d ) to predict the rna - seq validation samples .
finally , the prediction performance of the 500 microarray - trained models was compared to that of the 500 corresponding untrained rna - seq models to assess the transferability of signature genes from microarray to rna - seq .
the performance of each model in predicting validation samples was assessed with accuracy and the area under the receiver - operating characteristic curve ( auc ) ( table 5 ) .
the average prediction accuracies of the microarray models for each mapping group and each endpoint were compared to those of the transferred rna - seq models ( figure 5a ) .
all 18 ( three mapping groups by six endpoints ) average prediction accuracy pairs closely locate to the diagonal of the square indicating the comparable prediction ability of the transferred rna - seq models and the original microarray models ( paired t - test p is 0.718 ) .
the comparability is the same in terms of auc .
per sample agreement beyond chance between the two predictions from each pair of microarray and rna - seq models was evaluated with kappa statistic ( figure 5b ) .
for the endpoints c _ sex _ all and d _ fav _ all which are supposedly easy to predict , model pairs reached perfect agreement ( kappa > 0.8 ) ; for a _ efs _ all and b _ os _ all , moderate ( 0.4 < kappa < 0.6 ) to substantial agreement ( 0.6 < kappa < 0.8 ) was achieved ; while for the most difficult to be predicted endpoints e _ efs _ hr and f _ os _ hr , fair ( 0.2 < kappa < 0.4 ) to moderate agreement was reached .
therefore , per sample agreement is inversely correlated to the prediction difficulty of the clinical endpoints .
the transferability of signature genes from microarray to rna - seq data was assessed with t - index score [ 24 ] .
as shown in table 5 , the t - index scores for transferring signature genes from microarray to rna - seq data mainly vary according to the clinical endpoints with only modest variation due to the gene mapping complexity .
no significant difference was observed among three mapping groups a , b , and c ( one - way anova test p is 0.996 ; pairwise paired t - test p values are 0.271 , 0.571 , and 0.508 for a vs. b , a vs. c , and b vs. c , respectively ) .
thus , the gene mapping complexity did not affect the transferability of signature genes from microarray to rna - seq data .
table 5 performance metrics for the assessment of cross - platform transferability of signature genes of k - nn models based on the seqc nb data direction endpoint gene set microarray models is predict microarray validation samples rna - seq models predict rna - seq validation samples t - index accuracy auc accuracy auc mean 95 % ci mean 95 % ci mean 95 % ci mean 95 % ci from microarray to rna - seq a * a 0.732 0.667 - 0.775 0.708 0.645 - 0.758 0.728 0.653 - 0.771 0.696 0.627 - 0.746 0.729 b 0.721 0.655 - 0.759 0.691 0.631 - 0.733 0.714 0.647 - 0.759 0.678 0.614 - 0.726 0.716 c 0.696 0.639 - 0.735 0.664 0.609 - 0.704 0.702 0.654 - 0.747 0.670 0.631 - 0.713 0.700 b * a 0.780 0.747 - 0.811 0.667 0.615 - 0.72 0.787 0.755 - 0.815 0.648 0.601 - 0.694 0.786 b 0.777 0.743 - 0.807 0.643 0.585 - 0.704 0.794 0.755 - 0.827 0.659 0.580 - 0.725 0.791 c 0.789 0.739 - 0.827 0.678 0.613 - 0.732 0.788 0.747 - 0.819 0.660 0.620 - 0.711 0.788 c * a 0.978 0.971 - 0.992 0.978 0.971 - 0.992 0.992 0.992 - 0.992 0.992 0.992 - 0.992 0.992 b 0.989 0.983 - 0.992 0.989 0.984 - 0.992 0.989 0.983 - 0.992 0.989 0.984 - 0.992 0.989 c 0.931 0.900 - 0.954 0.935 0.905 - 0.958 0.988 0.975 - 0.992 0.988 0.976 - 0.992 0.984 d * a 0.934 0.882 - 0.971 0.920 0.863 - 0.962 0.921 0.882 - 0956 0.895 0.848 - 0.940 0.921 b 0.947 0.824 - 0.978 0.938 0.798 - 0.973 0.933 0.772 - 0.978 0.915 0.737 - 0.967 0.934 c 0.915 0.838 - 0.956 0.911 0.841 - 0.961 0.921 0.853 - 0.963 0.914 0.840 - 0.956 0.920 e * a 0.624 0.533 - 0.700 0.534 0.463 - 0.615 0.606 0.522 - 0.689 0.537 0.460 - 0.617 0.612 b 0.562 0.478 - 0.623 0.507 0.417 - 0.588 0.569 0.500 - 0.633 0.519 0.443 - 0.595 0.566 c 0.607 0.511 - 0.689 0.513 0.437 - 0.603 0.599 0.511 - 0.689 0.515 0.438 - 0.603 0.602 f * a 0.513 0.444 - 0.589 0.513 0.446 - 0.585 0.510 0.433 - 0.589 0.510 0.426 - 0.589 0.511 b 0.507 0.456 - 0.567 0.511 0.452 - 0.572 0.490 0.422 - 0.556 0.498 0.431 - 0.562 0.498 c 0.532 0.456 - 0.611 0.534 0.460 - 0.609 0.527 0.444 - 0.611 0.531 0.448 - 0.611 0.529 from rna - seq to microarray a * a 0.701 0.614 - 0.759 0.669 0.590 - 0.732 0.709 0.643 - 0.759 0.671 0.603 - 0.727 0.703 b 0.680 0.584 - 0.741 0.644 0.543 - 0.708 0.693 0.604 - 0.747 0.651 0.568 - 0.710 0.684 c 0.719 0.647 - 0.767 0.691 0.618 - 0.748 0.730 0.648 - 0.771 0.698 0.621 - 0.743 0.722 b * a 0.775 0.715 - 0.819 0.662 0.576 - 0.737 0.775 0.733 - 0.811 0.640 0.579 - 0.696 0.775 b 0.777 0.715 - 0.819 0.639 0.552 - 0.713 0.785 0.735 - 0.825 0.640 0.566 - 0.718 0.778 c 0.792 0.749 - 0.823 0.681 0.621 - 0.757 0.790 0.753 - 0.819 0.659 0.606 - 0.728 0.791 c * a 0.971 0.967 - 0.992 0.972 0.969 - 0.992 0.984 0.983 - 0.992 0.985 0.984 - 0.992 0.971 b 0.939 0.900 - 0.950 0.943 0.901 - 0.954 0.990 0.988 - 0.992 0.990 0.988 - 0.992 0.939 c 0.987 0.975 - 0.992 0.987 0.975 - 0.992 0.987 0.971 - 0.992 0.987 0.972 - 0.992 0.987 d * a 0.914 0.809 - 0.971 0.899 0.792 - 0.957 0.927 0.868 - 0.963 0.910 0.841 - 0.951 0.915 b 0.918 0.838 - 0.963 0.907 0.825 - 0.962 0.928 0.860 - 0.971 0.908 0.836 - 0.957 0.918 c 0.937 0.875 - 0.978 0.923 0.853 - 0.973 0.933 0.882 - 0.971 0.913 0.882 - 0.962 0.937 e * a 0.598 0.456 - 0.689 0.506 0.414 - 0.606 0.598 0.444 - 0.700 0.522 0.400 - 0.630 0.598 b 0612 0.511 - 0.700 0.513 0.432 - 0.602 0.588 0.489 - 0.678 0.510 0.415 - 0.613 0.603 c 0.582 0.478 - 0.667 0.512 0.412 - 0.633 0.596 0.500 - 0.689 0.522 0.432 - 0.615 0.587 f * a 0.507 0.433 - 0.600 0.502 0.421 - 0.590 0.498 0.400 - 0.600 0.496 0.406 - 0.597 0.503 b 0.500 0.411 - 0.595 0.503 0.414 - 0.596 0.493 0.400 - 0.589 0.503 0.411 - 0.601 0.496 c 0.523 0.456 - 0.600 0.527 0.452 - 0.602 0.498 0.405 - 0.578 0.505 0.411 - 0.59 0.511 a * : a _ efs _ all ; b * : b _ os _ all ; c * : c _ sex _ all ; d * : d _ fav _ all ; e * : e _ efs _ hr ; f * : f _ os _ hr ; auc : area under roc curve ; ci : confidence interval ; 95 % ci was calculated from the bootstrap estimation .
the upper - right and lower - left regions are for the untrained models built using cross - platform transferred signature genes , while the upper - left and lower - right regions are for the models originally trained .
figure 5 a performance comparison of k - nearest neighbors ( k - nn ) models and their corresponding transferred models .
the comparison is based on the seqc nb data set .
for each of the six binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 k - nn models were developed from microarray training data and used to predict microarray validation samples .
the k parameter and signature genes of each of the 500 microarray models were then used with all rna - seq training data for those genes to build an untrained rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance given by the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely calculated .
the 500 k - nn models trained from rna - seq data were used to predict rna - seq validation samples .
then the k parameter and signature genes of each rna - seq model were used with all microarray training data for those genes to build a microarray model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models are compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance given by the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic for the 500 pairs of k - nns models ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
to confirm these findings , we also applied nearest shrunken centroids ( nsc ) and support vector machine ( svm ) modeling algorithms .
using the same comparison workflow , the results from nsc and svm are similar to those from k - nn ( additional file 6 : figure s6a and s6b , additional file 7 : figure s7a and s7b and additional file 8 : table s1 and additional file 9 : table s2 ) .
comparing the results from different modeling algorithms shows that , for a specific endpoint , different modeling algorithms might perform differently and result in different t - index scores .
for instance , the t - index scores of svm , k - nn , and nsc models for endpoint ' a _ efs _ all ' are 0.676 , 0.729 , and 0.734 , respectively ; but the performance of the predictive models developed from microarrays and transferred from microarrays to rna - seq using the same modeling algorithm is consistently comparable .
signature genes of a rna - seq model can be equally transferred back to microarray data for model development to assess the transferability of signature genes of models developed from rna - seq data to microarray data ( figure 1a , blue line ) we again used the fda seqc nb data , and again applied k - nn , nsc , and svm algorithms .
we first mapped rna - seq genes to agilent array probes and separated rna - seq genes into a , b , c , and d groups , as presented in table 2 .
for each algorithm and each group of a , b , and c genes , we used rna - seq training samples to develop 500 trained models through the process shown in figure 1c to predict the rna - seq validation samples .
then the parameters and signature genes of each model were used with all microarray training samples for those genes to build an untrained microarray model to subsequently predict the microarray validation samples .
the prediction performance of the trained rna - seq models was compared to that of the corresponding transferred microarray models using the same metrics as above ( table 5 , figure 5c and d , additional file 6 : figure s6c , figure s6d , additional file 7 : figure s7c , and s7d , and additional file 8 : table s1 and additional file 9 : table s2 ) .
the results show that the performance of transferred untrained microarray models is comparable to that of original trained rna - seq models .
there is no significant difference between the accuracies of the untrained microarray models and the trained rna - seq models ( paired t - test p values are 0.356 , 0.058 , and 0.158 for k - nn , nsc , and svm , respectively ) .
thus , signature genes identified from rna - seq can also be directly transferred back to microarray data for model development without significant loss of predictive accuracy .
again , the cross - platform gene mapping complexity did not affect the transferability of rna - seq signature genes back to microarray data .
microarray models can accurately predict samples profiled with rna - seq to test whether the predictive models trained from microarray data can directly predict rna - seq - profiled samples , we conducted the model level evaluation process ( figure 1b , red line ) on gene mappings a and b separately ( the genes in group c were excluded from this analysis due to the mapping ambiguity ) .
because microarray log2 intensity data are quite different from rna - seq log2 counts , both microarray and rna - seq data were z - scored prior to the modeling process .
to prevent information leakage , z - score transformation was carried out independently for each sample and within each data set .
we trained 500 k - nn models from z - scored microarray training data using the approach depicted in figure 1c and directly applied the models to predict both microarray and rna - seq validation samples .
the performance of the 500 models in predicting microarray samples in terms of accuracy and auc was compared to that in predicting rna - seq samples ( figure 6a and table 6 ) .
the average accuracies of the models in predicting microarray data are quite close to those in predicting rna - seq data ( figure 6a ) , indicating that the microarray models can directly predict rna - seq - profiled samples without significant loss of prediction performance ( paired t - test p is 0.093 ) .
the per sample prediction agreement assessed with the kappa statistic is inversely correlated to the complexity of the clinical endpoints ( figure 6b ) .
the difference between t - index scores ( table 6 ) from gene mappings a and b is not significant ( paired t - test p is 0.106 ) .
the results from nsc algorithm are similar to those from k - nn ( additional file 10 : figure s8a and s8b and additional file 11 : table s3 ) .
figure 6 a performance comparison of k - nearest neighbors ( k - nn ) in predicting microarray and rna - seq validation samples .
the comparison is based on the seqc nb data set .
in the comparison , both microarray log2 intensity data and rna - seq log2 counts were per sample z - scored .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 k - nn models were developed from microarray and rna - seq training data independently .
each set of k - nn models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray k - nn models in predicting microarray data are plotted against those in predicting rna - seq data ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq k - nn models in predicting rna - seq data are compared to those in predicting microarray data ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
table 6 the performance of k - nn models in predicting microarray and rna - seq validation samples based on the seqc nb data direction end point gene set predicto mg microarray validation data predicting rna - seq validation data t - index accuracy auc accuracy auc mean 95 % ci mean 95 % ci mean 95 % ci mean 95 % ci models developed from microarray a * a 0.728 0.659 - 0.775 0.698 0.633 - 0.752 0.706 0.606 - 0.763 0.678 0.596 - 0.747 0.712 b 0.730 0.655 - 0.775 0.694 0.619 - 0.749 0.709 0.640 - 0.755 0.671 0.610 - 0.730 0.714 b * a 0.786 0.751 - 0.815 0.662 0.600 - 0.719 0.792 0.743 - 0.831 0.621 0.547 - 0.738 0.791 b 0.785 0.743 - 0.821 0.638 0.572 - 0.708 0.764 0.663 - 0.815 0.621 0.521 - 0.737 0.768 c * a 0.988 0.983 - 0.992 0.988 0.983 - 0.992 0.990 0.975 - 0.992 0.990 0.977 - 0.992 0.990 b 0.982 0.971 - 0.992 0.983 0.974 - 0.992 0.984 0.975 - 0.992 0.985 0.976 - 0.995 0.984 d * a 0.928 0.860 - 0.971 0.907 0.831 - 0.962 0.890 0.790 - 0.949 0.860 0.728 - 0.937 0.891 b 0.918 0.816 - 0.982 0.900 0.781 - 0.978 0.868 0.746 - 0.956 0.841 0.736 - 0.945 0.870 e * a 0.625 0.522 - 0.711 0.540 0.446 - 0.637 0.627 0.456 - 0.733 0.529 0.440 - 0.636 0.626 b 0.564 0.456 - 0.661 0.489 0.394 - 0.573 0.516 0.278 - 0.711 0.497 0.429 - 0.575 0.533 f * a 0.516 0.433 - 0.600 0.515 0.432 - 0.597 0.532 0.433 - 0.622 0.521 0.438 - 0.607 0.525 b 0.493 0.422 - 0.556 0.497 0.430 - 0.562 0.512 0.422 - 0.600 0.495 0.415 - 0.575 0.503 models developed from rna - seq a * a 0.655 0.456 - 0.759 0.653 0.528 - 0.752 0.695 0.610 - 0.747 0.656 0.586 - 0.714 0.665 b 0.551 0.367 - 0.719 0.572 0.421 - 0.705 0.692 0.614 - 0.747 0.651 0.575 - 0.710 0.584 b * a 0.778 0.715 - 0.811 0.571 0.516 - 0.636 0.776 0.735 - 0.815 0.641 0.583 - 0.704 0.777 b 0.740 0.524 - 0.807 0.643 0.500 - 0.768 0.775 0.723 - 0.815 0.629 0.556 - 0.698 0.746 c * a 0.991 0.979 - 0.992 0.991 0.981 - 0.992 0.992 0.992 - 0.992 0.991 0.992 - 0.992 0.991 b 0.797 0.797 - 0.801 0.823 0.822 - 0.826 0.987 0.979 - 0.992 0.987 0.981 - 0.992 0.796 d * a 0.862 0.651 - 0.956 0.832 0.632 - 0.945 0.914 0.846 - 0.956 0.896 0.809 - 0.946 0.863 b 0.781 0.408 - 0.941 0.812 0.548 - 0.937 0.910 0.824 - 0.956 0.890 0.782 - 0.946 0.775 e * a 0.538 0.333 - 0.689 0.546 0.452 - 0.632 0.606 0.478 - 0.706 0.526 0.432 - 0.618 0.560 b 0.607 0.400 - 0.722 0.502 0.420 - 0.609 0.593 0.500 - 0.689 0.511 0.419 - 0.615 0.603 f * a 0.491 0.411 - 0.584 0.500 0.421 - 0.588 0.497 0.405 - 0.589 0.495 0.401 - 0.588 0.494 b 0538 0.456 - 0.600 0.505 0.440 - 0585 0.492 0.411 - 0.567 0.502 0.424 - 0.574 0.516 when svm algorithm was applied , the difference between the model performances in predicting microarray and rna - seq data was quite large ( additional file 12 : figure s9a and s9b and additional file 13 : table s4 ) , particularly for endpoint c _ sex _ all and gene mapping group b ( the average accuracy dropped from 0.967 to 0.824 ) .
the difference between the average accuracies in predicting microarray and rna - seq data is significant ( paired t - test p is 0.008 ) .
therefore , the transferability of microarray models to predict rna - seq data is dependent on the choice of modeling algorithms .
for algorithms that are not too sensitive to data values such as k - nn and nsc , microarray - based models can directly be applied for prediction of rna - seq - profiled samples ; while for data - value - sensitive algorithms such as svm , such a direct application is challenging .
it is more difficult to use rna - seq models to predict microarray - profiled samples we next examined the transferability of models developed from rna - seq data back to predict microarray data ( figure 1b , blue line ) .
a set of 500 k - nn models were trained from z - scored rna - seq training data and used to predict both rna - seq and microarray validation samples .
as shown in figure 6c and d and table 6 , the accuracies of the rna - seq models developed from mapping group b in predicting microarray validation samples for endpoints a _ efs _ all , b _ os _ all , c _ sex _ all , and d _ fav _ all decreased considerably compared to that in predicting rna - seq - profiled samples ; while the models developed from mapping group a achieved comparable accuracies in prediction both microarray and rna - seq validation samples .
the similar results were observed with nsc ( additional file 10 : figure s8c and s8d and additional file 11 : table s3 ) .
thus , the transferability of rna - seq models back to predict microarray data can be substantially affected by the lack of cross - platform gene mapping correspondence .
the performance of the rna - seq models dropped dramatically in predicting microarray - profiled validation samples when svm was used , regardless which mapping group of genes were used to develop rna - seq models ( additional file 12 : figure s9c and s9d and additional file 13 : table s4 ) .
clearly , it is more difficult and degraded accuracy should be expected when using the svm algorithm to develop rna - seq models to predict microarray data .
data transformation is required to use the models developed from one platform to predict samples profiled with the other platform we also evaluated the model level transferability ( figure 1b ) without z - score preprocessing ( that is , using log2 intensity and log2 counts data for microarray and rna - seq , respectively ) .
the accuracies of the models in cross - platform prediction dropped dramatically for most endpoints compared to that in predicting the samples profiled with the same platform as used for model development ( additional file 14 : figure s10 , additional file 15 : figure s11 , and additional file 16 : figure s12 ) .
the results suggest that it is essential to adequately transform both microarray and rna - seq data prior to model development and cross - platform prediction .
the transferability of cox models from survival analysis follow the similar patterns as observed from the binary endpoint prediction analyses the analyses above only used binary endpoints ( a _ efs _ all , b _ os _ all , e _ efs _ hr , and f _ os _ hr ) for the prediction of patient 's survival status .
because survival times were not considered during modeling process , the analyses may not be extrapolated to the models in which survival times were directly modeled .
to examine the transferability of such models and associated signature genes , we applied cox proportional hazards survival regression to model survival times with gene expression data for the seqc nb data set and compared the performance of cox models in terms of concordance index and p value calculated with concordance.index and cindex.comp functions from r package survcomp [ 26 ] .
the concordance index estimates the probability of concordance between predicted and observed responses with values of 0.5 , 1 , and 0 for random guessing , perfect prediction , and anti - perfect prediction , respectively [ 27 ] .
to train a cox 's model , the genes in a training set were first filtered with their median intensities ( the median intensity of a gene across the training samples is greater than the median intensity of all genes across all training samples ) and p values (< 0.01 ) calculated with the function of concordance.index in r package survcomp [ 26 ] and ranked according to their concordance indices .
the signature genes were then selected by running a leave - one - out cross - validation process with a one - step forward gene selection approach .
the final cox model was built using all training samples with the selected signature genes .
to assess gene level transferability , a cox model was first trained from a training data set from one platform through the leave - one - out cross - validation process and then used to predict the corresponding validation samples profiled with the same platform .
the signature genes were then used with the training data set from the other platform to build a cox model to predict the corresponding validation samples .
the performance of each cox model was assessed with a concordance index with a p value indicating whether the concordance index is significantly different from 0.5 .
the two concordance indices were finally compared with the function of cindex.comp to test whether the first concordance index is significantly greater than the second .
as shown in additional file 17 : table s5 , for the patient cohorts of a _ efs _ all and b _ os _ all that are easier to predict , the signature genes of cox models can be easily transferred between the two platforms for cox model development .
but for the high - risk cohorts ( e _ efs _ hr and f _ os _ hr ) that are supposedly more difficult to predict , the transferability is much lower .
the results are consistent with those from the binary endpoint prediction analyses .
to examine model level transferability , we first did per - sample z - score transformation for data and then trained a cox model using a training set from one platform and then applied it to separately predict the validation samples profiled with the two platforms .
the performance of the model in predicting both validation samples was separately measured with the concordance index and then the two concordance indices were compared to each other with cindex.comp .
the transferability of cox models between microarray and rna - seq data sets also shows a similar pattern to those from the previous binary endpoint prediction analyses ( additional file 18 : table s6 ) .
validation of the findings using the cancer genome atlas ( tcga ) acute myeloid leukemia ( aml ) data to validate the findings based on the nb data set , we repeated the same analysis processes to the tcga aml data set which contains 175 affymetrix hg - u133 _ plus _ 2 microarrays and illumina hiseq 2000 rna - seq assays from the same set of aml tumor rna samples ( see methods and materials ) with two binary ( sex and cytogenetic risk status ) and two continuous ( event - free survival time ( efs ) and overall survival time ( os )) endpoints .
for binary endpoint prediction , the three binary modeling algorithms ( that is , k - nn , nsc , and svm ) were separately applied to predict patients' sex and cytogenetic risk status .
while the time to efs and os events of patients were modelled with cox proportional hazards regression as we did for the nb data set .
at signature gene level , the untrained rna - seq models built with the signature genes of trained microarray models show comparable prediction performance except for using the mapping group c to predict the sex of patients ( figure 7a and b and table 7 ; additional file 19 : figure s13a and s13b ; additional file 20 : figure s14a and s14b ) .
using mapping group c , microarray - based trained models cannot accurately predict the sex endpoint ( about 50 % accuracy ) .
however , the transferred rna - seq models show much better prediction capability ( about 73 % accuracy ) .
this could be explained by the more accurate measurements of rna - seq .
the microarray models built with the signature genes of trained rna - seq models consistently show comparable prediction performance compared to that of trained rna - seq models ( figure 7c and d and table 7 , additional file 19 : figure s13c and s13d ; additional file 20 : figure s14c and s14d ) .
for efs and os survival time cox regression analysis , the original trained models and transferred models did not show significant difference ( additional file 21 : table s7 , p4 > 0.01 ) except for using mapping group c to predict efs time in which the original trained microarray models outperformed the transferred rna - seq untrained models ( p4 < 0.0018 ) .
therefore , the signature genes are reciprocally transferable between microarray and rna - seq data .
figure 7 a performance comparison of k - nearest neighbors ( k - nn ) models and their corresponding transferred models based on the tcga aml data .
for each of the two binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 k - nn models were developed from microarray training data and used to predict microarray validation samples .
the signature genes of each of the 500 microarray models were then used with all rna - seq training data for those genes to build an untrained rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely calculated .
the 500 k - nn models trained from rna - seq data were used to predict rna - seq validation samples .
then the signature genes of each rna - seq model were used with all microarray training data for those genes to build an untrained k - nn model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models were then compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of model predictions ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
no significant difference is observed between trained microarrays models and transferred rna - seq models ( paired t - test p is 0.366 ) and between the trained rna - seq models and the transferred microarray models ( paired t - test p is 0.269 ) .
table 7 performance metrics for the assessment of cross - platform transferability of signature genes of predictive models based on the tcga aml data algorithm direction endpoint gene set microarray model rna - seqmodel t - index accuracy auc accuracy auc mean 95 % ci mean 95 % ci mean 95 % ci mean 95 % ci k - nn forward sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 b 0.980 0.953 - 0.988 0.980 0.955 - 0.987 0.986 0.977 - 0.988 0.985 0.977 - 0.987 0.986 c 0.496 0.419 - 0.57 0.496 0.413 - 0.579 0.734 0.419 - 0.988 0.733 0.418 - 0.987 0.647 cyto risk a 0.945 0.907 - 0.988 0.895 0.805 - 0.993 0.947 0.872 - 0.988 0.905 0.794 - 0.993 0.947 b 0.939 0.872 - 0.977 0.904 0.745 - 0.986 0.942 0.884 - 0.977 0.925 0.825 - 0.986 0.942 c 0.919 0.848 - 0.965 0.884 0.767 - 0.964 0.907 0.872 - 0.953 0.854 0.776 - 0.948 0.908 reverse sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 b 0.508 0.419 - 0.599 0.501 0.41 - 0.591 0.506 0.407 - 0.593 0.508 0.409 - 0.593 0.507 c 0.977 0.977 - 0.977 0.977 0.977 - 0.977 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.977 cyto risk a 0.937 0.837 - 0.988 0.886 0.724 - 0.993 0.951 0.843 - 0.988 0.924 0.815 - 0.993 0.938 b 0.856 0.744 - 0.919 0.758 0.59 - 0.888 0.848 0.767 - 0.907 0.748 0.589 - 0.893 0.855 c 0.930 0.86 - 0.965 0.887 0.767 - 0.979 0.943 0.86 - 0.988 0.920 0.746 - 0.993 0.930 nsc forward sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 b 0.983 0.977 - 0.988 0.982 0.977 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 c 0.471 0.419 - 0.547 0.454 0.398 - 0.531 0.725 0.488 - 0.988 0.701 0.46 - 0.987 0.619 cyto risk a 0.937 0.907 - 0.953 0.857 0.75 - 0.907 0.951 0.919 - 0.977 0.904 0.836 - 0.979 0.950 b 0.892 0.837 - 0.93 0.860 0.707 - 0.933 0.891 0.872 - 0.907 0.873 0.801 - 0.919 0.891 c 0.889 0.849 - 0.907 0.812 0.666 - 0.871 0.876 0.86 - 0.919 0.775 0.625 - 0.829 0.877 reverse sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 b 0.526 0.453 - 0.547 0.487 0.439 - 0.52 0.504 0.436 - 0.547 0.481 0.426 - 0.52 0.515 c 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 cyto risk a 0.926 0.872 - 0.977 0.828 0.656 - 0.986 0.929 0.907 - 0.977 0.913 0.846 - 0.986 0.927 b 0.854 0.814 - 0.895 0.609 0.5 - 0.743 0.820 0.814 - 0.837 0.521 0.5 - 0.562 0.849 c 0.907 0.884 - 0.925 0.907 0.863 - 0.954 0.886 0.872 - 0.942 0.852 0.794 - 0.964 0.905 svm forward sex a 0.980 0.965 - 0.988 0.980 0.966 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 b 0.981 0.942 - 0.988 0.981 0.945 - 0.987 0.984 0.977 - 0.988 0.983 0.974 - 0.987 0.984 c 0.516 0.43 - 0.593 0.515 0.429 - 0.599 0.753 0.43 - 0.988 0.752 0.426 - 0.987 0.671 cyto risk a 0.939 0.895 - 0.988 0.879 0.774 - 0.993 0.957 0.895 - 0.988 0.919 0.774 - 0.993 0.956 b 0.963 0.919 - 0.988 0.941 0.829 - 0.993 0.961 0.93 - 0.988 0.947 0.868 - 0.993 0.961 c 0.919 0.884 - 0.953 0.901 0.832 - 0.964 0.920 0.86 - 0.965 0.888 0.736 - 0.979 0.920 reverse sex a 0.981 0.965 - 0.988 0.980 0.964 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.981 b 0.493 0.407 - 0.593 0.489 0.404 - 0.592 0.497 0.407 - 0.593 0.497 0.409 - 0.588 0.495 c 0.982 0.977 - 0.988 0.982 0.977 - 0.987 0.988 0.977 - 0.988 0.987 0.974 - 0.987 0.983 cyto risk a 0.932 0.872 - 0.977 0.871 0.739 - 0.962 0.965 0.919 - 0.988 0.955 0.812 - 0.993 0.932 b 0.845 0.756 - 0.919 0.778 0.608 - 0.895 0.869 0.779 - 0.942 0.787 0.583 - 0.925 0.847 c 0.944 0.872 - 0.977 0.901 0.729 - 962 0.964 0.907 - 0.988 0.944 0.846 - 0.993 0.944 auc : area under roc curve ; ci : confidence interval ; 95 % ci was calculated from the bootstrap estimation .
a * : a _ efs _ all ; b * : b _ os _ all ; c * : c _ sex _ all ; d * : d _ fav _ all ; e * : e _ efs _ hr ; f * : f _ os _ hr ; auc : area under roc curve ; ci : confidence interval ; 95 % ci was calculated from the bootstrap estimation .
the upper - right and lower - left regions are for the cross - platform prediction of the models ( the training and validation samples were profiled with different platforms ) , while the upper - left and lower - right regions are for the intra - platform prediction of the models ( both training and validation samples were profiled with the same platform ) .
using the models developed from one platform to directly predict the samples whose expression value obtained from the other platform , the results were dependent on several factors , that is , the selection of mapping groups , the choice of machine learning algorithms , and / or with or without proper data transformation ( figure 8 and table 8 , additional file 22 : figure s15 , additional file 23 : figure s16 , additional file 24 : figure s17 , additional file 25 : figure s18 , additional file 26 : figure s19 ) .
specifically , we found that , using microarray - based models to classify samples with rna - seq based expression data , ( 1 ) k - nn performed well except for mapping group b to classify patients' sex ( figure 8a and b ) , ( 2 ) nsc worked well for both endpoints ( sex and cytogenetic risk status ) and for both mapping groups ( a and b ) ( additional file 22 : figure s15a and s15b ) , however ( 3 ) svm performed well only for cytogenetic risk status prediction ( additional file 23 : figure s16a and s16b ) .
conversely , we found that more difficult to classify samples with microarray data using the models developed with rna - seq data .
for example , the performance of some models decreased dramatically ( figure 8c and d and table 8 , additional file 22 : figure s15c and s15d , additional file 23 : figure s16c and s16d ) .
when using the original expression data without per sample z - score transformation , the models developed from one platform cannot accurately predict the samples with gene expression data obtained from the other platform ( additional file 24 : figure s17 , additional file 25 : figure s18 and additional file 26 : figure s19 ) .
the efs and os survival time cox regression analysis shows the same trend as from the seqc nb data ( additional file 27 : table s8 ) .
figure 8 a performance comparison of k - nearest neighbors ( k - nn ) models in predicting microarray and rna - seq validation data based on the tcga aml data .
in the comparison , both microarray log2 intensity and rna - seq log2 count were per sample z - scored .
for each of the two binary clinical endpoints and each of the two mapping groups a and b , a set of 500 k - nn models were developed from microarray and rna - seq training data independently .
each set of k - nn models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
table 8 the performance of models developed from one - platform in predicting microarray and rna - seq validation samples based on the tcga aml data algorithm direction end point gene set microarray data rna - seq data t - index accuracy auc accuracy auc mean 95 % ci mean 95 % ci mean 95 % ci mean 95 % ci k - nn forward sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.977 0.977 - 0.977 0.977 0.977 - 0.977 0.977 b 0.978 0.942 - 0.988 0.978 0.945 - 0.987 0.869 0.523 - 0.988 0.857 0.481 - 0.987 0.851 cyto risk a 0.939 0.895 - 0.988 0.884 0.805 - 0.993 0.916 0.837 - 0.977 0.825 0.68 - 0.979 0.917 b 0.931 0.837 - 0.977 0.890 0.69 - 0.986 0.914 0.837 - 0.965 0.903 0.736 - 0.979 0.914 reverse sex a 0.895 0.895 - 0.895 0.885 0.885 - 0.885 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.896 b 0.512 0.419 - 0.593 0.503 0.426 - 0.58 0.508 0.407 - 0.593 0.509 0.409 - 0.6 0.510 cyto risk a 0.920 0.866 - 0.988 0.864 0.736 - 0.993 0.949 0.837 - 0.988 0.916 0.822 - 0.993 0.921 b 0.447 0.186 - 0.849 0.609 0.5 - 0.802 0.850 0.767 - 0.919 0.747 0.587 - 0.896 0.425 nsc forward sex a 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.978 0.977 - 0.988 0.978 0.977 - 0.987 0.978 b 0.982 0.977 - 0.988 0.981 0.977 - 0.987 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.988 cyto risk a 0.931 0.872 - 0.953 0.840 0.656 - 0.899 0.927 0.86 - 0.977 0.828 0.649 - 0.962 0.927 b 0.884 0.826 - 0.919 0.843 0.676 - 0.923 0.888 0.872 - 0.892 0.885 0.815 - 0.912 0.888 reverse sex a 0.977 0.977 - 0.977 0.974 0.974 - 0.974 0.988 0.988 - 0.988 0.987 0.987 - 0.987 0.977 b 0.523 0.442 - 0.558 0.502 0.472 - 0.553 0.508 0.442 - 0.558 0.486 0.438 - 0.539 0.516 cyto risk a 0.906 0.837 - 0.965 0.788 0.635 - 0.947 0.924 0.895 - 0.953 0.893 0.839 - 0.968 0.907 b 0.663 0.198 - 0.919 0.704 0.5 - 0.854 0.819 0.814 - 0.837 0.520 0.5 - 0.579 0.653 svm forward sex a 0.984 0.977 - 0.988 0.983 0.977 - 0.987 0.713 0.453 - 0.988 0.737 0.5 - 0.987 0.641 b 0.981 0.93 - 0.988 0.981 0.934 - 0.987 0.817 0.488 - 0.988 0.799 0.45 - 0.987 0.782 cyto risk a 0.925 0.86 - 0.965 0.849 0.736 - 0.93 0.909 0.837 - 0.988 0.787 0.611 - 0.993 0.910 b 0.950 0.831 - 0.977 0.916 0.66 - 0.986 0.935 0.849 - 0.977 0.924 0.704 - 0.986 0.935 reverse sex a 0.603 0.547 - 0.698 0.563 0.5 - 0.667 0.986 0.977 - 0.988 0.985 0.974 - 0.987 0.587 b 0.510 0.453 - 0.547 0.500 0.458 - 0.549 0.500 0.407 - 0.599 0.499 0.401 - 0.6 0.505 cyto risk a 0.897 0.826 - 0.977 0.777 0.562 - 0.979 0.961 0.924 - 0.988 0.945 0.837 - 0.993 0.896 b 0.789 0.535 - 0.814 0.487 0.339 - 0.5 0.874 0.767 - 0942 0.798 0.61 - 0.94 0.793 auc : area under roc curve ; ci : confidence interval ; 95 % ci was calculated from the bootstrap estimation .
in summary , the results from the analysis of the tcga aml data are consistent with those from the analysis of the seqc nb data .
discussion as a part of seqc project , we used two large clinical data sets to comprehensively investigate the transferability of predictive models and associated signature genes derived from microarrays to rna - seq data , and reciprocally from rna - seq back to microarray data .
the study design is comprehensive .
first , since the nature of an endpoint is the most significant factor to determine the robustness of a predictive model [ 28 ] , our study contains eight binary endpoints and six continuous survival times with varying degrees of difficulty for prediction ( table 1 ) .
second , we observed large variation derived from array annotations and rna - seq gene models when mapping genes between microarray and rna - seq ( figures 3b,c,d , and 4 ) .
therefore , the cross - platform gene mapping complexity was taken into consideration in the analysis .
third , realizing the choice of modeling algorithms could affect observations ; three representative classification algorithms from simple to complicated were selected according to their mathematical complexity .
last and most importantly , the investigation was conducted at both signature gene ( figure 1a ) and model levels ( figure 1b ) and the conclusions were drawn from the prediction of external validation data sets. with this design , several important observations were made ( figure 2a,b and c ) .
we observed that signature genes derived from one platform can be directly used to build predictive models using data generated from the other platform .
we also demonstrated that microarray - base predictive models can directly predict rna - seq - profiled samples , but the reverse process yielded less accuracy .
apparently , the effect of the cross - platform gene mapping complexity was minimal to the transferability of signature genes between the two platforms , but did show influence to a certain degree at the model level .
this could result from the model ' recalibration ' step ( figure 1d ) at signature level transfer .
the ' recalibration ' might take care of the cross - platform discordance at absolute gene expression measurement .
in addition , neither k - nn nor nsc models developed from microarray data were detrimentally affected by the cross - platform gene mapping ambiguity in predicting rna - seq - profiled samples .
however , both k - nn and nsc models developed from rna - seq data using mapping group b were unfavorably affected by the cross - platform gene mapping ambiguity .
the choice of modeling algorithms was also found to affect the goodness of model level transferability .
because the svm algorithm is much more sensitive than k - nn and nsc to data values , svm models developed from one platform in predicting samples profiled with the other platform suffered large degradation of accuracy compared to those in predicting samples profiled with the same platform .
relatively , the models developed using k - nn and nsc algorithms were much more robust than svm .
because of the systematic differences between microarray and rna - seq gene expression measurements , proper data transformation is essential to develop a predictive model for the cross - platform prediction .
our analysis demonstrated that per sample z - score transformation is such an adequate approach , and furthermore has no leakage of information from validation samples to training process .
microarray annotations are subject to constant updating with changes from refseq , genbank , and ensembl databases .
rna - seq gene models also vary with improving knowledge about the genome and functional elements [ 29 ] .
such changes increase the complexity of cross - platform gene mappings .
previous studies suggest that the changes of array annotations can induce variability in comparisons of different microarray technologies [ 23,30 ] .
the current study found that array annotations and rna - seq gene models can cause variation too when comparing gene expression levels from microarrays and rna - seq .
the finding might provide a partial explanation as to why the overlap of differentially expressed genes from microarrays and rna - seq is quite low [ 20 ] .
we learned from the fda - led second phase of microarray quality control ( maqc - ii ) study that the prediction performance of microarray gene expression profile - based models is mainly dependent on endpoints [ 28 ] .
the results of this study indicate that the transferability of predictive models and associated signature genes between microarray and rna - seq data also depend on the complexity of clinical endpoints .
for example , endpoints c _ sex _ all ( sex of patients ) and d _ fav _ all ( unfavorable and favorable patients for extreme disease course ) of the seqc nb data set and sex and cyto genetic risk of the tcga aml data set were the easiest to predict and showed the highest transferability ; while e _ efs _ hr ( event - free survival for high - risk patients ) and f _ os _ hr ( overall survival for high - risk patients ) of the seqc nb data set and efs and os of the tcga aml data set were the most difficult to predict and exhibited the lowest transferability .
even though the complexity of cross - platform gene mappings can cause large variation in absolute gene - expression values between microarrays and rna - seq , it had minimal effect on the observed transferability of signature genes .
in addition , the prediction performance of models developed using three distinct gene mappings was very similar to each other , indicating that there was a lot of redundant information in both microarray and rna - seq data and that only a fraction of all the available data is necessary to derive models with good cross - platform predictions .
conclusions the analyses demonstrated that microarray models can directly predict rna - seq - profiled samples if the gene - expression data were z - score preprocessed before modeling and prediction and that the signature genes of a model developed from one platform can be directly transferred to the other platform for model development .
however , it is difficult to directly use the models developed from rna - seq data to predict microarray - profiled samples .
our study offers a viable option for the proper use of legacy microarray data , microarray - based predictive models and biomarkers in the rna - seq era and demonstrated a means to utilize rna - seq - based signature genes in microarray data analysis .
methods and materials neuroblastoma ( nb ) data set from the fda sequencing quality control ( seqc ) project the fda seqc nb data set contains 498 nb samples that were independently profiled with agilent customized 4 x 44 k oligonucleotide microarrays and illumina hiseq 2000 rna - seq .
in the fda seqc nb study , six binary clinically relevant endpoints and four continuous survival times were defined among the 498 nb samples ( table 1 ) .
for each clinical endpoint , samples were assigned to either a training set or a validation set , with varying numbers of positive and negative samples in each set ( table 1 ) .
detailed information on the nb samples , clinical parameters , microarrays and rna - seq assays were described elsewhere .
the data set can be obtained from geo database with series accession numbers gse49710 and gse62564 for microarray and rna - seq data , respectively .
acute myeloid leukemia ( aml ) data from the cancer genome atlas ( tcga ) the tcga aml [ 17 ] data set includes 175 paired affymetrix hg - u133 _ plus _ 2 microarrays and illumina rna - seq assays after cleaning up the cytogenetic risk endpoint .
the microarray and rna - seq data were generated from the same set of aml tumor rna samples .
the microarray mas5 normalized data and rna - seq rpkm data were downloaded from [ 31,32 ] , respectively .
the clinical information of patients was downloaded from [ 31 ] .
we used patients' sex and cytogenetic risk as two binary endpoints for binary endpoint prediction analysis and used event - free survival ( efs ) and overall survival ( os ) times as two continuous responses with cox proportional hazards regression to predict patients' potential survival risk based on gene expression data .
the training and validation sets were constructed as follow : ( 1 ) since the original cytogenetic risk includes good , intermediate , and poor three levels , we combined the intermediate and poor levels together to form a new ' poor ' level and used with the original good level for binary endpoint prediction analysis ; ( 2 ) then randomly split the patients in the two cytogenetic risk groups into a training set ( 17 good + 51 intermediate + 21 poor ) and a validation set ( 16 good + 50 intermediate + 20 poor ) .
the same splitting was also used for the endpoint sex .
the training set includes 43 female and 46 male patients , while the validation set contains 39 female and 47 male patients .
nctr rat toxicogenomics data set the nctr rat toxicogenomics data set includes eight microarray and eight rna - seq assays .
the microarray and rna - seq data were generated from exactly the same set of rna samples isolated from the kidneys of four aristolochic acid - treated and four control rats [ 20 ] .
the microarray assays were done in the microarray quality control phase i ( maqc - i ) validation study [ 21 ] with affymetrix rat _ 230 _ 2 arrays and the rna - seq data were generated in another study [ 20 ] with the illumina ga ii platform and single - end 36 base pairs length protocol .
the microarray data were previously processed using mas5 [ 21 ] .
the rna - seq reads were aligned against ucsc rat genome rn4 [ 33 ] using novoalign v2.08.1 [ 34 ] and gene counts were quantified and normalized with the p2 pipeline [ 22 ] .
the microarray and rna - seq data can be downloaded from geo database with series accession numbers gse5350 and gse21210 , respectively .
fda sequencing quality control ( seqc ) main study data and microarray quality control phase i ( maqc - i ) main study data microarray data came from the fda maqc main study [ 23 ] and consisted of data from affymetrix hg - u133 _ plus _ 2 microarrays .
the rna - seq data were from the fda seqc main study [ 16 ] using the illumina hiseq 2000 platform .
the microarray data were generated by affymetrix site 1 in the maqc study , while the rna - seq data were generated by site bgi in the seqc study .
both sets of data were generated from the same set of four human rna samples , that is , universal human reference rna ( uhrr , agilent ) , human brain reference rna ( hbrr , life technologies ) , and mixtures c and d of uhrr and hbrr samples in a ratio of 3:1 and 1:3 , respectively .
the hg - u133 _ plus _ 2 arrays were normalized with mas5 algorithm .
the rna - seq data were generated with illumina hiseq 2000 using the paired - end 100 bp truseq v3 rna - seq protocol and were analyzed with the p2 pipeline [ 22 ] using ucsc human genome hg19 as reference .
gene counts were normalized into reads per million ( rpm ) with a global scaling approach [ 35 ] .
the microarray and rna - seq data can be obtained from geo database with series accession numbers gse5350 and gse47774 , respectively .
fda seqc rat toxicogenomics data the seqc rat toxicogenomics data contains 62 rat liver rna samples .
each individual rna sample was separately assayed with affymetrix rat _ 230 _ 2 arrays and illumina hiscansq / hiseq 2000 rna - seq .
the microarray data were generated and normalized in the national toxicology program drugmatrix database .
details about the data generation and normalization can be found elsewhere [ 22 ] .
here , we directly downloaded mas5 normalized data from the drugmatrix ftp site [ 36 ] .
for rna - seq analysis , the paired - end 100 base pair illumina truseq rna - seq protocol was used .
the rna - seq reads were analyzed with six different bioinformatics pipelines with different references used by six independent data analysis teams ( table 4 ) , that is , p1 ( ncbi magic ) , p2 ( novoalign with refseq gene models ) , p3 ( bwa + refseq rnas ) , p4 ( tophat + htseq with refseq gene models ) , p5 ( bowtie + rsem with ensembl gene models ) , and p6 ( tophat + cufflinks de novo assembly ) .
details about rna - seq reads generation , alignment , and gene counting can be found elsewhere [ 22 ] .
the microarray and rna - seq data can be downloaded from geo database with series accession number gse47875 and gse55347 , respectively .
cross - platform gene mapping between microarray and rna - seq the method used for cross - platform gene mapping between microarray probes / probe sets and rna - seq genes is depicted in figure 3a .
the workflow was implemented in a software tool that can be obtained upon request .
two mapping methods , public gene id mapping and genome location mapping , were implemented in the software tool .
to use both approaches , the array probes / probe sets annotation information for individual microarray is required .
for affymetrix arrays , annotation files , usually in csv format , are available at the affymetrix web site [ 37 ] .
information for rna - seq genes can be in one of two formats : ( 1 ) a gene id list file containing one of the following public gene ids : refseq transcript id , gene symbol , ensembl gene id , or entrez gene id ; or ( 2 ) a gtf / gff file generated by rna - seq pipelines during de novo assembly or used by rna - seq pipelines for quantification of gene expression .
to map by one of the four types of public gene ids , each array probe / probe set was examined by comparing the gene id or id list in the corresponding array type annotation file to all rna - seq genes .
in order to map with a genome location mapping approach , the coordinates in the ' alignments' column of array type annotation files were used to calculate the overlap between each microarray probe set and all exons of each rna - seq gene .
a microarray probe set was considered to be mapped to a rna - seq gene if the length of the overlap between the coordinates specified in the annotation file and an exon of an rna - seq gene was greater than 40 base pairs , or if it overlapped with at least two exons of the rna - seq gene .
after mapping , both microarray probes / probe sets and rna - seq genes were separately classified into four different groups : a , b , c , and d ( table 2 ) .
microarray gene annotation files the agilent customized 4 x 44 k oligonucleotide microarray annotation file was obtained from the geo database with series accession number gse49710 .
the microarray probe set annotation files for rat230 _ 2 and hg - u133 _ plus _ 2 were downloaded from the affymetrix web site [ 37 ] .
both files were created on 9 june 2011 by using the netaffx ( tm ) annotation software .
the hg - u133 _ plus _ 2 and rat230 _ 2 array types were annotated with human genome ucsc version hg19 ( or ncbi grch37 ) and rat genome ucsc version rn4 , respectively .
other reference databases used for both array types for annotation included ensembl version 60 , genbank version 180 , and refseq release 41 .
t - index for assessing model transferability we used the t - index [ 24 ] score to measure the transferability of predictive models and signature genes .
the t - index score has a value between 0 and 1 .
a larger t - index score means better transferability across platforms and a t - index score less than 0.5 indicates that the transferability is due to chance .
the t - index sxcore was calculated according to formula ( 1 ) : 1 \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ { t }^ a =\ frac { 1 }{ n }{\ displaystyle \ sum _{ k = 1 }^ n { p }_ k ^ a }\ left [ 1 - \ frac {\ frac { 1 }{ n }{\ displaystyle \ sum _{ k = 1 }^ n \ left ({ p }_ k ^ a - { p }_ k ^ b \ right )}}{ e ^{ - s.d. }}\ right ] $$\ end { document } ta = 1nsumk = 1npka1 - 1nsumk = 1npka - pkbe - s.d. where ta is a metric for estimating the transferability of the models developed from platform a to the models for platform b. n is the total number of models ( 500 in this study ) .
\ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ { p }_ k ^ a $$\ end { document } pka and \ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ { p }_ k ^ b $$\ end { document } pkb are prediction accuracies of the models developed from platform a and b , respectively .
s.d. is the standard deviation of (\ documentclass [ 12pt ]{ minimal } \ usepackage { amsmath } \ usepackage { wasysym } \ usepackage { amsfonts } \ usepackage { amssymb } \ usepackage { amsbsy } \ usepackage { mathrsfs } \ usepackage { upgreek } \ setlength {\ oddsidemargin }{ - 69pt } \ begin { document }$$ { p }_ k ^ a - { p }_ k ^ b $$\ end { document } pka - pkb ) .
rna - seq pipelines and gene models table 4 lists the rna - seq pipelines and gene models used for each rna - seq data set used in the study .
data availability the seqc nb microarray gene expression data and rna - seq log2rpm used in this study can be downloaded from the geo database with series accession number gse49710 and gse62564 , respectively .
the tcga aml clinical information , microarray and rna - seq data can be separately downloaded using links https :// tcga - data.nci.nih.gov / docs / publications / laml _ 2012 / clinical _ patient _ laml.tsv , https :// tcga - data.nci.nih.gov / docs / publications / laml _ 2012 / hg - u133 _ plus _ 2.level _ 2.tgz and https :// tcga - data.nci.nih.gov / docs / publications / laml _ 2012 / laml.rnaseq.179 _ v1.0 _ gaf2.0 _ rpkm _ matrix.txt.tcgaid.txt.gz. the nctr rat toxicogenomics microarray and rna - seq data can be obtained with geo series accession numbers gse5350 and gse21210 , respectively .
the maqc - i main study and the seqc main study data can be downloaded from geo database with series accession numbers gse5350 and gse47774 , respectively .
the seqc rat toxicogenomics microarray and rna - seq data have been deposited in geo database under series accession numbers gse47875 and gse55347 , respectively .
additional files additional file 1 : figure s1 .
comparison of the number of samples profiled by expression microarray and rna - seq in the gene expression omnibus ( geo ) database .
the numbers of samples for expression profiling by microarray or by high throughput sequencing ( rna - seq ) were collected from the geo database on 28 april 2014 .
in the geo database , the start dates for expression microarray and rna - seq data accumulation are 2001 and 2006 , respectively .
each bar ( blue or red ) represents the number of samples for expression profiling cumulated in the geo database since the start date ( 2001 and 2006 for microarray and rna - seq , respectively ) .
the dashed blue and red lines are the trend lines fitted with the ' polynomial ' and ' power ' options , respectively , in excel .
the bars after 2013 are the projections of the trend lines fitted with current the geo data .
additional file 2 : figure s2 .
the consistency of affymetrix microarray and rna - seq gene expression levels for maqc reference rna samples .
the intensities of affymetrix microarray probe sets in three mapping groups a , b , and c are separately compared to the corresponding rna - seq gene counts in panels ( a ) , ( b ) , and ( c ) for one of the four microarray quality control ( maqc ) human rna samples .
the mappings from microarray probe sets to rna - seq genes are based on the genome location mapping approach .
the microarray data are from maqc - i affymetrix hg - u133 _ plus _ 2 arrays with mas5 - normalized probe set intensities , and the rna - seq reads are from the fda sequencing quality control ( seqc ) illumina hiseq 2000 with gene counts from the p2 pipeline ( novoalign with refseq human gene models ) .
additional file 3 : figure s3 .
the consistency of affymetrix hg - u133 _ plus _ 2 microarray and rna - seq gene expression levels for the acute myeloid leukemia ( aml ) rna samples .
the intensities of affymetrix array probe sets in three mapping groups a , b , and c are separately compared to the corresponding rna - seq gene counts in panels ( a ) , ( b ) , and ( c ) for one of the 175 acute myeloid leukemia ( aml ) rna samples from the cancer genome atlas ( tcga ) acute myeloid leukemia study .
the microarray data are mas5 normalized and the rna - seq data are scaled as rpkm .
the mappings from array probe sets to rna - seq genes are based on the gene id mapping approach .
additional file 4 : figure s4 .
the consistency of agilent microarray and rna - seq gene expression levels for human rna samples .
the intensities of agilent array probes in three mapping groups a , b , and c are separately compared to the corresponding rna - seq gene counts in panels ( a ) , ( b ) , and ( c ) for one of the 498 neuroblastoma rna samples from the fda sequencing quality control ( seqc ) project .
the mappings from agilent probes to rna - seq genes are based on the gene id mapping approach .
the microarray data are from agilent customized 4 x 44 k oligonucleotide arrays , and rna - seq reads are from illumina hiseq 2000 with gene counts from the p2 pipeline ( novoalign with refseq human gene models ) .
additional file 5 : figure s5 .
the consistency of microarray gene expression levels and six sets of rna - seq gene counts derived from the same set of rna - seq raw data but using a diversity of rna - seq data analysis approaches .
the mas5 normalized microarray gene expression levels of mapping groups a , b , and c are plotted against the corresponding rna - seq measurements generated by six independent data analysis teams with a variety of bioinformatics pipelines and references , that is , ( a ) p1 ( ncbi magic ) , ( b ) p2 ( novoalign with refseq rat gene models ) , ( c ) p3 ( bwa + refseq rat rnas ) , ( d ) p4 ( tophat + htseq with refseq rat gene models ) , ( e ) p5 ( bowtie + rsem with ensembl rat gene models ) , and ( f ) p6 ( tophat + cufflinks de novo assembly ) .
the mappings from microarrays to p1 , p2 , p3 , and p4 gene sets are based on the gene id mapping approach , while to p5 and p6 gene sets on the genome location mapping .
the data set containing 62 rat liver rnas is from sample profiling in the fda sequencing quality control toxicogenomics study with separate assays for each individual rna sample from affymetrix rat _ 230 _ 2 arrays and illumina hiscansq / hiseq 2000 rna - seq .
in each of the six subpanels , gene expression measurements for mapping groups a , b , and c from microarrays are plotted against those from rna - seq in scatter plots ( 1 ) , ( 2 ) , and ( 3 ) , respectively .
additional file 6 : figure s6 .
a performance comparison of nearest shrunken centroids ( nsc ) models and their corresponding transferred models based on the seqc nb data .
for each of the six binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 nsc models were developed from microarray training data and used to predict microarray validation samples .
the signature genes of each of the 500 microarray models were then used with all rna - seq training data for those genes to build an untrained rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely calculated .
the 500 nsc models trained from rna - seq data were used to predict rna - seq validation samples .
then the signature genes of each rna - seq model were used with all microarray training data for those genes to build an untrained nsc model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models were then compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of model predictions ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
no significant difference is observed between trained microarrays models and transferred rna - seq models ( paired t - test p is 0.841 ) and between the trained rna - seq models and the transferred microarray models ( paired t - test p is 0.058 ) .
additional file 7 : figure s7 .
a performance comparison of support vector machine ( svm ) models and their corresponding transferred models based on the seqc nb data .
for each of the six binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 svm models were developed from microarray training data and used to predict microarray validation samples .
the signature genes of each of the 500 models were then used with all rna - seq training data for those genes to build a rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely computed .
the 500 svm models trained from rna - seq data were used to predict rna - seq validation samples .
then the signature genes of each rna - seq model were used with all microarray training data for those genes to build a microarray model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models were then compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of models ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
no significant difference is observed between trained microarray models and transferred untrained rna - seq models ( paired t - test p is 0.557 ) and between trained rna - seq models and transferred untrained microarray models ( paired t - test p is 0.158 ) .
additional file 8 : table s1 .
performance metrics for the assessment of cross - platform transferability of signature genes of nsc models based on the seqc nb data .
additional file 9 : table s2 .
performance metrics for the assessment of cross - platform transferability of signature genes of svm models based on the seqc nb data .
additional file 10 : figure s8 .
a performance comparison of nearest shrunken centroids ( nsc ) models in predicting microarray and rna - seq validation data based on the seqc nb data .
in the comparison , both microarray log2 intensity and rna - seq log2 count were per sample z - scored .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 nsc models were developed from microarray and rna - seq training data independently .
each set of ncs models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 11 : table s3 .
the performance of nsc models in predicting microarray and rna - seq validation samples based on the seqc nb data .
additional file 12 : figure s9 .
a performance comparison of support vector machine ( svm ) models in predicting microarray and rna - seq validation data based on the seqc nb data .
in the comparison , both microarray log2 intensity and rna - seq log2 count were per sample z - score transformed .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 svm models were developed from microarray and rna - seq training data independently .
each set of models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement evaluated with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 13 : table s4 .
the performance of svm models in predicting microarray and rna - seq validation samples based on the seqc nb data .
additional file 14 : figure s10 .
a performance comparison of k - nearest neighbors ( k - nn ) models in predicting microarray and rna - seq validation samples , based on the seqc nb data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 k - nn models were developed from microarray and rna - seq training data independently .
each set of k - nns models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 15 : figure s11 .
a performance comparison of nearest shrunken centroids ( nsc ) models in predicting microarray and rna - seq validation samples , based on the seqc nb data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 nsc models were developed from microarray and rna - seq training data independently .
each set of ncs models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 16 : figure s12 .
a performance comparison of support vector machine ( svm ) models in predicting microarray and rna - seq validation samples , based on the seqc nb data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the six binary clinical endpoints and each of the two mapping groups a and b , a set of 500 svm models were developed from microarray and rna - seq training data independently .
each set of models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the six symbols in each panel represent the six binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 17 : table s5 .
concordance indices and p values for the assessment of cross - platform transferability of signature genes of cox models based on the seqc nb data .
additional file 18 : table s6 .
the performance of cox proportional hazards models developed from one - platform in predicting microarray and rna - seq validation samples based on the seqc nb data .
additional file 19 : figure s13 .
a performance comparison of nearest shrunken centroids ( nsc ) models and their corresponding transferred models based on the tcga aml data .
for each of the two binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 nsc models were developed from microarray training data and used to predict microarray validation samples .
the signature genes of each of the 500 microarray models were then used with all rna - seq training data for those genes to build an untrained rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely calculated .
the 500 nsc models trained from rna - seq data were used to predict rna - seq validation samples .
then the signature genes of each rna - seq model were used with all microarray training data for those genes to build an untrained nsc model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models were then compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of model predictions ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
no significant difference is observed between trained microarrays models and transferred rna - seq models ( paired t - test p is 0.354 ) and between the trained rna - seq models and the transferred microarray models ( paired t - test p is 0.106 ) .
additional file 20 : figure s14 .
a performance comparison of support vector machine ( svm ) models and their corresponding transferred models based on the tcga aml data .
for each of the two binary clinical endpoints and each of the three mapping groups a , b , and c , a set of 500 svm models were developed from microarray training data and used to predict microarray validation samples .
the signature genes of each of the 500 models were then used with all rna - seq training data for those genes to build a rna - seq model to predict rna - seq validation samples .
finally , the average prediction accuracies of the 500 microarray models are plotted against those of the 500 corresponding rna - seq models ( a ) , with the per sample agreement better than chance evaluated with the kappa statistic as shown in ( b ) .
the transferability of the signature genes from rna - seq back to microarray data was conversely computed .
the 500 svm models trained from rna - seq data were used to predict rna - seq validation samples .
then the signature genes of each rna - seq model were used with all microarray training data for those genes to build a microarray model to predict microarray validation samples .
the average accuracies of the 500 rna - seq models were then compared to those of the 500 corresponding microarray models ( c ) , with the per sample agreement better than chance assessed with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green , blue , and orange colors denoting mapping groups a , b , and c , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of the 500 pairs of models ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
no significant difference is observed between trained microarray models and transferred untrained rna - seq models ( paired t - test p is 0.305 ) and between trained rna - seq models and transferred untrained microarray models ( paired t - test p is 0.022 ) .
additional file 21 : table s7 .
concordance indices and p values for the assessment of cross - platform transferability of signature genes of cox models based on the tcga aml data .
additional file 22 : figure s15 .
a performance comparison of nearest shrunken centroids ( nsc ) models in predicting microarray and rna - seq validation data based on the tcga aml data .
in the comparison , both microarray log2 intensity and rna - seq log2 count were per sample z - scored .
for each of the two clinical binary endpoints and each of the two mapping groups a and b , a set of 500 nsc models were developed from microarray and rna - seq training data independently .
each set of ncs models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 23 : figure s16 .
a performance comparison of support vector machine ( svm ) models in predicting microarray and rna - seq validation data based on the tcga aml data .
in the comparison , both microarray log2 intensity and rna - seq log2 count were per sample z - score transformed .
for each of the two binary clinical endpoints and each of the two mapping groups a and b , a set of 500 svm models were developed from microarray and rna - seq training data independently .
each set of models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 24 : figure s17 .
a performance comparison of k - nearest neighbors ( k - nn ) models in predicting microarray and rna - seq validation samples , based on the tcga aml data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the two binary clinical endpoints and each of the two mapping groups a and b , a set of 500 k - nn models were developed from microarray and rna - seq training data independently .
each set of k - nns models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 25 : figure s18 .
a performance comparison of nearest shrunken centroids ( nsc ) models in predicting microarray and rna - seq validation samples , based on the tcga aml data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the two binary clinical endpoints and each of the two mapping groups a and b , a set of 500 nsc models were developed from microarray and rna - seq training data independently .
each set of ncs models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 26 : figure s19 .
a performance comparison of support vector machine ( svm ) models in predicting microarray and rna - seq validation samples , based on the tcga aml data without per sample z - score transformation .
in the comparison , microarray and rna - seq data were log2 intensity data and log2 counts , respectively .
for each of the two binary clinical endpoints and each of the two mapping groups a and b , a set of 500 svm models were developed from microarray and rna - seq training data independently .
each set of models were then used to predict both microarray and rna - seq validation samples .
the average prediction accuracies of the 500 microarray - based models in prediction microarray data were plotted against those in predicting rna - seq data ( a ) , with per sample agreement better than chance assessed with the kappa statistic as shown in ( b ) ; while the average accuracies of the 500 rna - seq - based models in predicting rna - seq data were compared to those in predicting microarray data ( c ) , with per sample agreement better than chance evaluated with the kappa statistic as shown in ( d ) .
the two symbols in each panel represent the two binary clinical endpoints with green and blue colors denoting mapping groups a and b , respectively .
in panels ( b ) and ( d ) , each symbol denotes the average kappa statistic of 500 pairs of prediction results ; and each error bar shows the 95 % confidence interval ( ci ) for the mean kappa statistic .
each ci was calculated with the bootstrap estimation .
additional file 27 : table s8 .
the performance of cox proportional hazards models developed from one - platform in predicting microarray and rna - seq validation samples based on the tcga aml data .
abbreviations aml acute myeloid leukemia k - nn k - nearest neighbors maqc microarray quality control nb neuroblastoma nsc nearest shrunken centroids seqc sequencing quality control svm support vector machine tcga the cancer genome atlas competing interests the authors declare that they have no competing interests .
authors' contributions zs had the idea , designed the methods and experiments , developed the program , carried out all the data analysis and wrote the manuscript .
hf , hh , ls , ll , mb , xy , bn , bg , jx , and jm were involved in the discussion on data analysis and the software development , and verified some of the calculations .
rgp assisted with writing the manuscript .
mf provided nb samples , microarray and rna - seq data .
wqz , wwz , yz , and zd involved in the generation of the seqc nb rna - seq data .
wt conceived the concept and lead the project .
all authors read and approved the final manuscript .
acknowledgements the authors gratefully acknowledge the contribution of drs jean thierry - mieg , danielle thierry - mieg , stan gaj , marco chierici , and their co - workers for processing the rna - seq data in the fda seqc toxicogenomic data set using their respective data analysis pipelines .
this work was supported in part by the national high technology research and development program of china ( 2015aa020104 , to ls ) and the national science foundation of china ( 31471239 , to ls ) .
disclaimer the views presented in this article do not necessarily reflect those of the us food and drug administration .
references 1 .
michnick sw the connectivity map nat chem biol 2006 2 663 664 10.1038 / nchembio1206 - 663 17108982 2 .
lamb j crawford ed peck d modell jw blat ic wrobel mj lerner j brunet jp subramanian a ross kn reich m hieronymus h wei g armstrong sa haggarty sj clemons pa wei r carr sa lander es golub tr the connectivity map : using gene - expression signatures to connect small molecules , genes , and disease science 2006 313 1929 1935 10.1126 / science.1132939 17008526 3 .
waters m stasiewicz s merrick ba tomer k bushel p paules r stegman n nehls g yost kj johnson ch gustafson sf xirasagar s xiao n huang cc boyer p chan dd pan q gong h taylor j choi d rashid a ahmed a howle r selkirk j tennant r fostel j cebs - chemical effects in biological systems : a public data repository integrating study design and toxicity data with microarray and proteomics data nucleic acids res 2008 36 d892 d900 10.1093 / nar / gkm755 17962311 4 .
ganter b snyder rd halbert dn lee md toxicogenomics in drug discovery and development : mechanistic analysis of compound / class - dependent effects using the drugmatrix database pharmacogenomics 2006 7 1025 1044 10.2217 / 14622416.7.7.1025 17054413 5 .
kiyosawa n manabe s yamoto t sanbuissho a practical application of toxicogenomics for profiling toxicant - induced biological perturbations int j mol sci 2010 11 3397 3412 10.3390 / ijms11093397 20957103 6 .
va n't veer lj dai h van de vijver mj he yd hart aa mao m peterse hl van der kooy k marton mj witteveen at schreiber gj kerkhoven rm roberts c linsley ps bernards r friend sh gene expression profiling predicts clinical outcome of breast cancer nature 2002 415 530 536 10.1038 / 415530a 11823860 7 .
kuiper r broyl a de knegt y van vliet mh van beers eh van der holt b el jarari l mulligan g gregory w morgan g goldschmidt h lokhorst hm van duin m sonneveld p a gene expression signature for high - risk multiple myeloma leukemia 2012 26 2406 2413 10.1038 / leu.2012.127 22722715 8 .
zhan f barlogie b arzoumanian v huang y williams dr hollmig k pineda - roman m tricot g van rhee f zangari m dhodapkar m shaughnessy jd jr gene - expression signature of benign monoclonal gammopathy evident in multiple myeloma is linked to good prognosis blood 2007 109 1692 1700 10.1182 / blood - 2006 - 07 - 037077 17023574 9 .
su z hong h fang h shi l perkins r tong w very important pool ( vip ) genes - an application for microarray - based molecular signatures bmc bioinformatics 2008 9 s9 10.1186 / 1471 - 2105 - 9 - s9 - s9 18793473 10 .
cornero a acquaviva m fardin p versteeg r schramm a eva a bosco mc blengio f barzaghi s varesio l design of a multi - signature ensemble classifier predicting neuroblastoma patients' outcome bmc bioinformatics 2012 13 s13 10.1186 / 1471 - 2105 - 13 - s4 - s13 22536959 11 .
simon r development and evaluation of therapeutically relevant predictive classifiers using gene expression profiling j natl cancer inst 2006 98 1169 1171 10.1093 / jnci / djj364 16954463 12 .
su z hong h perkins r shao x cai w tong w consensus analysis of multiple classifiers using non - repetitive variables : diagnostic application to microarray gene expression data comput biol chem 2007 31 48 56 10.1016 / j.compbiolchem.2007.01.001 17303535 13 .
wang z gerstein m snyder m rna - seq : a revolutionary tool for transcriptomics nat rev genet 2009 10 57 63 10.1038 / nrg2484 19015660 14 .
rowley jw oler aj tolley nd hunter bn low en nix da yost cc zimmerman ga weyrich as genome - wide rna - seq analysis of human and mouse platelet transcriptomes blood 2011 118 e101 e111 10.1182 / blood - 2011 - 03 - 339705 21596849 15 .
su z ning b fang h hong h perkins r tong w shi l next - generation sequencing and its applications in molecular diagnostics expert rev mol diagn 2011 11 333 343 21463242 16 .
su z labaj pp li s thierry - mieg j thierry - mieg d shi w wang c schroth gp jones wd xiao w xu w jensen rv kelly r xu j conesa a furlanello c gao h hong h jafari n letovsky s liao y lu f oakeley ej peng z praul ca santoyo - lopez j scherer a shi t smyth gk staedtler f a comprehensive assessment of rna - seq accuracy , reproducibility and information content by the sequencing quality control consortium nat biotechnol 2014 32 903 914 10.1038 / nbt.2957 25150838 17 .
network tcgar genomic and epigenomic landscapes of adult de novo acute myeloid leukemia n engl j med 2013 368 2059 2074 10.1056 / nejmoa1301689 23634996 18 .
tibshirani r hastie t narasimhan b chu g diagnosis of multiple cancer types by shrunken centroids of gene expression proc natl acad sci u s a 2002 99 6567 6572 10.1073 / pnas.082099299 12011421 19 .
collett d modelling survival data in medical research 2003 2boca raton , fl chapman and hall / crc 20 .
su z li z chen t li qz fang h ding d ge w ning b hong h perkins rg tong w shi l comparing next - generation sequencing and microarray technologies in a toxicological study of the effects of aristolochic acid on rat kidneys chem res toxicol 2011 24 1486 1493 10.1021 / tx200103b 21834575 21 .
guo l lobenhofer ek wang c shippy r harris sc zhang l mei n chen t herman d goodsaid fm hurban p phillips kl xu j deng x sun ya tong w dragan yp shi l rat toxicogenomic study reveals analytical consistency across microarray platforms nat biotechnol 2006 24 1162 1169 10.1038 / nbt1238 17061323 22 .
wang c gong b bushel pr thierry - mieg j thierry - mieg d xu j fang h hong h shen j su z meehan j li x yang l li h labaj pp kreil dp megherbi d gaj s caiment f van delft j kleinjans j scherer a devanarayan v wang j yang y qian hr lancashire lj bessarabova m nikolsky y furlanello c the concordance between rna - seq and microarray data depends on chemical treatment and transcript abundance nat biotechnol 2014 32 926 932 10.1038 / nbt.3001 25150839 23 .
shi l reid lh jones wd shippy r warrington ja baker sc collins pj de longueville f kawasaki es lee ky luo y sun ya willey jc setterguist ra fischer gm tong w dragan yp dix dj frueh fw goodsaid fm herman d jensen rv johnson cd lobenhofer ek puri rk schrf u thierry - mieg j wang c wilson m wolber pk the microarray quality control ( maqc ) project shows inter - and intraplatform reproducibility of gene expression measurements nat biotechnol 2006 24 1151 1161 10.1038 / nbt1239 16964229 24 .
fan x lobenhofer ek chen m shi w huang j luo j zhang j walker sj chu tm li l wolfinger r bao w paules rs bushel pr li j shi t nikolskaya t nikolsky y hong h deng y cheng y fang h shi l tong w consistency of predictive signature genes and classifiers generated using different microarray platforms pharmacogenomics j 2010 10 247 257 10.1038 / tpj.2010.34 20676064 25 .
djebali s davis ca merkel a dobin a lassmann t mortazavi a tanzer a lagarde j lin w schlesinger f xue c marinov gk khatun j williams ba zaleski c rozowsky j roder m kokocinski f abdelhamid rf alioto t antoshechkin i baer mt bar ns batut p bell k bell i chakrabortty s chen x chrast j curado j landscape of transcription in human cells nature 2012 489 101 108 10.1038 / nature11233 22955620 26 .
schroder ms culhane ac quackenbush j haibe - kains b survcomp : an r / bioconductor package for performance assessment and comparison of survival models bioinformatics 2011 27 3206 3208 10.1093 / bioinformatics / btr511 21903630 27 .
harrell fe jr califf rm pryor db lee kl rosati ra evaluating the yield of medical tests jama 1982 247 2543 2546 10.1001 / jama.1982.03320430047030 7069920 28 .
shi l campbell g jones wd campagne f wen z walker sj su z chu tm goodsaid fm pusztai l shaughnessy jd jr oberthuer a thomas rs paules rs fielden m barlogie b chen w du p fischer m furlanello c gallas bd ge x megherbi db symmans wf wang md zhang j bitter h brors b bushel pr bylesjo m the microarray quality control ( maqc ) - ii study of common practices for the development and validation of microarray - based predictive models nat biotechnol 2010 28 827 838 10.1038 / nbt.1665 20676074 29 .
dunham i kundaje a aldred sf collins pj davis ca doyle f epstein cb frietze s harrow j kaul r khatun j lajoie br landt sg lee bk pauli f rosenbloom kr sabo p safi a sanyal a shoresh n simon jm song l trinklein nd altshuler rc birney e brown jb cheng c djebali s dong x dunham i an integrated encyclopedia of dna elements in the human genome nature 2012 489 57 74 10.1038 / nature11247 22955616 30 .
irizarry ra wu z jaffee ha comparison of affymetrix genechip expression measures bioinformatics 2006 22 789 794 10.1093 / bioinformatics / btk046 16410320 31 .
tcga aml rna - seq data matrix [ https :// tcga - data.nci.nih.gov / docs / publications / laml _ 2012 / laml.rnaseq.179 _ v1.0 _ gaf2.0 _ rpkm _ matrix.txt.tcgaid.txt.gz ] 32 .
tcga aml affymetrix level 2 data matrix [ https :// tcga - data.nci.nih.gov / docs / publications / laml _ 2012 / hg - u133 _ plus _ 2.level _ 2.tgz ] 33 .
ucsc rat genome rn4 reference [ http :// hgdownload.cse.ucsc.edu / goldenpath / rn4 ] 34 .
novoalign from the novocraft company [ www.novocraft.com ] 35 .
mortazavi a williams ba mccue k schaeffer l wold b mapping and quantifying mammalian transcriptomes by rna - seq nat methods 2008 5 621 628 10.1038 / nmeth.1226 18516045 36 .
affymetrix microarray data from the drugmatrix [ ftp :// anonftp.niehs.nih.gov / drugmatrix / affymetrix _ data / normalized _ data _ by _ organ ] 37 .
affymetrix array annotation files [ http :// www.affymetrix.com / support / technical / annotationfilesmain.affx ]