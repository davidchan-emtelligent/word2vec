plos one plos one plos plosone plos one 1932 - 6203 public library of science san francisco , ca usa 25955023 4425705 pone - d - 14 - 37041 10.1371 / journal.pone.0124107 research article assessing the probability that a finding is genuine for large - scale genetic association studies probability that a finding is genuine kuo chia - ling 1 ++ vsevolozhskaya olga a .
2 ++ zaykin dmitri v .
3 * 1 department of community medicine and health care , university of connecticut , farmington , connecticut , united sates of america 2 department of epidemiology and biostatisitcs , michigan state university , east lansing , michigan , united states of america 3 national institute of environmental health sciences , national institutes of health , research triangle park , north carolina , united states of america wu rongling academic editor pennsylvania state university , united states competing interests : the authors have declared that no competing interests exist .
conceived and designed the experiments : clk oav dvz .
performed the experiments : oav dvz .
analyzed the data : oav dvz .
wrote the paper : clk oav dvz .
++ these authors contributed equally to this work * e - mail : dmitri.zaykin @ nih.gov 2015 8 5 2015 10 5 e0124107 19 8 2014 26 2 2015 this is an open - access article distributed under the terms of the creative commons public domain declaration , which stipulates that , once placed in the public domain , this work may be freely reproduced , distributed , transmitted , modified , built upon , or otherwise used by anyone for any lawful purpose .
genetic association studies routinely involve massive numbers of statistical tests accompanied by p - values .
whole genome sequencing technologies increased the potential number of tested variants to tens of millions .
the more tests are performed , the smaller p - value is required to be deemed significant .
however , a small p - value is not equivalent to small chances of a spurious finding and significance thresholds may fail to serve as efficient filters against false results .
while the bayesian approach can provide a direct assessment of the probability that a finding is spurious , its adoption in association studies has been slow , due in part to the ubiquity of p - values and the automated way they are , as a rule , produced by software packages .
attempts to design simple ways to convert an association p - value into the probability that a finding is spurious have been met with difficulties .
the false positive report probability ( fprp ) method has gained increasing popularity .
however , fprp is not designed to estimate the probability for a particular finding , because it is defined for an entire region of hypothetical findings with p - values at least as small as the one observed for that finding .
here we propose a method that lets researchers extract probability that a finding is spurious directly from a p - value .
considering the counterpart of that probability , we term this method pofig : the probability that a finding is genuine .
our approach shares fprp 's simplicity , but gives a valid probability that a finding is spurious given a p - value .
in addition to straightforward interpretation , pofig has desirable statistical properties .
the pofig average across a set of tentative associations provides an estimated proportion of false discoveries in that set .
pofigs are easily combined across studies and are immune to multiple testing and selection bias .
we illustrate an application of pofig method via analysis of gwas associations with crohn 's disease .
this research was supported by the intramural research program of the nih , national institute of environmental health sciences .
the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript.data availabilitydata used in the paper are available from the tables of barrett et al .
2008 publication , which is cited in the references section .
data availability data used in the paper are available from the tables of barrett et al .
2008 publication , which is cited in the references section .
1 introduction multiple statistical tests are routinely applied in genetic association studies and the corresponding p - values are reported .
journals require that p - values should be adjusted for multiple testing to protect against spurious findings .
nevertheless , findings often do not replicate in subsequent studies .
various explanations have been suggested for the low replicability of findings in observational studies , including inadequate accounting for multiple testing [ 1 , 2 ] .
in modern genetic studies , the number of statistical tests can be very large .
such discovery studies are often performed in a manner in which some small number of the most promising results are selected for closer investigation in a replication study .
it is now appreciated that a p - value does not reflect uncertainty about validity of a hypothesis .
yet p - values do contain information that can be used to evaluate this uncertainty , and we incorporate that information into our proposed method .
a solution to the dilemma which findings are false and which are genuine can be obtained via conversion of p - values to bayesian probabilities that a finding is genuine .
a simple bayesian solution has been proposed previously , termed the false positive report probability ( fprp ) [ 3 ] .
in this approach , tailored to genetic association p - values , a plausible effect size , for example an odds ratio and the prior probability of the null hypothesis are proposed by a researcher , and " the probability of no true association " is determined for any finding with the p - value that is smaller than a preset threshold .
it has been suggested that the fprp approach has two main deficiencies .
first , as acknowledged by its authors , fprp is not the probability that a particular finding is false , because it is based on the tail distributions rather than on the respective densities .
the fprp approach advocated plugging in an observed p - value in place of a fixed threshold .
the result can only be interpreted as " the lowest fprp for which the finding meets a preset criterion for noteworthiness " [ 4 ] .
in his critique of the fprp , lucke [ 5 ] wrote that " the fprp can promote false positive results " , due to a peculiar property of the fprp that it cannot exceed the proposed prior probability .
secondly , the usage of a single " typical " value of the odds ratio fails to acknowledge that in reality different genuine signals carry different effect sizes and a proper calculation should take into account the entire distribution of possible effect sizes .
lucke was not optimistic regarding performance of methods such as fprp built using this simplification [ 5 ] .
however , the extent of imprecision introduced by the usage of a single value remains unclear .
lastly , we note that in the fprp approach , all variants are divided into two classes , the first class containing those that are truly associated , and the second class containing variants with the effect size that is precisely equal to zero .
the second class is assumed to contain majority of the variants and corresponds to the sharp null hypothesis , h 0 .
while such approach is common due to its convenience , the non - associated set is likely to contain many variants with effect sizes sufficiently small to be either inconsequential to a researcher or undetectable given a particular sample size .
it is more realistic to define the null hypothesis in such a way as to allow inclusion of variants with negligibly small effects .
the fprp method is simple to apply and it has been referenced extensively since its introduction in 2004 .
similarly simple methods are needed to convert a particular p - value to the " probability of no true association " , so that the result can be interpreted as the probability about this particular report .
one such method has been proposed by wakefield , called the " bayesian false - discovery probability " ( bfdp ) [ 6 ] .
in bfdp , the prior distribution of effect sizes , specified in terms of the log relative risk , is assumed to be normal .
strength of association is modeled via the variance of that distribution .
bfdp has a sound bayesian foundation , but the focus on the relative risk and the usage of the normal prior distribution for the effect sizes might be somewhat restrictive .
here we introduce pofig , " probability that a finding is genuine " - - a solution inspired by the idea behind the fprp approach .
our method shares generality and simplicity of fprp in that it utilizes p - values that may result from various association statistics .
pofig alleviates the main shortcomings identified with the fprp approach .
the usage of a single value taken to be the mean of the underlying effect size distribution does introduce a bias that can be substantial for very small p - values .
however , a modification based on just three typical values ( small , medium , and large ) with their respective frequencies provides a much better approximation to the complete specification of the effect size distribution .
typically , most signals would carry small effect sizes , some signals would fall into the middle group around the mean of the effect size distribution , and signals of large magnitude would represent only a small proportion of the distribution .
in addition , the " null bin " can also be defined to capture magnitudes of effect sizes that are close to zero ( fig 1 ) .
instead of testing the usual null hypothesis that a variant has precisely zero effect , one can test a hypothesis whether the effect associated with a variant is sufficiently close to zero , i.e. , falls into the null bin .
statistical methods are starting to appear that allow to characterize the effect size distribution in a tabulated way .
park et al. proposed a method to extract tabulated effect size values with their abundances from genome - wide association studies of complex traits [ 7 ] .
our method is designed to utilize such tables of estimated or plausible effect sizes .
correct specification of the effect size distribution becomes especially important when top hits are selected from a study with very many tests .
when the distribution of effect sizes is specified correctly , posterior probabilities of association are completely unaffected by multiple testing and by the process of selection of the most significant results .
in an experiment with multiple tests , one can sort results by an association statistic and take the most extreme one : the pofig calculations do not depend on the number of tests .
pofig is similarly unaffected by the process where only those multiple testing experiments are retained which contained statistically significant results .
computed probabilities that a finding is genuine are still correct when selectively applied to experiments that contained statistically significant findings .
10.1371 / journal.pone.0124107.g001 fig 1 approximating the effect size distribution by three values .
discretization of the gamma ( shape = 1 , scale = 1 ) distribution .
the middle bin is centered around gamma medium = mu = scalexshape = 1 and has the width mu .
2 results our method estimates the posterior probability of the null hypothesis ( h 0 ) that an association is spurious , or the posterior probability of the alternative hypothesis ( h a ) that an association is genuine .
these probabilities are estimated given the association strength summarized by a p - value ( p ) .
pofig can be defined using the bayes rule in a traditional way as pofig = pr ( h a | p ) = 1 - pr ( h 0 | p ) , pofig = 1 - [ 1 + 1 - pr ( h0 ) pr ( h0 ) xfgamma ( p )] - 1 .
( 1 ) pofig depends on the marginal probability density of p - values for truly associated variants , given by fgamma ( p )= sumi = 1bwifgammai ( p | gamma ) sumi = 1bwi .
( 2 ) in calculating this marginal density one specifies b plausible ranges ( i.e , " bins ") of effect sizes , with the effect size value for the bin i given by gamma i , and the number of loci with that effect size ( w i ) .
the index i = 1 , ... , b tracks the current bin in the summation .
if the total number of loci in the genome is k , the prior probability of the null hypothesis is pr ( h 0 ) = 1 - sumw i / k. consistent with the fprp and bfdp approaches , the above formulation presents the null hypothesis as sharp , i.e , as a special class for signals with precisely zero effect size .
in an alternative specification of pofig , the null hypotheses can be defined to encompass variants with effect sizes that are small enough to be considered undetectable .
this formulation has a number of advantages .
the sharp null hypothesis , h 0 : gamma = 0 is a convenient statistical concept , however it implies that the effect size distribution has a spike at a single point gamma = 0 , which is biologically unrealistic .
instead , it is believed that there is a very large number of variants with tiny effect sizes that influence common traits and complex diseases .
these effects are of negligible size when a particular variant is considered by itself , but collectively these effects may explain a substantial proportion of heritability [ 8 , 9 ] .
rather than treating null effects as a special class , we define an extra bin for the effects with the average effect size equal to gamma 0 , in a narrow interval near zero and the number ( or the proportion ) of such effects , w 0 .
the posterior probability of the null hypothesis is evaluated via pr ( hj | p )= pr ( hj ) fgammaj ( p | gamma ) sumi = 0bpr ( hi ) fgammai ( p | gamma ) ( 3 ) with j = 0 .
the posterior probabilities for the rest of the bins ( i.e. , j = small , medium , large ) can be calculated similarly .
the weights w i in eq ( 2 ) are proportional to pr ( h i ) and sumi = 0bpr ( hi )= 1 .
the posterior mean for the effect size e ( gamma | p )= sumi = 0bgammaipr ( hi | p ) .
( 4 ) the summation index in eqs ( 3 , 4 ) now starts from zero rather than from one to accommodate inclusion of the null bin that is no longer associated with the point null hypothesis ( h 0 ) , as in eq ( 1 ) .
the effect size in eqs ( 1 - 4 ) is defined as a parameter of the p - value density .
as an example , we will use the usual one degree of freedom chi - square snp association statistic , but the p - value density is defined in the same way for statistics that have distributions other than the chi - square ( details are given in materials and methods ) .
the p - value density is fgammai ( p | gamma )= ggammai ( g0 - 1 ( 1 - p )) g0 ( g0 - 1 ( 1 - p )) , ( 5 ) where g gammai (.) is the one degree of freedom noncentral chi - square density function with the noncentrality gamma i and subscript 0 refers to the central chi - square density .
the function g0 - 1 (.) is the inverse central chi - square cumulative distribution with one degree of freedom .
tabulated effect size values can be given in terms of the odds ratios and then related to noncentralities , assuming a logistic regression model : gamma = nxdq ( 1 - q )= nxe , ( 6 ) where d is the squared log of odds ratio , n is one half of the harmonic mean of case and control sample sizes ( n 1 , n 2 , in allele counts ) , n = n 1 n 2 /( n 1 + n 2 ) , and q is the pooled allele frequency .
thus , the effect of an increase in sample size is an increase in the noncentrality and an increased skewness toward zero in the distribution of p - values .
e can be interpreted as a standardized effect size : 2e corresponds to the contribution of a snp to the additive genetic variance of the trait .
park et al. gave a method for estimating the distribution of e that utilizes data from replicated gwas findings [ 7 ] .
as noted above , the effect size distribution can be modeled in terms of parameters , such as relative risk or odds ratio , or directly in terms of the noncentralities .
park et al. used a standardized effect distribution which is the same as the distribution defined in terms of noncentralities .
when sample sizes are the same for all tested variants in a study , placing the distribution directly on e ( equivalently , on gamma ) gives posterior probabilities that have the same ranks as p - values .
on the other hand , specification of the distribution for d will give probabilities with ranks that differ from the ranks of p - values .
in snp association testing , the same noncentrality ( gamma ) may result from a snp with a large odds ratio and a small allele frequency , as well as from a snp with a small odds ratio but a large allele frequency .
thus , usage of the standardized effect size implicitly assumes that rare variants tend to have a larger effect size compared to common variants .
our approach utilizes a weighted sum of b tabulated effect size values ( eqs 1 - 3 ) .
at one extreme we may consider a single " typical " effect size value ( b = 1 ) , as in the fprp approach .
at the other extreme , the effect size distribution may be represented by a continuous function .
these modifications and the relation between pofig and fprp are given in materials and methods .
representation of the effect size distribution by a discrete set of bins offers several advantages .
among them are ( 1 ) simplicity of calculations ; ( 2 ) emergence of methods for estimation of effect size distribution in human genome [ 7 ] ; ( 3 ) straightforward specification by practitioners , e.g. , it is easier for a researcher to come up with several plausible effect sizes and their relative abundances than to specify parameters of a continuous distribution ; ( 4 ) flexibility of the approach : the binned distribution does not need to be cast in a form of a parametric statistical distribution , such as a normal distribution , and thus can reflect more closely a biologically realistic distribution .
the advantages of our approach might be offset if the number of bins ( b ) is too small to represent the actual effect size distribution for the purpose of estimating posterior probabilities with good precision .
it is especially important that the probabilities are well - estimated for top hits of a study , i.e. , for those variants that are selected based on the smallest association p - values .
such selection of top hits is known to induce bias known as the " winner 's curse " phenomenon , in which selected p - values tend to be too small and the corresponding estimated effect sizes tend to be too large .
correcting this bias is known to be difficult [ 10 ] .
fully bayesian inference is not susceptible to the winner 's curse [ 11 ] , as long as the prior distributions are specified correctly .
in our case , prior for the effect size distribution needs to reflect the actual prevalence of all possible signal magnitudes in the genome .
our proposal to collapse the effect size distribution into discrete bins may induce imprecision and make the method susceptible to the winner 's curse bias .
however , our results demonstrate that even a crude approximation based on three ranges for effect sizes provides good protection against bias due to selection of top strongest signals in a study .
2.1 simulation results simulation experiments were designed for judging precision of our method in evaluating the proportion of true signals among smallest p - values in multiple - testing experiments .
we assumed that the effect size is represented by the odds ratios ( or ) and that the squared logarithm of or has an l - shaped distribution .
for any true effect , its effect size was sampled from an l - shaped distribution and the corresponding p - value was obtained based on that effect size value .
we also allowed for a proportion pr ( h 0 ) of signals to be completely spurious ( false ) , i.e. , to have the or of exactly one .
in a single multiple - testing simulation experiment with k p - values , each p - value carried a flag indicating whether it originated from a true ( t ) or a false ( f ) signal .
once k p - values were sorted , we examined the fraction of flags that were equal to t in a set of k smallest p - values .
this gives an empirical ( i.e. , true ) proportion of true signals among k smallest p - values for a single simulation experiment .
our pofig method provides an estimate of this proportion : it is the average of pofig values for these k smallest p - values .
next , we averaged the true ( empirical ) and the pofig - estimated proportions over a large number of simulation experiments .
given this simulation setup , correctness of our method can be judged by closeness of the estimated values to the true values obtained using the knowledge of which p - values are actually generated from true signals .
this gives an overview of the simulation setup ; more detailed description is given in material and methods .
in the simulation experiments , we defined the effect size d in terms of the squared log of odds ratio , and further allowed for the effect size to have different values for different genuine signals , assuming a continuous ( gamma ) distribution .
we assumed the proportion of null signals is known and considered three degrees of the knowledge regarding the effect size distribution : complete knowledge , i.e. , precise fraction of signals with the odds ratio greater than any given magnitude .
note that the knowledge of the distribution does not imply knowledge of the effect size that gave rise to any given p - value .
only summary information given by a probability distribution of various odds ratios is assumed .
we refer to this as the exact or the integration method .
knowledge about the abundance of three classes of odds ratios , low , average and high .
we refer to this as the discretization or the tabulated values method .
in this paper , we approximate the effect size distribution by three bins , capturing the bulk of the effect size distribution and the fourth " null " bin containing close - to - zero effect sizes , as illustrated in fig 1 .
posterior probabilities in these simulations were evaluated by eq ( 3 ) , assuming that the null bin includes odds ratios of 1 to 1.001 .
we also evaluated these probabilities by eq ( 1 ) that assumes the sharp null hypothesis .
results obtained by these two methods were identical ( up to the reported precision ) .
note that the simulations also modeled the null hypothesis as sharp , i.e. , the expected proportion pr ( h 0 ) of all signals in a simulation experiment had exactly zero effect size .
knowledge about only the mean of the distribution .
we refer to this as the single - value or the distribution mean method .
in our experiments we focused on estimating pofig probabilities for the smallest p - values .
selection of the smallest p - values may cause bias in estimation .
an extreme case of selection is when the single smallest p - value is selected from a multiple testing experiment , which we call the minp .
additionally , we may envision a process whereby the entire experiment is discarded by a researcher unless the minp is smaller than the multiple testing adjusted significance threshold .
thus , we considered two types of p - value selection ( 1 ) selecting the smallest p - values of every experiment and ( 2 ) selecting the smallest p - values of only those experiments where statistically significant findings were observed .
first , we considered just the single smallest p - value , the minp , to determine whether our method can correctly recover the probability that the minp represents a spurious signal in both of these selection scenarios .
next , we extended the experiments by considering a larger set of the smallest p - values .
in these experiments , we calculated the proportion of spurious signals among selected smallest p - values and evaluated how well our method can recover that proportion .
we used either the bonferroni at the level of 0.05 / k or benjamini and hochberg 's fdr criterion [ 12 ] at the level of 10 % as the rule for discarding sets of the smallest p - values .
2.1.1 posterior probability of h 0 for a signal with the smallest p - value with or without a multiple testing correction table 1 summarizes the posterior probabilities that the smallest p - value is a spurious signal in a study with k tests .
as expected , the posterior probabilities are unaffected by the " winner 's curse " phenomenon : the true ( first number in each cell ) and the estimated probabilities are nearly identical for the " exact " method ( the second entry in each cell ) which assumes precise knowledge of the effect size distribution ( the number of simulations was 50,000 for table 1 and 10,000 for other tables ) .
the three - value approximation works well but becomes conservatively biased with 1 x 106 tests ; the bias increases for bonferroni - selected scans ( the " 0.05 / k " columns ) compared to experiments without selection and for experiments with the relatively higher proportion of non - zero signals .
the single value approximation ( last number in each cell ) is surprisingly good for small to moderate number of tests .
at 1 x 106 tests , the bias for the smallest p - value becomes excessive ( table 1 ) , but the bias is greatly reduced as p - values with higher ranks are considered ( table 2 ) .
results in table 1 suggests that the bonferroni adjustment for multiplicity ( alpha = 0.05 / k columns ) fails to substantially decrease the probability that the smallest p - value is a spurious finding : although we observe a decrease in the values of posterior probability , the reduction is not as drastic as may have been anticipated , considering the stringency of the bonferroni threshold , 0.05 / k .
10.1371 / journal.pone.0124107.t001 table 1 probability that the minimum p - value is a false finding .
table entries w / x / y / z give the true probability ( w ) , followed by the estimated probabilities using the integration method ( x ) ; the discretization method ( y ) ; the distribution mean method ( z ) .
sample sizes ( n 1 , n 2 : number of cases , controls in allele counts ) : n 1 + n 2 = 800 for k = 10 to 10,000 ; n 1 + n 2 = 4000 for k = 106 .
number of tests pr ( h 0 ) = 0.5 pr ( h 0 ) = 0.9 no correction alpha = 0.05 / k no correction alpha = 0.05 / k k = 10 0.40 / 0.40 / 0.40 / 0.40 0.26 / 0.26 / 0.26 / 0.27 0.86 / 0.86 / 0.86 / 0.86 0.76 / 0.76 / 0.76 / 0.77 k = 100 0.28 / 0.28 / 0.28 / 0.29 0.18 / 0.18 / 0.18 / 0.20 0.79 / 0.79 / 0.79 / 0.80 0.67 / 0.67 / 0.67 / 0.70 k = 1000 0.19 / 0.19 / 0.19 / 0.21 0.12 / 0.12 / 0.13 / 0.16 0.70 / 0.70 / 0.71 / 0.73 0.56 / 0.56 / 0.58 / 0.62 k = 10,000 0.12 / 0.12 / 0.13 / 0.15 0.08 / 0.08 / 0.09 / 0.12 0.59 / 0.59 / 0.61 / 0.65 0.45 / 0.45 / 0.48 / 0.55 pr ( h 0 ) = 1 - 1000 / 106 pr ( h 0 ) = 1 - 150 / 106 no correction alpha = 0.05 / k no correction alpha = 0.05 / k k = 106 0.36 / 0.36 / 0.47 / 0.74 0.13 / 0.13 / 0.23 / 0.58 0.84 / 0.84 / 0.89 / 0.97 0.51 / 0.51 / 0.68 / 0.91 10.1371 / journal.pone.0124107.t002 table 2 the average of posterior probabilities among the 100 smallest p - values , i.e. , the false discovery rate ( fdr ) among the 100 smallest p - values .
table entries w / x / y / z give the true averaged probability ( w ) , followed by the estimated averaged probabilities using the integration method ( x ) ; the discretization method ( y ) ; the distribution mean method ( z ) .
sample sizes ( n 1 , n 2 : number of cases , controls in allele counts ) : n 1 + n 2 = 800 for k = 10 to 10,000 ; n 1 + n 2 = 14000 for k = 106 .
number of tests pr ( h 0 ) = 0.5 pr ( h 0 ) = 0.9 k = 100 0.50 / 0.50 / 0.50 / 0.50 0.90 / 0.90 / 0.90 / 0.90 k = 500 0.42 / 0.42 / 0.42 / 0.42 0.87 / 0.87 / 0.87 / 0.87 k = 1000 0.38 / 0.38 / 0.38 / 0.38 0.85 / 0.85 / 0.85 / 0.85 k = 10,000 0.26 / 0.26 / 0.26 / 0.27 0.78 / 0.78 / 0.78 / 0.79 pr ( h 0 ) = 1 - 1000 / 106 pr ( h 0 ) = 1 - 150 / 106 k = 106 0.17 / 0.17 / 0.16 / 0.23 0.82 / 0.82 / 0.81 / 0.84 2.1.2 proportion of false signals among the 5 smallest p - values with and without an application of the fdr criterion similar conclusions can be drawn from table 3 where benjamini and hochberg 's fdr criterion [ 12 ] ( b & h 's fdr ) was applied at the level of 10 % .
in experiments with the application of b & h 's fdr , the five smallest p - values were discarded unless all five satisfied b & h 's fdr criterion .
proportions of spurious signals are very similar for the results with and without the application of b & h 's fdr criterion .
10.1371 / journal.pone.0124107.t003 table 3 the average of posterior probabilities among the 5 smallest p - values , i.e. , the false discovery rate ( fdr ) among the 5 smallest p - values .
table entries w / x / y / z give the true probability ( w ) , followed by the estimated probabilities using the integration method ( x ) ; the discretization method ( y ) ; the distribution mean method ( z ) .
sample sizes ( n 1 , n 2 : number of cases , controls in allele counts ) : n 1 + n 2 = 800 .
pr ( h 0 ) = 0.5 pr ( h 0 ) = 0.9 number of tests no correction b & h 's fdr at 10 % no correction b & h 's fdr at 10 % k = 10 0.47 / 0.47 / 0.47 / 0.47 0.36 / 0.36 / 0.36 / 0.36 0.89 / 0.89 / 0.89 / 0.89 0.84 / 0.83 / 0.83 / 0.83 k = 100 0.35 / 0.35 / 0.35 / 0.35 0.26 / 0.26 / 0.26 / 0.27 0.83 / 0.83 / 0.83 / 0.84 0.75 / 0.76 / 0.76 / 0.77 k = 1000 0.23 / 0.23 / 0.24 / 0.25 0.18 / 0.18 / 0.19 / 0.20 0.75 / 0.76 / 0.76 / 0.77 0.66 / 0.66 / 0.67 / 0.70 k = 10,000 0.15 / 0.15 / 0.16 / 0.18 0.13 / 0.12 / 0.13 / 0.15 0.66 / 0.65 / 0.67 / 0.69 0.56 / 0.56 / 0.58 / 0.63 2.1.3 proportion of false signals among the 100 smallest p - values table 2 summarizes the proportion of false signals among the set of 100 smallest p - values. that proportion , or the false discovery rate ( fdr ) , is simply the average of posterior probabilities among the 100 smallest p - values .
in this case , even the single - value approximation is reasonably close to the true value : as the p - value rank moves away from minp , the bias decreases .
interestingly , the three tables of simulation results demonstrate the phenomenon that as the number of tests becomes larger , the proportion of spurious signals among a given number of top hits decreases .
this can be inferred from inspecting results of experiments with the numbers of tests k increasing from 10 to 10,000 , where the sample size and the prior pr ( h 0 ) were held the same for different values of k .
2.1.4 pofigs for the smallest p - value from a scan , its replication p - value , and for the combined scan and replication p - value in fig 2 , the first graph is a histogram of estimated posterior probabilities associated with the smallest p - value for a simulated discovery scan with 10,000 tests ( simulation details are described in the methods section " scan , replication and combined probabilities ") .
smaller probabilities that the finding is false are associated with the over - presence of genuine signals , indicated by red color , while large probabilities are associated with false signals , indicated by blue color .
the mean value of the first histogram does estimate the true proportion of false signals in an unbiased way .
however , there is a large area of overlap ( purple color ) , that is , there is no good separation of " red " and " blue " signals .
once all of these signals are evaluated in a four times larger replication sample ( middle histogram ) , we observe an appropriately u - shaped distribution .
now most low and high probabilities correctly capture the genuine and the false signals , respectively , although there is a sizable purple bar at the right indicating mis - classification of some genuine signals as false .
we observe that a sufficiently large sample size assures a good correspondence between the probability and the actual status ( genuine vs. false ) of a signal .
the u - shape becomes more prominent in the last histogram that is based on probabilities for the combined scan and replication p - values , due to an increased sample size .
these figures clearly demonstrate utility of pofig for discrimination of genuine and spurious signals .
a value of pr ( h 0 | p - value ) that is close to one reflects high likelihood that the finding is spurious .
in contrast to that , large association p - value does not give support toward the hypothesis of no association .
10.1371 / journal.pone.0124107.g002 fig 2 distribution of estimated posterior probabilities that a p - value is a false finding .
color refers to whether the actual signal is genuine ( red ) or false ( blue ) .
purple color denotes the overlap of genuine and false signals .
first graph : estimated probability that the smallest p - value in a scan ( minp ) is a false finding .
second graph : estimated probability that the signal from the scan with the smallest p - value is a false finding when evaluated in a replication study .
third graph : estimated probability that the finding is false based on the combined p - value ( the smallest scan p - value combined with the replication p - value ) .
2.2 pofig application to crohn 's disease p - values for the analysis of real data , we used snp association p - values for crohn 's disease from barrett et al. [ 13 ] we considered newly identified loci from table 2 of their work , selecting those snps for which genes of interest were listed .
utilizing their scan and replication p - values , we applied the pofig method to provide scan and replication posterior probabilities of no association for selected snps .
we used the prior for the h 0 equal to 1 - 142 / 12877 , where 142 is the number of susceptibility loci estimated by park et al. [ 7 ] and 12877 is the total number of loci , estimated using their definition of a locus based on the extent of linkage disequilibrium .
we assumed the effect size distribution to be a gamma with the shape parameter 1 and the scale parameter was chosen to give the distribution mean computed from supplementary table 3 of park et al. we also conducted a sensitivity analysis , utilizing different priors and effect size distributions including tabulated effect sizes given in park et al. [ 7 ] .
it is common to combine p - values or association statistics between studies , for example , as presented in barrett et al. ' s table 2 .
it should be pointed out that although this type of meta - analysis , based on summary statistics can be nearly as efficient as analysis based on pooling raw data [ 14 ] , possible non - independence of samples and effect size heterogeneity between studies require careful consideration during meta - analysis of gwas [ 15 ] .
the scan and replication probabilities can also be combined .
these combined probabilities can be obtained by using the posterior probability from the scan as the prior pr ( h 0 ) for the replication .
this is mathematically equivalent to replacement of fgamma - ( p ) in eq ( 1 ) by the product fgamma - ( p1 ) xfgamma - ( p2 ) where p 1 and p 2 are the scan and the replication p - values , while using the initial prior probability , pr ( h 0 ) , for the scan .
using this approach , combined posteriors probabilities , labeled as " combined pr ( h 0 | p - value )" , were obtained by combining the scan and the replication posterior probabilities that the finding is spurious for the newly discovered snp associations .
the results based on the combined probabilities provide substantially higher chances that the newly identified loci are genuine findings .
barrett et al. reported combined p - values for the scan and the replication statistics .
their values were based on a combination of two - sided statistics .
therefore , in our analyses , both the scan - and the replication posterior probabilities were obtained using two - sided p - values .
this approach does not take into account direction of the association ( i.e. , effect sign ) .
in materials and methods we describe a simple way that takes into consideration the correspondence of effect directions between studies ( section " scan , replication and combined probabilities ") .
fig 3 and table 4 provide combined posterior probabilities for the newly identified loci reported in barrett et al. [ 13 ] .
barrett et al. ' s scan , replication , and combined p - values are given in the table for comparison .
figs 4 and 5 and table 5 illustrate the effect of the prior probability and the assumed effect size distribution on the posterior estimates of pr ( h 0 | p - value ) .
neither of the choices considered in the table and figures substantially affected the posterior probability that the association is false .
in particular , posterior probabilities using the tabulated distribution are similar to the ones obtained assuming a continuous , l - shaped gamma distribution .
10.1371 / journal.pone.0124107.g003 fig 3 minus log of posterior probabilities that the finding is spurious .
minus 1 - pofig for novel snp associations with crohn 's disease in barrett et al. reported on the logarithmic scale .
10.1371 / journal.pone.0124107.t004 table 4 p - values reported for the newly identified loci for crohn 's disease in barrett et al. and the corresponding posterior probabilities of the null hypothesis .
rows highlighted in bold correspond to the maximum and minimum scan p - values .
p - value pr ( h 0 | p - value ) snp scan replic .
combined scan replic .
combined gene rs2476601 1.8 x 10 - 5 1.0 x 10 - 4 1.5 x 10 - 8 0.043 0.174 1.1 x 10 - 4 ptpn22 rs2274910 3.5 x 10 - 7 4.8 x 10 - 4 1.5 x 10 - 9 0.001 0.457 1.4 x 10 - 5 itln1 rs10045431 8.8 x 10 - 9 3.7 x 10 - 6 3.9 x 10 - 13 4.9 x 10 - 5 0.012 6.7 x 10 - 9 il12b rs6908425 2.5 x 10 - 7 2.8 x 10 - 4 9.0 x 10 - 10 0.001 0.340 6.3 x 10 - 6 cdkal1 rs2301436 3.3 x 10 - 7 3.3 x 10 - 7 1.0 x 10 - 12 0.001 0.001 2.3 x 10 - 8 ccr6 rs10758669 6.8 x 10 - 7 4.3 x 10 - 4 3.5 x 10 - 9 0.003 0.432 2.2 x 10 - 5 jak2 rs7927894 1.4 x 10 - 7 7.3 x 10 - 4 1.3 x 10 - 9 0.001 0.551 9.0 x 10 - 6 c11orf30 rs11175593 1.3 x 10 - 7 1.6 x 10 - 4 3.1 x 10 - 10 0.001 0.245 2.2 x 10 - 6 lrrk2 - muc19 rs2872507 2.1 x 10 - 6 2.9 x 10 - 4 5.0 x 10 - 9 0.007 0.350 4.2 x 10 - 5 ormdl3 rs744166 5.9 x 10 - 6 9.1 x 10 - 8 6.8 x 10 - 12 0.017 4.6 x 10 - 4 8.7 x 10 - 8 stat3 rs762421 1.1 x 10 - 5 1.6 x 10 - 5 1.4 x 10 - 9 0.028 0.041 1.4 x 10 - 5 icoslg the proportion of false findings ( fdr ) 0.009 0.237 1.9 x 10 - 5 10.1371 / journal.pone.0124107.g004 fig 4 probability that a finding is false ( 1 - pofig ) .
the probability that the most significant newly identified loci reported in barrett et al. is false .
the prior probabilities are based on the estimates for the total number of susceptibility snps reported in park et al. the shape parameter 0.634 was chosen to yield the median value of the noncentrality distribution to be twice as small as that of the exponential distribution ( shape = 1 ) for the same value of the scale .
10.1371 / journal.pone.0124107.g005 fig 5 probability that a finding is false ( 1 - pofig ) .
the probability that the least significant newly identified loci reported in barrett et al. is false .
the prior probabilities are based on the estimates for the total number of susceptibility snps reported in park et al. the shape parameter 0.634 was chosen to yield the median value of the noncentrality distribution to be twice as small as that of the exponential distribution ( shape = 1 ) for the same value of the scale .
10.1371 / journal.pone.0124107.t005 table 5 posterior pr ( h 0 | p - value ) for two newly identified loci based on the results reported in barrett et al .
[ 13 ] .
the three prior probabilities are based on the three estimates for the total number of susceptibility snps taken from park et al's. supplementary table 5 .
[ 7 ] the " tabulated " effect size distribution is based on park et al 's supplementary table 3 ; " scale " in gamma ( 1 or 0.634 , scale ) is chosen to have the distribution mean equal to that of the tabulated distribution .
snp gene reported p - value prior effect size distribution posterior rs10045431 il12b 8.80 x 10 - 9 1 - 76 / 12877 tabulated 1.9 x 10 - 4 gamma ( 0.634 , 27.21 ) 1.0 x 10 - 4 gamma ( 1 , 17.25 ) 8.6 x 10 - 5 1 - 142 / 12877 tabulated 9.9 x 10 - 5 gamma ( 0.634 , 27.21 ) 5.5 x 10 - 5 gamma ( 1 , 17.25 ) 4.6 x 10 - 5 1 - 219 / 12877 tabulated 6.4 x 10 - 5 gamma ( 0.634 , 27.21 ) 3.6 x 10 - 5 gamma ( 1 , 17.25 ) 3.0 x 10 - 5 rs2476601 ptpn22 1.81 x 10 - 5 1 - 76 / 12877 tabulated 0.082 gamma ( 0.634 , 27.21 ) 0.096 gamma ( 1 , 17.25 ) 0.078 1 - 142 / 12877 tabulated 0.045 gamma ( 0.634 , 27.21 ) 0.054 gamma ( 1 , 17.25 ) 0.043 1 - 219 / 12877 tabulated 0.030 gamma ( 0.634 , 27.21 ) 0.035 gamma ( 1 , 17.25 ) 0.028 fig 6 illustrates the comparison of the pofig posterior probabilities of no true associations to the fprp values .
the fprp estimates tend to be smaller , as they refer to the whole tail of p - values as small as the one observed .
the posterior probabilities of h 0 are monotone in the ranking of p - values as the distribution of the noncentralities for this analysis was specified directly ( eq 14 ) , based on the results reported in park et al. [ 7 ] 10.1371 / journal.pone.0124107.g006 fig 6 posterior probabilities of the null hypothesis by pofig and fprp methods .
the posterior probabilities are calculated for the newly identified crohn 's disease associations from barrett et al. ' s study [ 13 ] .
unmarked genes in the lower left corner : il12b , lrrk2 - muc19 , c11orf30 , cdkal1 , ccr6 , itln1 - - for red and blue ; il12b , lrrk2 - muc19 , c11orf30 , cdkal1 , ccr6 , itln1 , jak2 - - for green ( fprp ) .
3 discussion modern molecular technologies continue to reveal information about genetic architecture of human diseases .
it is now possible to utilize available knowledge to make informed decisions regarding parameters needed for the calculation of probability that a p - value represents a genuine association , namely the overall proportion of susceptibility loci and the distribution of their effect sizes .
the " false positive report probability " ( fprp ) approach [ 3 ] utilizing these parameters was proposed previously , however the fprp was not designed as a method for assessing the probability that a finding ( i.e. , a " report ") in question is false .
here we introduce a similarly inspired approach , the method for assessing the " probability that a finding is genuine " ( pofig ) .
our method eliminates the shortcomings of fprp , but shares its computational simplicity .
as in the fprp approach , one can simply assume a " typical " effect size ( taken to be the mean of the underlying true distribution ) .
this results in a method that is just as simple computationally as the fprp .
its bias in the estimation of the posterior probability increases with the number of tests , but decreases with the p - value magnitude or rank. that is , the bias is the largest for the most significant finding in a study .
when the mean value is used , estimate of the posterior probability that the finding is spurious appears to be conservative ( i.e. , it is larger than the true value ) and is tolerably small for experiments with as many as 10,000 tests .
truly massive multiple testing experiments such as whole genome sequencing and genome - wide association studies may require a more precise specification of the effect size distribution .
ideally , the whole probability distribution needs to be specified and the population genetics theory suggests that a gamma distribution can be successfully utilized to model the expected l - shaped distribution of effect sizes [ 16 ] .
a far more convenient way is to assume several tabulated effect size values with the relative abundance of each .
methods and data from which these values can be readily extracted are starting to emerge [ 7 ] .
we find that this computationally simple approach can greatly reduce the bias and usage of only three bins with low , moderate and large effect size values already provides sufficient precision .
false signals can be handled in two different ways within our approach .
traditionally , false signals are assumed to have zero effect size ; this requires specification of the prior probability of the null hypothesis , pr ( h 0 ) .
alternatively , an extra " null bin " is introduced with its respective proportion for signals which effect sizes are within a narrow interval close to zero .
the second specification acknowledges an understanding that there are many signals whose effect sizes are tiny but non - zero , avoiding an unrealistic assumption that there is a sizable fraction of signals with exactly zero effect size .
there are various desirable properties of pofig .
when the same genetic variant ( hypothesis ) is tested in several studies , one can assess the combined posterior probability of false association by sequentially using the 1 - pofig probability from one study as the prior pr ( h 0 ) for the next .
this can be entered in any order and is equivalent to using the initial prior probability , pr ( h 0 ) , while replacing f gamma ( p ) in eq ( 1 ) by the product f gamma ( p 1 ) x f gamma ( p 2 ) x ... , where p i is the i - th study p - value .
alternatively , one can combine study - specific p - values first and convert the result to the posterior probability of a hypothesis .
this approach gives a simple way to account for correspondence in the effect direction between studies ( eqs 20 , 21 ) .
we may contrast this approach with the practice of combining scan and replication statistics or p - values .
barrett et al. reported scan , replication and combined p - values in their table 2 .
their combined values are obtained by pooling z - statistics , and very similar values can be obtained by combining their scan and replication p - values by the inverse normal method [ 17 ] .
these combined p - values are biased under the hypothesis of no association by the fact that the scan p - values were selected among the set of the smallest p - values .
to preserve the type - i error rate in a conservative way , these combined p - values would need to be adjusted by the number of tests in the scan .
ideally , classical p - value combination procedures would need to take into account the number of tests as well as ranks of p - values in both the scan and the replication studies [ 18 ] .
following our approach , we combined the scan and the replication posterior probabilities for novel snp associations with crohn 's disease [ 13 ] using our approach ( fig 3 ) .
not only the two probabilities can be combined in a straightforward way , but they can also be averaged across selected snps .
this average gives the estimated proportion of spurious signals among the snps .
in the analysis of barrett 's data , we computed probabilities that a finding is spurious ( i.e. , false ) .
the average of these probabilities gives the estimated proportion of false signals , or the false discovery rate estimate ( fdr ) , as reported in the last row of table 4 .
selection issues aside , the scan and combined p - values in table 4 should be viewed with caution , because the smallest gwas p - values may themselves be imprecise for various reasons , including residual confounding , genotyping errors , and violations of statistical assumptions in computing p - values from very large values of association statistics .
we also assume that the bulk of p - value distribution is appropriately flattened by methods that adjust for systematic biases caused by population stratification or other sources of confounding [ 19 - 21 ] .
our posterior probabilities are extracted from p - values , thus they are similarly affected by these issues .
our approach compares favorably to classical estimation procedures where effect size estimates for top hits of a study tend to be over - estimated and the corresponding p - values tend to be too small .
this bias , known as the winner 's curse phenomenon , has been a formidable challenge .
bowden and dudbridge concluded that in the classical ( frequentist ) statistical framework , no unbiased correction is possible without replication data [ 10 ] .
combination of selected smallest p - values results in complicated distributions [ 22 - 24 ] and methods for combining results from studies , some of which involve selection of the best results , are lacking .
the main appeal of our method is that it is unaffected by selection of either smallest or statistically significant p - values , as we demonstrated by simulation experiments .
estimated posterior probabilities and their averages among selected p - values ( fdr estimates ) are unbiased .
these estimates of posterior probabilities and especially of their averages among the smallest p - values were shown to be robust in the presence of high linkage disequilibrium [ 25 ] .
admittedly , high precision in estimation of true probabilities comes at a price of correct specification of the effect size distribution and the overall proportion of susceptibility variants .
this underlines importance of emerging statistical research on estimation of these parameters from large scale genetic data .
table 1 shows that in experiments with and without a multiplicity correction , the smallest p - value is increasingly more likely to represent a genuine signal as the number of tests increases from 10 to 10,000 .
in experiments with the multiplicity correction , only those experiments were retained for analysis where one or more results were significant .
although the multiplicity adjustment itself does not change the order of p - values , probability for the signal with the smallest p - value to be genuine changes when computed among those retained experiments with significant findings .
there is another interpretation of these results .
in the columns with the multiplicity correction , simulations can be thought of as modeling a process that leads to the publication bias phenomenon : experiments without significant findings are put in a file drawer , while those with significances are sent to a journal .
the fact that the calculated posterior probability correctly estimates the true proportion of spurious results indicates that our method is unaffected by the publication bias phenomenon .
the calculation of posterior probabilities is not informed in any way by the significance threshold used or by how many tests were performed .
it is understood within the research community that p - values , even after a multiplicity adjustment still do not reflect chances that the finding is spurious .
nevertheless , multiplicity adjustments are thought to be highly efficient in filtering out spurious results , similarly to how the distillation process turns the wash into vodka .
it is evident from table 1 after comparing probabilities for columns with and without the correction that the multiplicity adjustment even as strict as the bonferroni does not necessarily serve as a good filter of spurious signals .
application of benjamini and hochberg 's fdr criterion ( table 3 ) changes the true proportion of spurious signals only slightly .
when half of the signals are genuine , this proportion drops from 15 % to 12 % , but in these simulations , only about 1 in every 18 experiments had all five smallest p - values significant by this criterion .
these simulations were deliberately designed to be under - powered to detect any single genuine signal .
in studies with low power , genuine signals do not come up at the top with high certainty .
in these situations , multiple - testing approaches should supposedly shield us from accepting too many spurious signals as genuine .
as we see , this is not the case .
moreover , there appears to be increased enrichment of top hits by genuine signals as the number of tests becomes larger .
in summary , p - values , despite their deficiencies , do contain information that can be used for judging validity of findings and we propose pofig for converting p - values to valid probabilities that a finding is genuine .
as we demonstrate , this simple method avoids numerous complications that arise in making decisions based on p - values .
pofig requires an informed input from researchers regarding a likely proportion of genuine signals in their multiple testing experiments and some characterization of the effect size distribution .
the later can be replaced by a good guess for the mean of that distribution unless the p - values are extremely small , in which case validity of p - values themselves is likely in doubt .
software microsoft excel and r programs to convert p - values to posterior probabilities that a finding is genuine are available at https :// sites.google.com / site / pofigscript / or by a request to d.v.z. the programs assume that p - values result from one degree of freedom chi - square tests , but can be easily modified to accommodate other tests statistics .
we welcome requests for help with modifications .
4 materials and methods suppose our test statistic is z , with the cumulative distribution function ( cdf ) under the null hypothesis denoted by g 0 (.) .
under the alternative hypothesis , h a , we denote its cdf by g gamma (.) .
the parameter gamma captures deviation from the null hypothesis .
p - value is obtained in the usual manner , as p = 1 - g 0 ( z ). by rewriting this and applying the inverse of the cdf , g0 - 1 (.) , we recover the statistic z : 1 - p = g0 ( z ) g0 - 1 ( 1 - p )= z ( 7 ) under h a , the p - value has the cdf 1 - g gamma ( z ) .
we can apply 1 - g gamma (.) to the both sides of eq ( 7 ) to write this distribution in terms of the usual p - value computed under h 0 .
thus , under h a , the p - value cdf , which we denote by f gamma ( p ) is fgamma ( p | gamma )= 1 - ggamma [ g0 - 1 ( 1 - p )] ( 8 ) by differentiating this cdf , we obtain the corresponding probability density function , pdf : fgamma ( p | gamma )= ggamma ( g0 - 1 ( 1 - p )) g0 ( g0 - 1 ( 1 - p )) ( 9 ) here , g 0 (.) and g gamma (.) are the pdfs that correspond to the cdfs g 0 (.) and g gamma (.) .
p - value distribution as defined in this section arises from a broad range of statistical tests .
for a normally distributed test statistic , gamma is the normal mean , shifted away from zero .
for chi - squared f , and t statistics , gamma is the noncentrality parameter of the corresponding distribution .
in all these cases , zero value of gamma corresponds to h 0 .
thus , the p - value distribution is quite general with regard to the underlying statistical test .
its applicability is not limited to models with a single predictor ; e.g. , in regression models with adjustment for covariates , distribution of p - value for a predictor of interest can be modeled in the same way .
the proposed approach applies to continuous test statistics with a distribution where the degree of deviation from h 0 is captured by a value of a single parameter ( gamma ) .
because this approach requires an explicit specification of the distribution , it cannot be readily applied to p - values that result from permutation - based tests and other tests that are based on resampling .
it is at present unclear whether our approach would provide sufficient precision when applied simply as a convenient statistical device to approximate and model an unknown ( e.g. , resampling ) distribution .
we note that a beta distribution has been used successfully to mimic p - value distributions in several studies concerned with problems related to those considered here [ 26 - 29 ] .
the choice of a beta distribution in these studies was due to flexibility of its shape rather than to any known relation to the actual distribution of p - values .
good performance of approximations based on a beta distribution is encouraging , given that the p - values of common test statistics do not in fact follow that distribution .
thus , the issue of applicability of our approach to p - values that do not necessarily follow an assumed parametric distribution is worthy of future investigation .
to make the exposition more focused , we primarily discuss the binary outcome , a chi - square statistic , and the effect size defined via odds ratios or directly as a value of the noncentrality , but there is no restriction for the outcome to be binary .
lee and wray provide useful expressions that present the noncentrality parameter in terms of the proportion of variability in the outcome due to a genetic predictor [ 30 ] .
these expressions cover a variety of designs with different sampling schemes and both continuous and binary outcomes .
yang et al. give formulas to relate noncentralities of population - based quantitative trait and case - control designs [ 31 ] .
4.1 false positive report probability if the rejection of the null hypothesis is based on some nominal alpha - level , such as 5 % , the probability of obtaining p - value , p , that is at least as small as alpha is equal to alpha , given that the null hypothesis is true : pr ( p <= alpha | h 0 ) = alpha .
the value alpha defines the type - i error rate .
under the alternative hypothesis , denoted by h a , the corresponding probability is the power : pr ( p <= alpha | h a ) = 1 - beta , where beta is the type - ii error rate : the probability of failing to reject the null hypothesis correctly. by the bayes rule , pr ( h0 | p <= alpha )= pr ( p <= alpha | h0 ) pr ( h0 ) pr ( p <= alpha | h0 ) pr ( h0 )+ pr ( p <= alpha | ha ) pr ( ha )=[ 1 + 1 - pr ( h0 ) pr ( h0 ) xpr ( p <= alpha | ha ) pr ( p <= alpha | h0 )] - 1 ( 10 ) this approach was used by morton to define posterior probabilities in the context of genetic linkage analysis [ 32 ] .
it also forms the basis of the false positive report probability ( fprp )[ 3 ] .
although wacholder et al. assumed a single ( typical ) effect size , the probability pr ( p <= alpha | h a ) depends on the distribution of all possible effect sizes and has to be represented in its marginal form , i.e. , averaged over all possible values of the effect size for genuine signals pr ( p <= alpha | ha )= integralfgamma ( alpha | gamma ) gamma ( gamma ) dgamma ( 11 ) assuming that gamma follows the distribution gamma ( gamma ). by using the notation fgamma - ( alpha )= pr ( p <= alpha | ha ) and assuming , following wacholder et al. , uniformity of p - values under h 0 , so that f 0 ( alpha ) = pr ( p <= alpha | h 0 ) = alpha , the fprp is fprp =[ 1 + 1 - pr ( h0 ) pr ( h0 ) xfgamma ( alpha ) alpha ] - 1 ( 12 ) eq ( 12 ) gives the proportion of null signals among p - values that are smaller or equal to a fixed threshold alpha .
wacholder et al. advocated plugging in an observed p - value in place of alpha .
because pr ( p <= alpha | h a ) >= pr ( p <= alpha | h 0 ) , the result can never be larger than the prior probability , pr ( h 0 ) .
for the result to be interpreted as the probability of no true association between a genetic variant and disease given a p - value , a modification is needed , as described in the next section .
4.2 pofig : probability that a finding a genuine in this section , we present pofig via its relation to fprp , assuming the point null hypothesis , i.e. , exactly zero effect size for false signals .
to obtain the posterior probability of h 0 given a particular p - value , one cannot simply substitute alpha in eq ( 12 ) for the p - value ( p ) , because the ratio of cdfs , fgamma - ( p )/ f0 ( p )= fgamma - ( p )/ p would refer to the entire interval [ 0 , p ] .
to assess the posterior probability of h 0 given an observed p - value , one could consider a narrow interval around p instead .
this is simply achieved by replacing the ratio of cdfs by the ratio of densities : pr ( h0 | p )= limdelta - - > 0pr ( h0 | pin [ p,p + delta ])=[ 1 + 1 - pr ( h0 ) pr ( h0 ) xfgamma ( p ) f0 ( p )] - 1 as in the original fprp approach , we will assume that p - values follow the uniform distribution under h 0 , i.e. , f 0 ( p ) = 1 , so that the probability that the finding is genuine is pofig = pr ( ha | p )= 1 - pr ( h0 | p )= 1 - [ 1 + 1 - pr ( h0 ) pr ( h0 ) xfgamma ( p )] - 1 ( 13 ) where fgamma - ( p ) is the marginal p - value density that acknowledges that different signals have different effect sizes .
the next subsection presents basic ways to take this distribution into account in computing the averaged (" marginal ") p - value pdf .
conceptually , 1 - pofig corresponds to the local fdr [ 33 , 34 ] .
the equivalence of local fdr and the " point null " version of pofig is in that they are both inversions of the conditional probability .
both can be described as an application of the bayes rule .
there are several differences between the approaches .
one difference is that p - value and pofig ranks are not necessarily the same , while local fdr ( and q - values ) have the same ranks as p - values .
further , pofig in its general form , where the null hypothesis is not a point , eq 3 ) is no longer equivalent to the local fdr .
we argue that this form is a more biologically realistic representation of the effect size distribution ; not only the point null is a statistical abstraction , but it is expected that most genetic variants with heritable contribution have only tiny effect on a trait .
another distinction is in how the p - value distribution is modeled .
local fdr relies on an empirical bayes approach which uses the totality of data to evaluate prior parameters .
this approach works well when non - null signal frequency is high , as found in differential gene expression studies .
in contrast , q - value and local fdr approaches are not commonly applied in genetic association studies , where they may not be reliable due to high sparsity of true signals [ 35 ] .
4.2.1 marginal p - value density : continuous approach if the sample size is the same or similar for all tests , as can be found in snp association studies , one can specify the distribution for the parameter gamma directly : gamma ~ gamma (.) .
realistic shapes for the effect size distribution in association studies would assume that there are many small effects and few that are large .
effect size distributions for such genetic association signals follow an " l - shape " that is well approximated by a gamma distribution with the shape parameter smaller or equal to one [ 16 ] .
there are some advantages to this approach .
as suggested by park et al. [ 7 ] , when gamma is defined as in eq ( 6 ) , then gamma x 2 / n can serve as a definition of the effect size and corresponds to the contribution of a snp to the additive genetic variance of the trait .
it is also very general in that gamma may refer to a parameter that is measuring a deviation from h 0 for a variety of test statistics , including noncentrality for chi - square and f distributions , and mean shift for normally or t - distributed test statistics .
it has been noted that because gamma values would typically depend on allele frequency , an implicit assumption in modeling the distribution of gamma directly is that less frequent alleles tend to have larger effect size [ 36 ]. with this approach , the marginal p - value pdf is fgamma ( p )= integralfgamma ( p | gamma ) gamma ( gamma ) dgamma ( 14 ) when sample sizes ( n ) differ among tests , we can take advantage of the fact that n often appear as a separate term ( as in eq 6 ) and specify a distribution for the standardized effect size , e ~ gammae (.) .
contingency table chi - square noncentrality can be similarly written in terms of the actual ( o i ) and expected e i frequencies as gamma = n x sum ( o i - e i ) 2 / e i. for the normal test statistics , n factors out instead .
thus , allowing for varying sample sizes of different tests , the marginal p - value pdf is fgamma ( p )= 1sigmaintegralfgamma ( p | gamma ) gammae ( gammasigma ) dgamma ( 15 ) where sigma is equal to n for chi - square and n for normal test statistics .
it is also possible to specify a distribution for a non - standardized effect size , defined , for example , by the square of log odds ratio , d , as in the logistic model ( eq 6 ) .
this model specifies that d follows the distribution gammad (.) .
in this case , the marginal pdf is a function of both the p - value and the allele frequency , q. then the marginal p - value pdf is fgamma ( p )= 1sigmaintegralfgamma ( p | gamma ) gammad ( gammasigma ) dgamma ( 16 ) in this specification , sigma = nq ^( 1 - q ^) , where q ^ is the sample pooled allele frequency .
given the three alternative specifications of the marginal p - value density just described , we will consider two approximations that do not require the complete specification of the effect size distribution , gamma (.) and allow to sidestep calculation of the integral .
4.2.2 marginal p - value density : typical effect size method the first approximation is reminiscent of the fprp approach where a " typical " single value is considered in place of the entire effect size distribution. by writing eq ( 14 ) as an expectation and applying the first order taylor expansion , we obtain an approximation as fgamma ( p )= e { fgamma ( p | gamma )}=~ fgamma ( p | mugamma ) ( 17 ) where mu gamma is the mean value of the effect size distribution. with the specification by eq ( 14 ) , mu gamma = e ( gamma ). with the specifications by eqs ( 15 , 16 ) , mu gamma = sigma x e ( e ) and mu gamma = sigma x e ( d ) , respectively .
this approximation is appealing primarily because it is a much simpler task for a researcher to specify a single " typical " value than to come up with the entire effect size distribution .
here , we consider utilization of the mean primarily as a way of misspecification of the effect size distribution .
the effect size distribution can be misspecified in an infinite number of ways , and reducing the distribution to just the mean gives one such natural way .
the effect of misstating the mean would introduce further bias in posterior estimates , however it is difficult to systematically evaluate that bias , since its degree would depend on many parameters , including sample size .
nevertheless , for any specific study , researchers may evaluate the effect of varying the mean on robustness of the posterior inference .
4.2.3 marginal p - value density : tabulated values ( discretization ) method while the simple " mean " approximation can be sufficient , sometimes it may introduce a noticeable imprecision .
the second approximation is based on discretizing the effect size distribution into several " bins " .
while only slightly more complex than the previous approximation , our results indicate that usage of as little as three bins provides sufficient precision .
one possible way , based on the extension of the previous single - value method is to take the middle bin to be centered around the mean value of the effect size distribution mu , with the left and the right sides extending to mu - mu / 2 and mu + mu / 2 , respectively .
assuming the majority of signals are of small size and signals of large magnitude are rare , the effect size distribution can be represented by a gamma ( shape , scale ) distribution with the shape smaller or equal to one .
these distributions taper off as shown in fig 1 and the mean value is mu = scale x shape .
the figure also illustrates a representation of a continuous distribution by three mean values for each of three bins .
each bin is characterized by its mean effect size value mu i and the relative proportion ( signal count ) for the bin , w i. the marginal density approximation is fgamma ( p )=~ sumi = 1bwifgamma ( p | gammai ) sumi = 1bwi ( 18 ) where b is the number of bins. with the specification given by eq ( 14 ) , gamma i = mu i. with the specifications given by eqs ( 15 , 16 ) , gamma i = mu i sigma .
park et al. designed a method for tabulating effect sizes with their respective abundances ( w i ) based on gwas data and provided such tabulated values for several diseases .
in their definition , effect sizes are expressed as gamma x 2 / n ( where gamma and n are given by eq 6 ) .
4.3 simulation experiments each simulation experiment consisted of k one degree of freedom chi - square allelic association tests .
each test with its corresponding p - value was randomly chosen to represent either a genuine or a spurious signal with respective probabilities 1 - pr ( h 0 ) for genuine and pr ( h 0 ) for spurious signals .
for experiments with k <= 10000 tests , we assumed two distinct proportions of false signals .
scenario 1 was modeled after a " fishing expedition " , using a relatively large proportion 0.9 .
scenario 2 was " we know what we are doing " setup with the smaller proportion of 0.5 .
for simulations with a very large number of tests , k = 106 , we used much larger proportions of false signals , 1 - ( 150 / 106 ) and 1 - ( 1000 / 106 ) that are expected in genome wide association studies .
these proportions and the number of tests are given in table 1 .
for a given genuine signal , its effect size d was sampled from a gamma distribution with parameters as will be specified below .
then , the population snp frequency q was sampled from the uniform ( 0.05 , 0.95 ) distribution .
for a given sample size parameter n ( given by eq 6 ) , the noncentrality parameter was determined as gamma = n d q ( 1 - q ) , according to eq ( 6 ) .
next , the p - value for this particular genuine effect was sampled as follows : ( 1 ) sample a normal z - score z from the standard normal distribution ; ( 2 ) convert z to a noncentral chi - square statistic x =( z + gamma ) 2 ; ( 3 ) calculate the p - value using the central chi - square cumulative distribution function ( cdf ) with one degree of freedom , g 0 (.) , as p - value = 1 - g 0 ( x ) .
the value gamma was discarded , i.e. , it was assumed to be unknown , and only the p - value was stored .
p - values for spurious signals were sampled from the uniform ( 0,1 ) distribution .
for the effect size distribution , we assumed an l - shaped gamma distribution with the shape equal to one .
we assumed the mean odds ratio of 1.1 from which the effect size distribution is given approximately by gamma ( 1 , [ log ( 1.1 )] 2 ) .
sample sizes are given in footnotes for the tables of results ( tables 1 , 2 and 3 ) .
since effect sizes were modeled in terms of odds ratios instead of the noncentralities , the marginal p - value density for the exact method was computed via eq ( 16 ) .
allele frequency was binomially sampled given the signal - specific population allele frequency and the sample size .
the noncentrality parameter was computed via eq ( 6 ) .
eq ( 1 ) was used to obtain the posterior probability , assuming known prior proportion of spurious signals .
note that the method of modeling the effect size distribution in terms of odds ratios , applied in these simulations does not preserve the ranking of p - values when they are converted to the posterior probability of h 0 .
this is because two snps with the identical odds ratios may have different allele frequencies , and the allele frequency is a part of the posterior computation .
4.3.1 scan , replication and combined probabilities that the finding is genuine to illustrate the distribution of scan , replication and combined posterior probabilities as well as their accuracy in distinguishing between genuine and spurious signals , we used a simulation setup similar to the one just described .
in each of these experiments , we took the smallest p - value ( minp ) from the scan ( n = 4000 ) , and generated a random replication p - value , re - using the effect size associated with the scan minp .
for the replication study , we assumed a four times larger sample size , pr ( h 0 ) = 0.99 , and the number of tests equal to k = 10000 .
probabilities for the replication samples were computed in a conservative way , using the same effect size distribution as that assumed for the scan , although the effect size distribution in replication studies is expected to be modified .
one can most easily combine scan and replication posterior probabilities , or more generally , probabilities from s independent studies if p - values are reported as one - sided , that is , when a specific direction of association is being tested .
in this case , the distribution of effect sizes needs to reflect the effect direction as well , for example , log odds ratios instead of their squared values might be used .
then eq ( 1 ) is modified as pofig = 1 - [ 1 + 1 - pr ( h0 ) pr ( h0 ) xproductj = 1sfgamma ( pj )] - 1 ( 19 ) most association p - values are reported as two - sided , i.e. , based on an association statistic where the direction of association is not reflected .
there is also convenience in using two - sided p - values , in which case the effect size distribution is specified based on its magnitude , without taking into account the sign of the effect .
a simple way of taking the effect sign into account is to convert two - sided scan and replication p - values to one - sided , then combine one - sided p - values , and convert the result ( p o ) back to a two - sided p - value , p t. the resulted combined p - value approximates well the p - value that would have been obtained by pooling individual - level data [ 37 ] .
in general , several two - sided p - values ( p i , i = 1 , ... , k ) can be combined with this method as follows : po = 1 - phi [ sumi = 1k [ 2i ( signi = sign1 ) - 1 ] wiphi - 1 ( pi / 2 ) sumi = 1kwi2 ] ( 20 ) pt = 2min ( po,1 - po ) ( 21 ) where i (.) is the indicator function , signi is the effect direction associated with the p - value p i , phi - 1 (.) is the inverse normal cdf , and w i are the weights which can be taken to be square roots of the sample sizes ( square root of the harmonic mean of case and control sample sizes for case - control studies ) .
such combined p - value can be converted to the posterior probability in the same way as the original p - values ( using eq 1 ) , but utilizing the total sample size of the studies .
we illustrated this approach via simulation experiments ( as summarized in fig 2 ) .
4.4 pofig application to crohn 's disease p - values for crohn 's disease , the total number of susceptibility loci was estimated together with the tabulated effect size distribution by park et al. [ 7 ] and given in their supplementary tables 3 and 5 in a standardized fashion as 2dq ( 1 - q ) which is 2 / n of the noncentrality for the logistic model ( eq 6 ) .
therefore , we modeled the marginal p - value density , which is a part of eq ( 1 ) for the posterior probability by assuming the distribution for the noncentralities directly ( eq 14 ) .
this method preserves the ranking of p - values when they are converted to the posterior probability of h 0 .
we assumed a gamma distribution with the shape parameter equal to 1 .
the second parameter of the gamma distribution , its scale , was obtained using its property that mean = shape x scale .
park 's supplementary table 5 was used to derive the mean effect size value .
we used park 's estimate of 142 susceptibility loci .
the " loci " in this case correspond to associated regions , defined by barrett et al. on the basis of linkage disequilibrium , with the average locus length equal to 232973 base pairs .
taking the total genome length to be 3 billion base pairs , the number of segments with that length in the genome is 12877 .
we used these numbers to derive the prior for the h 0 as 1 - 142 / 12877 .
additionally , we evaluated our pofig approach with different priors and effect size distributions .
we considered different estimated numbers of susceptibility loci obtained by different methods as given in supplementary table 5 of park et al. for the approach that assumes a continuous effect size distribution , we utilized a gamma distribution with the shape parameter equal to 1 or 0.634 .
the value 0.634 for shape parameter value was chosen to yield the median value of the noncentrality distribution to be twice as small as that of the distribution with the shape equal to 1 for the same value of the scale .
again , the second ( scale ) parameter was determined by the mean effect size value .
references 1 ioannidis jp , tarone r , mclaughlin jk . the false - positive to false - negative ratio in epidemiologic studies . epidemiology .
2011 ; 22 ( 4 ) : 450 - 456 . doi : 10.1097 / ede.0b013e31821b506e 21490505 2 young ss , karr a . deming , data and observational studies . significance .
2011 ; 8 ( 3 ) : 116 - 120 . 3 wacholder s , chanock s , garcia - closas m , el ghormli l , rothman n . assessing the probability that a positive report is false : an approach for molecular epidemiology studies . j natl canc inst .
2004 ; 96 ( 6 ) : 434 - 442 . doi : 10.1093 / jnci / djh075 4 wacholder s , chanock s , garcia - closas m , katki ha , rothman n , et al response : re : assessing the probability that a positive report is false : an approach for molecular epidemiology studies . j natl cancer inst .
2004 ; 96 ( 22 ) : 1722 - 1723 . doi : 10.1093 / jnci / djh327 15547186 5 lucke jf . a critique of the false - positive report probability . genet epidemiol .
2009 ; 33 ( 2 ) : 145 - 150 . doi : 10.1002 / gepi.20363 18720477 6 wakefield j . a bayesian measure of the probability of false discovery in genetic epidemiology studies . am j hum genet .
2007 ; 81 ( 2 ) : 208 - 227 . doi : 10.1086 / 519024 17668372 7 park jh , wacholder s , gail mh , peters u , jacobs kb , chanock sj , et al estimation of e ect size distribution from genome - wide association studies and implications for future discoveries . nat genet .
2010 ; 42 ( 7 ) : 570 - 575 . doi : 10.1038 / ng.610 20562874 8 yang j , benyamin b , mcevoy bp , gordon s , henders ak , nyholt dr , et al common snps explain a large proportion of the heritability for human height . nat genet .
2010 7 ; 42 ( 7 ) : 565 - 569 . doi : 10.1038 / ng.608 20562875 9 visscher pm , brown ma , mccarthy mi , yang j . five years of gwas discovery . am j hum genet .
2012 ; 90 ( 1 ) : 7 - 24 . doi : 10.1016 / j.ajhg.2011.11.029 22243964 10 bowden j , dudbridge f . unbiased estimation of odds ratios : combining genomewide association scans with replication studies . genet epidemiol .
2009 ; 33 ( 5 ) : 406 - 418 . doi : 10.1002 / gepi.20394 19140132 11 senn s . a note concerning a selection " paradox " of dawid 's . am stat .
2008 ; 62 ( 3 ) : 206 - 210 . doi : 10.1198 / 000313008x331530 12 benjamini y , hochberg y . controlling the false discovery rate : a practical and powerful approach to multiple testing . j royal stat soc b .
1995 ; 57 ( 1 ) : 289 - 300 . 13 barrett jc , hansoul s , nicolae dl , cho jh , duerr rh , rioux jd , et al genome - wide association defines more than 30 distinct susceptibility loci for crohn 's disease . nat genet .
2008 ; 40 ( 8 ) : 955 - 962 . doi : 10.1038 / ng.175 18587394 14 lin d , zeng d . meta - analysis of genome - wide association studies : no efficiency gain in using individual participant data . genet epidemiol .
2010 ; 34 ( 1 ) : 60 - 66 . doi : 10.1002 / gepi.20435 19847795 15 zaykin dv , kozbur do . p - value based analysis for shared controls design in genome - wide association studies . genet epidemiol .
2010 ; 34 ( 7 ) : 725 - 738 . doi : 10.1002 / gepi.20536 20976797 16 otto sp , jones cd . detecting the undetected : estimating the total number of loci underlying a quantitative trait . genetics .
2000 12 ; 156 ( 4 ) : 2093 - 107 . 11102398 17 stouffer sa , devinney lc , suchmen ea . the american soldier : adjustment during army life. vol. 1 princeton university press , princeton , us ; 1949 . 18 zaykin dv. statistical analysis of genetic associations : chapter 6 .
p - value adjustments in confirmatory studies .
ph.d. thesis .
north carolina state university ; 2000 .
19 devlin b , roeder k . genomic control for association studies . biometrics .
1999 ; 55 ( 4 ) : 997 - 1004 . doi : 10.1111 / j.0006 - 341x.1999.00997.x 11315092 20 price al , patterson nj , plenge rm , weinblatt me , shadick na , reich d . principal components analysis corrects for stratification in genome - wide association studies . nat genet .
2006 ; 38 ( 8 ) : 904 - 909 . doi : 10.1038 / ng1847 16862161 21 zhang h , li q , zang y , yang y , zheng g . centralized genomic control : a simple approach correcting for population structures in case - control association studies in : balakrishnan n , editor .
methods and applications of statistics in the life and health sciences .
new york : wiley ; 2009 p .
81 - 93 . 22 zaykin dv , zhivotovsky la , westfall ph , weir bs . truncated product method for combining p - values . genet epidemiol .
2002 ; 22 ( 2 ) : 170 - 185 . doi : 10.1002 / gepi.0042 11788962 23 dudbridge f , koeleman bp . rank truncated product of p - values , with application to genomewide association scans . genet epidemiol .
2003 ; 25 ( 4 ) : 360 - 366 . doi : 10.1002 / gepi.10264 14639705 24 zaykin dv , zhivotovsky la , czika w , shao s , wolfinger rd . combining p - values in large - scale genomics experiments . pharm stat .
2007 ; 6 ( 3 ) : 217 - 226 . doi : 10.1002 / pst.304 17879330 25 kuo cl , zaykin dv . novel rank - based approaches for discovery and replication in genome - wide association studies . genetics .
2011 ; 189 ( 1 ) : 329 - 340 . doi : 10.1534 / genetics.111.130542 21705758 26 allison db , gadbury gl , heo m , fernandez jr , lee ck , prolla ta , et al a mixture model approach for the analysis of microarray gene expression data . comput stat data anal .
2002 ; 39 ( 1 ) : 1 - 20 . doi : 10.1016 / s0167 - 9473 ( 01 ) 00046 - 9 27 pounds s , morris sw . estimating the occurrence of false positives and false negatives in microarray studies by approximating and partitioning the empirical distribution of p - values . bioinformatics .
2003 ; 19 ( 10 ) : 1236 - 1242 . doi : 10.1093 / bioinformatics / btg148 12835267 28 leek jt , storey jd . the joint null criterion for multiple hypothesis tests . stat appl genet mol .
2011 ; 10 ( 1 ) : 1 - 22 . 29 jager lr , leek jt . an estimate of the science - wise false discovery rate and application to the top medical literature . biostatistics .
2014 ; 15 ( 1 ) : 1 - 12 . doi : 10.1093 / biostatistics / kxt007 24068246 30 lee sh , wray nr . novel genetic analysis for case - control genome - wide association studies : quantification of power and genomic prediction accuracy . plos one .
2013 ; 8 ( 8 ) : e71494 doi : 10.1371 / journal.pone.0071494 23977056 31 yang j , wray nr , visscher pm . comparing apples and oranges : equating the power of case - control and quantitative trait association studies . genet epidemiol .
2010 ; 34 ( 3 ) : 254 - 257 . 19918758 32 morton ne . sequential tests for the detection of linkage . am j hum genet .
1955 ; 7 ( 3 ) : 277 13258560 33 efron b , tibshirani r , storey jd , tusher v . empirical bayes analysis of a microarray experiment . j am statist assoc .
2001 ; 96 ( 456 ) : 1151 - 1160 . doi : 10.1198 / 016214501753382129 34 efron b , tibshirani r . empirical bayes methods and false discovery rates for microarrays . genet epidemiol .
2002 ; 23 ( 1 ) : 70 - 86 . doi : 10.1002 / gepi.1124 12112249 35 dudbridge f , gusnanto a , koeleman b . detecting multiple associations in genome - wide studies . human genomics .
2006 ; 2 ( 5 ) : 310 - 317 . doi : 10.1186 / 1479 - 7364 - 2 - 5 - 310 16595075 36 wakefield j . bayes factors for genome - wide association studies : comparison with p - values . genet epidemiol .
2009 ; 33 ( 1 ) : 79 - 86 . doi : 10.1002 / gepi.20359 18642345 37 zaykin dv . optimally weighted z - test is a powerful method for combining probabilities in meta - analysis . j evol biol .
2011 ; 24 ( 8 ) : 1836 - 1841 . doi : 10.1111 / j.1420 - 9101.2011.02297.x 21605215