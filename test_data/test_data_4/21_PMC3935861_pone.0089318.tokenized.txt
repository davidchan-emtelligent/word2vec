plos one plos one plos plosone plos one 1932 - 6203 public library of science san francisco , usa 24586684 3935861 pone - d - 13 - 39224 10.1371 / journal.pone.0089318 research articlebiologycomputational biologygenomicsgenome analysis toolstranscriptomesfunctional genomicsgenome databasesgenome expression analysismicroarraysmicrobiologybacterial pathogensstreptococcicomputer sciencecomputing methodsinformation technologymathematicsprobability theoryprobability densityprobability distributionstatisticsstatistical methodsscience policyresearch assessmentresearch monitoring global meta - analysis of transcriptomics studies global meta - analysis of transcriptomics studies caldas jose 1 * vinga susana 2 1 inesc - id , instituto de engenharia de sistemas e computadores , investigacao e desenvolvimento , lisboa , portugal 2 idmec / laeta , instituto superior tecnico , universidade de lisboa , lisboa , portugal zeller tanja editor medical university hamburg , university heart center , germany * e - mail : jose @ kdbio.inesc - id.pt competing interests : the authors have declared that no competing interests exist .
conceived and designed the experiments : jc sv. performed the experiments : jc. analyzed the data : jc. wrote the paper : jc sv .
2014 26 2 2014 9 2 e89318 24 9 2013 18 1 2014 ( c ) 2014 caldas , vinga 2014 caldas , vingathis is an open - access article distributed under the terms of the creative commons attribution license , which permits unrestricted use , distribution , and reproduction in any medium , provided the original author and source are properly credited .
transcriptomics meta - analysis aims at re - using existing data to derive novel biological hypotheses , and is motivated by the public availability of a large number of independent studies .
current methods are based on breaking down studies into multiple comparisons between phenotypes ( e.g. disease vs. healthy ) , based on the studies' experimental designs , followed by computing the overlap between the resulting differential expression signatures .
while useful , in this methodology each study yields multiple independent phenotype comparisons , and connections are established not between studies , but rather between subsets of the studies corresponding to phenotype comparisons .
we propose a rank - based statistical meta - analysis framework that establishes global connections between transcriptomics studies without breaking down studies into sets of phenotype comparisons. by using a rank product method , our framework extracts global features from each study , corresponding to genes that are consistently among the most expressed or differentially expressed genes in that study .
those features are then statistically modelled via a term - frequency inverse - document frequency ( tf - idf ) model , which is then used for connecting studies .
our framework is fast and parameter - free ; when applied to large collections of homo sapiens and streptococcus pneumoniae transcriptomics studies , it performs better than similarity - based approaches in retrieving related studies , using a medical subject headings gold standard .
finally , we highlight via case studies how the framework can be used to derive novel biological hypotheses regarding related studies and the genes that drive those connections .
our proposed statistical framework shows that it is possible to perform a meta - analysis of transcriptomics studies with arbitrary experimental designs by deriving global expression features rather than decomposing studies into multiple phenotype comparisons .
this work was supported by national funds through fundacao para a cieancia e a tecnologia ( fct , portugal ) under contracts pestoe / eei / la0021 / 2011 ; through idmec , under laeta ( pestoe / eme / la0022 ) ; and projects pneumosys ( ptdc / saumii / 100964 / 2008 ) , intelegen ( ptdc / dtpfto / 1747 / 2012 ) , and bachberry ( fp7kbbe20137 singlestage , grant agreement no 613793 ) .
sv acknowledges support by program investigador fct ( if / 00653 / 2012 ) from fct , co - funded by the european social fund ( esf ) through the operational program human potential ( poph ) .
the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .
introduction meta - analysis consists of aggregating the outcome of multiple studies in order to derive robust and reproducible results [ 1 ] .
in dna microarray transcriptomics , the availability of large - scale public databases such as arrayexpress has encouraged the development of meta - analysis methods [ 2 ] .
the meta - analysis paradigm has been successfully used in a variety of applications , including oncogenomics [ 3 ] , drug repurposing [ 4 ] , disease diagnosis [ 5 ] , and mapping of tissue and condition - specific expression signatures [ 6 ] .
additionally , web - based tools have been developed for facilitating the exploration of large collections of transcriptomics studies [ 7 ] - [ 9 ] .
for recent reviews of the field , see e.g. [ 10 ] or [ 11 ] .
the challenges involved in performing meta - analysis stem from the intrinsic complexity of biological phenotypes , as well as from the observed heterogeneity between independent studies , namely the use of multiple microarray platforms , biological samples , and experimental procedures .
in order to minimize the impact of those factors , meta - analysis methods typically focus on examining differential expression signatures across studies .
figure 1a illustrates this approach .
this consists of first breaking down each study into a set of comparisons between phenotypes and then deriving a differential expression signature from each phenotype comparison .
connections between phenotype comparisons are then established based on the similarity between the corresponding differential expression signatures .
potential similarity measures include for instance correlation - based methods or probabilistic relevance measures [ 8 ],[ 9 ] .
10.1371 / journal.pone.0089318.g001 figure 1 summary of the steps performed ( a ) in the differential expression meta - analysis paradigm and ( b ) in our proposed framework .
two studies from a collection of independent studies are shown .
one of the studies includes experimental annotations about gender ( male or female ) and disease status ( healthy or disease ) , while the other study includes experimental annotations indicating whether each sample comes from a control or a treatment .
in the differential expression approach each study is broken down into a set of comparisons between phenotypes , with the first study yielding two comparisons and the second study yielding a single comparison ; genes are ordered according to a differential expression measure , e.g. , log - ratios , which are used as a basis for computing the similarities between phenotype comparisons .
in the proposed approach , one first decides if the analysis is based on absolute expression or differential expression .
then , in the case that one is interested in a differential expression analysis , the expression in every non - control sample ( e.g. treatment or disease ) is computed relative to the corresponding control sample .
afterwards , the rank product method is used to compute global , study - wide features corresponding to genes that possess a consistently high expression or differential expression in a given study .
these global features are statistically modelled and used as a basis for deriving similarities between studies .
the connections are therefore established not between subsets of studies , but rather directly between studies .
meta - analysis approaches based on decomposing studies into comparisons between phenotypes , while successful , are critically hampered by the lack of extensive experimental and clinical annotations about the samples in each study .
they also do not infer global connections between studies , rather detecting similarities between subsets of the studies corresponding to specific phenotype comparisons ( cf. fig.1a ) .
while this latter aspect is not necessarily a disadvantage , an important methodological open question in transcriptomics meta - analysis is whether it is possible to aggregate and summarize all of the expression data within each study , regardless of the study 's specific experimental design , with the aim of directly establishing global connections between independent studies .
to the best of our knowledge , no general methods have been proposed with this purpose in mind .
while gene or pathway - oriented statistical tests [ 12 ] have been frequently used in the context of differential expression - based meta - analysis frameworks , they rely on decomposing each study into a set of comparisons between phenotypes .
on the other hand , standard similarity measures such as spearman correlation may be combined with linkage criteria to establish an overall similarity measure between studies .
for instance , the global similarity between two studies may be computed as the mean spearman correlation between microarrays from the two studies .
however , this approach merely aggregates similarity measures between study subsets ; our aim is rather to devise a method for globally encoding each study with features that represent the study 's relevant expression signatures , allowing studies to be globally connected on the basis of those features .
additionally , the global features can be used to guide the interpretation of the inferred connections , which helps to formulate posterior biological hypotheses .
we propose a statistical meta - analysis framework for establishing global connections between transcriptomics studies , which does not require breaking down the studies into sets of phenotype comparisons .
intuitively , our approach detects the genes within each study that consistently possess high absolute or differential expression ( for one - channel arrays ) or expression ratio ( for two - channel arrays ) values across the arrays in that study .
if the aim is to analyze absolute expression values in one - channel arrays , our approach does not make use of each study 's experimental annotation .
on the other hand , if the aim is to analyze differential expression values in one - channel arrays , our approach simply requires an indication of which samples in the study are used as a control .
connections between studies are then inferred and interpreted on the basis of shared relevant genes , via a vector space model .
figure 1b summarizes the flowchart of the proposed framework .
our framework partly relies on using the non - parametric rank product method [ 13 ] to aggregate gene expression data from all samples in any given study .
the rank product method has been previously shown to be a useful statistic for aggregating differential expression fold - change measures across independent control - vs - treatment studies [ 14 ] .
in the present paper , we apply the rank product method in a vastly different manner .
instead of restricting ourselves to simple control - vs - treatment studies , we consider studies with arbitrary experimental designs .
also , we do not use the rank product method to directly aggregate data from independent studies ; rather , we use the rank product method to obtain a measure of consistent expression for every gene within each study , thus deriving an encoding for every study which is then used as a basis for matching independent studies according to their similarity .
in effect , in our setting it is not possible or meaningful to apply the rank product method as described by hong and breitling [ 14 ] , because we do not have an a priori list of related studies with equivalent experimental designs ; we instead have a large , heterogeneous collection of studies with varying experimental designs that we want to mine for interesting connections .
we apply our framework to large , heterogeneous collections of transcriptomics studies from human and streptococcus pneumoniae .
we perform an analysis both on absolute and differential expression data , and also provide a strategy for harmonizing data from multiple platforms and s. pneumoniae strains .
we propose a quantitative validation strategy that assesses the quality of the inferred connections by verifying if the connected studies share medical subject headings ( mesh ) terms [ 15 ] .
using this strategy , we show that our method outperforms standard correlation - based measures in terms of connecting studies that are effectively related .
finally , we provide illustrative case studies of applying our method to both study collections .
results and discussion in this section we provide an analysis of our proposed framework .
figure 2 displays a detailed methodology flowchart .
we assess our framework in two ways : first , we measure the ability of the framework to detect connections between studies that are effectively related , using mesh terms assigned to each study as a gold standard ; second , we provide multiple case studies that show how the framework can be used as an exploratory tool to detect interesting connections between transcriptomics studies and generate novel biological hypotheses .
10.1371 / journal.pone.0089318.g002 figure 2 detailed flowchart for the proposed framework .
for succinctness , we illustrate the steps as applied to the streptococcus pneumoniae two - channel array data collection .
in stage ( a ) , we download data from three souces : refseq , for bacterial genomes from multiple s. pneumoniae strains ; arrayexpress , for two - channel microarray transcriptomics studies along with the corresponding experimental annotations ; pubmed , for the mesh annotations associated with each study 's corresponding publication .
stage ( b ) consists of multiple preprocessing and modeling steps .
we start by mapping orthologous genes from different strains to the same so - called metagene .
for each transcriptomics study , we rank metagenes in each sample according to their absolute log - ratio .
then , for each study and metagene we take the product of its ranks across the study 's samples , derive a corresponding - value , and binarize - values accounting for multiple hypothesis testing .
this yields a metagenes studies binary matrix that indicates for every metagene - study pair if the metagene is significant in the corresponding study .
the last step in stage ( b ) is to convert the binary matrix into a weighted matrix via tf - idf modeling .
this consists simply of replacing ones in the binary matrix by a weight that is indicative of the corresponding metagene 's information content .
in stage ( c ) , we apply the cosine similarity measure to connect studies on the basis of their tf - idf vector - space encoding .
we then assess the performance of the framework by quantifying the extent to which related studies are found to be similar , using mesh terms as a gold standard .
we also inspect the similarity matrix to detect interesting case studies that provide novel biological hypotheses .
the results and accompanying r software are available from http :// kdbio.inesc - id.pt /~ svinga / meta / .
method comparison we applied the mesh test setting outlined in the methods section to compare our framework to alternative approaches in three contexts : one - channel human microarrays with absolute expression values , one - channel human microarrays with differential expression values , and streptococcus pneumoniae two - channel arrays with differential expression values .
we tested four alternative versions of our framework .
in each version , either the binary or discrete rank product significance matrix is used ; also , we either apply the tf - idf model before computing cosine similarities between studies , or skip the tf - idf step and directly compute cosine similarities on the rank product matrix . as additional competing methods , we considered correlation - based approaches that , unlike our framework , do not extract any global features from the studies .
instead , these approaches simply estimate the similarity between studies as a combination of the similarity values between microarrays of the compared studies .
we chose the spearman rank correlation coefficient as the similarity measure between microarrays from different studies .
we then estimated the similarity between two studies as the maximum , mean , or median of the spearman correlation between microarrays from the two studies .
our choice of similarity measure is based on the fact that the spearman correlation coefficient is a well - performing robust nonparametric estimator of statistical dependence [ 16 ] .
additionally , it has been previously shown to perform well in the transcriptomics meta - analysis setting [ 9 ],[ 17 ] .
regarding the actual testing procedure , in essence we measured each method 's ability to connect studies that are effectively related , using pubmed mesh annotations as a gold standard .
given a study designated as the query , we sort the remaining studies according to their relevance to the query study .
then , for each of the query study 's mesh terms , we quantify how top retrieved studies tend to include that same mesh term , using a standard information retrieval performance measure known as average precision ( ap ) .
applying the aforementioned test setting yields a set of ap performance scores for every competing method , with every study yielding an ap score for each of its assigned mesh terms .
throughout this section , we apply a one - sided paired wilcoxon signed - rank test [ 16 ] to evaluate if the ap scores in a given method are significantly higher than the corresponding ap scores in another method .
in our context , the one - sided wilcoxon signed - rank test specifies the null hypothesis that the median difference between paired ap scores from the two methods is zero , while the alternative hypothesis specifies that the median difference is greater than zero .
the first question we addressed was whether the - value threshold used in computing the binary significance matrix had an impact on the framework 's performance .
figure 3 displays the mean and standard error of ap scores when varying the - value threshold .
it can be seen that the performance peaks at for the human data sets and at for the s. pneumoniae data set , which indicates that standard - value thresholds may be safely chosen .
additionally , it can be seen that the framework 's performance when the tf - idf step is not performed typically lags behind .
the exception is for the s. pneumoniae data set , where the " no tf - idf " framework appears to perform slightly better than the " tf - idf " framework , particularly at the peak performance point . however , the one - sided paired wilcoxon signed - rank test indicates that this difference is not significant () .
on the contrary , the signed - rank test on the human data set ( absolute or differential expression ) , applied to the data at the peak performance point , indicates that the " tf - idf " framework is significantly better than the " no tf - idf " framework () .
in the following method comparisons , when considering the binary version of our framework , we take for the human data and for the s. pneumoniae data , in order to avoid displaying an excessive number of performance values for multiple methods .
10.1371 / journal.pone.0089318.g003 figure 3 retrieval performance according to - value threshold .
mean and standard error of the ap scores when a - value threshold is used .
for each data set , we display the performance for two alternatives of our framework , namely with or without the tf - idf step .
notice that , for every - value threshold ( x - axis ) , the two framework alternatives are displayed side - by - side .
then we proceeded to assess the performance differences between our framework variants and the spearman competing methods .
figure 4 displays the mean and standard error of the ap scores for both our framework and the spearman correlation - based methods .
it can be seen that our framework attains higher scores in all data sets .
finally , is can be seen that on the human data sets , the discrete variants attain a better performance , while in the s. pneumoniae data set the binary variant performs the best .
10.1371 / journal.pone.0089318.g004 figure 4 retrieval performance for all methods .
mean and standard error of the ap scores for four variants of our framework , as well as for three spearman correlation - based methods .
regarding the x - axis labels , " binary " indicates the binary significance matrix variant of our framework while " discrete " indicates the discrete significance matrix variant ; " bin + idf " and " disc + idf " indicate those two same variants , but also performing the tf - idf modeling step prior to establishing connections between studies ; finally , the " max - sp " , " mean - sp " , and " median - sp " labels refer to the maximum , mean , and median statistic summarization approaches in the competing spearman correlation methods .
taken together , these results indicate that our method 's feature - based , global encoding is an adequate basis for connecting studies , improving on correlation - based approaches that are known to perform well in the meta - analysis setting [ 9 ],[ 17 ] .
additionally , usage of the tf - idf weighting scheme improves upon the connectivity performance of our proposed framework , for both the binary and discrete rank product estimation approaches .
biological interpretation in this section , we describe case studies using our proposed method with a - value threshold of . homo sapiens study collection table 1 displays query examples , the first two considering absolute expression and the second two considering differential expression .
the table also include the corresponding top - three most similar studies and the three protein - coding genes with the highest idf score that are significant in both the query and the top - three most similar studies .
the justification for this heuristic is to focus on genes that are significant in a low number of studies in the collection ( i.e. that possess a high idf score ) ; the event of these genes being significant in both the query and the top - three most similar studies is statistically more significant than the same event for genes with a low idf score .
for succinctness of analysis only the three top studies are shown .
note that in order to maximize the interpretability of the results , we display the three protein - coding shared genes with the highest idf scores .
in some case studies , the shared probesets with the highest idf scores do not match to known protein - coding genes .
in such cases , we do not present those probesets in the corresponding results table , as interpreting why such probesets are shared by independent studies requires further probeset - mapping work that falls outside the scope of this paper .
however , our web - based tool shows the full extent of the results , including probesets that do not match to known protein - coding genes .
10.1371 / journal.pone.0089318.t001 table 1 case studies from the human study collection .
type case study results details absolute expression stem cells query microrna and mrna expression profiles of human pancreatic islet - like cell clusters ( e - geod - 14503 ) result # 1 human embryonic stem cells derived from embryos at different stages of development share similar transcription profiles ( e - geod - 29625 ) result # 2 microrna and mrna expression profiles of human embryonic stem cells treated with activin a ( e - geod - 16910 ) result # 3 transcription profiling by array of human embryonic and induced pluripotent stem cells ( e - geod - 23402 ) top genes cathepsin l2 ( ctsl2 ) , von willebrand factor d and egf domains ( vwde ) , zfp42 zinc finger protein ( zfp42 ) muscle tissue query gene expression profiles in muscle tissue from fshd patients ( e - geod - 15090 ) result # 1 a transcriptional map of the impact of endurance exercise training on skeletal muscle phenotype ( resting muscle after endurance training ) ( e - geod - 35659 ) result # 2 expression data of normal human extraocular muscle and strabismic human extraocular muscle ( e - geod - 38780 ) result # 3 gene expression in skeletal muscle of cancer patients before and after potentially curative surgery ( e - geod - 34111 ) top genes mindbomb e3 ubiquitin protein ligase 1 ( mib1 ) , bestrophin 3 ( best3 ) , myosin light chain kinase family , member 4 ( mylk4 ) differential expression hepatocytes query transcription profiling of human primary hepatocytes after treatment with pirinixic acid ( e - geod - 17251 ) result # 1 heparg cells as a model of the primary human hepatocyte transcriptome ( e - geod - 18269 ) result # 2 atorvastatin , rosuvastatin and rifampicin effect on human primary hepatocyte transcriptome ( e - geod - 24187 ) result # 3 transcriptome analysis identifies fn14 , a tnf superfamily receptor member , as a therapeutic target in alcoholic hepatitis ( e - geod - 28619 ) top genes wd repeat - containing protein 72 ( wdr72 ) , indoleamine 2,3 - dioxygenase 2 ( ido2 ) , nuclear receptor subfamily 1 , group i , member 3 ( nr1i3 ) prostate cancer query identification of an srf - and androgen - dependent gene signature in prostate cancer ( e - geod - 22606 ) result # 1 expression data from androgen treated lncap cells ( e - geod - 17044 ) result # 2 atorvastatin , rosuvastatin and rifampicin effect on human primary hepatocyte transcriptome [ affymetrix platform ] ( e - geod - 24187 ) result # 3 expression data from breast cancer cell lines with various colony - forming ability ( e - geod - 15026 ) top genes vacuolar protein sorting 13 homolog b ( vps13b ) , histidine triad nucleotide binding protein 1 ( hint1 ) , diacylglycerol kinase , eta ( dgkh ) arrayexpress study identifiers are shown next to each study title .
the " type " column indicates if a case study corresponds to absolute or differential expression data .
the " results " column displays for every case study ( 1 ) the query study , ( 2 ) the top - three most relevant studies , and ( 3 ) the three protein - coding genes with the highest idf score that are active in the query and the top - three most relevant studies .
in the first case study , the query study analyses the expression of pancreatic cell clusters derived from the embryonic stem cell t3 cell line .
all of the top three studies are mapped to the mesh term " embryonic stem cells " .
the first shared significant gene is ctsl2 , a cathepsin family member ; it has recently been proposed that cathepsin l family members play a role in differentiation via histone proteolysis [ 18 ] .
the second shared gene vwde codes for the von willebrand factor ( vwf ) d and egf domain - containing protein ; while no direct role in stem cell differentiation has been proposed for vwde , egf has been shown to promote proliferation of mouse embryonic stem cells in mouse [ 19 ] , while vwf has been shown to regulate adhesion of mesenchymal stem cells to endothelial cells [ 20 ] .
finally , zfp42 is a known marker for pluripotency in embryonic stem cells [ 21 ] .
in the second case study , both the query study and the top - three most relevant studies involve expression profiling of muscle tissue .
concerning the three protein - coding genes with the highest idf score , best3 is expressed in renal and muscle tissues [ 22 ] .
on the other hand , mylk4 is a partly characterized member of the myosin light chain kinases ( mlcks ) protein family , known to have muscle - specific expression [ 23 ] .
finally , we did not find evidence for constitutive expression of mib1 in muscle tissue , which leaves open the question as to why it is relevant to the association between the three muscle tissue studies .
this case study again highlights the ability of the proposed framework to connect independent studies based on tissue - specific expression .
in the third case study , both the query and the retrieved studies concern transcription profiling in hepatocytes .
while nr1i3 is a regulator of multiple hepatic genes [ 24 ] , we did not find a hepatocyte - related role for wdr72 or ido2 , which suggests these genes may have yet unknown liver - related roles .
in the fourth case study , the framework connects a prostate cancer study with two other cancer studies and one hepatocyte - related study .
concerning the top - three shared genes , hint1 is a tumor - suppressor gene in gastric cancer , which suggests it may have a yet - unknown role in prostate cancer [ 25 ] .
as for dgkh , it is known to be associated with bipolar disorder [ 26 ] , leaving open the question of a potential role in prostate cancer .
finally , we did not find a relevant role for vps13b in the query or retrieved studies .
interestingly , when considering only the query and the top retrieved study , the shared protein - coding gene with the highest idf score is the transmembrane protease , serine 2 ( tmprss2 ) gene , known to be differentially expressed in prostate cancer [ 27 ] .
finally , we note that when applying the previously described median spearman correlation method to compute the top - three studies for each query , we were not able to obtain the results here described .
concretely , for the stem cell case study , the retrieved studies were about ulcerative colitis , parkinson 's disease and double - stranded rna recognition ; for the muscle tissue case study , while the top retrieved study is e - geod - 35659 ( i.e. the same study as retrieved by our framework ) , the other two studies are about renal transplantation and pulmonary lymphoma ; for the hepatocyte case study , only the study e - geod - 24187 is retrieved in the top - three studies , the others being about keratinocytes and pancreatic cancer ; finally , for the prostate cancer case study , the retrieved studies concern stem cells , interstitial lung disease , and b - cell differentiation , therefore seeming less relevant to the query study than the retrieval results provided by our framework .
additionally , in all case studies the average number of mesh terms shared between the query and the top - three studies is lower for the median spearman correlation method .
this implies that our framework 's improved performance ultimately yields results that are biologically more meaningful than when applying correlation - based approaches .
streptococcus pneumoniae study collection here , we describe two case studies from the s. pneumoniae two - channel microarray study collection related to the mesh terms " zinc " and " virulence " .
table 2 displays each query study , along with the top three most similar studies .
in each of these two case studies , we found that the third most similar study does not share the same mesh term as the query .
therefore , we restricted our analysis to the top - two most similar studies .
in general , since the s. pneumoniae study collection includes only 21 studies , it is expected that only the very top most similar studies are effectively related to the query .
10.1371 / journal.pone.0089318.t002 table 2 virulence and zinc case studies from the s. pneumoniae collection .
case study results details virulence query role of psar of streptococcus pneumoniae d39 and tigr4 in global gene expression and virulence ( e - geod - 13505 ) result # 1 site - specific contributions of glutamine - dependent regulator glnr and glnr - regulated genes to virulence of streptococcus pneumoniae ( e - geod - 9850 ) result # 2 cody of streptococcus pneumoniae : link between nutritional gene regulation and virulence ( e - geod - 7350 ) result # 3 search for genes essential for pneumococcal transformation : the rada dna repair protein plays a role in genomic recombination of donor dna ( e - geod - 8362 ) shared genes mutr , sp _ 0142 , sp _ 0143 zinc query transcriptional response of streptococcus pneumoniae to zn2 + - limitation and the repressor / activator function of adcr ( e - geod - 29236 ) result # 1 interplay between manganese and zinc homeostasis in the human pathogen streptococcus pneumoniae ( e - geod - 23504 ) result # 2 the metalloregulatory site in streptococcus pneumoniae adcr , a zinc - activated marr - family repressor ( e - geod - 21506 ) result # 3 celr - mediated activation of the cellobiose - utilization gene cluster in streptococcus pneumoniae ( e - geod - 30891 ) shared genes adh , adhp , adca , adcb , adcc , adcr , lmb , phtd , phte studies are in decreasing order of similarity to the query .
arrayexpress study identifiers are shown next to each study title .
the " results " column displays for every case study ( 1 ) the query study , ( 2 ) the top - three most relevant studies , and ( 3 ) the protein - coding genes that are active in the query and the top - three most relevant studies , in decreasing order of idf score .
regarding the zinc case study , both the query and the top - two studies are annotated with the mesh term " zinc " .
the study samples correspond either to an adhesin competence repressor ( adcr ) knockout strain vs. wildtype or to a zinc pulse .
zinc is known to influence the expression of multiple s. pneumoniae genes [ 28 ],[ 29 ] , while adcr is a zinc - sensing transcription factor involved in multiple processes including virulence and antibiotic stress response [ 30 ] .
we computed the genes that are significant in all three studies , obtaining a group of nine genes : adh , adhp , adca / b / c / r , lmb , and phtd / e. most of these genes have been reported as direct transcriptional targets of adcr in one of the analyzed publications [ 29 ] .
our framework therefore confirmed that a group of adcr transcriptional targets is significantly expressed in multiple zinc - related studies .
this shows how our meta - analysis approach can be used as an in silico computational validation strategy .
regarding the virulence case study , both the query and the top two studies share the same " virulence " mesh annotation .
the genes that are significant in all three studies are the transcription factor mutr and two members of a putative bacteriocin system ( sp _ 0142 / 0143 ) .
interestingly , while large differences in the bacterial virulence phenotype of mouse models were observed in all three studies , no major virulence role has been assigned to any of these genes .
it is therefore an open question whether these genes possess a relevant role in the s. pneumoniae virulence phenotype .
potential follow - up studies may involve performing transcription and virulence assays of s. pneumoniae response to knockouts of mutr , sp _ 0142 and / or sp _ 0143 .
as in the human case studies , the overlap between our results and the results obtained with the median spearman correlation method are low - - only one study from the virulence case study is also retrieved by the correlation - based method .
additionally , the mean number of mesh terms shared between the query and the top studies is lower in both case studies for the median spearman correlation method .
conclusions in the present work we have proposed a framework for performing meta - analysis of transcriptomics studies .
our main contribution is in providing a solution to the open methodological question of whether it is feasible to perform meta - analysis on a global , study - wide level ( establishing direct connections between studies rather than between study subsets ) , by learning study - wide expression signatures that provide a basis for interpreting the connections and deriving novel biological hypotheses .
using a mesh - based test setting , we have shown that our framework improves upon the performance of correlation - based measures that estimate the similarity between studies as a combination of the similarities between the corresponding microarrays ( this latter approach does not learn any global study features , therefore hindering the subsequent analysis ) .
finally , via a series of case studies , we showed that our global meta - analysis framework yields biologically meaningful results , in particular suggesting a follow - up study on the potential virulence role of the streptococcus pneumoniae genes mutr , sp _ 0142 , and sp _ 0143 .
our proposed framework has certain desirable properties : it is fast , since both the rank product and the tf - idf methods are easily parallelizable and run in a few minutes on a single cpu ; it is parameter - free , since apart from an optional , standard - value significance threshold , the user is not required to specify any parameter settings .
importantly , the rank product method is threshold - free , i.e. , it does not require the previous specification of a rank threshold that classifies genes in each study sample as " high - ranking " or " low - ranking " .
finally , our log - score interpretation of the rank product method suggests that this method is particularly suited to the high - throughput setting , as log - ranks yield a damping effect that effectively makes large ranks equivalent .
our proposed test setting was based on the mesh annotations of the paper associated with each study .
however , other ontological tools may be used for evaluation purposes .
for instance , the recently developed experimental factor ontology ( efo ) [ 31 ] maps experimental design variables to standardized terms .
the efo may be used for instance to measure the degree to which similar studies share the same experimental annotations .
one important consideration is how our framework and other recent proposals for gene expression meta - analysis map to " classical " meta - analysis frameworks .
in classical meta - analysis , one starts with a set of studies that are known to be related , and methods are proposed for aggregating the results of said studies .
here , the aim is different : there is instead a large , disorganized collection of studies and methods are proposed for suggesting which studies are related .
naturally , the detected connections may correspond to studies that are known to be related and which could be obtained using standard text - driven methods ( e.g. studies about the same disease ) .
however , the detected connections may also correspond to unexpected , novel connections , which are not supported by the textual annotations assigned to each study , and which may be used as a basis for establishing and testing novel biological hypotheses .
once related studies are identified by our framework , it is straightforward to derive a consensus from the studies , by simply computing the genes which are the most significant in the majority of them .
finally , the integration of additional data types into our framework is also an open challenge for future work , which is becoming increasingly relevant due the emergence of large - scale transcriptomics projects which aggregate data from complementary technologies [ 32 ] .
additionally , statistical meta - analysis methodologies will have to adapt to emerging next - generation sequencing technologies [ 33 ] .
while our framework takes as input pre - processed gene expression data , therefore not being directly dependent on the underlying technology used to generate the data , applying our framework to next - gen data falls outside the scope of our paper and is presently difficult due to the yet small number of available studies .
materials and methods microarray data source we accessed the arrayexpress database [ 2 ] to download transcriptomics studies from the one - channel affymetrix genechip human genome u133 plus 2.0 and from the species streptococcus pneumoniae .
we chose this particular affymetrix platform because it is the one with the highest number of human studies in arrayexpress .
we also chose s. pneumoniae for analysis due to our own expertise and to demonstrate the applicability of our method to two - channel microarrays .
for s. pneumoniae studies , we focussed our analysis on two - channel microarray studies , which correspond to the vast majority of available studies .
we discarded studies that did not contain processed data , which were not associated with published articles indexed in pubmed , or which were a subset of other studies .
for human studies , we restricted our analysis to studies with processed data files under 16 mb , corresponding to about eighty percent of the total number of studies .
this threshold was established in order to accelerate the analysis by avoiding the download and parsing of excessively large files .
data processing we considered microarray studies whose processed expression files contain the standard column names id _ ref or reporter _ identifier for identifying probesets and the column names value or affymetrix _ value for identifying processed expression values .
since s. pneumoniae studies correspond to multiple array platforms , we considered only studies whose microarray platform file contains the standard columns reporter name ( probe identifiers ) and orf ( open reading frame ) .
the column - name requirements allow for a fully automated processing pipeline .
for human studies , we performed the subsequent analysis directly on probesets , while for s. pneumoniae studies we first mapped probes to orfs using each study 's corresponding array design file , summarizing the expression of probes that map to the same gene by computing their median expression .
we assumed two strategies for missing value replacement , depending on whether the human study collection analysis is based on absolute or differential expression .
for absolute expression , we replaced missing values within a given study 's expression data with the minimum absolute expression value in that study ; for differential expression , we replaced missing values for a given gene with its mean observed expression .
the rationale for these two strategies is to assign the lowest ranks to genes whose expression is not observed .
after pre - processing , our approach yields a total of 289 human studies corresponding to 4368 microarray samples and 21 streptococcus pneumoniae studies corresponding to 129 microarray samples .
homo sapiens differential expression for the human study collection , we performed two independent analyses , one based on absolute expression , the other based on differential expression .
in the absolute expression analysis , we did not make use of each study 's experimental annotations .
in the differential expression analysis , we downloaded each study 's experimental design annotation files from arrayexpress .
in those files , each array in each study is assigned to a number of so - called experimental factor values which indicate the experimental annotation for that array , e.g. , disease state = cardiomyopathy or gender = male .
we collected all the experimental factor value annotations for all arrays in all studies and manually decided which of those annotations correspond to typical experimental controls ( e.g. , diseasestate = normal , treatment = control , time = 0h ) .
the full list of control annotations is available from text s1 in file s1 .
then , for each study , we selected a subset of arrays corresponding to the study 's control .
if any arrays in the study are annotated only with experimental control labels , they are selected as the control and averaged .
if no such arrays exist , then the control is defined as the average of all arrays in the study .
finally , we compute the log - ratio for each probeset 's expression in each of the non - control arrays relative to the corresponding control .
streptococcus pneumoniae ortholog mapping in order to reconcile s. pneumoniae studies from multiple strains , we downloaded reference sequences for strains tigr4 ( nc _ 003028.3 ) , d39 ( nc _ 008533.1 ) , and r6 ( nc _ 003098.1 ) from the refseq database [ 34 ] .
we assessed the homology of coding sequences between every pair of strains by running the nucleotide basic local alignment tool ( blastn ; [ 35 ]) .
we obtained orthologous gene groups by identifying groups of three genes , one per strain , which are all reciprocal blastn best - hits to one another .
this approach yields a total of 1621 so - called s. pneumoniae metagenes .
mesh terms we downloaded the entire mesh tree from the mesh web site and kept terms from the top - level categories anatomy , diseases , chemicals and drugs , biological sciences , and persons .
for every study corresponding to a pubmed - indexed paper , we downloaded its associated pubmed mesh annotations , discarded qualifiers ( e.g. , breast neoplasms / genetics and breast neoplasms / metabolism are treated as equivalent annotations ) , and kept only the terms that belong to any of the aforementioned mesh categories .
the rationale for only considering a subset of mesh categories is to discard categories that are not directly about biological findings or the samples and biological / clinical conditions under study ( e.g. the information science category , which describes the computational methodology followed in each paper , is not taken into account ) .
rank product we obtained study rank data by sorting the genes in each study sample according to their absolute expression ( in the case of one - channel absolute expression analysis ) or absolute log - ratio ( in the case of two - channel arrays or one - channel differential expression analysis ) .
then we applied the rank product method [ 13 ] to compute the relevance of each gene in each study .
succinctly , the rank product assigns a score to each gene by computing the product of the gene 's ranks across samples in a given study , or equivalently by computing the sum of the log - ranks , ( 1 ) ( 2 ) where indexes genes , indexes samples in a given study , is the total number of samples in a given study , and is the rank of the - th gene in the - th sample of a given study .
the log - function above dampens the distinction between large ranks .
we provide an additional discussion of this effect in text s2 in file s1 .
we used a gamma distribution approximation method to compute - values , which is based on the null hypothesis that ranks are uniformly distributed [ 36 ] .
text s2 in file s1 provides the details of the approximate method derivation .
more recently , a method has been proposed for computing exact - values [ 37 ] .
unfortunately , the running time for this method does not scale well enough for our large - scale purposes ( text s2 in file s1 ) .
after obtaining - values , we tested two alternatives .
first , we computed the corresponding false - discovery rate - values using the qvalue r package [ 38 ] , and considered genes to be significant at a standard cut - off value of . as an alternative , instead of computing a binary significance , we round the value to the nearest integer .
this latter alternative yields sparse discrete rather than sparse binary data .
additionally , this latter alternative does not require setting a significance threshold , thus making our framework entirely parameter - free .
the final output of the above approach is either a binary significance matrix that indicates for every gene - study pair whether gene is significant in study , ( 3 ) or a discrete matrix where for each gene - study pair , we have , where is the - value of gene in study . in subsequent sections , we consider a gene to be active in a study when . term frequency - inverse document frequency in order to detect connections between studies , we model the rank product matrix using the term frequency - inverse document frequency ( tf - idf ) vector space model [ 39 ],[ 40 ] .
the tf - idf model is commonly used in the natural language processing field ; here , each study may be conceptually seen as a " document " and each gene as a " word " .
in the tf - idf model , each gene receives an inverse document frequency ( idf ) score ( 4 ) the idf score is higher for genes that are active in a lower number of studies , and conversely lower for genes that are active in a greater number of studies .
the idea is to model the information content of the event of a gene being active in a given study .
each study is then encoded as an array , where . as a technical detail , if a gene is inactive in all studies , then we simply discard it from the data instead of computing its idf score .
this speeds - up the computations and avoids the problem of having infinite idf scores .
finally , the similarity between two studies and is computed via the standard cosine similarity coefficient which measures the cosine of the angle between the corresponding pair of vectors in the tf - idf vector space , ( 5 ) where is the dot product operator .
genes that possess a lower idf score contribute less to the dot product between two studies .
conversely , genes that are seldom active in the rank product matrix and which therefore possess a higher idf score make a larger contribution to the dot product between two studies .
in other words , two studies are similar when they both activate genes that possess a high information content .
connectivity performance evaluation to assess if the model connects studies that are effectively related , we quantified the relation between study similarity in terms of ( 5 ) and study similarity in terms of shared mesh terms assigned to the studies' pubmed - indexed papers .
for each study ( hereafter designated as the query study ) , we consider each of its assigned mesh terms in turn .
we assume that studies possessing that same mesh term are relevant to the query study , while the remaining studies are irrelevant .
first , we sort all studies according to their similarity to the query study as per ( 5 ) .
then , we take the similarity - sorted study list and compute the precision at each rank in the list , ( 6 ) ( 7 ) we then average the precisions at all ranks in the list that correspond to relevant studies , ( 8 ) this measure is known as average precision ( ap ) and is a standard performance measure in information retrieval .
it can be geometrically interpreted as approximating the area under the precision - recall curve [ 40 ] .
the above procedure yields for every study ( considered as the query ) and each of its mesh terms a performance measure between zero and one , that quantifies how the studies that are most similar to the query tend to possess that same mesh term .
figure 5 illustrates the described performance evaluation strategy .
10.1371 / journal.pone.0089318.g005 figure 5 retrieval performance strategy .
illustration of the proposed validation strategy .
each study in turn is considered as the query study , with the remaining studies being ordered according to their similarity with the query study .
the query study has three fictitious mesh terms : a , b , and c. the brown circles indicate studies that also possess those terms .
the average precision ( ap ) performance measure is higher when the most similar studies also possess the given mesh term , or conversely lower when studies mapped to the mesh term are among the least similar to the query study .
notice that the number of ap performance scores per query study equals the number of its mesh terms .
supporting information checklist s1 prisma checklist .
( pdf ) click here for additional data file .
file s1 control annotations and rank product technical details .
( pdf ) click here for additional data file .
we thank ana rute neves and sandra carvalho for valuable comments .
contributions conceived and designed the experiments : jc sv. performed the experiments : jc. analyzed the data : jc. wrote the paper : jc sv. references 1 nordmann aj ( 2012 ) meta - analyses : what they can and cannot do . swiss med wkly 142 : w13518 . 22407741 2 parkinson h , sarkans u , kolesnikov n , abeygunawardena n , burdett t , et al ( 2009 ) arrayexpress update - from an archive of functional genomics experiments to the atlas of gene expression . nucleic acids res 37 : d868 - d872 . 19015125 3 segal e , friedman n , koller d , regev a ( 2004 ) a module map showing conditional activity of expression modules in cancer . nat genet 36 : 1090 - 1098 . 15448693 4 sirota m , dudley jt , kim j , chiang ap , morgan aa , et al ( 2011 ) discovery and preclinical validation of drug indications using compendia of public gene expression data . sci transl med 3 : 96ra77 . 5 huang h , liu cc , zhou xj ( 2010 ) bayesian approach to transforming public gene expression repositories into disease diagnosis databases . proc natl acad sci usa 107 : 6823 - 6828 . 20360561 6 lukk m , kapushesky m , nikkila j , parkinson h , goncalves angela , et al ( 2010 ) a global map of human gene expression . nat biotechnol 28 : 322 - 324 . 20379172 7 rhodes dr , kalyana - sundaram s , mahavisno v , varambally r , yu j , et al ( 2007 ) oncomine 3.0 : genes , pathways , and networks in a collection of 18,000 cancer gene expression profiles . neoplasia 9 : 166 - 180 . 17356713 8 kupershmidt i , su qj , grewal a , sundaresh s , halperin i , et al ( 2010 ) ontology - based meta - analysis of global collections of high - throughput public data . plos one 5 : e13066 . 20927376 9 caldas j , gehlenborg n , kettunen e , faisal a , ronty m , et al ( 2012 ) data - driven information retrieval in heterogeneous collections of transcriptomics data links sim2s to malignant pleural mesothelioma . bioinformatics 28 : 246 - 253 . 22106335 10 rung j , brazma a ( 2012 ) reuse of public genome - wide gene expression data . nat rev genet 14 : 89 - 99 . 23269463 11 tseng gc , ghosh d , feingold e ( 2012 ) comprehensive literature review and statistical considerations for microarray meta - analysis . nucleic acids res 40 : 3785 - 3799 . 22262733 12 subramanian a , tamayo p , mootha vk , mukherjee s , ebert bl , et al ( 2005 ) gene set enrichment analysis : a knowledge - based approach for interpreting genome - wide expression profiles . proc natl acad sci usa 102 : 15545 - 15550 . 16199517 13 breitling r , armengaud p , amtmann a , herzyk p ( 2004 ) rank products : a simple , yet powerful , new method to detect differentially regulated genes in replicated microarray experiments . febs lett 573 : 83 - 92 . 15327980 14 hong f , breitling r ( 2008 ) a comparison of meta - analysis methods for detecting differentially expressed genes in microarray experiments . bioinformatics 24 : 374 - 382 . 18204063 15 lipscomb ce ( 2000 ) medical subject headings ( mesh ) . bull med libr assoc 88 : 265 - 266 . 10928714 16 hollander m , wolfe da ( 2000 ) nonparametric statistical methods .
new york , ny : wiley - interscience .
17 fujibuchi w , kiseleva l , taniguchi t , harada h , horton p ( 2007 ) cellmontage : similar expression profile search server . bioinformatics 23 : 3103 - 3104 . 17895274 18 duncan em , muratore - schroeder tl , cook rg , garcia ba , shabanowitz j , et al ( 2008 ) cathepsin l proteolytically processes histone h3 during mouse embryonic stem cell differentiation . cell 135 : 284 - 294 . 18957203 19 heo js , lee yj , han hj ( 2006 ) egf stimulates proliferation of mouse embryonic stem cells : involvement of ca2 + inux and p44 / 42 mapks . am j physiol cell physiol 290 : c123 - c133 . 16107508 20 potapova ia , cohen is , doronin sv ( 2010 ) von willebrand factor increases endothelial cell adhesiveness for human mesenchymal stem cells by activating p38 mitogen - activated protein kinase . stem cell res ther 1 : 35 . 21083900 21 shi w , wang h , pan g , geng y , guo y , et al ( 2006 ) regulation of the pluripotency marker rex - 1 by nanog and sox2 . j biol chem 281 : 23319 - 23325 . 16714766 22 jiang k , liu y , ma m , tang yb , zhou jg , et al ( 2013 ) mitochondria dependent pathway is involved in the protective effect of bestrophin - 3 on hydrogen peroxide - induced apoptosis in basilar artery smooth muscle cells . apoptosis 18 : 556 - 565 . 23468120 23 chan jy , takeda m , briggs le , graham ml , lu jt , et al ( 2008 ) identification of cardiac - specific myosin light chain kinase . circ res 102 : 571 - 580 . 18202317 24 maglich jm , lobe dc , moore jt ( 2008 ) the nuclear receptor car ( nr1i3 ) regulates serum triglyceride levels under conditions of metabolic stress . j lipid res 50 : 439 - 445 . 18941143 25 huang h , wei x , su x , qiao f , xu z , et al ( 2011 ) clinical significance of expression of hint1 and potential epigenetic mechanism in gastric cancer . int j oncol 38 : 1557 - 1564 . 21468541 26 baum ae , cabanero m , cardona i , corona w , klemens b , et al ( 2008 ) a genome - wide association study implicates diacylglycerol kinase eta ( dgkh ) and several other genes in the etiology of bipolar disorder . mol psychiatry 13 : 197 - 207 . 17486107 27 squire ja ( 2009 ) tmprss2 - erg and pten loss in prostate cancer . nat genet 41 : 509 - 510 . 19399032 28 jacobsen fe , kazmierczak km , lisher jp , winkler me , giedroc dp ( 2011 ) interplay between manganese and zinc homeostasis in the human pathogen streptococcus pneumoniae . metallomics 3 : 38 - 41 . 21275153 29 shafeeq s , kloosterman tg , kuipers op ( 2011 ) transcriptional response of streptococcus pneu - moniae to zn ( 2 +) limitation and the repressor / activator function of adcr . metallomics 3 : 609 - 618 . 21603707 30 reyes - caballero h , guerra aj , jacobsen fe , kazmierczak km , cowart d , et al ( 2010 ) the metalloregulatory zinc site in streptococcus pneumoniae adcr , a zinc - activate marr family repressor . j mol biol 403 : 197 - 216 . 20804771 31 malone j , holloway e , adamusiak t , kapushesky m , zheng j , et al ( 2010 ) modeling sample variables with an experimental factor ontology . bioinformatics 26 : 1112 - 1118 . 20200009 32 network cgar ( 2008 ) comprehensive genomic characterization defines human glioblastoma genes and core pathways . nature 455 : 1061 - 1068 . 18772890 33 mardis er ( 2008 ) next - generation dna sequencing methods . annu rev genomics hum genet 9 : 387 - 402 . 18576944 34 pruitt kd , tatusova t , maglott dr ( 2007 ) ncbi reference sequences ( refseq ) : a curated non - redundant sequence database of genomes , transcripts and proteins . nucleic acids res 35 : d61 - d65 . 17130148 35 altschul sf , madden tl , schaffer aa , zhang j , zhang z , et al ( 1997 ) gapped blast and psi - blast : a new generation of protein database search programs . nucleic acids res 25 : 3389 - 3402 . 9254694 36 koziol ja ( 2010 ) comments on the rank product method for analyzing replicated experiments . febs lett 584 : 941 - 944 . 20093118 37 eisinga r , breitling r , heskes t ( 2013 ) the exact probability distribution of the rank product statistics for replicated experiments . febs lett 587 : 677 - 682 . 23395607 38 storey jd , tibshirani r ( 2003 ) statistical significance for genomewide studies . p natl acad sci usa 100 : 9440 - 9445 . 39 salton g , wong a , yang cs ( 1975 ) a vector space model for automatic indexing . commun acm 18 : 613 - 620 . 40 manning cd , raghavan p , schutze h ( 2008 ) introduction to information retrieval .
cambridge , uk : cambridge university press .