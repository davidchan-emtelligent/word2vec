plos comput biol plos comput .
biol plos ploscomp plos computational biology 1553 - 734x 1553 - 7358 public library of science san francisco , usa 20333237 2841614 09 - plcb - ra - 1470r2 10.1371 / journal.pcbi.1000716 research articleevolutionary biologyevolutionary biology / microbial evolution and genomicsevolutionary biology / pattern formation emergence of spatial structure in cell groups and the evolution of cooperation spatial structure and cooperation in cell groups nadell carey d .
1 2 foster kevin r .
3 * xavier joao b .
3 4 * 1 department of ecology and evolutionary biology , princeton university , princeton , new jersey , united states of america 2 department of molecular biology , princeton university , princeton , new jersey , united states of america 3 center for systems biology , harvard university , cambridge , massachusetts , united states of america 4 program in computational biology , memorial sloan - kettering cancer center , new york , new york , united states of america pfeiffer thomas editor harvard university , united states of america * e - mail : kfoster @ cgr.harvard.edu ( krf ) ; xavierj @ mskcc.org ( jbx ) conceived and designed the experiments : cdn krf jbx .
performed the experiments : cdn jbx .
analyzed the data : cdn jbx .
wrote the paper : cdn krf jbx .
3 2010 19 3 2010 6 3 e1000716 3 12 2009 18 2 2010 nadell et al .
2010 this is an open - access article distributed under the terms of the creative commons attribution license , which permits unrestricted use , distribution , and reproduction in any medium , provided the original author and source are properly credited .
on its own , a single cell cannot exert more than a microscopic influence on its immediate surroundings .
however , via strength in numbers and the expression of cooperative phenotypes , such cells can enormously impact their environments .
simple cooperative phenotypes appear to abound in the microbial world , but explaining their evolution is challenging because they are often subject to exploitation by rapidly growing , non - cooperative cell lines .
population spatial structure may be critical for this problem because it influences the extent of interaction between cooperative and non - cooperative individuals .
it is difficult for cooperative cells to succeed in competition if they become mixed with non - cooperative cells , which can exploit the public good without themselves paying a cost .
however , if cooperative cells are segregated in space and preferentially interact with each other , they may prevail .
here we use a multi - agent computational model to study the origin of spatial structure within growing cell groups .
our simulations reveal that the spatial distribution of genetic lineages within these groups is linked to a small number of physical and biological parameters , including cell growth rate , nutrient availability , and nutrient diffusivity .
realistic changes in these parameters qualitatively alter the emergent structure of cell groups , and thereby determine whether cells with cooperative phenotypes can locally and globally outcompete exploitative cells .
we argue that cooperative and exploitative cell lineages will spontaneously segregate in space under a wide range of conditions and , therefore , that cellular cooperation may evolve more readily than naively expected .
author summary cooperation is a fundamental and widespread phenomenon in nature , yet explaining the evolution of cooperation is difficult .
natural selection typically favors individuals that maximize their own reproduction , so how is it that many diverse organisms , from bacteria to humans , have evolved to help others at a cost to themselves ?
research has shown that cooperation can most readily evolve when cooperative individuals preferentially help each other , but this leaves open another critical question : how do cooperators achieve selective interaction with one another ?
we focus on this question in the context of unicellular organisms , such as bacteria , which exhibit simple forms of cooperation that play roles in nutrient acquisition and pathogenesis .
we use a realistic simulation framework to model large cell groups , and observe that cell lines can spontaneously segregate from each other in space as the group expands .
finally , we demonstrate that lineage segregation allows cooperative cell types to preferentially benefit each other , thereby favoring the evolution of cooperation .
introduction many cell phenotypes alter the growth and division of nearby cells by changing local resource availability [ 1 ] - [ 4 ] .
some of these phenotypes promote the survival and reproduction of others , and thus qualify as a simple form of cooperation .
a cell may be considered cooperative , for example , if it secretes enzymes that free nutrients which neighboring cells can use .
the efficiency with which a cell group processes environmental resources or exploits a host often depends on such publicly beneficial cell phenotypes .
for instance , many microbial infections and cancerous tumors derive their pathogenicity in part from the cooperative secretion of digestive enzymes by their constituent cells [ 5 ] - [ 8 ] .
how cooperative cell phenotypes evolve therefore presents an important question , one that is particularly challenging because any genetic variants that exploit others' cooperation - without themselves paying a cost - can potentially invade and increase in frequency .
in light of this problem , social evolution theory has been developed to understand the evolutionary trajectories of cooperative traits [ 9 ] , but this framework has only recently been applied to unicellular systems [ 4 ] , [ 10 ] - [ 12 ] .
the critical prediction is that preferential interaction among genetically related individuals increases the propensity for cooperative phenotypes to evolve .
variation among individual cells is a common feature of many cell groups : microbial biofilms are often composed of multiple strains or species [ 13 ],[ 14 ] , and cancerous tumors can consist of many different genetic lineages [ 15 ],[ 16 ] .
the majority of work on cooperative cell phenotypes assumes relatively well mixed interactions among different genetic variants in standing or shaken liquid culture [ 17 ] - [ 21 ] .
this kind of environment does not reflect the natural condition of most cell groups , in which cells are typically constrained in space and influence each other in a distance - dependent manner .
these spatial relationships may be paramount to understanding the evolution of cellular cooperation [ 22 ] .
when different cell lineages are segregated in space , those expressing cooperative phenotypes are more likely to benefit others of their own kind [ 23 ] - [ 25 ] .
when different cell lineages are mixed together , on the other hand , cells that exploit the resources of others can thrive [ 17 ] - [ 20 ] .
local populations of bacterial and cancer cells are often established by groups of progenitors that proliferate into larger clusters .
experiments with bacterial colonies on agar have revealed that expanding cell groups can segregate into sectors that are each dominated by a single genetic lineage [ 26 ],[ 27 ] .
this observation has been used predominantly to motivate new population genetic models [ 28 ] - [ 30 ] .
when only cells on the periphery of an expanding group can access nutrients and reproduce , the group 's effective population size is reduced .
as a result , neutral or even mildly deleterious alleles can spread by genetic drift along the advancing front .
because they are constrained in space , genetic lineages that manage to proliferate along the population 's leading edge become physically separated into zones composed of clonal or closely related individuals. by promoting interaction between individuals of the same genotype , the spontaneous segregation of different genetic lineages in space may also influence social evolution within cell groups [ 23 ],[ 24 ] .
in the present paper , we use a generalized mechanistic model to define the physical and biological factors that govern cell group spatial structure , and we explore the potential connection between genetic drift along the fronts of expanding cell groups and the evolution of social phenotypes .
results / discussion to study how the collective structure of cell groups arises from the activity of many individual cells , we used a computational model that employs mechanistic descriptions of solute diffusion and cell growth [ 31 ] - [ 33 ] .
our framework is derived from the latest generation of agent - based models that have been developed over the last decade using biochemical engineering principles ( methods , supporting information , table s1 ) .
the model 's underlying assumptions are described and justified in detail elsewhere [ 33 ] - [ 36 ] , and empirical tests have demonstrated the framework 's ability to make accurate predictions for real biological systems [ 37 ],[ 38 ] .
briefly , each cell is implemented as a circular agent in explicit two - dimensional space , and each simulation is set on one of two possible conditions .
the first consists of cells growing on a flat surface with growth substrate ( nutrients ) diffusing from above .
the second condition represents a cell cluster immersed in a resource pool , such that substrate diffuses into the cluster from all directions .
the transport of all solutes occurs exclusively through diffusion .
each cell grows according to a michaelis - menten function of substrate concentration in its local environment and divides once it reaches a maximum radius ( methods , supporting information , table s2 ) .
cells move passively due to the forces exerted between neighboring individuals as they grow and divide .
growth substrate availability and cell lineage segregation we began with simulations in which the environment surrounding cell groups was altered by increasing or decreasing growth substrate concentration .
these in silico experiments were initiated with equal numbers of randomly distributed red and blue cells , which did not differ in any way other than their color .
the two neutral color markers were used to judge whether cell lineages remain randomly mixed or become spatially segregated as cell groups expand .
environmental substrate availability was decreased from saturating to sparse across multiple simulations , and we observed three different regimes in cell group structure : 1 .
well mixed with smooth front when growth substrate was supplied to cell groups at saturating concentration , the red and blue cell lines appeared to remain well mixed relative to their random initial distributions .
the advancing fronts of cell groups were smooth ( figure 1a,d ) .
10.1371 / journal.pcbi.1000716.g001 figure 1 dynamic simulations show that cell lineages segregate in a manner dependent on growth substrate availability .
simulations began with a 1:1 mixture of red and blue cells , where cell color served a neutral marker for lineage segregation .
as bulk substrate concentration was decreased , we observed an increased propensity for cell lineages to segregate in space .
this pattern held true under ( a - c ) surface growth and ( d - f ) radial growth conditions .
2. segregation with smooth front when substrate availability was decreased to a moderate concentration , the surfaces of cell groups remained smooth , but their internal structures were substantially altered .
cell lineages segregated as group fronts advanced , creating adjacent red and blue cell sectors ( figure 1b,e ) .
this segregation occurred because many cell lineages were cut off from advancing fronts and ceased growing , while the few remaining lineages proliferated into adjoining zones containing only one cell type .
3. segregation with irregular front when substrate availability was sparse , we noted another qualitative shift in cell group structure .
red and blue cell lineages separated into adjacent sectors , just as described above .
additionally , the advancing fronts of cell groups became sensitive to small irregularities , which grew into tower clusters separated by open space ( figure 1c,f ) .
akin to the sector structures described above , each cell tower consisted of only one color , and thus appeared to contain the descendents of a single ancestral cell .
further exploration with the simulation framework suggested that these three structure regimes represent qualitatively different regions within a continuum of possibilities .
when we altered substrate availability by small increments over a sufficiently large range , we observed cell group structures that were intermediate between those shown in figure 1 .
for simplicity and clarity in the remainder of the paper , we will focus only on the three distinct patterns of cell group spatial structure described above .
before proceeding , we also ruled out the possibility that our results were an artifact of simulating cell groups in two - dimensional space by repeating our simulations in three dimensions , which yielded qualitatively identical results ( supporting information , figure s1 ) .
all subsequent simulations were performed in two dimensions using the surface growth condition ( as in figure 1a - c ) .
we quantified lineage segregation in cell groups by performing replicate simulations under the three substrate availability conditions shown in figure 1 .
at every time step of each simulation , we identified every actively growing cell and , within a 10 cell - length radius , measured the local frequency of other actively growing cells of the same color ( methods ) .
the resulting segregation index directly measures the spatial assortment of cell lineages and ranges from 0 to 1 , where 1 denotes complete lineage segregation on a spatial scale of 10 cell lengths .
fifty replicate simulations of each substrate availability condition were performed , and the average segregation index from each series was visualized as a function of cell group size ( figure 2 ) .
the results quantitatively confirm our observation that decreasing growth substrate availability leads to stronger lineage segregation in cell groups .
10.1371 / journal.pcbi.1000716.g002 figure 2 lineage segregation in growing cell groups , visualized as a function of increasing cell group size .
we ran 50 simulations under each of the three substrate availability conditions shown in figure 1 .
each simulation was initiated with 10 % blue cells and 90 % red cells , and we calculated the segregation index relative to the blue cell line ( methods ) .
dark lines are means ; shaded regions are running 95 % confidence intervals .
a general model for lineage segregation our next goal was to describe why environmental substrate concentration affects lineage assortment in expanding cell groups .
under limited growth substrate availability , the majority of cell growth and division occurs along a group 's advancing front in an active layer whose depth depends on substrate penetration ( figure 3 ) .
previous work has hinted that active layer depth is a critical factor influencing cell group surface structure [ 39 ],[ 40 ] , and we therefore hypothesized that it is not substrate concentration in particular , but more generally the depth of a cell group 's active layer that controls cell lineage segregation .
because segregation increased as growth substrate supply decreased in our preliminary simulations , we predicted that thinner active layers would lead to stronger lineage segregation in expanding cell groups .
10.1371 / journal.pcbi.1000716.g003 figure 3 the active layer of a cell group , illustrated for the surface growth condition .
cells are colored according to their growth rate : green cells are growing and make up the cell group 's active layer .
black cells have become inactive due to lack of available growth substrate .
the left - hand panel illustrates the vertical profile of growth substrate concentration along the dashed blue line .
active layer depth is not solely a function of bulk growth substrate concentration .
for example , higher substrate diffusivity increases active layer depth by allowing substrate to enter further into the cell group before being depleted .
faster cell growth rates , on the other hand , decrease active layer depth by raising the rate of substrate consumption at the cell group 's outer surface .
if we are correct that active layer depth is the underlying determinant of lineage segregation , all of the physical and biological factors that control active layer depth should also influence lineage segregation in cell groups .
using an analytical technique from chemical engineering ( methods ) , we combined the factors that influence active layer depth into a dimensionless number , delta , which has the following form for our system : ( 1 ) here , gbulk is the bulk liquid concentration of growth substrate , dg is the growth substrate diffusion coefficient , y is the yield with which cells convert substrate to biomass , mumax is the maximum specific cell growth rate , rho is the cell biomass density , and h is the height of the diffusion boundary layer ( figure 3 ) .
the smaller the value of delta , the thinner the cell group 's active layer .
we performed three new sets of simulations to test the hypothesis that active layer depth controls cell lineage segregation .
within each set , we varied active layer depth ( delta ) by altering only one parameter from equation 1 : maximum cell growth rate ( mumax ) , bulk growth substrate concentration ( gbulk ) , or growth substrate diffusivity ( dg ) .
at the end of each simulation , we calculated the segregation index .
our hypothesis makes two key predictions : 1 ) cell lineage segregation should be inversely related to delta , a proxy for active layer depth .
2 ) the relationship between cell lineage segregation and delta should be independent of which parameter from equation 1 is altered .
the results are shown in figure 4 and support both predictions .
lineage segregation within cell groups declines with increasing delta , regardless of how delta is altered .
using the dimensionless number delta renders our results independent of the exact values of gbulk , dg , y , mu max , rho , and h used to run simulations .
it is the relative magnitudes of these parameters in combination that ultimately matter .
10.1371 / journal.pcbi.1000716.g004 figure 4 lineage segregation within cell groups is inversely related to active layer depth .
the factors influencing cell group active layer depth were combined into a single dimensionless number , delta .
this number was varied across 3 sets of simulations by independently altering mumax ( maximum cell growth rate , red ) , gbulk ( bulk substrate availability , black ) , or dg ( substrate diffusivity , blue ) .
cell groups were grown to 100 microm maximum height , and then the segregation index was calculated ( filled circles are means , and bars denote 95 % confidence intervals ) .
the horizontal dotted line represents the final segregation index of simulations in which delta was infinitely large , allowing all cells to grow at the maximum rate at all times .
the simulations show that cell lineage segregation is inversely related to active layer depth , independently of how active layer depth is altered .
how does active layer depth influence cell lineage segregation ?
when growth substrate penetrates through most of a cell group before being depleted , all cells grow and divide , pushing each other into a homogeneous mixture .
as active layer depth decreases below the total thickness of a cell group , however , cells that happen to fall below a critical distance from the group 's front can no longer contribute to population expansion .
decreasing active layer depth thus reduces the cell group 's effective population size , rendering it more susceptible to genetic drift along its advancing front .
because the cells are constrained in space , reductions in genetic diversity along the group 's leading edge lead to localized clusters of individuals that all descend from a common progenitor [ 30 ] .
this phenomenon - often referred to as sectoring or gene surfing [ 28 ] - [ 30 ] - has been observed in agar colonies of paenibacillus dendritiformis [ 26 ] , escherichia coli and saccharomyces cerevisiae [ 27 ] .
reducing active layer depth even further yields an additional qualitative shift in cell group structure : the expanding population becomes sensitive to small irregularities along its leading edge .
cells in the peaks of surface irregularities retain access to substrate and grow into tower projections , while cells in the troughs of surface irregularities lose access to substrate and cease growing .
this process is related to viscous fingering at the interface of two fluids [ 39 ],[ 41 ] , and it is known to generate rough surface structure along the leading edges of growing biofilms , bacterial colonies on agar [ 34 ],[ 35 ],[ 40 ] , and moving fronts in general [ 36 ]. from a biological perspective , our analysis predicts that such surface roughness is accompanied by abrupt genetic lineage segregation along the front of an expanding population .
bridging cell lineage segregation and social evolution the spatial assortment of cell lineages is potentially critical for traits that affect the reproduction of other individuals in the population .
it is increasingly recognized that cells express many such social phenotypes [ 4 ],[ 12 ] , which are often involved in nutrient acquisition and pathogenesis [ 42 ] - [ 45 ] .
a common example is the secretion of extracellular enzymes or nutrient - chelating molecules .
cells that synthesize these substances must forgo a fraction of their reproductive capacity [ 17 ] - [ 19 ] , but if enough cells participate , all can gain a net benefit ( to the detriment of their host , in the case of pathogens ) .
in many cases the evolution of simple cooperative phenotypes depends on three factors : 1 ) c , the cost incurred by cooperative individuals 2 ) b , the benefit gained by the receivers of cooperative behavior , and 3 ) r , the correlation between genotypes of givers and receivers of cooperation .
cooperation is predicted to evolve when rb > c , a condition known as hamilton 's rule [ 9 ] .
the cost and benefit factors are measured in terms of reproductive fitness .
when cooperation is genetically determined , relatedness may be thought of as the degree to which the benefits of cooperation are preferentially distributed to other cooperative individuals .
the segregation index depicted in figures 2 and 4 is equivalent to a form of the relatedness coefficient in hamilton 's rule : both measure the degree of biased interaction among relatives ( here , physical proximity amounts to biased interaction ) .
as such , our segregation index forms a bridge between social evolution theory and the emergence of lineage segregation in cell groups , allowing us to extend our prediction from the previous section .
because thin active layer conditions generate lineage segregation , we predict that decreasing active layer depth will promote interaction among clonemates ( increasing r in hamilton 's rule ) and favor the evolution of cooperation [ 9 ],[ 12 ],[ 23 ] .
positive spatial assortment of related cells does not guarantee that cooperation will be favored , however , as the same segregation that allows cooperators to preferentially interact also increases the strength of competition between them [ 24 ] .
we tested our prediction by implementing a cooperative phenotype in our model framework and competing cooperative cells against exploitative cells that devote all resources to growth .
cooperative individuals secrete a diffusible compound that benefits all other cells in the local area ( we will refer to the compound as an extracellular enzyme ) .
local availability of the secreted enzyme increases cell growth rate by a fold factor b , but only after the enzyme 's concentration passes a threshold value , tau .
cooperative cells constitutively secrete the enzyme and incur a fold decrease in growth rate of c x re , where c is a cost scaling factor and re is the enzyme production rate .
in our main analysis , b = 3 , c = 0.3 , and re ranges from 0 to 2 .
we derived these values from experimental data on elastase , a secreted enzyme and virulence factor of the bacterial pathogen pseudomonas aeruginosa [ 19 ],[ 46 ] .
lineage segregation favors cooperation in cell groups we asked whether a cooperative cell line , which pays a cost to produce a diffusible , publicly beneficial compound , could outcompete an exploitative cell line that invests all of its resources into growth .
each competition simulation began with a randomly distributed 1:1 mixed monolayer of the two cell types , and cell groups were grown to a maximum height of 100 microm .
we then calculated the evolutionary fitness of the cooperative cell line , relative to that of the exploitative cell line ( methods ) .
this competition pairing was repeated over a range of extracellular enzyme production rates on the part of cooperative cells .
the higher the enzyme production rate , the more rapidly cells accrue its benefit , but the larger the cost suffered by cooperative cells .
finally , all competition pairings were repeated across three active layer depth conditions ( delta = 10 , 2 , 1 ) , representing the three cell group structure regimes described in figure 1 .
figure 5 summarizes the results of our competition simulations .
when active layers are thick ( delta = 10 ) , leading to well mixed cell lineages , the extracellular enzyme is homogenously distributed through cell groups .
the non - cooperative cell line is therefore able to consistently exploit and outcompete the cooperative cell line ( figure 5a ) .
this result is consistent with numerous observations that exploitative mutants outcompete enzyme - secreting bacteria when they are inoculated together in liquid culture , in which cell lineages largely remain mixed [ 17 ] - [ 20 ] .
10.1371 / journal.pcbi.1000716.g005 figure 5 cooperation is favored as cell group active layer depth decreases and lineage segregation increases .
we examined competition between enzyme - secreting cells ( cooperative , labeled blue ) and non - secreting cells ( exploitative , labeled red ) under three different active layer conditions : delta = 10 ( a , well mixed lineages ) , delta = 2 ( b , lineage sectoring ) , and delta = 1 ( c , lineage tower formation ) .
each empty black circle denotes the relative fitness of the cooperative cell type at the end of a single simulation ( 40 replicates per column ) .
sample images ( drawn from simulations indicated by black arrows ) are shown in the corner of each plot , along with concentration [ g / l ] profiles of the extracellular enzyme .
( a ) when cell lineages remain mixed , cooperative cells are always outgrown by exploitative cells .
( b ) when cell lineages segregate into sectors , there is a narrow range of enzyme production rates at which cooperative cells outcompete exploitative cells .
( c ) when lineages are strongly segregated into cell tower projections , there is a large range of enzyme production rates at which cooperative cells outcompete exploitative cells .
when active layer depth is decreased ( delta = 2 ) , there is a narrow range of extracellular enzyme production rates at which cooperative cells outcompete exploitative cells ( figure 5b ) .
the critical difference is that cooperative cells and exploitative cells no longer remain well mixed ; rather , they segregate into clonal regions .
as a result , the benefit of extracellular enzyme released by cooperative cells accrues asymmetrically to other cooperative cells .
the range of enzyme production rates at which cooperative cells prevail is narrow , however , because the benefits of lineage segregation ( increasing r in hamilton 's rule ) can be outweighed by the cost of higher extracellular enzyme production ( increasing c in hamilton 's rule ) .
further decreasing active layer depth ( delta = 1 ) leads to the growth of spatially isolated , clonal cell towers .
under these conditions , the benefits of a cooperative secreted enzyme are distributed even more asymmetrically to other cooperative cells .
consistent with our predictions , this allows cooperative cells to outcompete exploitative cells over a larger range of enzyme production rates ( figure 5c ) .
we also noted the sizable variation between simulation runs when delta = 1 , particularly if extracellular enzyme production rates were low ( figure 5c , enzyme production rate = 0 , 0.25 , 0.5 ) .
this variation reflects a founder effect ; it manifests most strongly when there is no or little difference between the competitive abilities of cooperative and exploitative cell lines , rendering the outcome of each simulation subject to chance events that determine which cells seed the few tower structures that emerge from an expanding cell group .
our results show that thin active layer conditions allow cells expressing cooperative phenotypes to outcompete exploitative cells within a single cell group .
to better account for the long - term evolution of a metapopulation comprising many cell groups , we performed an invasion analysis to determine whether a novel cooperative mutant can spread through a metapopulation otherwise containing only exploitative cells ( supporting information , text s1 ) .
we also examined the reciprocal case to determine if a rare exploitative mutant can invade a metapopulation otherwise containing only cooperative cells [ 32 ],[ 33 ] .
we found that cooperation can invade under a large swath of parameter space , but only under thin active layer conditions that promote lineage segregation can cooperative cells eliminate exploitative cell types on a metapopulation scale ( supporting information , figure s2 ) .
the results of both our local competition and invasion analyses are robust to the cost / benefit ratio of cooperation , with one partial exception when cells invest very heavily into an expensive cooperative phenotype ( supporting information , figure s3 ) .
conclusion our study indicates that an order of magnitude change in nutrient availability , nutrient diffusivity , cell metabolic efficiency , cell growth rate , or biomass density can shift cell groups from a regime of lineage mixing to a regime of pronounced lineage segregation .
the number delta defined in equation 1 relates these parameters to the depth of a cell group 's active layer , which governs how cell lineages become spatially assorted over time .
thick active layers promote lineage mixing , while decreasing active layer depth generates increasingly strong lineage segregation .
cell lineage segregation , in turn , favors the evolution of cooperative phenotypes .
previous work performed with bacteria in liquid planktonic culture has concluded that cooperative cell phenotypes cannot be selectively favored within a single population also containing exploitative cells [ 17 ],[ 19 ],[ 20 ] .
our study shows that this conclusion will not always hold because cooperative cells can spontaneously segregate from exploitative cells when they are constrained in space .
our results also imply that , given realistic parameters for a cooperative cell phenotype , the benefits of preferential interaction between cooperators can outweigh the costs of increased competition between related cells that are clustered together in space [ 24 ] .
like all models , ours uses simplifying assumptions .
we deliberately omit some physical processes , such as shear stress , that may be applied to cell groups in the real world [ 47 ] .
our simulations also do not consider active cell motility , which in reality could influence cell group structure and evolution .
we have additionally assumed that cell phenotypes of interest , such as extracellular enzyme secretion , are expressed constitutively or not at all .
in nature , the expression of many social phenotypes is adjusted in response to environmental cues [ 48 ] - [ 50 ] .
though these simplifications should be assessed theoretically and empirically , they were critical in allowing us to identify basic physical and biological parameters that control cell group structure and evolution .
in summary , our model suggests that clusters of genetically related cells can emerge quite easily in spatially constrained cell groups , even when cells possess no mechanism for actively gathering with clonemates .
lineage segregation allows cooperative cells to outcompete exploitative cells , and accordingly we predict that localized cooperation will evolve more readily in cell groups than suggested by models and experiments that only consider liquid environments .
methods model framework we simulate cell groups using an individual - based model described in detail previously [ 31 ] .
simulation parameters are listed in table s1 ( supporting information ) .
cell growth is a function of the local microenvironment , namely the concentrations of solutes such as growth substrate ( g ) and extracellular enzyme ( e ) ( supporting information , table s2 ) .
the uptake of growth substrate by each cell is considered when calculating the spatial gradients of substrate concentration .
we achieve this by solving a reaction - diffusion equation , where r is a growth rate expression : ( 2 ) following the common assumption that reaction - diffusion is much faster than cell growth and division [ 31 ] , our simulations proceed according to the following steps : cell growth and division 1 ) every cellular agent grows according to local substrate concentration and ( for competition simulations ) extracellular enzyme availability .
agents that exceed a critical radius are divided into two new agents .
2 ) agents that now overlap due to their growth and / or division in the previous step are moved so as to eliminate overlap throughout the cell group .
this process causes the cell group 's front to advance in space .
update solute concentration fields 3 ) bulk concentrations of all solutes ( growth substrate or extracellular enzyme ) are held constant throughout the simulation .
thus , the bulk liquid ( the region outside the boundary layer ) acts as an infinite source , in the case of substrate , or a perfect sink , in the case of extracellular enzyme .
4 ) the new spatial concentration fields of all solutes are determined by solving equation 2 ( and an analogous equation for extracellular enzyme concentration ) to steady state at each iteration .
computation the individual - based simulation framework was written in the java programming language , and its related numerical methods are detailed elsewhere [ 31 ] .
briefly , they include the euler method to grow cells at each iteration , a hard - sphere collision detection method to identify pushing events between neighboring agents , and the fas multigrid to solve reaction - diffusion equations to steady state [ 51 ] .
the 3d images in figure s1 where rendered using pov - ray .
all other figures were prepared using matlab ( the mathworks , inc. ) .
the computations in this paper were run on the odyssey cluster supported by the harvard university fas research computing group .
calculation of the segregation index to obtain the segregation index for a cell group at a single point in time , we first identify every actively growing cell .
these m cells are indexed by ai : a 1 , a 2 , ... , am. to measure segregation with respect to a single focal cell ai , we identify all other individuals within a distance of 10 cell lengths .
the n cells in this neighborhood are indexed by aj : a 1 , a 2 , ... , an. we define a genetic identity function , g ( aj ) : ( 3 ) and a metabolic activity function , m ( aj ) : ( 4 ) where [ g ] is the local concentration of growth substrate , and kg is the half - saturation constant for cell growth rate .
segregation with respect to a focal cell , s ( ai ) , is calculated as the mean product of the g and m functions for every cell in its neighborhood : ( 5 ) finally , we define the segregation index for the entire cell group as the mean value of s ( ai ) across all metabolically active cells : ( 6 ) our segregation index measures the degree to which co - localized , metabolically active cells are clonally related to each other .
the index is equal to a form of the relatedness coefficient from social evolution theory under the following assumptions : 1 ) a cell expressing the cooperative phenotype equally benefits all other individuals within a 10 cell - length radius ; 2 ) each cell within range of receiving cooperative benefits makes a contribution to mean relatedness proportional to its growth rate ; 3 ) cell groups are seeded randomly from a large population pool .
derivation of the number delta the dimensionless number , delta , is a proxy for the depth to which growth substrate penetrates into a cell group before being depleted by cell metabolic activity .
delta is derived by non - dimensionalizing equation 2 .
we normalize growth substrate concentration by its bulk liquid concentration , , and local biomass by cell biomass density , x = x / rho .
we then normalize the space coordinates by the height of the boundary layer , h. the steady state , dimensionless version of equation 2 becomes : ( 7 ) note that the factor multiplying the laplacian of , , is the square of delta as defined in the main text .
delta is also the inverse of the thiele modulus [ 52 ] , a number commonly used in chemical engineering to quantify the activity of solid catalysts .
calculation of evolutionary fitness we calculate the competitive fitness of each cell line as the mean number of rounds of cell division per unit time that each achieves over the course of a simulation : ( 8 ) where ns,t is the number of cells of strain s present within the cell group at time t. the relative fitness of a strain s1 in local competition with another strain s2 is defined as : . supporting information text s1 evolutionary invasion analysis for cooperative extracellular enzyme secretion .
( 0.04 mb doc ) click here for additional data file .
figure s1 3 - d simulations replicate the results of 2 - d simulations examining cell lineage segregation .
cell lineage segregation increases as environmental growth substrate concentration decreases .
this result is valid for both ( a ) surface growth and ( b ) radial growth conditions .
( 8.22 mb tif ) click here for additional data file .
figure s2 a rare cooperative cell line can often invade a metapopulation of exploitative cells .
mean invasiveness ( filled circles , with bars denoting sd ) from 40 replicate simulations was calculated for a cooperative cell line invading a metapopulation of exploitative cells , and for an exploitative cell line invading a metapopulation of cooperative cells .
( a ) under thick active layer conditions that promote lineage mixing , a rare cooperative cell line can invade from rarity ( blue trace ) , despite losing in local competition with exploitative cells ( see main text , fig. 5a ) .
the exploitative cell type can also invade from rarity ( red trace ) .
( b ) and ( c ) under thinner active layer conditions , cooperative cells can again invade from rarity ( blue traces ) , but exploitative cells usually cannot ( red traces ) .
( 0.89 mb tif ) click here for additional data file .
figure s3 the local competition and global invasion analyses were repeated with a higher cost / benefit ratio for cooperative enzyme secretion .
here , b = 0.5 and c = 0.3 .
panels a - c summarize the local competition simulations .
as for figure 5 in the main text , each open black circle represents the reproductive fitness of the cooperative strain after a single simulation .
( a ) under thick active layer conditions , cooperative cells always lose in local competition .
( b - c ) under thin active layer conditions , cooperative cells can prevail over exploitative cells , though under a much narrower range of enzyme production rates than for lower cost / benefit ratio of cooperation ( compare with figure 5b - c , main text ) .
panels d - f summarize the global invasion analysis .
each filled circle denotes mean invasiveness , and bars denote standard deviations .
( d ) cooperative cells can often invade under thick active layer conditions ( blue trace ) , even though such conditions prevent them from prevailing in local competition .
the exploitative cell type can also strongly invade ( red trace ) .
( e - f ) under thin active layer conditions , there is a narrower range of enzyme production rates at which cooperative cells can invade ( blue traces ) .
when cooperative cells can invade , however , they can also prevent the exploitative cell type from re - invading ( red traces are below unity ) .
in this important sense , our results are robust .
it should be noted , however , that when cooperative cells invest heavily into enzyme secretion , they may fare better in global competition under thick active layer conditions that promote lineage mixing ( for enzyme production rate = 2 , the blue trace is above the invasion criterion in d , but below the invasion criterion in e and f ) .
this departure from our broader conclusion occurs because thin active layer conditions , while promoting cell lineage segregation and generally favoring cooperation , also increase the strength of competition within cell groups .
as a result , when it commits a large amount of resources to enzyme secretion , the cooperative cell line can fair so poorly in local competition that it fails to invade on a global scale .
( 1.28 mb tif ) click here for additional data file .
table s1 list of parameters used in our simulation models and subsequent analyses .
( 0.07 mb pdf ) click here for additional data file .
table s2 stoichiometry of cell metabolism used in our simulation models .
( 0.19 mb pdf ) click here for additional data file .
we are grateful to jim adelman , bonnie bassler , iain couzin , adrian de froment , nathan gregory , simon levin , david nelson , katharina ribbeck , dan rubenstein , and ned wingreen for discussions and comments on previous versions of this manuscript .
the authors have declared that no competing interests exist .
cdn is supported by an nsf graduate research fellowship ( http :// www.nsfgrfp.org /) , a princeton university centennial fellowship , and a sigma xi student grant ( http :// www.sigmaxi.org / programs / giar / index.shtml ) .
cdn also acknowledges support from the defense advanced research projects agency ( darpa ) under grant hr0011 - 05 - 1 - 0057 to simon a. levin ( http :// www.darpa.mil / dso / thrusts / math / funmath / fundamental / index.htm ) .
krf and jbx are supported by national institute of general medical sciences center of excellence grant 5p50 gm 068763 - 01 ( http :// www.nigms.nih.gov /) .
the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .
references 1 pfeiffer t bonhoeffer s 2003 an evolutionary scenario for the transition to undifferentiated multicellularity .
proc natl acad sci usa 100 1095 1098 12547910 2 kreft ju 2004 biofilms promote altruism .
microbiol - sgm 150 2751 2760 3 kreft ju bonhoeffer s 2005 the evolution of groups of cooperating bacteria and the growth rate versus yield trade - off .
microbiology 151 637 641 15758209 4 west sa diggle sp buckling a gardner a griffins as 2007 the social lives of microbes .
annu rev ecol evol s 38 53 77 5 stetler - stevenson wg aznavoorian s liotta la 1993 tumor cell interactions with the extracellular matrix during invasion and metastasis .
annu rev cell biol 9 541 573 8280471 6 lee v 2001 protein secretion and the pathogenesis of bacterial infections .
gene dev 15 1725 1752 11459823 7 egeblad m werb z 2002 new functions for the matrix metalloproteinases in cancer progression .
nat rev cancer 2 161 174 11990853 8 coussens lm fingleton b matrisian lm 2002 matrix metalloproteinase inhibitors and cancer - trials and tribulations .
science 295 2387 2392 11923519 9 hamilton wd 1964 the genetical evolution of social behaviour i & ii. j theor biol 7 1 52 5875341 10 crespi bj 2001 the evolution of social behavior in microorganisms .
trends ecol evol 16 178 183 11245940 11 axelrod r axelrod de pienta kj 2006 evolution of cooperation among tumor cells .
proc natl acad sci usa 103 13474 13479 16938860 12 nadell cd xavier jb foster kr 2009 the sociobiology of biofilms .
fems microbiol rev 33 206 224 19067751 13 kolenbrander pe 2000 oral microbial communities : biofilms , interactions , and genetic systems .
annu rev microbiol 54 413 437 11018133 14 hall - stoodley l costerton jw stoodley p 2004 bacterial biofilms : from the natural environment to infectious diseases .
nat rev microbiol 2 95 108 15040259 15 maley cc galipeau pc finley jc wongsurawat vj li x 2006 genetic clonal diversity predicts progression to esophageal adenocarcinoma .
nat genet 38 468 473 16565718 16 lyons j lobo e martorana a myerscough m 2008 clonal diversity in carcinomas : its implications for tumour progression and the contribution made to it by epithelial - mesenchymal transitions .
clin exp metastasis 25 665 677 18071912 17 griffin as west sa buckling a 2004 cooperation and competition in pathogenic bacteria .
nature 430 1024 1027 15329720 18 sandoz km mitzimberg sm schuster m 2007 social cheating in pseudomonas aeruginosa quorum sensing .
proc natl acad sci usa 104 15876 15881 17898171 19 diggle s griffin a campbell g west s 2007 cooperation and conflict in quorum - sensing bacterial populations .
nature 450 411 414 18004383 20 chuang js rivoire o leibler s 2009 simpson 's paradox in a synthetic microbial system .
science 323 272 275 19131632 21 gore j youk h van oudenaarden a 2009 snowdrift game dynamics and facultative cheating in yeast .
nature 459 253 256 19349960 22 durrett r levin s 1994 the importance of being discrete ( and spatial ) .
theor pop biol 46 363 394 23 mitteldorf j wilson ds 2000 population viscosity and the evolution of altruism .
j theor biol 204 481 496 10833350 24 griffin as west sa 2002 kin selection : fact and fiction .
trends ecol evol 17 15 21 25 axelrod r hammond ra grafen a 2004 altruism via kin - selection strategies that rely on arbitrary tags with which they coevolve .
evolution 58 1833 1838 15446434 26 golding i cohen i ben - jacob e 1999 studies of sector formation in expanding bacterial colonies .
europhys lett 48 587 593 27 hallatschek o hersen p ramanathan s nelson dr 2007 genetic drift at expanding frontiers promotes gene segregation .
proc natl acad sci usa 104 19926 19930 18056799 28 klopfstein s currat m excoffier l 2005 the fate of mutations surfing on the wave of a range expansion .
mol biol evol 23 482 490 16280540 29 hallatschek o nelson dr 2007 gene surfing in expanding populations .
theor pop biol 73 158 170 17963807 30 excoffier l ray n 2008 surfing during population expansions promotes genetic revolutions and structuration .
trends ecol evol 23 347 351 18502536 31 xavier jb picioreanu c van loosdrecht mcm 2005 a framework for multidimensional modelling of activity and structure of multispecies biofilms .
environ microbiol 7 1085 1103 16011747 32 xavier jb foster kr 2007 cooperation and conflict in microbial biofilms .
proc natl acad sci usa 104 876 881 17210916 33 nadell cd xavier jb levin sa foster kr 2008 the evolution of quorum sensing in bacterial biofilms .
plos biol 6 e14 18232735 34 matsushita m fujikawa hh 1990 diffusion - limited growth in bacterial colony formation .
physica a 168 498 506 35 ben - jacob e schochet o tenenbaum a cohen i czirok a 1994 generic modelling of cooperative growth patterns in bacterial colonies .
nature 368 46 49 8107881 36 kessler da levine h 1998 fluctuation - induced diffusive instabilities .
nature 394 556 558 37 xavier jb picioreanu c van loosdrecht mcm 2004 assessment of three - dimensional biofilm models through direct comparison with confocal microscopy imaging .
wat sci technol 49 177 185 38 xavier jb de kreuk mk picioreanu c van loosdrecht mcm 2007 multi - scale individual - based model of microbial and bioconversion dynamics in aerobic granular sludge .
environ sci technol 41 6410 6417 17948787 39 kitsunezaki s 1997 interface dynamics for bacterial colony formation .
j phys soc jpn 66 1544 1550 40 motoike in 2007 simple modeling of branching pattern formation in a reaction diffusion system with cellular automaton .
j phys soc jpn 76 034002 41 homsy gm 1987 viscous fingering in porous media .
annu rev fluid mech 19 271 311 42 harrison f browning le vos m buckling a 2006 cooperation and virulence in acute pseudomonas aeruginosa infections .
bmc biol 4 32 17002801 43 inglis rf gardner a cornelis p buckling a 2009 spite and virulence in the bacterium pseudomonas aeruginosa .
proc natl acad sci usa 106 5703 5707 19321425 44 rumbaugh kp diggle sp watters cm ross - gillespie a griffin as 2009 quorum sensing and the social evolution of bacterial virulence .
curr biol 19 341 345 19230668 45 kohler t buckling a van delden c 2009 cooperation and virulence of clinical pseudomonas aeruginosa populations .
proc natl acad sci usa 106 6339 6344 19332772 46 galloway dr 1991 pseudomonas aeruginosa elastase and elastolysis revisited : recent developments .
mol microbiol 5 2315 2321 1791748 47 xavier jb picioreanu c van loosdrecht mcm 2005 a general description of detachment for multidimensional modelling of biofilms .
biotechnol bioeng 91 651 669 15918167 48 waters cm bassler bl 2005 quorum sensing : cell - to - cell communication in bacteria .
annu rev cell dev biol 21 319 346 16212498 49 bassler bl losick r 2006 bacterially speaking .
cell 125 237 246 16630813 50 nadell cd bassler bl levin sa 2008 observing bacteria through the lens of social evolution .
j biol 7 27 18831723 51 press wh flannery bp teukolsky sa vetterling wt 1997 numerical recipes in c : the art of scientific computing .
cambridge cambridge university press 882 888 52 thiele e 1939 relation between catalytic activity and size of particle .
ind eng chem 31 916 920